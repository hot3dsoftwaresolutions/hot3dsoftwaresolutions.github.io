"use strict";(self.webpackChunkng=self.webpackChunkng||[]).push([[179],{384:(Zu,Oa,Mi)=>{Mi.d(Oa,{Uw:()=>ns,fo:()=>Si});var it=Mi(239);"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global&&global;var Hi=(()=>{return(Xe=Hi||(Hi={})).Unimplemented="UNIMPLEMENTED",Xe.Unavailable="UNAVAILABLE",Hi;var Xe})();class Ei extends Error{constructor(ye,Se,_t){super(ye),this.message=ye,this.code=Se,this.data=_t}}const Dr=Xe=>{var ye,Se,_t,Nt,Oe;const dn=Xe.CapacitorCustomPlatform||null,mt=Xe.Capacitor||{},qn=mt.Plugins=mt.Plugins||{},yn=Xe.CapacitorPlatforms,Ls=(null===(ye=null==yn?void 0:yn.currentPlatform)||void 0===ye?void 0:ye.getPlatform)||(()=>null!==dn?dn.name:(Xe=>{var ye,Se;return(null==Xe?void 0:Xe.androidBridge)?"android":(null===(Se=null===(ye=null==Xe?void 0:Xe.webkit)||void 0===ye?void 0:ye.messageHandlers)||void 0===Se?void 0:Se.bridge)?"ios":"web"})(Xe)),On=(null===(Se=null==yn?void 0:yn.currentPlatform)||void 0===Se?void 0:Se.isNativePlatform)||(()=>"web"!==Ls()),sc=(null===(_t=null==yn?void 0:yn.currentPlatform)||void 0===_t?void 0:_t.isPluginAvailable)||(rn=>{const kn=$o.get(rn);return!(!(null==kn?void 0:kn.platforms.has(Ls()))&&!Ha(rn))}),Ha=(null===(Nt=null==yn?void 0:yn.currentPlatform)||void 0===Nt?void 0:Nt.getPluginHeader)||(rn=>{var kn;return null===(kn=mt.PluginHeaders)||void 0===kn?void 0:kn.find(qo=>qo.name===rn)}),$o=new Map,Em=(null===(Oe=null==yn?void 0:yn.currentPlatform)||void 0===Oe?void 0:Oe.registerPlugin)||((rn,kn={})=>{const qo=$o.get(rn);if(qo)return console.warn(`Capacitor plugin "${rn}" already registered. Cannot register plugins twice.`),qo.proxy;const is=Ls(),Xo=Ha(rn);let hr;const oc=function(){var Gt=(0,it.Z)(function*(){return!hr&&is in kn?hr=hr="function"==typeof kn[is]?yield kn[is]():kn[is]:null!==dn&&!hr&&"web"in kn&&(hr=hr="function"==typeof kn.web?yield kn.web():kn.web),hr});return function(){return Gt.apply(this,arguments)}}(),rs=Gt=>{let Kn;const Qt=(...Rr)=>{const ho=oc().then(Vi=>{const Qo=((Gt,Kn)=>{var Qt,Rr;if(!Xo){if(Gt)return null===(Rr=Gt[Kn])||void 0===Rr?void 0:Rr.bind(Gt);throw new Ei(`"${rn}" plugin is not implemented on ${is}`,Hi.Unimplemented)}{const ho=null==Xo?void 0:Xo.methods.find(Vi=>Kn===Vi.name);if(ho)return"promise"===ho.rtype?Vi=>mt.nativePromise(rn,Kn.toString(),Vi):(Vi,Qo)=>mt.nativeCallback(rn,Kn.toString(),Vi,Qo);if(Gt)return null===(Qt=Gt[Kn])||void 0===Qt?void 0:Qt.bind(Gt)}})(Vi,Gt);if(Qo){const hn=Qo(...Rr);return Kn=null==hn?void 0:hn.remove,hn}throw new Ei(`"${rn}.${Gt}()" is not implemented on ${is}`,Hi.Unimplemented)});return"addListener"===Gt&&(ho.remove=(0,it.Z)(function*(){return Kn()})),ho};return Qt.toString=()=>`${Gt.toString()}() { [capacitor code] }`,Object.defineProperty(Qt,"name",{value:Gt,writable:!1,configurable:!1}),Qt},Va=rs("addListener"),Ki=rs("removeListener"),Zo=(Gt,Kn)=>{const Qt=Va({eventName:Gt},Kn),Rr=function(){var Vi=(0,it.Z)(function*(){const Qo=yield Qt;Ki({eventName:Gt,callbackId:Qo},Kn)});return function(){return Vi.apply(this,arguments)}}(),ho=new Promise(Vi=>Qt.then(()=>Vi({remove:Rr})));return ho.remove=(0,it.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield Rr()}),ho},Yo=new Proxy({},{get(Gt,Kn){switch(Kn){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return Xo?Zo:Va;case"removeListener":return Ki;default:return rs(Kn)}}});return qn[rn]=Yo,$o.set(rn,{name:rn,proxy:Yo,platforms:new Set([...Object.keys(kn),...Xo?[is]:[]])}),Yo});return mt.convertFileSrc||(mt.convertFileSrc=rn=>rn),mt.getPlatform=Ls,mt.handleError=rn=>Xe.console.error(rn),mt.isNativePlatform=On,mt.isPluginAvailable=sc,mt.pluginMethodNoop=(rn,kn,qo)=>Promise.reject(`${qo} does not have an implementation of "${kn}".`),mt.registerPlugin=Em,mt.Exception=Ei,mt.DEBUG=!!mt.DEBUG,mt.isLoggingEnabled=!!mt.isLoggingEnabled,mt.platform=mt.getPlatform(),mt.isNative=mt.isNativePlatform(),mt},dr=(Xe=>Xe.Capacitor=Dr(Xe))("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{}),Si=dr.registerPlugin;class ns{constructor(ye){this.listeners={},this.windowListeners={},ye&&(console.warn(`Capacitor WebPlugin "${ye.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=ye)}addListener(ye,Se){var _t=this;this.listeners[ye]||(this.listeners[ye]=[]),this.listeners[ye].push(Se);const Oe=this.windowListeners[ye];Oe&&!Oe.registered&&this.addWindowListener(Oe);const dn=function(){var qn=(0,it.Z)(function*(){return _t.removeListener(ye,Se)});return function(){return qn.apply(this,arguments)}}(),mt=Promise.resolve({remove:dn});return Object.defineProperty(mt,"remove",{value:(qn=(0,it.Z)(function*(){console.warn("Using addListener() without 'await' is deprecated."),yield dn()}),function(){return qn.apply(this,arguments)})}),mt;var qn}removeAllListeners(){var ye=this;return(0,it.Z)(function*(){ye.listeners={};for(const Se in ye.windowListeners)ye.removeWindowListener(ye.windowListeners[Se]);ye.windowListeners={}})()}notifyListeners(ye,Se){const _t=this.listeners[ye];_t&&_t.forEach(Nt=>Nt(Se))}hasListeners(ye){return!!this.listeners[ye].length}registerWindowListener(ye,Se){this.windowListeners[Se]={registered:!1,windowEventName:ye,pluginEventName:Se,handler:_t=>{this.notifyListeners(Se,_t)}}}unimplemented(ye="not implemented"){return new dr.Exception(ye,Hi.Unimplemented)}unavailable(ye="not available"){return new dr.Exception(ye,Hi.Unavailable)}removeListener(ye,Se){var _t=this;return(0,it.Z)(function*(){const Nt=_t.listeners[ye];if(!Nt)return;const Oe=Nt.indexOf(Se);_t.listeners[ye].splice(Oe,1),_t.listeners[ye].length||_t.removeWindowListener(_t.windowListeners[ye])})()}addWindowListener(ye){window.addEventListener(ye.windowEventName,ye.handler),ye.registered=!0}removeWindowListener(ye){!ye||(window.removeEventListener(ye.windowEventName,ye.handler),ye.registered=!1)}}const Ps=Xe=>encodeURIComponent(Xe).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);class jo extends ns{setCookie(ye){return(0,it.Z)(function*(){try{const Se=Ps(ye.key),_t=Ps(ye.value),Nt=`; expires=${(ye.expires||"").replace("expires=","")}`,Oe=(ye.path||"/").replace("path=","");document.cookie=`${Se}=${_t||""}${Nt}; path=${Oe}`}catch(Se){return Promise.reject(Se)}})()}deleteCookie(ye){return(0,it.Z)(function*(){try{document.cookie=`${ye.key}=; Max-Age=0`}catch(Se){return Promise.reject(Se)}})()}clearCookies(){return(0,it.Z)(function*(){try{const ye=document.cookie.split(";")||[];for(const Se of ye)document.cookie=Se.replace(/^ +/,"").replace(/=.*/,`=;expires=${(new Date).toUTCString()};path=/`)}catch(ye){return Promise.reject(ye)}})()}clearAllCookies(){var ye=this;return(0,it.Z)(function*(){try{yield ye.clearCookies()}catch(Se){return Promise.reject(Se)}})()}}Si("CapacitorCookies",{web:()=>new jo});const ka=function(){var Xe=(0,it.Z)(function*(ye){return new Promise((Se,_t)=>{const Nt=new FileReader;Nt.onload=()=>{const Oe=Nt.result;Se(Oe.indexOf(",")>=0?Oe.split(",")[1]:Oe)},Nt.onerror=Oe=>_t(Oe),Nt.readAsDataURL(ye)})});return function(Se){return Xe.apply(this,arguments)}}();class $h extends ns{request(ye){return(0,it.Z)(function*(){const Se=((Xe,ye={})=>{const Se=Object.assign({method:Xe.method||"GET",headers:Xe.headers},ye),Nt=((Xe={})=>{const ye=Object.keys(Xe);return Object.keys(Xe).map(Nt=>Nt.toLocaleLowerCase()).reduce((Nt,Oe,dn)=>(Nt[Oe]=Xe[ye[dn]],Nt),{})})(Xe.headers)["content-type"]||"";if("string"==typeof Xe.data)Se.body=Xe.data;else if(Nt.includes("application/x-www-form-urlencoded")){const Oe=new URLSearchParams;for(const[dn,mt]of Object.entries(Xe.data||{}))Oe.set(dn,mt);Se.body=Oe.toString()}else if(Nt.includes("multipart/form-data")){const Oe=new FormData;if(Xe.data instanceof FormData)Xe.data.forEach((mt,qn)=>{Oe.append(qn,mt)});else for(const mt of Object.keys(Xe.data))Oe.append(mt,Xe.data[mt]);Se.body=Oe;const dn=new Headers(Se.headers);dn.delete("content-type"),Se.headers=dn}else(Nt.includes("application/json")||"object"==typeof Xe.data)&&(Se.body=JSON.stringify(Xe.data));return Se})(ye,ye.webFetchExtra),_t=((Xe,ye=!0)=>Xe?Object.entries(Xe).reduce((_t,Nt)=>{const[Oe,dn]=Nt;let mt,qn;return Array.isArray(dn)?(qn="",dn.forEach(yn=>{mt=ye?encodeURIComponent(yn):yn,qn+=`${Oe}=${mt}&`}),qn.slice(0,-1)):(mt=ye?encodeURIComponent(dn):dn,qn=`${Oe}=${mt}`),`${_t}&${qn}`},"").substr(1):null)(ye.params,ye.shouldEncodeUrlParams),Nt=_t?`${ye.url}?${_t}`:ye.url,Oe=yield fetch(Nt,Se),dn=Oe.headers.get("content-type")||"";let qn,yn,{responseType:mt="text"}=Oe.ok?ye:{};switch(dn.includes("application/json")&&(mt="json"),mt){case"arraybuffer":case"blob":yn=yield Oe.blob(),qn=yield ka(yn);break;case"json":qn=yield Oe.json();break;default:qn=yield Oe.text()}const Ri={};return Oe.headers.forEach((Ls,Ua)=>{Ri[Ua]=Ls}),{data:qn,headers:Ri,status:Oe.status,url:Oe.url}})()}get(ye){var Se=this;return(0,it.Z)(function*(){return Se.request(Object.assign(Object.assign({},ye),{method:"GET"}))})()}post(ye){var Se=this;return(0,it.Z)(function*(){return Se.request(Object.assign(Object.assign({},ye),{method:"POST"}))})()}put(ye){var Se=this;return(0,it.Z)(function*(){return Se.request(Object.assign(Object.assign({},ye),{method:"PUT"}))})()}patch(ye){var Se=this;return(0,it.Z)(function*(){return Se.request(Object.assign(Object.assign({},ye),{method:"PATCH"}))})()}delete(ye){var Se=this;return(0,it.Z)(function*(){return Se.request(Object.assign(Object.assign({},ye),{method:"DELETE"}))})()}}Si("CapacitorHttp",{web:()=>new $h})},892:(Zu,Oa,Mi)=>{function it(t){return"function"==typeof t}function As(t){const i=t(r=>{Error.call(r),r.stack=(new Error).stack});return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}const lo=As(t=>function(i){t(this),this.message=i?`${i.length} errors occurred during unsubscription:\n${i.map((r,o)=>`${o+1}) ${r.toString()}`).join("\n  ")}`:"",this.name="UnsubscriptionError",this.errors=i});function Cr(t,e){if(t){const i=t.indexOf(e);0<=i&&t.splice(i,1)}}class ci{constructor(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}unsubscribe(){let e;if(!this.closed){this.closed=!0;const{_parentage:i}=this;if(i)if(this._parentage=null,Array.isArray(i))for(const l of i)l.remove(this);else i.remove(this);const{initialTeardown:r}=this;if(it(r))try{r()}catch(l){e=l instanceof lo?l.errors:[l]}const{_finalizers:o}=this;if(o){this._finalizers=null;for(const l of o)try{Hi(l)}catch(d){e=null!=e?e:[],d instanceof lo?e=[...e,...d.errors]:e.push(d)}}if(e)throw new lo(e)}}add(e){var i;if(e&&e!==this)if(this.closed)Hi(e);else{if(e instanceof ci){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=null!==(i=this._finalizers)&&void 0!==i?i:[]).push(e)}}_hasParent(e){const{_parentage:i}=this;return i===e||Array.isArray(i)&&i.includes(e)}_addParent(e){const{_parentage:i}=this;this._parentage=Array.isArray(i)?(i.push(e),i):i?[i,e]:e}_removeParent(e){const{_parentage:i}=this;i===e?this._parentage=null:Array.isArray(i)&&Cr(i,e)}remove(e){const{_finalizers:i}=this;i&&Cr(i,e),e instanceof ci&&e._removeParent(this)}}ci.EMPTY=(()=>{const t=new ci;return t.closed=!0,t})();const Rs=ci.EMPTY;function Is(t){return t instanceof ci||t&&"closed"in t&&it(t.remove)&&it(t.add)&&it(t.unsubscribe)}function Hi(t){it(t)?t():t.unsubscribe()}const Ei={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},Yi={setTimeout(t,e,...i){const{delegate:r}=Yi;return(null==r?void 0:r.setTimeout)?r.setTimeout(t,e,...i):setTimeout(t,e,...i)},clearTimeout(t){const{delegate:e}=Yi;return((null==e?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Dr(t){Yi.setTimeout(()=>{const{onUnhandledError:e}=Ei;if(!e)throw t;e(t)})}function ts(){}const dr=ic("C",void 0,void 0);function ic(t,e,i){return{kind:t,value:e,error:i}}let ns=null;function Qi(t){if(Ei.useDeprecatedSynchronousErrorHandling){const e=!ns;if(e&&(ns={errorThrown:!1,error:null}),t(),e){const{errorThrown:i,error:r}=ns;if(ns=null,i)throw r}}else t()}class jo extends ci{constructor(e){super(),this.isStopped=!1,e?(this.destination=e,Is(e)&&e.add(this)):this.destination=Xe}static create(e,i,r){return new Ar(e,i,r)}next(e){this.isStopped?rc(function co(t){return ic("N",t,void 0)}(e),this):this._next(e)}error(e){this.isStopped?rc(function Si(t){return ic("E",void 0,t)}(e),this):(this.isStopped=!0,this._error(e))}complete(){this.isStopped?rc(dr,this):(this.isStopped=!0,this._complete())}unsubscribe(){this.closed||(this.isStopped=!0,super.unsubscribe(),this.destination=null)}_next(e){this.destination.next(e)}_error(e){try{this.destination.error(e)}finally{this.unsubscribe()}}_complete(){try{this.destination.complete()}finally{this.unsubscribe()}}}const Wh=Function.prototype.bind;function ka(t,e){return Wh.call(t,e)}class jh{constructor(e){this.partialObserver=e}next(e){const{partialObserver:i}=this;if(i.next)try{i.next(e)}catch(r){Ba(r)}}error(e){const{partialObserver:i}=this;if(i.error)try{i.error(e)}catch(r){Ba(r)}else Ba(e)}complete(){const{partialObserver:e}=this;if(e.complete)try{e.complete()}catch(i){Ba(i)}}}class Ar extends jo{constructor(e,i,r){let o;if(super(),it(e)||!e)o={next:null!=e?e:void 0,error:null!=i?i:void 0,complete:null!=r?r:void 0};else{let l;this&&Ei.useDeprecatedNextContext?(l=Object.create(e),l.unsubscribe=()=>this.unsubscribe(),o={next:e.next&&ka(e.next,l),error:e.error&&ka(e.error,l),complete:e.complete&&ka(e.complete,l)}):o=e}this.destination=new jh(o)}}function Ba(t){Ei.useDeprecatedSynchronousErrorHandling?function Ps(t){Ei.useDeprecatedSynchronousErrorHandling&&ns&&(ns.errorThrown=!0,ns.error=t)}(t):Dr(t)}function rc(t,e){const{onStoppedNotification:i}=Ei;i&&Yi.setTimeout(()=>i(t,e))}const Xe={closed:!0,next:ts,error:function $h(t){throw t},complete:ts},ye="function"==typeof Symbol&&Symbol.observable||"@@observable";function Se(t){return t}let Oe=(()=>{class t{constructor(i){i&&(this._subscribe=i)}lift(i){const r=new t;return r.source=this,r.operator=i,r}subscribe(i,r,o){const l=function qn(t){return t&&t instanceof jo||function mt(t){return t&&it(t.next)&&it(t.error)&&it(t.complete)}(t)&&Is(t)}(i)?i:new Ar(i,r,o);return Qi(()=>{const{operator:d,source:p}=this;l.add(d?d.call(l,p):p?this._subscribe(l):this._trySubscribe(l))}),l}_trySubscribe(i){try{return this._subscribe(i)}catch(r){i.error(r)}}forEach(i,r){return new(r=dn(r))((o,l)=>{const d=new Ar({next:p=>{try{i(p)}catch(g){l(g),d.unsubscribe()}},error:l,complete:o});this.subscribe(d)})}_subscribe(i){var r;return null===(r=this.source)||void 0===r?void 0:r.subscribe(i)}[ye](){return this}pipe(...i){return function Nt(t){return 0===t.length?Se:1===t.length?t[0]:function(i){return t.reduce((r,o)=>o(r),i)}}(i)(this)}toPromise(i){return new(i=dn(i))((r,o)=>{let l;this.subscribe(d=>l=d,d=>o(d),()=>r(l))})}}return t.create=e=>new t(e),t})();function dn(t){var e;return null!==(e=null!=t?t:Ei.Promise)&&void 0!==e?e:Promise}const yn=As(t=>function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"});let Ri=(()=>{class t extends Oe{constructor(){super(),this.closed=!1,this.currentObservers=null,this.observers=[],this.isStopped=!1,this.hasError=!1,this.thrownError=null}lift(i){const r=new Ls(this,this);return r.operator=i,r}_throwIfClosed(){if(this.closed)throw new yn}next(i){Qi(()=>{if(this._throwIfClosed(),!this.isStopped){this.currentObservers||(this.currentObservers=Array.from(this.observers));for(const r of this.currentObservers)r.next(i)}})}error(i){Qi(()=>{if(this._throwIfClosed(),!this.isStopped){this.hasError=this.isStopped=!0,this.thrownError=i;const{observers:r}=this;for(;r.length;)r.shift().error(i)}})}complete(){Qi(()=>{if(this._throwIfClosed(),!this.isStopped){this.isStopped=!0;const{observers:i}=this;for(;i.length;)i.shift().complete()}})}unsubscribe(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null}get observed(){var i;return(null===(i=this.observers)||void 0===i?void 0:i.length)>0}_trySubscribe(i){return this._throwIfClosed(),super._trySubscribe(i)}_subscribe(i){return this._throwIfClosed(),this._checkFinalizedStatuses(i),this._innerSubscribe(i)}_innerSubscribe(i){const{hasError:r,isStopped:o,observers:l}=this;return r||o?Rs:(this.currentObservers=null,l.push(i),new ci(()=>{this.currentObservers=null,Cr(l,i)}))}_checkFinalizedStatuses(i){const{hasError:r,thrownError:o,isStopped:l}=this;r?i.error(o):l&&i.complete()}asObservable(){const i=new Oe;return i.source=this,i}}return t.create=(e,i)=>new Ls(e,i),t})();class Ls extends Ri{constructor(e,i){super(),this.destination=e,this.source=i}next(e){var i,r;null===(r=null===(i=this.destination)||void 0===i?void 0:i.next)||void 0===r||r.call(i,e)}error(e){var i,r;null===(r=null===(i=this.destination)||void 0===i?void 0:i.error)||void 0===r||r.call(i,e)}complete(){var e,i;null===(i=null===(e=this.destination)||void 0===e?void 0:e.complete)||void 0===i||i.call(e)}_subscribe(e){var i,r;return null!==(r=null===(i=this.source)||void 0===i?void 0:i.subscribe(e))&&void 0!==r?r:Rs}}function Ua(t){return it(null==t?void 0:t.lift)}function On(t){return e=>{if(Ua(e))return e.lift(function(i){try{return t(i,this)}catch(r){this.error(r)}});throw new TypeError("Unable to lift unknown Observable type")}}function In(t,e,i,r,o){return new sc(t,e,i,r,o)}class sc extends jo{constructor(e,i,r,o,l,d){super(e),this.onFinalize=l,this.shouldUnsubscribe=d,this._next=i?function(p){try{i(p)}catch(g){e.error(g)}}:super._next,this._error=o?function(p){try{o(p)}catch(g){e.error(g)}finally{this.unsubscribe()}}:super._error,this._complete=r?function(){try{r()}catch(p){e.error(p)}finally{this.unsubscribe()}}:super._complete}unsubscribe(){var e;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){const{closed:i}=this;super.unsubscribe(),!i&&(null===(e=this.onFinalize)||void 0===e||e.call(this))}}}function nn(t,e){return On((i,r)=>{let o=0;i.subscribe(In(r,l=>{r.next(t.call(e,l,o++))}))})}function Ki(t){return this instanceof Ki?(this.v=t,this):new Ki(t)}function Zo(t,e,i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var o,r=i.apply(t,e||[]),l=[];return o={},d("next"),d("throw"),d("return"),o[Symbol.asyncIterator]=function(){return this},o;function d(P){r[P]&&(o[P]=function(B){return new Promise(function(z,Z){l.push([P,B,z,Z])>1||p(P,B)})})}function p(P,B){try{!function g(P){P.value instanceof Ki?Promise.resolve(P.value.v).then(x,T):D(l[0][2],P)}(r[P](B))}catch(z){D(l[0][3],z)}}function x(P){p("next",P)}function T(P){p("throw",P)}function D(P,B){P(B),l.shift(),l.length&&p(l[0][0],l[0][1])}}function Gt(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,e=t[Symbol.asyncIterator];return e?e.call(t):(t=function hr(t){var e="function"==typeof Symbol&&Symbol.iterator,i=e&&t[e],r=0;if(i)return i.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),i={},r("next"),r("throw"),r("return"),i[Symbol.asyncIterator]=function(){return this},i);function r(l){i[l]=t[l]&&function(d){return new Promise(function(p,g){!function o(l,d,p,g){Promise.resolve(g).then(function(x){l({value:x,done:p})},d)}(p,g,(d=t[l](d)).done,d.value)})}}}const hn=t=>t&&"number"==typeof t.length&&"function"!=typeof t;function qh(t){return it(null==t?void 0:t.then)}function g_(t){return it(t[ye])}function Ko(t){return Symbol.asyncIterator&&it(null==t?void 0:t[Symbol.asyncIterator])}function y_(t){return new TypeError(`You provided ${null!==t&&"object"==typeof t?"an invalid object":`'${t}'`} where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.`)}const Sm=function Jo(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}();function Tm(t){return it(null==t?void 0:t[Sm])}function za(t){return Zo(this,arguments,function*(){const i=t.getReader();try{for(;;){const{value:r,done:o}=yield Ki(i.read());if(o)return yield Ki(void 0);yield yield Ki(r)}}finally{i.releaseLock()}})}function Cm(t){return it(null==t?void 0:t.getReader)}function Ji(t){if(t instanceof Oe)return t;if(null!=t){if(g_(t))return function fo(t){return new Oe(e=>{const i=t[ye]();if(it(i.subscribe))return i.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}(t);if(hn(t))return function Ga(t){return new Oe(e=>{for(let i=0;i<t.length&&!e.closed;i++)e.next(t[i]);e.complete()})}(t);if(qh(t))return function v_(t){return new Oe(e=>{t.then(i=>{e.closed||(e.next(i),e.complete())},i=>e.error(i)).then(null,Dr)})}(t);if(Ko(t))return ea(t);if(Tm(t))return function __(t){return new Oe(e=>{for(const i of t)if(e.next(i),e.closed)return;e.complete()})}(t);if(Cm(t))return function x_(t){return ea(za(t))}(t)}throw y_(t)}function ea(t){return new Oe(e=>{(function w_(t,e){var i,r,o,l;return function kn(t,e,i,r){return new(i||(i=Promise))(function(l,d){function p(T){try{x(r.next(T))}catch(D){d(D)}}function g(T){try{x(r.throw(T))}catch(D){d(D)}}function x(T){T.done?l(T.value):function o(l){return l instanceof i?l:new i(function(d){d(l)})}(T.value).then(p,g)}x((r=r.apply(t,e||[])).next())})}(this,void 0,void 0,function*(){try{for(i=Gt(t);!(r=yield i.next()).done;)if(e.next(r.value),e.closed)return}catch(d){o={error:d}}finally{try{r&&!r.done&&(l=i.return)&&(yield l.call(i))}finally{if(o)throw o.error}}e.complete()})})(t,e).catch(i=>e.error(i))})}function Xn(t,e,i,r=0,o=!1){const l=e.schedule(function(){i(),o?t.add(this.schedule(null,r)):this.unsubscribe()},r);if(t.add(l),!o)return l}function ui(t,e,i=1/0){return it(e)?ui((r,o)=>nn((l,d)=>e(r,l,o,d))(Ji(t(r,o))),i):("number"==typeof e&&(i=e),On((r,o)=>function b_(t,e,i,r,o,l,d,p){const g=[];let x=0,T=0,D=!1;const P=()=>{D&&!g.length&&!x&&e.complete()},B=Z=>x<r?z(Z):g.push(Z),z=Z=>{l&&e.next(Z),x++;let re=!1;Ji(i(Z,T++)).subscribe(In(e,me=>{null==o||o(me),l?B(me):e.next(me)},()=>{re=!0},void 0,()=>{if(re)try{for(x--;g.length&&x<r;){const me=g.shift();d?Xn(e,d,()=>z(me)):z(me)}P()}catch(me){e.error(me)}}))};return t.subscribe(In(e,B,()=>{D=!0,P()})),()=>{null==p||p()}}(r,o,t,i)))}function Ir(t=1/0){return ui(Se,t)}const zi=new Oe(t=>t.complete());function Xh(t){return t[t.length-1]}function Dm(t){return it(Xh(t))?t.pop():void 0}function ta(t){return function E_(t){return t&&it(t.schedule)}(Xh(t))?t.pop():void 0}function ac(t,e=0){return On((i,r)=>{i.subscribe(In(r,o=>Xn(r,t,()=>r.next(o),e),()=>Xn(r,t,()=>r.complete(),e),o=>Xn(r,t,()=>r.error(o),e)))})}function Qu(t,e=0){return On((i,r)=>{r.add(t.schedule(()=>i.subscribe(r),e))})}function Lm(t,e){if(!t)throw new Error("Iterable cannot be null");return new Oe(i=>{Xn(i,e,()=>{const r=t[Symbol.asyncIterator]();Xn(i,e,()=>{r.next().then(o=>{o.done?i.complete():i.next(o.value)})},0,!0)})})}function di(t,e){return e?function Nm(t,e){if(null!=t){if(g_(t))return function Am(t,e){return Ji(t).pipe(Qu(e),ac(e))}(t,e);if(hn(t))return function Im(t,e){return new Oe(i=>{let r=0;return e.schedule(function(){r===t.length?i.complete():(i.next(t[r++]),i.closed||this.schedule())})})}(t,e);if(qh(t))return function Rm(t,e){return Ji(t).pipe(Qu(e),ac(e))}(t,e);if(Ko(t))return Lm(t,e);if(Tm(t))return function Pm(t,e){return new Oe(i=>{let r;return Xn(i,e,()=>{r=t[Sm](),Xn(i,e,()=>{let o,l;try{({value:o,done:l}=r.next())}catch(d){return void i.error(d)}l?i.complete():i.next(o)},0,!0)}),()=>it(null==r?void 0:r.return)&&r.return()})}(t,e);if(Cm(t))return function Fm(t,e){return Lm(za(t),e)}(t,e)}throw y_(t)}(t,e):Ji(t)}function lc(t){return t<=0?()=>zi:On((e,i)=>{let r=0;e.subscribe(In(i,o=>{++r<=t&&(i.next(o),t<=r&&i.complete())}))})}function Ku(t,e,...i){return!0===e?(t(),null):!1===e?null:e(...i).pipe(lc(1)).subscribe(()=>t())}function on(t){for(let e in t)if(t[e]===on)return e;throw Error("Could not find renamed property on target object.")}function Kt(t){if("string"==typeof t)return t;if(Array.isArray(t))return"["+t.map(Kt).join(", ")+"]";if(null==t)return""+t;if(t.overriddenName)return`${t.overriddenName}`;if(t.name)return`${t.name}`;const e=t.toString();if(null==e)return""+e;const i=e.indexOf("\n");return-1===i?e:e.substring(0,i)}function ed(t,e){return null==t||""===t?null===e?"":e:null==e||""===e?t:t+" "+e}const Bm=on({__forward_ref__:on});function td(t){return t.__forward_ref__=td,t.toString=function(){return Kt(this())},t}function gt(t){return Yh(t)?t():t}function Yh(t){return"function"==typeof t&&t.hasOwnProperty(Bm)&&t.__forward_ref__===td}class Be extends Error{constructor(e,i){super(function Qh(t,e){return`NG0${Math.abs(t)}${e?": "+e:""}`}(e,i)),this.code=e}}function dt(t){return"string"==typeof t?t:null==t?"":String(t)}function Ii(t){return"function"==typeof t?t.name||t.toString():"object"==typeof t&&null!=t&&"function"==typeof t.type?t.type.name||t.type.toString():dt(t)}function Fs(t,e){const i=e?` in ${e}`:"";throw new Be(-201,`No provider for ${Ii(t)} found${i}`)}function fr(t,e){null==t&&function Wt(t,e,i,r){throw new Error(`ASSERTION ERROR: ${t}`+(null==r?"":` [Expected=> ${i} ${r} ${e} <=Actual]`))}(e,t,null,"!=")}function at(t){return{token:t.token,providedIn:t.providedIn||null,factory:t.factory,value:void 0}}function Pr(t){return{providers:t.providers||[],imports:t.imports||[]}}function Vm(t){return A_(t,tf)||A_(t,I_)}function A_(t,e){return t.hasOwnProperty(e)?t[e]:null}function R_(t){return t&&(t.hasOwnProperty(zm)||t.hasOwnProperty(lE))?t[zm]:null}const tf=on({\u0275prov:on}),zm=on({\u0275inj:on}),I_=on({ngInjectableDef:on}),lE=on({ngInjectorDef:on});var ht=(()=>((ht=ht||{})[ht.Default=0]="Default",ht[ht.Host=1]="Host",ht[ht.Self=2]="Self",ht[ht.SkipSelf=4]="SkipSelf",ht[ht.Optional=8]="Optional",ht))();let nf;function er(t){const e=nf;return nf=t,e}function P_(t,e,i){const r=Vm(t);return r&&"root"==r.providedIn?void 0===r.value?r.value=r.factory():r.value:i&ht.Optional?null:void 0!==e?e:void Fs(Kt(t),"Injector")}function na(t){return{toString:t}.toString()}var ss=(()=>((ss=ss||{})[ss.OnPush=0]="OnPush",ss[ss.Default=1]="Default",ss))(),os=(()=>{return(t=os||(os={}))[t.Emulated=0]="Emulated",t[t.None=2]="None",t[t.ShadowDom=3]="ShadowDom",os;var t})();const cE="undefined"!=typeof globalThis&&globalThis,Gm="undefined"!=typeof window&&window,rf="undefined"!=typeof self&&"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&self,ft=cE||"undefined"!=typeof global&&global||Gm||rf,as={},St=[],wn=on({\u0275cmp:on}),uc=on({\u0275dir:on}),sf=on({\u0275pipe:on}),Wm=on({\u0275mod:on}),tr=on({\u0275fac:on}),dc=on({__NG_ELEMENT_ID__:on});let F_=0;function qa(t){return na(()=>{const i={},r={type:t.type,providersResolver:null,decls:t.decls,vars:t.vars,factory:null,template:t.template||null,consts:t.consts||null,ngContentSelectors:t.ngContentSelectors,hostBindings:t.hostBindings||null,hostVars:t.hostVars||0,hostAttrs:t.hostAttrs||null,contentQueries:t.contentQueries||null,declaredInputs:i,inputs:null,outputs:null,exportAs:t.exportAs||null,onPush:t.changeDetection===ss.OnPush,directiveDefs:null,pipeDefs:null,selectors:t.selectors||St,viewQuery:t.viewQuery||null,features:t.features||null,data:t.data||{},encapsulation:t.encapsulation||os.Emulated,id:"c",styles:t.styles||St,_:null,setInput:null,schemas:t.schemas||null,tView:null},o=t.directives,l=t.features,d=t.pipes;return r.id+=F_++,r.inputs=Xm(t.inputs,i),r.outputs=Xm(t.outputs),l&&l.forEach(p=>p(r)),r.directiveDefs=o?()=>("function"==typeof o?o():o).map(jm):null,r.pipeDefs=d?()=>("function"==typeof d?d():d).map($m):null,r})}function jm(t){return ei(t)||function mo(t){return t[uc]||null}(t)}function $m(t){return function ra(t){return t[sf]||null}(t)}const qm={};function Lr(t){return na(()=>{const e={type:t.type,bootstrap:t.bootstrap||St,declarations:t.declarations||St,imports:t.imports||St,exports:t.exports||St,transitiveCompileScopes:null,schemas:t.schemas||null,id:t.id||null};return null!=t.id&&(qm[t.id]=t.type),e})}function Xm(t,e){if(null==t)return as;const i={};for(const r in t)if(t.hasOwnProperty(r)){let o=t[r],l=o;Array.isArray(o)&&(l=o[1],o=o[0]),i[o]=r,e&&(e[o]=l)}return i}const Jn=qa;function ei(t){return t[wn]||null}function pr(t,e){const i=t[Wm]||null;if(!i&&!0===e)throw new Error(`Type ${Kt(t)} does not have '\u0275mod' property.`);return i}function us(t){return Array.isArray(t)&&"object"==typeof t[1]}function un(t){return Array.isArray(t)&&!0===t[1]}function k(t){return 0!=(8&t.flags)}function Za(t){return 2==(2&t.flags)}function mc(t){return 1==(1&t.flags)}function Ln(t){return null!==t.template}function Os(t){return 0!=(512&t[2])}function ks(t,e){return t.hasOwnProperty(tr)?t[tr]:null}class sd{constructor(e,i,r){this.previousValue=e,this.currentValue=i,this.firstChange=r}isFirstChange(){return this.firstChange}}function vo(t){return t.type.prototype.ngOnChanges&&(t.setInput=el),$e}function $e(){const t=Km(this),e=null==t?void 0:t.current;if(e){const i=t.previous;if(i===as)t.previous=e;else for(let r in e)i[r]=e[r];t.current=null,this.ngOnChanges(e)}}function el(t,e,i,r){const o=Km(t)||function U_(t,e){return t[mr]=e}(t,{previous:as,current:null}),l=o.current||(o.current={}),d=o.previous,p=this.declaredInputs[i],g=d[p];l[p]=new sd(g&&g.currentValue,e,d===as),t[r]=e}const mr="__ngSimpleChanges__";function Km(t){return t[mr]||null}let ld;function pn(t){return!!t.listen}const eg={createRenderer:(t,e)=>function Or(){return void 0!==ld?ld:"undefined"!=typeof document?document:void 0}()};function Un(t){for(;Array.isArray(t);)t=t[0];return t}function nr(t,e){return Un(e[t.index])}function ir(t,e){return t.data[e]}function Li(t,e){const i=e[t];return us(i)?i:i[0]}function _o(t){return 128==(128&t[2])}function Hs(t,e){return null==e?null:t[e]}function ud(t){t[18]=0}function vc(t,e){t[5]+=e;let i=t,r=t[3];for(;null!==r&&(1===e&&1===i[5]||-1===e&&0===i[5]);)r[5]+=e,i=r,r=r[3]}const rt={lFrame:bc(null),bindingsEnabled:!0,isInCheckNoChangesMode:!1};function Hn(){return rt.bindingsEnabled}function ge(){return rt.lFrame.lView}function $t(){return rt.lFrame.tView}function pi(){let t=pf();for(;null!==t&&64===t.type;)t=t.parent;return t}function pf(){return rt.lFrame.currentTNode}function gr(t,e){const i=rt.lFrame;i.currentTNode=t,i.isParent=e}function mf(){return rt.lFrame.isParent}function Fi(){return rt.isInCheckNoChangesMode}function il(t){rt.isInCheckNoChangesMode=t}function Dn(){return rt.lFrame.bindingIndex++}function gf(t,e){const i=rt.lFrame;i.bindingIndex=i.bindingRootIndex=t,fs(e)}function fs(t){rt.lFrame.currentDirectiveIndex=t}function _c(t){rt.lFrame.currentQueryIndex=t}function yf(t){const e=t[1];return 2===e.type?e.declTNode:1===e.type?t[6]:null}function xc(t,e,i){if(i&ht.SkipSelf){let o=e,l=t;for(;!(o=o.parent,null!==o||i&ht.Host||(o=yf(l),null===o||(l=l[15],10&o.type))););if(null===o)return!1;e=o,t=l}const r=rt.lFrame=wc();return r.currentTNode=e,r.lView=t,!0}function ua(t){const e=wc(),i=t[1];rt.lFrame=e,e.currentTNode=i.firstChild,e.lView=t,e.tView=i,e.contextLView=t,e.bindingIndex=i.bindingStartIndex,e.inI18n=!1}function wc(){const t=rt.lFrame,e=null===t?null:t.child;return null===e?bc(t):e}function bc(t){const e={currentTNode:null,isParent:!0,lView:null,tView:null,selectedIndex:-1,contextLView:null,elementDepthCount:0,currentNamespace:null,currentDirectiveIndex:-1,bindingRootIndex:-1,bindingIndex:-1,currentQueryIndex:0,parent:t,child:null,inI18n:!1};return null!==t&&(t.child=e),e}function Mc(){const t=rt.lFrame;return rt.lFrame=t.parent,t.currentTNode=null,t.lView=null,t}const Ec=Mc;function sl(){const t=Mc();t.isParent=!0,t.tView=null,t.selectedIndex=-1,t.contextLView=null,t.elementDepthCount=0,t.currentDirectiveIndex=-1,t.currentNamespace=null,t.bindingRootIndex=-1,t.bindingIndex=-1,t.currentQueryIndex=0}function Ni(){return rt.lFrame.selectedIndex}function kr(t){rt.lFrame.selectedIndex=t}function da(t,e){for(let i=e.directiveStart,r=e.directiveEnd;i<r;i++){const l=t.data[i].type.prototype,{ngAfterContentInit:d,ngAfterContentChecked:p,ngAfterViewInit:g,ngAfterViewChecked:x,ngOnDestroy:T}=l;d&&(t.contentHooks||(t.contentHooks=[])).push(-i,d),p&&((t.contentHooks||(t.contentHooks=[])).push(i,p),(t.contentCheckHooks||(t.contentCheckHooks=[])).push(i,p)),g&&(t.viewHooks||(t.viewHooks=[])).push(-i,g),x&&((t.viewHooks||(t.viewHooks=[])).push(i,x),(t.viewCheckHooks||(t.viewCheckHooks=[])).push(i,x)),null!=T&&(t.destroyHooks||(t.destroyHooks=[])).push(i,T)}}function zn(t,e,i){md(t,e,3,i)}function zs(t,e,i,r){(3&t[2])===i&&md(t,e,i,r)}function wo(t,e){let i=t[2];(3&i)===e&&(i&=2047,i+=1,t[2]=i)}function md(t,e,i,r){const l=null!=r?r:-1,d=e.length-1;let p=0;for(let g=void 0!==r?65535&t[18]:0;g<d;g++)if("number"==typeof e[g+1]){if(p=e[g],null!=r&&p>=r)break}else e[g]<0&&(t[18]+=65536),(p<l||-1==l)&&(Sc(t,i,e,g),t[18]=(4294901760&t[18])+g+2),g++}function Sc(t,e,i,r){const o=i[r]<0,l=i[r+1],p=t[o?-i[r]:i[r]];if(o){if(t[2]>>11<t[18]>>16&&(3&t[2])===e){t[2]+=2048;try{l.call(p)}finally{}}}else try{l.call(p)}finally{}}class ha{constructor(e,i,r){this.factory=e,this.resolving=!1,this.canSeeViewProviders=i,this.injectImpl=r}}function Mo(t,e,i){const r=pn(t);let o=0;for(;o<i.length;){const l=i[o];if("number"==typeof l){if(0!==l)break;o++;const d=i[o++],p=i[o++],g=i[o++];r?t.setAttribute(e,p,g,d):e.setAttributeNS(d,p,g)}else{const d=l,p=i[++o];vf(d)?r&&t.setProperty(e,d,p):r?t.setAttribute(e,d,p):e.setAttribute(d,p),o++}}return o}function rg(t){return 3===t||4===t||6===t}function vf(t){return 64===t.charCodeAt(0)}function vd(t,e){if(null!==e&&0!==e.length)if(null===t||0===t.length)t=e.slice();else{let i=-1;for(let r=0;r<e.length;r++){const o=e[r];"number"==typeof o?i=o:0===i||sg(t,i,o,null,-1===i||2===i?e[++r]:null)}}return t}function sg(t,e,i,r,o){let l=0,d=t.length;if(-1===e)d=-1;else for(;l<t.length;){const p=t[l++];if("number"==typeof p){if(p===e){d=-1;break}if(p>e){d=l-1;break}}}for(;l<t.length;){const p=t[l];if("number"==typeof p)break;if(p===i){if(null===r)return void(null!==o&&(t[l+1]=o));if(r===t[l+1])return void(t[l+2]=o)}l++,null!==r&&l++,null!==o&&l++}-1!==d&&(t.splice(d,0,e),l=d+1),t.splice(l++,0,i),null!==r&&t.splice(l++,0,r),null!==o&&t.splice(l++,0,o)}function og(t){return-1!==t}function al(t){return 32767&t}function ll(t,e){let i=function Y_(t){return t>>16}(t),r=e;for(;i>0;)r=r[15],i--;return r}let _f=!0;function _d(t){const e=_f;return _f=t,e}let Q_=0;function Tc(t,e){const i=wf(t,e);if(-1!==i)return i;const r=e[1];r.firstCreatePass&&(t.injectorIndex=e.length,xf(r.data,t),xf(e,null),xf(r.blueprint,null));const o=xd(t,e),l=t.injectorIndex;if(og(o)){const d=al(o),p=ll(o,e),g=p[1].data;for(let x=0;x<8;x++)e[l+x]=p[d+x]|g[d+x]}return e[l+8]=o,l}function xf(t,e){t.push(0,0,0,0,0,0,0,0,e)}function wf(t,e){return-1===t.injectorIndex||t.parent&&t.parent.injectorIndex===t.injectorIndex||null===e[t.injectorIndex+8]?-1:t.injectorIndex}function xd(t,e){if(t.parent&&-1!==t.parent.injectorIndex)return t.parent.injectorIndex;let i=0,r=null,o=e;for(;null!==o;){const l=o[1],d=l.type;if(r=2===d?l.declTNode:1===d?o[6]:null,null===r)return-1;if(i++,o=o[15],-1!==r.injectorIndex)return r.injectorIndex|i<<16}return-1}function wd(t,e,i){!function K_(t,e,i){let r;"string"==typeof i?r=i.charCodeAt(0)||0:i.hasOwnProperty(dc)&&(r=i[dc]),null==r&&(r=i[dc]=Q_++);const o=255&r;e.data[t+(o>>5)]|=1<<o}(t,e,i)}function cg(t,e,i){if(i&ht.Optional)return t;Fs(e,"NodeInjector")}function ug(t,e,i,r){if(i&ht.Optional&&void 0===r&&(r=null),0==(i&(ht.Self|ht.Host))){const o=t[9],l=er(void 0);try{return o?o.get(e,r,i&ht.Optional):P_(e,r,i&ht.Optional)}finally{er(l)}}return cg(r,e,i)}function dg(t,e,i,r=ht.Default,o){if(null!==t){const l=function n0(t){if("string"==typeof t)return t.charCodeAt(0)||0;const e=t.hasOwnProperty(dc)?t[dc]:void 0;return"number"==typeof e?e>=0?255&e:e0:e}(i);if("function"==typeof l){if(!xc(e,t,r))return r&ht.Host?cg(o,i,r):ug(e,i,r,o);try{const d=l(r);if(null!=d||r&ht.Optional)return d;Fs(i)}finally{Ec()}}else if("number"==typeof l){let d=null,p=wf(t,e),g=-1,x=r&ht.Host?e[16][6]:null;for((-1===p||r&ht.SkipSelf)&&(g=-1===p?xd(t,e):e[p+8],-1!==g&&pg(r,!1)?(d=e[1],p=al(g),e=ll(g,e)):p=-1);-1!==p;){const T=e[1];if(fg(l,p,T.data)){const D=t0(p,e,i,d,r,x);if(D!==hg)return D}g=e[p+8],-1!==g&&pg(r,e[1].data[p+8]===x)&&fg(l,p,e)?(d=T,p=al(g),e=ll(g,e)):p=-1}}}return ug(e,i,r,o)}const hg={};function e0(){return new cl(pi(),ge())}function t0(t,e,i,r,o,l){const d=e[1],p=d.data[t+8],T=function bd(t,e,i,r,o){const l=t.providerIndexes,d=e.data,p=1048575&l,g=t.directiveStart,T=l>>20,P=o?p+T:t.directiveEnd;for(let B=r?p:p+T;B<P;B++){const z=d[B];if(B<g&&i===z||B>=g&&z.type===i)return B}if(o){const B=d[g];if(B&&Ln(B)&&B.type===i)return g}return null}(p,d,i,null==r?Za(p)&&_f:r!=d&&0!=(3&p.type),o&ht.Host&&l===p);return null!==T?Cc(e,d,T,p):hg}function Cc(t,e,i,r){let o=t[i];const l=e.data;if(function q_(t){return t instanceof ha}(o)){const d=o;d.resolving&&function nd(t,e){const i=e?`. Dependency path: ${e.join(" > ")} > ${t}`:"";throw new Be(-200,`Circular dependency in DI detected for ${t}${i}`)}(Ii(l[i]));const p=_d(d.canSeeViewProviders);d.resolving=!0;const g=d.injectImpl?er(d.injectImpl):null;xc(t,r,ht.Default);try{o=t[i]=d.factory(void 0,l,t,r),e.firstCreatePass&&i>=r.directiveStart&&function yr(t,e,i){const{ngOnChanges:r,ngOnInit:o,ngDoCheck:l}=e.type.prototype;if(r){const d=vo(e);(i.preOrderHooks||(i.preOrderHooks=[])).push(t,d),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,d)}o&&(i.preOrderHooks||(i.preOrderHooks=[])).push(0-t,o),l&&((i.preOrderHooks||(i.preOrderHooks=[])).push(t,l),(i.preOrderCheckHooks||(i.preOrderCheckHooks=[])).push(t,l))}(i,l[i],e)}finally{null!==g&&er(g),_d(p),d.resolving=!1,Ec()}}return o}function fg(t,e,i){return!!(i[e+(t>>5)]&1<<t)}function pg(t,e){return!(t&ht.Self||t&ht.Host&&e)}class cl{constructor(e,i){this._tNode=e,this._lView=i}get(e,i,r){return dg(this._tNode,this._lView,e,r,i)}}function bf(t){return Yh(t)?()=>{const e=bf(gt(t));return e&&e()}:ks(t)}const dl="__parameters__";function fl(t,e,i){return na(()=>{const r=function Mf(t){return function(...i){if(t){const r=t(...i);for(const o in r)this[o]=r[o]}}}(e);function o(...l){if(this instanceof o)return r.apply(this,l),this;const d=new o(...l);return p.annotation=d,p;function p(g,x,T){const D=g.hasOwnProperty(dl)?g[dl]:Object.defineProperty(g,dl,{value:[]})[dl];for(;D.length<=T;)D.push(null);return(D[T]=D[T]||[]).push(d),g}}return i&&(o.prototype=Object.create(i.prototype)),o.prototype.ngMetadataName=t,o.annotationCls=o,o})}class ze{constructor(e,i){this._desc=e,this.ngMetadataName="InjectionToken",this.\u0275prov=void 0,"number"==typeof i?this.__NG_ELEMENT_ID__=i:void 0!==i&&(this.\u0275prov=at({token:this,providedIn:i.providedIn||"root",factory:i.factory}))}toString(){return`InjectionToken ${this._desc}`}}const s0=new ze("AnalyzeForEntryComponents");function ms(t,e){t.forEach(i=>Array.isArray(i)?ms(i,e):e(i))}function yg(t,e,i){e>=t.length?t.push(i):t.splice(e,0,i)}function Md(t,e){return e>=t.length-1?t.pop():t.splice(e,1)[0]}const Pc={},Cf="__NG_DI_FLAG__",Sd="ngTempTokenPath",m0=/\n/gm,bg="__source",y0=on({provide:String,useValue:on});let Lc;function Mg(t){const e=Lc;return Lc=t,e}function v0(t,e=ht.Default){if(void 0===Lc)throw new Be(203,"");return null===Lc?P_(t,void 0,e):Lc.get(t,e&ht.Optional?null:void 0,e)}function Ee(t,e=ht.Default){return(function cc(){return nf}()||v0)(gt(t),e)}const _0=Ee;function Df(t){const e=[];for(let i=0;i<t.length;i++){const r=gt(t[i]);if(Array.isArray(r)){if(0===r.length)throw new Be(900,"");let o,l=ht.Default;for(let d=0;d<r.length;d++){const p=r[d],g=x0(p);"number"==typeof g?-1===g?o=p.token:l|=g:o=p}e.push(Ee(o,l))}else e.push(Ee(r))}return e}function Fc(t,e){return t[Cf]=e,t.prototype[Cf]=e,t}function x0(t){return t[Cf]}const Nc=Fc(fl("Inject",t=>({token:t})),-1),Eo=Fc(fl("Optional"),8),Oc=Fc(fl("SkipSelf"),4),Vg="__ngContext__";function Di(t,e){t[Vg]=e}function Hf(t){const e=function jc(t){return t[Vg]||null}(t);return e?Array.isArray(e)?e:e.lView:null}function zf(t){return t.ngOriginalError}function Q0(t,...e){t.error(...e)}class $c{constructor(){this._console=console}handleError(e){const i=this._findOriginalError(e),r=function Y0(t){return t&&t.ngErrorLogger||Q0}(e);r(this._console,"ERROR",e),i&&r(this._console,"ORIGINAL ERROR",i)}_findOriginalError(e){let i=e&&zf(e);for(;i&&zf(i);)i=zf(i);return i||null}}const qg=(()=>("undefined"!=typeof requestAnimationFrame&&requestAnimationFrame||setTimeout).bind(ft))();function Br(t){return t instanceof Function?t():t}var ar=(()=>((ar=ar||{})[ar.Important=1]="Important",ar[ar.DashCase=2]="DashCase",ar))();function jf(t,e){return undefined(t,e)}function Ws(t){const e=t[3];return un(e)?e[3]:e}function Xf(t){return Qg(t[13])}function qc(t){return Qg(t[4])}function Qg(t){for(;null!==t&&!un(t);)t=t[4];return t}function _l(t,e,i,r,o){if(null!=r){let l,d=!1;un(r)?l=r:us(r)&&(d=!0,r=r[0]);const p=Un(r);0===t&&null!==i?null==o?ny(e,i,p):pa(e,i,p,o||null,!0):1===t&&null!==i?pa(e,i,p,o||null,!0):2===t?function ay(t,e,i){const r=Pd(t,e);r&&function yx(t,e,i,r){pn(t)?t.removeChild(e,i,r):e.removeChild(i)}(t,r,e,i)}(e,p,d):3===t&&e.destroyNode(p),null!=l&&function ly(t,e,i,r,o){const l=i[7];l!==Un(i)&&_l(e,t,r,l,o);for(let p=10;p<i.length;p++){const g=i[p];Ur(g[1],g,t,e,r,l)}}(e,t,l,i,o)}}function Id(t,e,i){if(pn(t))return t.createElement(e,i);{const r=null!==i?function H_(t){const e=t.toLowerCase();return"svg"===e?"http://www.w3.org/2000/svg":"math"===e?"http://www.w3.org/1998/MathML/":null}(i):null;return null===r?t.createElement(e):t.createElementNS(r,e)}}function ey(t,e){const i=t[9],r=i.indexOf(e),o=e[3];1024&e[2]&&(e[2]&=-1025,vc(o,-1)),i.splice(r,1)}function Zf(t,e){if(t.length<=10)return;const i=10+e,r=t[i];if(r){const o=r[17];null!==o&&o!==t&&ey(o,r),e>0&&(t[i-1][4]=r[4]);const l=Md(t,10+e);!function cx(t,e){Ur(t,e,e[11],2,null,null),e[0]=null,e[6]=null}(r[1],r);const d=l[19];null!==d&&d.detachView(l[1]),r[3]=null,r[4]=null,r[2]&=-129}return r}function ty(t,e){if(!(256&e[2])){const i=e[11];pn(i)&&i.destroyNode&&Ur(t,e,i,3,null,null),function hx(t){let e=t[13];if(!e)return Yf(t[1],t);for(;e;){let i=null;if(us(e))i=e[13];else{const r=e[10];r&&(i=r)}if(!i){for(;e&&!e[4]&&e!==t;)us(e)&&Yf(e[1],e),e=e[3];null===e&&(e=t),us(e)&&Yf(e[1],e),i=e&&e[4]}e=i}}(e)}}function Yf(t,e){if(!(256&e[2])){e[2]&=-129,e[2]|=256,function gx(t,e){let i;if(null!=t&&null!=(i=t.destroyHooks))for(let r=0;r<i.length;r+=2){const o=e[i[r]];if(!(o instanceof ha)){const l=i[r+1];if(Array.isArray(l))for(let d=0;d<l.length;d+=2){const p=o[l[d]],g=l[d+1];try{g.call(p)}finally{}}else try{l.call(o)}finally{}}}}(t,e),function mx(t,e){const i=t.cleanup,r=e[7];let o=-1;if(null!==i)for(let l=0;l<i.length-1;l+=2)if("string"==typeof i[l]){const d=i[l+1],p="function"==typeof d?d(e):Un(e[d]),g=r[o=i[l+2]],x=i[l+3];"boolean"==typeof x?p.removeEventListener(i[l],g,x):x>=0?r[o=x]():r[o=-x].unsubscribe(),l+=2}else{const d=r[o=i[l+1]];i[l].call(d)}if(null!==r){for(let l=o+1;l<r.length;l++)r[l]();e[7]=null}}(t,e),1===e[1].type&&pn(e[11])&&e[11].destroy();const i=e[17];if(null!==i&&un(e[3])){i!==e[3]&&ey(i,e);const r=e[19];null!==r&&r.detachView(t)}}}function Qf(t,e,i){return function Kf(t,e,i){let r=e;for(;null!==r&&40&r.type;)r=(e=r).parent;if(null===r)return i[0];if(2&r.flags){const o=t.data[r.directiveStart].encapsulation;if(o===os.None||o===os.Emulated)return null}return nr(r,i)}(t,e.parent,i)}function pa(t,e,i,r,o){pn(t)?t.insertBefore(e,i,r,o):e.insertBefore(i,r,o)}function ny(t,e,i){pn(t)?t.appendChild(e,i):e.appendChild(i)}function iy(t,e,i,r,o){null!==r?pa(t,e,i,r,o):ny(t,e,i)}function Pd(t,e){return pn(t)?t.parentNode(e):e.parentNode}let Xc=function ry(t,e,i){return 40&t.type?nr(t,i):null};function Ld(t,e,i,r){const o=Qf(t,r,e),l=e[11],p=function Jf(t,e,i){return Xc(t,e,i)}(r.parent||e[6],r,e);if(null!=o)if(Array.isArray(i))for(let g=0;g<i.length;g++)iy(l,o,i[g],p,!1);else iy(l,o,i,p,!1)}function Yc(t,e){if(null!==e){const i=e.type;if(3&i)return nr(e,t);if(4&i)return ep(-1,t[e.index]);if(8&i){const r=e.child;if(null!==r)return Yc(t,r);{const o=t[e.index];return un(o)?ep(-1,o):Un(o)}}if(32&i)return jf(e,t)()||Un(t[e.index]);{const r=oy(t,e);return null!==r?Array.isArray(r)?r[0]:Yc(Ws(t[16]),r):Yc(t,e.next)}}return null}function oy(t,e){return null!==e?t[16][6].projection[e.projection]:null}function ep(t,e){const i=10+t+1;if(i<e.length){const r=e[i],o=r[1].firstChild;if(null!==o)return Yc(r,o)}return e[7]}function Fd(t,e,i,r,o,l,d){for(;null!=i;){const p=r[i.index],g=i.type;if(d&&0===e&&(p&&Di(Un(p),r),i.flags|=4),64!=(64&i.flags))if(8&g)Fd(t,e,i.child,r,o,l,!1),_l(e,t,o,p,l);else if(32&g){const x=jf(i,r);let T;for(;T=x();)_l(e,t,o,T,l);_l(e,t,o,p,l)}else 16&g?Nd(t,e,r,i,o,l):_l(e,t,o,p,l);i=d?i.projectionNext:i.next}}function Ur(t,e,i,r,o,l){Fd(i,r,t.firstChild,e,o,l,!1)}function Nd(t,e,i,r,o,l){const d=i[16],g=d[6].projection[r.projection];if(Array.isArray(g))for(let x=0;x<g.length;x++)_l(e,t,o,g[x],l);else Fd(t,e,g,d[3],o,l,!0)}function cy(t,e,i){pn(t)?t.setAttribute(e,"style",i):e.style.cssText=i}function tp(t,e,i){pn(t)?""===i?t.removeAttribute(e,"class"):t.setAttribute(e,"class",i):e.className=i}function en(t,e,i){let r=t.length;for(;;){const o=t.indexOf(e,i);if(-1===o)return o;if(0===o||t.charCodeAt(o-1)<=32){const l=e.length;if(o+l===r||t.charCodeAt(o+l)<=32)return o}i=o+1}}const Qc="ng-template";function Od(t,e,i){let r=0;for(;r<t.length;){let o=t[r++];if(i&&"class"===o){if(o=t[r],-1!==en(o.toLowerCase(),e,0))return!0}else if(1===o){for(;r<t.length&&"string"==typeof(o=t[r++]);)if(o.toLowerCase()===e)return!0;return!1}}return!1}function Kc(t){return 4===t.type&&t.value!==Qc}function xl(t,e,i){return e===(4!==t.type||i?t.value:Qc)}function Bi(t,e,i){let r=4;const o=t.attrs||[],l=function wl(t){for(let e=0;e<t.length;e++)if(rg(t[e]))return e;return t.length}(o);let d=!1;for(let p=0;p<e.length;p++){const g=e[p];if("number"!=typeof g){if(!d)if(4&r){if(r=2|1&r,""!==g&&!xl(t,g,i)||""===g&&1===e.length){if(xi(r))return!1;d=!0}}else{const x=8&r?g:e[++p];if(8&r&&null!==t.attrs){if(!Od(t.attrs,x,i)){if(xi(r))return!1;d=!0}continue}const D=np(8&r?"class":g,o,Kc(t),i);if(-1===D){if(xi(r))return!1;d=!0;continue}if(""!==x){let P;P=D>l?"":o[D+1].toLowerCase();const B=8&r?P:null;if(B&&-1!==en(B,x,0)||2&r&&x!==P){if(xi(r))return!1;d=!0}}}}else{if(!d&&!xi(r)&&!xi(g))return!1;if(d&&xi(g))continue;d=!1,r=g|1&r}}return xi(r)||d}function xi(t){return 0==(1&t)}function np(t,e,i,r){if(null===e)return-1;let o=0;if(r||!i){let l=!1;for(;o<e.length;){const d=e[o];if(d===t)return o;if(3===d||6===d)l=!0;else{if(1===d||2===d){let p=e[++o];for(;"string"==typeof p;)p=e[++o];continue}if(4===d)break;if(0===d){o+=4;continue}}o+=l?1:2}return-1}return function bl(t,e){let i=t.indexOf(4);if(i>-1)for(i++;i<t.length;){const r=t[i];if("number"==typeof r)return-1;if(r===e)return i;i++}return-1}(e,t)}function ma(t,e,i=!1){for(let r=0;r<e.length;r++)if(Bi(t,e[r],i))return!0;return!1}function El(t,e){return t?":not("+e.trim()+")":e}function uy(t){let e=t[0],i=1,r=2,o="",l=!1;for(;i<t.length;){let d=t[i];if("string"==typeof d)if(2&r){const p=t[++i];o+="["+d+(p.length>0?'="'+p+'"':"")+"]"}else 8&r?o+="."+d:4&r&&(o+=" "+d);else""!==o&&!xi(d)&&(e+=El(l,o),o=""),r=d,l=l||!xi(r);i++}return""!==o&&(e+=El(l,o)),e}const st={};function Bd(t){Ud($t(),ge(),Ni()+t,Fi())}function Ud(t,e,i,r){if(!r)if(3==(3&e[2])){const l=t.preOrderCheckHooks;null!==l&&zn(e,l,i)}else{const l=t.preOrderHooks;null!==l&&zs(e,l,0,i)}kr(i)}function pp(t,e){const i=t.contentQueries;if(null!==i)for(let r=0;r<i.length;r+=2){const o=i[r],l=i[r+1];if(-1!==l){const d=t.data[l];_c(o),d.contentQueries(2,e[l],l)}}}function uu(t,e,i,r,o,l,d,p,g,x){const T=e.blueprint.slice();return T[0]=o,T[2]=140|r,ud(T),T[3]=T[15]=t,T[8]=i,T[10]=d||t&&t[10],T[11]=p||t&&t[11],T[12]=g||t&&t[12]||null,T[9]=x||t&&t[9]||null,T[6]=l,T[16]=2==e.type?t[16]:T,T}function _s(t,e,i,r,o){let l=t.data[e];if(null===l)l=function mp(t,e,i,r,o){const l=pf(),d=mf(),g=t.data[e]=function fu(t,e,i,r,o,l){return{type:i,index:r,insertBeforeIndex:null,injectorIndex:e?e.injectorIndex:-1,directiveStart:-1,directiveEnd:-1,directiveStylingLast:-1,propertyBindings:null,flags:0,providerIndexes:0,value:o,attrs:l,mergedAttrs:null,localNames:null,initialInputs:void 0,inputs:null,outputs:null,tViews:null,next:null,projectionNext:null,child:null,parent:e,projection:null,styles:null,stylesWithoutHost:null,residualStyles:void 0,classes:null,classesWithoutHost:null,residualClasses:void 0,classBindings:0,styleBindings:0}}(0,d?l:l&&l.parent,i,e,r,o);return null===t.firstChild&&(t.firstChild=g),null!==l&&(d?null==l.child&&null!==g.parent&&(l.child=g):null===l.next&&(l.next=g)),g}(t,e,i,r,o),function ng(){return rt.lFrame.inI18n}()&&(l.flags|=64);else if(64&l.type){l.type=i,l.value=r,l.attrs=o;const d=function hd(){const t=rt.lFrame,e=t.currentTNode;return t.isParent?e:e.parent}();l.injectorIndex=null===d?-1:d.injectorIndex}return gr(l,!0),l}function Sl(t,e,i,r){if(0===i)return-1;const o=e.length;for(let l=0;l<i;l++)e.push(r),t.blueprint.push(r),t.data.push(null);return o}function du(t,e,i){ua(e);try{const r=t.viewQuery;null!==r&&nh(1,r,i);const o=t.template;null!==o&&qd(t,e,o,1,i),t.firstCreatePass&&(t.firstCreatePass=!1),t.staticContentQueries&&pp(t,e),t.staticViewQueries&&nh(2,t.viewQuery,i);const l=t.components;null!==l&&function Ix(t,e){for(let i=0;i<e.length;i++)Jd(t,e[i])}(e,l)}catch(r){throw t.firstCreatePass&&(t.incompleteFirstPass=!0,t.firstCreatePass=!1),r}finally{e[2]&=-5,sl()}}function Tl(t,e,i,r){const o=e[2];if(256==(256&o))return;ua(e);const l=Fi();try{ud(e),function rl(t){return rt.lFrame.bindingIndex=t}(t.bindingStartIndex),null!==i&&qd(t,e,i,2,r);const d=3==(3&o);if(!l)if(d){const x=t.preOrderCheckHooks;null!==x&&zn(e,x,null)}else{const x=t.preOrderHooks;null!==x&&zs(e,x,0,null),wo(e,0)}if(function Kd(t){for(let e=Xf(t);null!==e;e=qc(e)){if(!e[2])continue;const i=e[9];for(let r=0;r<i.length;r++){const o=i[r],l=o[3];0==(1024&o[2])&&vc(l,1),o[2]|=1024}}}(e),function An(t){for(let e=Xf(t);null!==e;e=qc(e))for(let i=10;i<e.length;i++){const r=e[i],o=r[1];_o(r)&&Tl(o,r,o.template,r[8])}}(e),null!==t.contentQueries&&pp(t,e),!l)if(d){const x=t.contentCheckHooks;null!==x&&zn(e,x)}else{const x=t.contentHooks;null!==x&&zs(e,x,1),wo(e,1)}!function fp(t,e){const i=t.hostBindingOpCodes;if(null!==i)try{for(let r=0;r<i.length;r++){const o=i[r];if(o<0)kr(~o);else{const l=o,d=i[++r],p=i[++r];gf(d,l),p(2,e[l])}}}finally{kr(-1)}}(t,e);const p=t.components;null!==p&&function Rx(t,e){for(let i=0;i<e.length;i++)Ty(t,e[i])}(e,p);const g=t.viewQuery;if(null!==g&&nh(2,g,r),!l)if(d){const x=t.viewCheckHooks;null!==x&&zn(e,x)}else{const x=t.viewHooks;null!==x&&zs(e,x,2),wo(e,2)}!0===t.firstUpdatePass&&(t.firstUpdatePass=!1),l||(e[2]&=-73),1024&e[2]&&(e[2]&=-1025,vc(e[3],-1))}finally{sl()}}function hu(t,e,i,r){const o=e[10],l=!Fi(),d=function hs(t){return 4==(4&t[2])}(e);try{l&&!d&&o.begin&&o.begin(),d&&du(t,e,r),Tl(t,e,i,r)}finally{l&&!d&&o.end&&o.end()}}function qd(t,e,i,r,o){const l=Ni(),d=2&r;try{kr(-1),d&&e.length>20&&Ud(t,e,20,Fi()),i(r,o)}finally{kr(l)}}function Cl(t,e,i){!Hn()||(function yu(t,e,i,r){const o=i.directiveStart,l=i.directiveEnd;t.firstCreatePass||Tc(i,e),Di(r,e);const d=i.initialInputs;for(let p=o;p<l;p++){const g=t.data[p],x=Ln(g);x&&kx(e,i,g);const T=Cc(e,t,p,i);Di(T,e),null!==d&&Mp(0,p-o,T,g,0,d),x&&(Li(i.index,e)[8]=T)}}(t,e,i,nr(i,e)),128==(128&i.flags)&&function Lx(t,e,i){const r=i.directiveStart,o=i.directiveEnd,d=i.index,p=function xo(){return rt.lFrame.currentDirectiveIndex}();try{kr(d);for(let g=r;g<o;g++){const x=t.data[g],T=e[g];fs(g),(null!==x.hostBindings||0!==x.hostVars||null!==x.hostAttrs)&&wy(x,T)}}finally{kr(-1),fs(p)}}(t,e,i))}function yp(t,e,i=nr){const r=e.localNames;if(null!==r){let o=e.index+1;for(let l=0;l<r.length;l+=2){const d=r[l+1],p=-1===d?i(e,t):t[d];t[o++]=p}}}function Xd(t){const e=t.tView;return null===e||e.incompleteFirstPass?t.tView=Dl(1,null,t.template,t.decls,t.vars,t.directiveDefs,t.pipeDefs,t.viewQuery,t.schemas,t.consts):e}function Dl(t,e,i,r,o,l,d,p,g,x){const T=20+r,D=T+o,P=function vp(t,e){const i=[];for(let r=0;r<e;r++)i.push(r<t?null:st);return i}(T,D),B="function"==typeof x?x():x;return P[1]={type:t,blueprint:P,template:i,queries:null,viewQuery:p,declTNode:e,data:P.slice().fill(null,T),bindingStartIndex:T,expandoStartIndex:D,hostBindingOpCodes:null,firstCreatePass:!0,firstUpdatePass:!0,staticViewQueries:!1,staticContentQueries:!1,preOrderHooks:null,preOrderCheckHooks:null,contentHooks:null,contentCheckHooks:null,viewHooks:null,viewCheckHooks:null,destroyHooks:null,cleanup:null,contentQueries:null,components:null,directiveRegistry:"function"==typeof l?l():l,pipeRegistry:"function"==typeof d?d():d,firstChild:null,schemas:g,consts:B,incompleteFirstPass:!1}}function pu(t,e,i){for(let r in t)if(t.hasOwnProperty(r)){const o=t[r];(i=null===i?{}:i).hasOwnProperty(r)?i[r].push(e,o):i[r]=[e,o]}return i}function xp(t,e,i,r){let o=!1;if(Hn()){const l=function Fx(t,e,i){const r=t.directiveRegistry;let o=null;if(r)for(let l=0;l<r.length;l++){const d=r[l];ma(i,d.selectors,!1)&&(o||(o=[]),wd(Tc(i,e),t,d.type),Ln(d)?(by(t,i),o.unshift(d)):o.push(d))}return o}(t,e,i),d=null===r?null:{"":-1};if(null!==l){o=!0,My(i,t.data.length,l.length);for(let T=0;T<l.length;T++){const D=l[T];D.providersResolver&&D.providersResolver(D)}let p=!1,g=!1,x=Sl(t,e,l.length,null);for(let T=0;T<l.length;T++){const D=l[T];i.mergedAttrs=vd(i.mergedAttrs,D.hostAttrs),Ey(t,i,e,x,D),Ox(x,D,d),null!==D.contentQueries&&(i.flags|=8),(null!==D.hostBindings||null!==D.hostAttrs||0!==D.hostVars)&&(i.flags|=128);const P=D.type.prototype;!p&&(P.ngOnChanges||P.ngOnInit||P.ngDoCheck)&&((t.preOrderHooks||(t.preOrderHooks=[])).push(i.index),p=!0),!g&&(P.ngOnChanges||P.ngDoCheck)&&((t.preOrderCheckHooks||(t.preOrderCheckHooks=[])).push(i.index),g=!0),x++}!function ga(t,e){const r=e.directiveEnd,o=t.data,l=e.attrs,d=[];let p=null,g=null;for(let x=e.directiveStart;x<r;x++){const T=o[x],D=T.inputs,P=null===l||Kc(e)?null:Bx(D,l);d.push(P),p=pu(D,x,p),g=pu(T.outputs,x,g)}null!==p&&(p.hasOwnProperty("class")&&(e.flags|=16),p.hasOwnProperty("style")&&(e.flags|=32)),e.initialInputs=d,e.inputs=p,e.outputs=g}(t,i)}d&&function Nx(t,e,i){if(e){const r=t.localNames=[];for(let o=0;o<e.length;o+=2){const l=i[e[o+1]];if(null==l)throw new Be(-301,!1);r.push(e[o],l)}}}(i,r,d)}return i.mergedAttrs=vd(i.mergedAttrs,i.attrs),o}function wp(t,e,i,r,o,l){const d=l.hostBindings;if(d){let p=t.hostBindingOpCodes;null===p&&(p=t.hostBindingOpCodes=[]);const g=~e.index;(function Ao(t){let e=t.length;for(;e>0;){const i=t[--e];if("number"==typeof i&&i<0)return i}return 0})(p)!=g&&p.push(g),p.push(r,o,d)}}function wy(t,e){null!==t.hostBindings&&t.hostBindings(1,e)}function by(t,e){e.flags|=2,(t.components||(t.components=[])).push(e.index)}function Ox(t,e,i){if(i){if(e.exportAs)for(let r=0;r<e.exportAs.length;r++)i[e.exportAs[r]]=t;Ln(e)&&(i[""]=t)}}function My(t,e,i){t.flags|=1,t.directiveStart=e,t.directiveEnd=e+i,t.providerIndexes=e}function Ey(t,e,i,r,o){t.data[r]=o;const l=o.factory||(o.factory=ks(o.type)),d=new ha(l,Ln(o),null);t.blueprint[r]=d,i[r]=d,wp(t,e,0,r,Sl(t,i,o.hostVars,st),o)}function kx(t,e,i){const r=nr(e,t),o=Xd(i),l=t[10],d=Ro(t,uu(t,o,null,i.onPush?64:16,r,e,l,l.createRenderer(r,i),null,null));t[e.index]=d}function Mp(t,e,i,r,o,l){const d=l[e];if(null!==d){const p=r.setInput;for(let g=0;g<d.length;){const x=d[g++],T=d[g++],D=d[g++];null!==p?r.setInput(i,D,x,T):i[T]=D}}}function Bx(t,e){let i=null,r=0;for(;r<e.length;){const o=e[r];if(0!==o)if(5!==o){if("number"==typeof o)break;t.hasOwnProperty(o)&&(null===i&&(i=[]),i.push(o,t[o],e[r+1])),r+=2}else r+=2;else r+=4}return i}function Sy(t,e,i,r){return new Array(t,!0,!1,e,null,0,r,i,null,null)}function Ty(t,e){const i=Li(e,t);if(_o(i)){const r=i[1];80&i[2]?Tl(r,i,r.template,i[8]):i[5]>0&&Il(i)}}function Il(t){for(let r=Xf(t);null!==r;r=qc(r))for(let o=10;o<r.length;o++){const l=r[o];if(1024&l[2]){const d=l[1];Tl(d,l,d.template,l[8])}else l[5]>0&&Il(l)}const i=t[1].components;if(null!==i)for(let r=0;r<i.length;r++){const o=Li(i[r],t);_o(o)&&o[5]>0&&Il(o)}}function Jd(t,e){const i=Li(e,t),r=i[1];(function Ux(t,e){for(let i=e.length;i<t.blueprint.length;i++)e.push(t.blueprint[i])})(r,i),du(r,i,i[8])}function Ro(t,e){return t[13]?t[14][4]=e:t[13]=e,t[14]=e,e}function ya(t,e,i){const r=e[10];r.begin&&r.begin();try{Tl(t,e,t.template,i)}catch(o){throw function Pl(t,e){const i=t[9],r=i?i.get($c,null):null;r&&r.handleError(e)}(e,o),o}finally{r.end&&r.end()}}function th(t){!function eh(t){for(let e=0;e<t.components.length;e++){const i=t.components[e],r=Hf(i),o=r[1];hu(o,r,o.template,i)}}(t[8])}function nh(t,e,i){_c(0),e(t,i)}const Io=(()=>Promise.resolve(null))();function xu(t,e,i,r,o){for(let l=0;l<i.length;){const d=i[l++],p=i[l++],g=e[d],x=t.data[d];null!==x.setInput?x.setInput(g,o,r,p):g[p]=o}}function lr(t,e,i){const r=function cd(t,e){return Un(e[t])}(e,t);!function Kg(t,e,i){pn(t)?t.setValue(e,i):e.textContent=i}(t[11],r,i)}function ih(t,e,i){let r=i?t.styles:null,o=i?t.classes:null,l=0;if(null!==e)for(let d=0;d<e.length;d++){const p=e[d];"number"==typeof p?l=p:1==l?o=ed(o,p):2==l&&(r=ed(r,p+": "+e[++d]+";"))}i?t.styles=r:t.stylesWithoutHost=r,i?t.classes=o:t.classesWithoutHost=o}const Ll=new ze("INJECTOR",-1);class bu{get(e,i=Pc){if(i===Pc){const r=new Error(`NullInjectorError: No provider for ${Kt(e)}!`);throw r.name="NullInjectorError",r}return i}}const sh=new ze("Set Injector scope."),Fl={},Ry={};let oh;function Tp(){return void 0===oh&&(oh=new bu),oh}function ah(t,e=null,i=null,r){const o=Cp(t,e,i,r);return o._resolveInjectorDefTypes(),o}function Cp(t,e=null,i=null,r){return new Iy(t,i,e||Tp(),r)}class Iy{constructor(e,i,r,o=null){this.parent=r,this.records=new Map,this.injectorDefTypes=new Set,this.onDestroy=new Set,this._destroyed=!1;const l=[];i&&ms(i,p=>this.processProvider(p,e,i)),ms([e],p=>this.processInjectorType(p,[],l)),this.records.set(Ll,va(void 0,this));const d=this.records.get(sh);this.scope=null!=d?d.value:null,this.source=o||("object"==typeof e?null:Kt(e))}get destroyed(){return this._destroyed}destroy(){this.assertNotDestroyed(),this._destroyed=!0;try{this.onDestroy.forEach(e=>e.ngOnDestroy())}finally{this.records.clear(),this.onDestroy.clear(),this.injectorDefTypes.clear()}}get(e,i=Pc,r=ht.Default){this.assertNotDestroyed();const o=Mg(this),l=er(void 0);try{if(!(r&ht.SkipSelf)){let p=this.records.get(e);if(void 0===p){const g=function Ol(t){return"function"==typeof t||"object"==typeof t&&t instanceof ze}(e)&&Vm(e);p=g&&this.injectableDefInScope(g)?va(lh(e),Fl):null,this.records.set(e,p)}if(null!=p)return this.hydrate(e,p)}return(r&ht.Self?Tp():this.parent).get(e,i=r&ht.Optional&&i===Pc?null:i)}catch(d){if("NullInjectorError"===d.name){if((d[Sd]=d[Sd]||[]).unshift(Kt(e)),o)throw d;return function w0(t,e,i,r){const o=t[Sd];throw e[bg]&&o.unshift(e[bg]),t.message=function b0(t,e,i,r=null){t=t&&"\n"===t.charAt(0)&&"\u0275"==t.charAt(1)?t.substr(2):t;let o=Kt(e);if(Array.isArray(e))o=e.map(Kt).join(" -> ");else if("object"==typeof e){let l=[];for(let d in e)if(e.hasOwnProperty(d)){let p=e[d];l.push(d+":"+("string"==typeof p?JSON.stringify(p):Kt(p)))}o=`{${l.join(", ")}}`}return`${i}${r?"("+r+")":""}[${o}]: ${t.replace(m0,"\n  ")}`}("\n"+t.message,o,i,r),t.ngTokenPath=o,t[Sd]=null,t}(d,e,"R3InjectorError",this.source)}throw d}finally{er(l),Mg(o)}}_resolveInjectorDefTypes(){this.injectorDefTypes.forEach(e=>this.get(e))}toString(){const e=[];return this.records.forEach((r,o)=>e.push(Kt(o))),`R3Injector[${e.join(", ")}]`}assertNotDestroyed(){if(this._destroyed)throw new Be(205,!1)}processInjectorType(e,i,r){if(!(e=gt(e)))return!1;let o=R_(e);const l=null==o&&e.ngModule||void 0,d=void 0===l?e:l,p=-1!==r.indexOf(d);if(void 0!==l&&(o=R_(l)),null==o)return!1;if(null!=o.imports&&!p){let T;r.push(d);try{ms(o.imports,D=>{this.processInjectorType(D,i,r)&&(void 0===T&&(T=[]),T.push(D))})}finally{}if(void 0!==T)for(let D=0;D<T.length;D++){const{ngModule:P,providers:B}=T[D];ms(B,z=>this.processProvider(z,P,B||St))}}this.injectorDefTypes.add(d);const g=ks(d)||(()=>new d);this.records.set(d,va(g,Fl));const x=o.providers;if(null!=x&&!p){const T=e;ms(x,D=>this.processProvider(D,T,x))}return void 0!==l&&void 0!==e.providers}processProvider(e,i,r){let o=Nl(e=gt(e))?e:gt(e&&e.provide);const l=function Ly(t,e,i){return Fy(t)?va(void 0,t.useValue):va(function Dp(t,e,i){let r;if(Nl(t)){const o=gt(t);return ks(o)||lh(o)}if(Fy(t))r=()=>gt(t.useValue);else if(function Po(t){return!(!t||!t.useFactory)}(t))r=()=>t.useFactory(...Df(t.deps||[]));else if(function Mn(t){return!(!t||!t.useExisting)}(t))r=()=>Ee(gt(t.useExisting));else{const o=gt(t&&(t.useClass||t.provide));if(!function zx(t){return!!t.deps}(t))return ks(o)||lh(o);r=()=>new o(...Df(t.deps))}return r}(t),Fl)}(e);if(Nl(e)||!0!==e.multi)this.records.get(o);else{let d=this.records.get(o);d||(d=va(void 0,Fl,!0),d.factory=()=>Df(d.multi),this.records.set(o,d)),o=e,d.multi.push(e)}this.records.set(o,l)}hydrate(e,i){return i.value===Fl&&(i.value=Ry,i.value=i.factory()),"object"==typeof i.value&&i.value&&function ws(t){return null!==t&&"object"==typeof t&&"function"==typeof t.ngOnDestroy}(i.value)&&this.onDestroy.add(i.value),i.value}injectableDefInScope(e){if(!e.providedIn)return!1;const i=gt(e.providedIn);return"string"==typeof i?"any"===i||i===this.scope:this.injectorDefTypes.has(i)}}function lh(t){const e=Vm(t),i=null!==e?e.factory:ks(t);if(null!==i)return i;if(t instanceof ze)throw new Be(204,!1);if(t instanceof Function)return function Py(t){const e=t.length;if(e>0)throw function Ic(t,e){const i=[];for(let r=0;r<t;r++)i.push(e);return i}(e,"?"),new Be(204,!1);const i=function oE(t){const e=t&&(t[tf]||t[I_]);if(e){const i=function aE(t){if(t.hasOwnProperty("name"))return t.name;const e=(""+t).match(/^function\s*([^\s(]+)/);return null===e?"":e[1]}(t);return console.warn(`DEPRECATED: DI is instantiating a token "${i}" that inherits its @Injectable decorator but does not provide one itself.\nThis will become an error in a future version of Angular. Please add @Injectable() to the "${i}" class.`),e}return null}(t);return null!==i?()=>i.factory(t):()=>new t}(t);throw new Be(204,!1)}function va(t,e,i=!1){return{factory:t,value:e,multi:i?[]:void 0}}function Fy(t){return null!==t&&"object"==typeof t&&y0 in t}function Nl(t){return"function"==typeof t}let mi=(()=>{class t{static create(i,r){var o;if(Array.isArray(i))return ah({name:""},r,i,"");{const l=null!==(o=i.name)&&void 0!==o?o:"";return ah({name:l},i.parent,i.providers,l)}}}return t.THROW_IF_NOT_FOUND=Pc,t.NULL=new bu,t.\u0275prov=at({token:t,providedIn:"any",factory:()=>Ee(Ll)}),t.__NG_ELEMENT_ID__=-1,t})();function By(t,e){da(Hf(t)[1],pi())}function oi(t,e,i){return!Object.is(t[e],i)&&(t[e]=i,!0)}function Gl(t,e,i,r,o,l,d,p){const g=ge(),x=$t(),T=t+20,D=x.firstCreatePass?function Jx(t,e,i,r,o,l,d,p,g){const x=e.consts,T=_s(e,t,4,d||null,Hs(x,p));xp(e,i,T,Hs(x,g)),da(e,T);const D=T.tViews=Dl(2,T,r,o,l,e.directiveRegistry,e.pipeRegistry,null,e.schemas,x);return null!==e.queries&&(e.queries.template(e,T),D.queries=e.queries.embeddedTView(T)),T}(T,x,g,e,i,r,o,l,d):x.data[T];gr(D,!1);const P=g[11].createComment("");Ld(x,g,P,D),Di(P,g),Ro(g,g[T]=Sy(P,g,P,D)),mc(D)&&Cl(x,g,D),null!=d&&yp(g,D,p)}function Cu(t){return function ji(t,e){return t[e]}(function W_(){return rt.lFrame.contextLView}(),20+t)}function We(t,e=ht.Default){const i=ge();return null===i?Ee(t,e):dg(pi(),i,gt(t),e)}function Wl(){throw new Error("invalid")}function xn(t,e,i){const r=ge();return oi(r,Dn(),e)&&function Qn(t,e,i,r,o,l,d,p){const g=nr(e,i);let T,x=e.inputs;!p&&null!=x&&(T=x[r])?(xu(t,i,T,r,o),Za(e)&&function Yd(t,e){const i=Li(e,t);16&i[2]||(i[2]|=64)}(i,e.index)):3&e.type&&(r=function mu(t){return"class"===t?"className":"for"===t?"htmlFor":"formaction"===t?"formAction":"innerHtml"===t?"innerHTML":"readonly"===t?"readOnly":"tabindex"===t?"tabIndex":t}(r),o=null!=d?d(o,e.value||"",r):o,pn(l)?l.setProperty(g,r,o):vf(r)||(g.setProperty?g.setProperty(r,o):g[r]=o))}($t(),function ln(){const t=rt.lFrame;return ir(t.tView,t.selectedIndex)}(),r,t,e,r[11],i,!1),xn}function iv(t,e,i,r,o){const d=o?"class":"style";xu(t,i,e.inputs[d],d,r)}function Ks(t,e,i,r){const o=ge(),l=$t(),d=20+t,p=o[11],g=o[d]=Id(p,e,function $_(){return rt.lFrame.currentNamespace}()),x=l.firstCreatePass?function Gn(t,e,i,r,o,l,d){const p=e.consts,x=_s(e,t,2,o,Hs(p,l));return xp(e,i,x,Hs(p,d)),null!==x.attrs&&ih(x,x.attrs,!1),null!==x.mergedAttrs&&ih(x,x.mergedAttrs,!0),null!==e.queries&&e.queries.elementStart(e,x),x}(d,l,o,0,e,i,r):l.data[d];gr(x,!0);const T=x.mergedAttrs;null!==T&&Mo(p,g,T);const D=x.classes;null!==D&&tp(p,g,D);const P=x.styles;return null!==P&&cy(p,g,P),64!=(64&x.flags)&&Ld(l,o,g,x),0===function G_(){return rt.lFrame.elementDepthCount}()&&Di(g,o),function Zn(){rt.lFrame.elementDepthCount++}(),mc(x)&&(Cl(l,o,x),function gp(t,e,i){if(k(e)){const o=e.directiveEnd;for(let l=e.directiveStart;l<o;l++){const d=t.data[l];d.contentQueries&&d.contentQueries(1,i[l],l)}}}(l,x,o)),null!==r&&yp(o,x),Ks}function Ru(){let t=pi();mf()?function Ve(){rt.lFrame.isParent=!1}():(t=t.parent,gr(t,!1));const e=t;!function Vs(){rt.lFrame.elementDepthCount--}();const i=$t();return i.firstCreatePass&&(da(i,t),k(t)&&i.queries.elementEnd(t)),null!=e.classesWithoutHost&&function gd(t){return 0!=(16&t.flags)}(e)&&iv(i,e,ge(),e.classesWithoutHost,!0),null!=e.stylesWithoutHost&&function yd(t){return 0!=(32&t.flags)}(e)&&iv(i,e,ge(),e.stylesWithoutHost,!1),Ru}function bh(t,e,i,r){return Ks(t,e,i,r),Ru(),bh}function Vp(t){return!!t&&"function"==typeof t.then}const zp=function dw(t){return!!t&&"function"==typeof t.subscribe};function Wp(t=1){return function pd(t){return(rt.lFrame.contextLView=function ii(t,e){for(;t>0;)e=e[15],t--;return e}(t,rt.lFrame.contextLView))[8]}(t)}function C(t,e=""){const i=ge(),r=$t(),o=t+20,l=r.firstCreatePass?_s(r,o,1,e,null):r.data[o],d=i[o]=function Rd(t,e){return pn(t)?t.createText(e):t.createTextNode(e)}(i[11],e);Ld(r,i,d,l),gr(l,!1)}function S(t,e,i){const r=ge(),o=function wa(t,e,i,r){return oi(t,Dn(),i)?e+dt(i)+r:st}(r,t,e,i);return o!==st&&lr(r,Ni(),o),S}const Ge="en-US";let ct=Ge;class DS{}class q1{resolveComponentFactory(e){throw function $1(t){const e=Error(`No component factory found for ${Kt(t)}. Did you add it to @NgModule.entryComponents?`);return e.ngComponent=t,e}(e)}}let qp=(()=>{class t{}return t.NULL=new q1,t})();function X1(){return Ch(pi(),ge())}function Ch(t,e){return new Ca(nr(t,e))}let Ca=(()=>{class t{constructor(i){this.nativeElement=i}}return t.__NG_ELEMENT_ID__=X1,t})();class Xp{}let K1=(()=>{class t{}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>null}),t})();class lv{constructor(e){this.full=e,this.major=e.split(".")[0],this.minor=e.split(".")[1],this.patch=e.split(".").slice(2).join(".")}}const J1=new lv("13.3.1"),zw={};function cv(t,e,i,r,o=!1){for(;null!==i;){const l=e[i.index];if(null!==l&&r.push(Un(l)),un(l))for(let p=10;p<l.length;p++){const g=l[p],x=g[1].firstChild;null!==x&&cv(g[1],g,x,r)}const d=i.type;if(8&d)cv(t,e,i.child,r);else if(32&d){const p=jf(i,e);let g;for(;g=p();)r.push(g)}else if(16&d){const p=oy(e,i);if(Array.isArray(p))r.push(...p);else{const g=Ws(e[16]);cv(g[1],g,p,r,!0)}}i=o?i.projectionNext:i.next}return r}class Zp{constructor(e,i){this._lView=e,this._cdRefInjectingView=i,this._appRef=null,this._attachedToViewContainer=!1}get rootNodes(){const e=this._lView,i=e[1];return cv(i,e,i.firstChild,[])}get context(){return this._lView[8]}set context(e){this._lView[8]=e}get destroyed(){return 256==(256&this._lView[2])}destroy(){if(this._appRef)this._appRef.detachView(this);else if(this._attachedToViewContainer){const e=this._lView[3];if(un(e)){const i=e[8],r=i?i.indexOf(this):-1;r>-1&&(Zf(e,r),Md(i,r))}this._attachedToViewContainer=!1}ty(this._lView[1],this._lView)}onDestroy(e){!function Rl(t,e,i,r){const o=function Dy(t){return t[7]||(t[7]=[])}(e);null===i?o.push(r):(o.push(i),t.firstCreatePass&&function Ay(t){return t.cleanup||(t.cleanup=[])}(t).push(r,o.length-1))}(this._lView[1],this._lView,null,e)}markForCheck(){!function Ep(t){for(;t;){t[2]|=64;const e=Ws(t);if(Os(t)&&!e)return t;t=e}return null}(this._cdRefInjectingView||this._lView)}detach(){this._lView[2]&=-129}reattach(){this._lView[2]|=128}detectChanges(){ya(this._lView[1],this._lView,this.context)}checkNoChanges(){!function Hx(t,e,i){il(!0);try{ya(t,e,i)}finally{il(!1)}}(this._lView[1],this._lView,this.context)}attachToViewContainerRef(){if(this._appRef)throw new Be(902,"");this._attachedToViewContainer=!0}detachFromAppRef(){this._appRef=null,function dx(t,e){Ur(t,e,e[11],2,null,null)}(this._lView[1],this._lView)}attachToAppRef(e){if(this._attachedToViewContainer)throw new Be(902,"");this._appRef=e}}class eR extends Zp{constructor(e){super(e),this._view=e}detectChanges(){th(this._view)}checkNoChanges(){!function qs(t){il(!0);try{th(t)}finally{il(!1)}}(this._view)}get context(){return null}}class RS extends qp{constructor(e){super(),this.ngModule=e}resolveComponentFactory(e){const i=ei(e);return new Gw(i,this.ngModule)}}function IS(t){const e=[];for(let i in t)t.hasOwnProperty(i)&&e.push({propName:t[i],templateName:i});return e}class Gw extends DS{constructor(e,i){super(),this.componentDef=e,this.ngModule=i,this.componentType=e.type,this.selector=function kd(t){return t.map(uy).join(",")}(e.selectors),this.ngContentSelectors=e.ngContentSelectors?e.ngContentSelectors:[],this.isBoundToModule=!!i}get inputs(){return IS(this.componentDef.inputs)}get outputs(){return IS(this.componentDef.outputs)}create(e,i,r,o){const l=(o=o||this.ngModule)?function nR(t,e){return{get:(i,r,o)=>{const l=t.get(i,zw,o);return l!==zw||r===zw?l:e.get(i,r,o)}}}(e,o.injector):e,d=l.get(Xp,eg),p=l.get(K1,null),g=d.createRenderer(null,this.componentDef),x=this.componentDef.selectors[0][0]||"div",T=r?function Al(t,e,i){if(pn(t))return t.selectRootElement(e,i===os.ShadowDom);let r="string"==typeof e?t.querySelector(e):e;return r.textContent="",r}(g,r,this.componentDef.encapsulation):Id(d.createRenderer(null,this.componentDef),x,function tR(t){const e=t.toLowerCase();return"svg"===e?"svg":"math"===e?"math":null}(x)),D=this.componentDef.onPush?576:528,P=function Ip(t,e){return{components:[],scheduler:t||qg,clean:Io,playerHandler:e||null,flags:0}}(),B=Dl(0,null,null,1,0,null,null,null,null,null),z=uu(null,B,P,D,null,null,d,g,p,l);let Z,re;ua(z);try{const me=function Rp(t,e,i,r,o,l){const d=i[1];i[20]=t;const g=_s(d,20,2,"#host",null),x=g.mergedAttrs=e.hostAttrs;null!==x&&(ih(g,x,!0),null!==t&&(Mo(o,t,x),null!==g.classes&&tp(o,t,g.classes),null!==g.styles&&cy(o,t,g.styles)));const T=r.createRenderer(t,e),D=uu(i,Xd(e),null,e.onPush?64:16,i[20],g,r,T,l||null,null);return d.firstCreatePass&&(wd(Tc(g,i),d,e.type),by(d,g),My(g,i.length,1)),Ro(i,D),i[20]=D}(T,this.componentDef,z,d,g);if(T)if(r)Mo(g,T,["ng-version",J1.full]);else{const{attrs:K,classes:Le}=function eu(t){const e=[],i=[];let r=1,o=2;for(;r<t.length;){let l=t[r];if("string"==typeof l)2===o?""!==l&&e.push(l,t[++r]):8===o&&i.push(l);else{if(!xi(o))break;o=l}r++}return{attrs:e,classes:i}}(this.componentDef.selectors[0]);K&&Mo(g,T,K),Le&&Le.length>0&&tp(g,T,Le.join(" "))}if(re=ir(B,20),void 0!==i){const K=re.projection=[];for(let Le=0;Le<this.ngContentSelectors.length;Le++){const Ze=i[Le];K.push(null!=Ze?Array.from(Ze):null)}}Z=function uh(t,e,i,r,o){const l=i[1],d=function $s(t,e,i){const r=pi();t.firstCreatePass&&(i.providersResolver&&i.providersResolver(i),Ey(t,r,e,Sl(t,e,1,null),i));const o=Cc(e,t,r.directiveStart,r);Di(o,e);const l=nr(r,e);return l&&Di(l,e),o}(l,i,e);if(r.components.push(d),t[8]=d,o&&o.forEach(g=>g(d,e)),e.contentQueries){const g=pi();e.contentQueries(1,d,g.directiveStart)}const p=pi();return!l.firstCreatePass||null===e.hostBindings&&null===e.hostAttrs||(kr(p.index),wp(i[1],p,0,p.directiveStart,p.directiveEnd,e),wy(e,d)),d}(me,this.componentDef,z,P,[By]),du(B,z,null)}finally{sl()}return new rR(this.componentType,Z,Ch(re,z),z,re)}}class rR extends class j1{}{constructor(e,i,r,o,l){super(),this.location=r,this._rootLView=o,this._tNode=l,this.instance=i,this.hostView=this.changeDetectorRef=new eR(o),this.componentType=e}get injector(){return new cl(this._tNode,this._rootLView)}destroy(){this.hostView.destroy()}onDestroy(e){this.hostView.onDestroy(e)}}class Da{}class PS{}const Dh=new Map;class NS extends Da{constructor(e,i){super(),this._parent=i,this._bootstrapComponents=[],this.injector=this,this.destroyCbs=[],this.componentFactoryResolver=new RS(this);const r=pr(e);this._bootstrapComponents=Br(r.bootstrap),this._r3Injector=Cp(e,i,[{provide:Da,useValue:this},{provide:qp,useValue:this.componentFactoryResolver}],Kt(e)),this._r3Injector._resolveInjectorDefTypes(),this.instance=this.get(e)}get(e,i=mi.THROW_IF_NOT_FOUND,r=ht.Default){return e===mi||e===Da||e===Ll?this:this._r3Injector.get(e,i,r)}destroy(){const e=this._r3Injector;!e.destroyed&&e.destroy(),this.destroyCbs.forEach(i=>i()),this.destroyCbs=null}onDestroy(e){this.destroyCbs.push(e)}}class Ww extends PS{constructor(e){super(),this.moduleType=e,null!==pr(e)&&function oR(t){const e=new Set;!function i(r){const o=pr(r,!0),l=o.id;null!==l&&(function LS(t,e,i){if(e&&e!==i)throw new Error(`Duplicate module registered for ${t} - ${Kt(e)} vs ${Kt(e.name)}`)}(l,Dh.get(l),r),Dh.set(l,r));const d=Br(o.imports);for(const p of d)e.has(p)||(e.add(p),i(p))}(t)}(e)}create(e){return new NS(this.moduleType,e)}}function jw(t){return e=>{setTimeout(t,void 0,e)}}const Xi=class ER extends Ri{constructor(e=!1){super(),this.__isAsync=e}emit(e){super.next(e)}subscribe(e,i,r){var o,l,d;let p=e,g=i||(()=>null),x=r;if(e&&"object"==typeof e){const D=e;p=null===(o=D.next)||void 0===o?void 0:o.bind(D),g=null===(l=D.error)||void 0===l?void 0:l.bind(D),x=null===(d=D.complete)||void 0===d?void 0:d.bind(D)}this.__isAsync&&(g=jw(g),p&&(p=jw(p)),x&&(x=jw(x)));const T=super.subscribe({next:p,error:g,complete:x});return e instanceof ci&&e.add(T),T}};Symbol;let Aa=(()=>{class t{}return t.__NG_ELEMENT_ID__=DR,t})();const TR=Aa,CR=class extends TR{constructor(e,i,r){super(),this._declarationLView=e,this._declarationTContainer=i,this.elementRef=r}createEmbeddedView(e){const i=this._declarationTContainer.tViews,r=uu(this._declarationLView,i,e,16,null,i.declTNode,null,null,null,null);r[17]=this._declarationLView[this._declarationTContainer.index];const l=this._declarationLView[19];return null!==l&&(r[19]=l.createEmbeddedView(i)),du(i,r,e),new Zp(r)}};function DR(){return uv(pi(),ge())}function uv(t,e){return 4&t.type?new CR(e,t,Ch(t,e)):null}let io=(()=>{class t{}return t.__NG_ELEMENT_ID__=AR,t})();function AR(){return function GS(t,e){let i;const r=e[t.index];if(un(r))i=r;else{let o;if(8&t.type)o=Un(r);else{const l=e[11];o=l.createComment("");const d=nr(t,e);pa(l,Pd(l,d),o,function vx(t,e){return pn(t)?t.nextSibling(e):e.nextSibling}(l,d),!1)}e[t.index]=i=Sy(r,e,o,t),Ro(e,i)}return new VS(i,t,e)}(pi(),ge())}const RR=io,VS=class extends RR{constructor(e,i,r){super(),this._lContainer=e,this._hostTNode=i,this._hostLView=r}get element(){return Ch(this._hostTNode,this._hostLView)}get injector(){return new cl(this._hostTNode,this._hostLView)}get parentInjector(){const e=xd(this._hostTNode,this._hostLView);if(og(e)){const i=ll(e,this._hostLView),r=al(e);return new cl(i[1].data[r+8],i)}return new cl(null,this._hostLView)}clear(){for(;this.length>0;)this.remove(this.length-1)}get(e){const i=zS(this._lContainer);return null!==i&&i[e]||null}get length(){return this._lContainer.length-10}createEmbeddedView(e,i,r){const o=e.createEmbeddedView(i||{});return this.insert(o,r),o}createComponent(e,i,r,o,l){const d=e&&!function Rc(t){return"function"==typeof t}(e);let p;if(d)p=i;else{const D=i||{};p=D.index,r=D.injector,o=D.projectableNodes,l=D.ngModuleRef}const g=d?e:new Gw(ei(e)),x=r||this.parentInjector;if(!l&&null==g.ngModule){const P=(d?x:this.parentInjector).get(Da,null);P&&(l=P)}const T=g.create(x,o,void 0,l);return this.insert(T.hostView,p),T}insert(e,i){const r=e._lView,o=r[1];if(function nl(t){return un(t[3])}(r)){const T=this.indexOf(e);if(-1!==T)this.detach(T);else{const D=r[3],P=new VS(D,D[6],D[3]);P.detach(P.indexOf(e))}}const l=this._adjustIndex(i),d=this._lContainer;!function fx(t,e,i,r){const o=10+r,l=i.length;r>0&&(i[o-1][4]=e),r<l-10?(e[4]=i[o],yg(i,10+r,e)):(i.push(e),e[4]=null),e[3]=i;const d=e[17];null!==d&&i!==d&&function px(t,e){const i=t[9];e[16]!==e[3][3][16]&&(t[2]=!0),null===i?t[9]=[e]:i.push(e)}(d,e);const p=e[19];null!==p&&p.insertView(t),e[2]|=128}(o,r,d,l);const p=ep(l,d),g=r[11],x=Pd(g,d[7]);return null!==x&&function ux(t,e,i,r,o,l){r[0]=o,r[6]=e,Ur(t,r,i,1,o,l)}(o,d[6],g,r,x,p),e.attachToViewContainerRef(),yg(qw(d),l,e),e}move(e,i){return this.insert(e,i)}indexOf(e){const i=zS(this._lContainer);return null!==i?i.indexOf(e):-1}remove(e){const i=this._adjustIndex(e,-1),r=Zf(this._lContainer,i);r&&(Md(qw(this._lContainer),i),ty(r[1],r))}detach(e){const i=this._adjustIndex(e,-1),r=Zf(this._lContainer,i);return r&&null!=Md(qw(this._lContainer),i)?new Zp(r):null}_adjustIndex(e,i=0){return null==e?this.length+i:e}};function zS(t){return t[8]}function qw(t){return t[8]||(t[8]=[])}function nb(t,e){return uv(t,e)}function fv(...t){}const lb=new ze("Application Initializer");let cb=(()=>{class t{constructor(i){this.appInits=i,this.resolve=fv,this.reject=fv,this.initialized=!1,this.done=!1,this.donePromise=new Promise((r,o)=>{this.resolve=r,this.reject=o})}runInitializers(){if(this.initialized)return;const i=[],r=()=>{this.done=!0,this.resolve()};if(this.appInits)for(let o=0;o<this.appInits.length;o++){const l=this.appInits[o]();if(Vp(l))i.push(l);else if(zp(l)){const d=new Promise((p,g)=>{l.subscribe({complete:p,error:g})});i.push(d)}}Promise.all(i).then(()=>{r()}).catch(o=>{this.reject(o)}),0===i.length&&r(),this.initialized=!0}}return t.\u0275fac=function(i){return new(i||t)(Ee(lb,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const Jp=new ze("AppId",{providedIn:"root",factory:function dT(){return`${ub()}${ub()}${ub()}`}});function ub(){return String.fromCharCode(97+Math.floor(25*Math.random()))}const hT=new ze("Platform Initializer"),db=new ze("Platform ID"),fT=new ze("appBootstrapListener");let pT=(()=>{class t{log(i){console.log(i)}warn(i){console.warn(i)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Xl=new ze("LocaleId",{providedIn:"root",factory:()=>_0(Xl,ht.Optional|ht.SkipSelf)||function nI(){return"undefined"!=typeof $localize&&$localize.locale||Ge}()});class rI{constructor(e,i){this.ngModuleFactory=e,this.componentFactories=i}}let mT=(()=>{class t{compileModuleSync(i){return new Ww(i)}compileModuleAsync(i){return Promise.resolve(this.compileModuleSync(i))}compileModuleAndAllComponentsSync(i){const r=this.compileModuleSync(i),l=Br(pr(i).declarations).reduce((d,p)=>{const g=ei(p);return g&&d.push(new Gw(g)),d},[]);return new rI(r,l)}compileModuleAndAllComponentsAsync(i){return Promise.resolve(this.compileModuleAndAllComponentsSync(i))}clearCache(){}clearCacheFor(i){}getModuleId(i){}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();const oI=(()=>Promise.resolve(0))();function hb(t){"undefined"==typeof Zone?oI.then(()=>{t&&t.apply(null,null)}):Zone.current.scheduleMicroTask("scheduleMicrotask",t)}class yi{constructor({enableLongStackTrace:e=!1,shouldCoalesceEventChangeDetection:i=!1,shouldCoalesceRunChangeDetection:r=!1}){if(this.hasPendingMacrotasks=!1,this.hasPendingMicrotasks=!1,this.isStable=!0,this.onUnstable=new Xi(!1),this.onMicrotaskEmpty=new Xi(!1),this.onStable=new Xi(!1),this.onError=new Xi(!1),"undefined"==typeof Zone)throw new Error("In this configuration Angular requires Zone.js");Zone.assertZonePatched();const o=this;o._nesting=0,o._outer=o._inner=Zone.current,Zone.TaskTrackingZoneSpec&&(o._inner=o._inner.fork(new Zone.TaskTrackingZoneSpec)),e&&Zone.longStackTraceZoneSpec&&(o._inner=o._inner.fork(Zone.longStackTraceZoneSpec)),o.shouldCoalesceEventChangeDetection=!r&&i,o.shouldCoalesceRunChangeDetection=r,o.lastRequestAnimationFrameId=-1,o.nativeRequestAnimationFrame=function aI(){let t=ft.requestAnimationFrame,e=ft.cancelAnimationFrame;if("undefined"!=typeof Zone&&t&&e){const i=t[Zone.__symbol__("OriginalDelegate")];i&&(t=i);const r=e[Zone.__symbol__("OriginalDelegate")];r&&(e=r)}return{nativeRequestAnimationFrame:t,nativeCancelAnimationFrame:e}}().nativeRequestAnimationFrame,function uI(t){const e=()=>{!function cI(t){t.isCheckStableRunning||-1!==t.lastRequestAnimationFrameId||(t.lastRequestAnimationFrameId=t.nativeRequestAnimationFrame.call(ft,()=>{t.fakeTopEventTask||(t.fakeTopEventTask=Zone.root.scheduleEventTask("fakeTopEventTask",()=>{t.lastRequestAnimationFrameId=-1,pb(t),t.isCheckStableRunning=!0,fb(t),t.isCheckStableRunning=!1},void 0,()=>{},()=>{})),t.fakeTopEventTask.invoke()}),pb(t))}(t)};t._inner=t._inner.fork({name:"angular",properties:{isAngularZone:!0},onInvokeTask:(i,r,o,l,d,p)=>{try{return gT(t),i.invokeTask(o,l,d,p)}finally{(t.shouldCoalesceEventChangeDetection&&"eventTask"===l.type||t.shouldCoalesceRunChangeDetection)&&e(),yT(t)}},onInvoke:(i,r,o,l,d,p,g)=>{try{return gT(t),i.invoke(o,l,d,p,g)}finally{t.shouldCoalesceRunChangeDetection&&e(),yT(t)}},onHasTask:(i,r,o,l)=>{i.hasTask(o,l),r===o&&("microTask"==l.change?(t._hasPendingMicrotasks=l.microTask,pb(t),fb(t)):"macroTask"==l.change&&(t.hasPendingMacrotasks=l.macroTask))},onHandleError:(i,r,o,l)=>(i.handleError(o,l),t.runOutsideAngular(()=>t.onError.emit(l)),!1)})}(o)}static isInAngularZone(){return"undefined"!=typeof Zone&&!0===Zone.current.get("isAngularZone")}static assertInAngularZone(){if(!yi.isInAngularZone())throw new Error("Expected to be in Angular Zone, but it is not!")}static assertNotInAngularZone(){if(yi.isInAngularZone())throw new Error("Expected to not be in Angular Zone, but it is!")}run(e,i,r){return this._inner.run(e,i,r)}runTask(e,i,r,o){const l=this._inner,d=l.scheduleEventTask("NgZoneEvent: "+o,e,lI,fv,fv);try{return l.runTask(d,i,r)}finally{l.cancelTask(d)}}runGuarded(e,i,r){return this._inner.runGuarded(e,i,r)}runOutsideAngular(e){return this._outer.run(e)}}const lI={};function fb(t){if(0==t._nesting&&!t.hasPendingMicrotasks&&!t.isStable)try{t._nesting++,t.onMicrotaskEmpty.emit(null)}finally{if(t._nesting--,!t.hasPendingMicrotasks)try{t.runOutsideAngular(()=>t.onStable.emit(null))}finally{t.isStable=!0}}}function pb(t){t.hasPendingMicrotasks=!!(t._hasPendingMicrotasks||(t.shouldCoalesceEventChangeDetection||t.shouldCoalesceRunChangeDetection)&&-1!==t.lastRequestAnimationFrameId)}function gT(t){t._nesting++,t.isStable&&(t.isStable=!1,t.onUnstable.emit(null))}function yT(t){t._nesting--,fb(t)}class dI{constructor(){this.hasPendingMicrotasks=!1,this.hasPendingMacrotasks=!1,this.isStable=!0,this.onUnstable=new Xi,this.onMicrotaskEmpty=new Xi,this.onStable=new Xi,this.onError=new Xi}run(e,i,r){return e.apply(i,r)}runGuarded(e,i,r){return e.apply(i,r)}runOutsideAngular(e){return e()}runTask(e,i,r,o){return e.apply(i,r)}}let mb=(()=>{class t{constructor(i){this._ngZone=i,this._pendingCount=0,this._isZoneStable=!0,this._didWork=!1,this._callbacks=[],this.taskTrackingZone=null,this._watchAngularEvents(),i.run(()=>{this.taskTrackingZone="undefined"==typeof Zone?null:Zone.current.get("TaskTrackingZone")})}_watchAngularEvents(){this._ngZone.onUnstable.subscribe({next:()=>{this._didWork=!0,this._isZoneStable=!1}}),this._ngZone.runOutsideAngular(()=>{this._ngZone.onStable.subscribe({next:()=>{yi.assertNotInAngularZone(),hb(()=>{this._isZoneStable=!0,this._runCallbacksIfReady()})}})})}increasePendingRequestCount(){return this._pendingCount+=1,this._didWork=!0,this._pendingCount}decreasePendingRequestCount(){if(this._pendingCount-=1,this._pendingCount<0)throw new Error("pending async requests below zero");return this._runCallbacksIfReady(),this._pendingCount}isStable(){return this._isZoneStable&&0===this._pendingCount&&!this._ngZone.hasPendingMacrotasks}_runCallbacksIfReady(){if(this.isStable())hb(()=>{for(;0!==this._callbacks.length;){let i=this._callbacks.pop();clearTimeout(i.timeoutId),i.doneCb(this._didWork)}this._didWork=!1});else{let i=this.getPendingTasks();this._callbacks=this._callbacks.filter(r=>!r.updateCb||!r.updateCb(i)||(clearTimeout(r.timeoutId),!1)),this._didWork=!0}}getPendingTasks(){return this.taskTrackingZone?this.taskTrackingZone.macroTasks.map(i=>({source:i.source,creationLocation:i.creationLocation,data:i.data})):[]}addCallback(i,r,o){let l=-1;r&&r>0&&(l=setTimeout(()=>{this._callbacks=this._callbacks.filter(d=>d.timeoutId!==l),i(this._didWork,this.getPendingTasks())},r)),this._callbacks.push({doneCb:i,timeoutId:l,updateCb:o})}whenStable(i,r,o){if(o&&!this.taskTrackingZone)throw new Error('Task tracking zone is required when passing an update callback to whenStable(). Is "zone.js/plugins/task-tracking" loaded?');this.addCallback(i,r,o),this._runCallbacksIfReady()}getPendingRequestCount(){return this._pendingCount}findProviders(i,r,o){return[]}}return t.\u0275fac=function(i){return new(i||t)(Ee(yi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),vT=(()=>{class t{constructor(){this._applications=new Map,gb.addToWindow(this)}registerApplication(i,r){this._applications.set(i,r)}unregisterApplication(i){this._applications.delete(i)}unregisterAllApplications(){this._applications.clear()}getTestability(i){return this._applications.get(i)||null}getAllTestabilities(){return Array.from(this._applications.values())}getAllRootElements(){return Array.from(this._applications.keys())}findTestabilityInTree(i,r=!0){return gb.findTestabilityInTree(this,i,r)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class hI{addToWindow(e){}findTestabilityInTree(e,i,r){return null}}let ro,gb=new hI;const _T=new ze("AllowMultipleToken");class xT{constructor(e,i){this.name=e,this.token=i}}function wT(t,e,i=[]){const r=`Platform: ${e}`,o=new ze(r);return(l=[])=>{let d=bT();if(!d||d.injector.get(_T,!1))if(t)t(i.concat(l).concat({provide:o,useValue:!0}));else{const p=i.concat(l).concat({provide:o,useValue:!0},{provide:sh,useValue:"platform"});!function gI(t){if(ro&&!ro.destroyed&&!ro.injector.get(_T,!1))throw new Be(400,"");ro=t.get(MT);const e=t.get(hT,null);e&&e.forEach(i=>i())}(mi.create({providers:p,name:r}))}return function yI(t){const e=bT();if(!e)throw new Be(401,"");return e}()}}function bT(){return ro&&!ro.destroyed?ro:null}let MT=(()=>{class t{constructor(i){this._injector=i,this._modules=[],this._destroyListeners=[],this._destroyed=!1}bootstrapModuleFactory(i,r){const p=function vI(t,e){let i;return i="noop"===t?new dI:("zone.js"===t?void 0:t)||new yi({enableLongStackTrace:!1,shouldCoalesceEventChangeDetection:!!(null==e?void 0:e.ngZoneEventCoalescing),shouldCoalesceRunChangeDetection:!!(null==e?void 0:e.ngZoneRunCoalescing)}),i}(r?r.ngZone:void 0,{ngZoneEventCoalescing:r&&r.ngZoneEventCoalescing||!1,ngZoneRunCoalescing:r&&r.ngZoneRunCoalescing||!1}),g=[{provide:yi,useValue:p}];return p.run(()=>{const x=mi.create({providers:g,parent:this.injector,name:i.moduleType.name}),T=i.create(x),D=T.injector.get($c,null);if(!D)throw new Be(402,"");return p.runOutsideAngular(()=>{const P=p.onError.subscribe({next:B=>{D.handleError(B)}});T.onDestroy(()=>{vb(this._modules,T),P.unsubscribe()})}),function _I(t,e,i){try{const r=i();return Vp(r)?r.catch(o=>{throw e.runOutsideAngular(()=>t.handleError(o)),o}):r}catch(r){throw e.runOutsideAngular(()=>t.handleError(r)),r}}(D,p,()=>{const P=T.injector.get(cb);return P.runInitializers(),P.donePromise.then(()=>(function De(t){fr(t,"Expected localeId to be defined"),"string"==typeof t&&(ct=t.toLowerCase().replace(/_/g,"-"))}(T.injector.get(Xl,Ge)||Ge),this._moduleDoBootstrap(T),T))})})}bootstrapModule(i,r=[]){const o=ET({},r);return function pI(t,e,i){const r=new Ww(i);return Promise.resolve(r)}(0,0,i).then(l=>this.bootstrapModuleFactory(l,o))}_moduleDoBootstrap(i){const r=i.injector.get(yb);if(i._bootstrapComponents.length>0)i._bootstrapComponents.forEach(o=>r.bootstrap(o));else{if(!i.instance.ngDoBootstrap)throw new Be(403,"");i.instance.ngDoBootstrap(r)}this._modules.push(i)}onDestroy(i){this._destroyListeners.push(i)}get injector(){return this._injector}destroy(){if(this._destroyed)throw new Be(404,"");this._modules.slice().forEach(i=>i.destroy()),this._destroyListeners.forEach(i=>i()),this._destroyed=!0}get destroyed(){return this._destroyed}}return t.\u0275fac=function(i){return new(i||t)(Ee(mi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function ET(t,e){return Array.isArray(e)?e.reduce(ET,t):Object.assign(Object.assign({},t),e)}let yb=(()=>{class t{constructor(i,r,o,l,d){this._zone=i,this._injector=r,this._exceptionHandler=o,this._componentFactoryResolver=l,this._initStatus=d,this._bootstrapListeners=[],this._views=[],this._runningTick=!1,this._stable=!0,this.componentTypes=[],this.components=[],this._onMicrotaskEmptySubscription=this._zone.onMicrotaskEmpty.subscribe({next:()=>{this._zone.run(()=>{this.tick()})}});const p=new Oe(x=>{this._stable=this._zone.isStable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks,this._zone.runOutsideAngular(()=>{x.next(this._stable),x.complete()})}),g=new Oe(x=>{let T;this._zone.runOutsideAngular(()=>{T=this._zone.onStable.subscribe(()=>{yi.assertNotInAngularZone(),hb(()=>{!this._stable&&!this._zone.hasPendingMacrotasks&&!this._zone.hasPendingMicrotasks&&(this._stable=!0,x.next(!0))})})});const D=this._zone.onUnstable.subscribe(()=>{yi.assertInAngularZone(),this._stable&&(this._stable=!1,this._zone.runOutsideAngular(()=>{x.next(!1)}))});return()=>{T.unsubscribe(),D.unsubscribe()}});this.isStable=function Om(...t){const e=ta(t),i=function Zh(t,e){return"number"==typeof Xh(t)?t.pop():e}(t,1/0),r=t;return r.length?1===r.length?Ji(r[0]):Ir(i)(di(r,e)):zi}(p,g.pipe(function km(t={}){const{connector:e=(()=>new Ri),resetOnError:i=!0,resetOnComplete:r=!0,resetOnRefCountZero:o=!0}=t;return l=>{let d=null,p=null,g=null,x=0,T=!1,D=!1;const P=()=>{null==p||p.unsubscribe(),p=null},B=()=>{P(),d=g=null,T=D=!1},z=()=>{const Z=d;B(),null==Z||Z.unsubscribe()};return On((Z,re)=>{x++,!D&&!T&&P();const me=g=null!=g?g:e();re.add(()=>{x--,0===x&&!D&&!T&&(p=Ku(z,o))}),me.subscribe(re),d||(d=new Ar({next:K=>me.next(K),error:K=>{D=!0,P(),p=Ku(B,i,K),me.error(K)},complete:()=>{T=!0,P(),p=Ku(B,r),me.complete()}}),di(Z).subscribe(d))})(l)}}()))}bootstrap(i,r){if(!this._initStatus.done)throw new Be(405,"");let o;o=i instanceof DS?i:this._componentFactoryResolver.resolveComponentFactory(i),this.componentTypes.push(o.componentType);const l=function mI(t){return t.isBoundToModule}(o)?void 0:this._injector.get(Da),p=o.create(mi.NULL,[],r||o.selector,l),g=p.location.nativeElement,x=p.injector.get(mb,null),T=x&&p.injector.get(vT);return x&&T&&T.registerApplication(g,x),p.onDestroy(()=>{this.detachView(p.hostView),vb(this.components,p),T&&T.unregisterApplication(g)}),this._loadComponent(p),p}tick(){if(this._runningTick)throw new Be(101,"");try{this._runningTick=!0;for(let i of this._views)i.detectChanges()}catch(i){this._zone.runOutsideAngular(()=>this._exceptionHandler.handleError(i))}finally{this._runningTick=!1}}attachView(i){const r=i;this._views.push(r),r.attachToAppRef(this)}detachView(i){const r=i;vb(this._views,r),r.detachFromAppRef()}_loadComponent(i){this.attachView(i.hostView),this.tick(),this.components.push(i),this._injector.get(fT,[]).concat(this._bootstrapListeners).forEach(o=>o(i))}ngOnDestroy(){this._views.slice().forEach(i=>i.destroy()),this._onMicrotaskEmptySubscription.unsubscribe()}get viewCount(){return this._views.length}}return t.\u0275fac=function(i){return new(i||t)(Ee(yi),Ee(mi),Ee($c),Ee(qp),Ee(cb))},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function vb(t,e){const i=t.indexOf(e);i>-1&&t.splice(i,1)}let TT=!0,CT=!1,_b=(()=>{class t{}return t.__NG_ELEMENT_ID__=MI,t})();function MI(t){return function EI(t,e,i){if(Za(t)&&!i){const r=Li(t.index,e);return new Zp(r,r)}return 47&t.type?new Zp(e[16],e):null}(pi(),ge(),16==(16&t))}const kI=wT(null,"core",[{provide:db,useValue:"unknown"},{provide:MT,deps:[mi]},{provide:vT,deps:[]},{provide:pT,deps:[]}]);let BI=(()=>{class t{constructor(i){}}return t.\u0275fac=function(i){return new(i||t)(Ee(yb))},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({}),t})(),yv=null;function Zl(){return yv}const Zi=new ze("DocumentToken");let ku=(()=>{class t{historyGo(i){throw new Error("Not implemented")}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:function(){return function zI(){return Ee(kT)}()},providedIn:"platform"}),t})();const GI=new ze("Location Initialized");let kT=(()=>{class t extends ku{constructor(i){super(),this._doc=i,this._init()}_init(){this.location=window.location,this._history=window.history}getBaseHrefFromDOM(){return Zl().getBaseHref(this._doc)}onPopState(i){const r=Zl().getGlobalEventTarget(this._doc,"window");return r.addEventListener("popstate",i,!1),()=>r.removeEventListener("popstate",i)}onHashChange(i){const r=Zl().getGlobalEventTarget(this._doc,"window");return r.addEventListener("hashchange",i,!1),()=>r.removeEventListener("hashchange",i)}get href(){return this.location.href}get protocol(){return this.location.protocol}get hostname(){return this.location.hostname}get port(){return this.location.port}get pathname(){return this.location.pathname}get search(){return this.location.search}get hash(){return this.location.hash}set pathname(i){this.location.pathname=i}pushState(i,r,o){BT()?this._history.pushState(i,r,o):this.location.hash=o}replaceState(i,r,o){BT()?this._history.replaceState(i,r,o):this.location.hash=o}forward(){this._history.forward()}back(){this._history.back()}historyGo(i=0){this._history.go(i)}getState(){return this._history.state}}return t.\u0275fac=function(i){return new(i||t)(Ee(Zi))},t.\u0275prov=at({token:t,factory:function(){return function WI(){return new kT(Ee(Zi))}()},providedIn:"platform"}),t})();function BT(){return!!window.history.pushState}function Eb(t,e){if(0==t.length)return e;if(0==e.length)return t;let i=0;return t.endsWith("/")&&i++,e.startsWith("/")&&i++,2==i?t+e.substring(1):1==i?t+e:t+"/"+e}function UT(t){const e=t.match(/#|\?|$/),i=e&&e.index||t.length;return t.slice(0,i-("/"===t[i-1]?1:0))+t.slice(i)}function Ra(t){return t&&"?"!==t[0]?"?"+t:t}let Rh=(()=>{class t{historyGo(i){throw new Error("Not implemented")}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:function(){return function jI(t){const e=Ee(Zi).location;return new HT(Ee(ku),e&&e.origin||"")}()},providedIn:"root"}),t})();const Sb=new ze("appBaseHref");let HT=(()=>{class t extends Rh{constructor(i,r){if(super(),this._platformLocation=i,this._removeListenerFns=[],null==r&&(r=this._platformLocation.getBaseHrefFromDOM()),null==r)throw new Error("No base href set. Please provide a value for the APP_BASE_HREF token or add a base element to the document.");this._baseHref=r}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}prepareExternalUrl(i){return Eb(this._baseHref,i)}path(i=!1){const r=this._platformLocation.pathname+Ra(this._platformLocation.search),o=this._platformLocation.hash;return o&&i?`${r}${o}`:r}pushState(i,r,o,l){const d=this.prepareExternalUrl(o+Ra(l));this._platformLocation.pushState(i,r,d)}replaceState(i,r,o,l){const d=this.prepareExternalUrl(o+Ra(l));this._platformLocation.replaceState(i,r,d)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(i=0){var r,o;null===(o=(r=this._platformLocation).historyGo)||void 0===o||o.call(r,i)}}return t.\u0275fac=function(i){return new(i||t)(Ee(ku),Ee(Sb,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),$I=(()=>{class t extends Rh{constructor(i,r){super(),this._platformLocation=i,this._baseHref="",this._removeListenerFns=[],null!=r&&(this._baseHref=r)}ngOnDestroy(){for(;this._removeListenerFns.length;)this._removeListenerFns.pop()()}onPopState(i){this._removeListenerFns.push(this._platformLocation.onPopState(i),this._platformLocation.onHashChange(i))}getBaseHref(){return this._baseHref}path(i=!1){let r=this._platformLocation.hash;return null==r&&(r="#"),r.length>0?r.substring(1):r}prepareExternalUrl(i){const r=Eb(this._baseHref,i);return r.length>0?"#"+r:r}pushState(i,r,o,l){let d=this.prepareExternalUrl(o+Ra(l));0==d.length&&(d=this._platformLocation.pathname),this._platformLocation.pushState(i,r,d)}replaceState(i,r,o,l){let d=this.prepareExternalUrl(o+Ra(l));0==d.length&&(d=this._platformLocation.pathname),this._platformLocation.replaceState(i,r,d)}forward(){this._platformLocation.forward()}back(){this._platformLocation.back()}historyGo(i=0){var r,o;null===(o=(r=this._platformLocation).historyGo)||void 0===o||o.call(r,i)}}return t.\u0275fac=function(i){return new(i||t)(Ee(ku),Ee(Sb,8))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Tb=(()=>{class t{constructor(i,r){this._subject=new Xi,this._urlChangeListeners=[],this._platformStrategy=i;const o=this._platformStrategy.getBaseHref();this._platformLocation=r,this._baseHref=UT(VT(o)),this._platformStrategy.onPopState(l=>{this._subject.emit({url:this.path(!0),pop:!0,state:l.state,type:l.type})})}path(i=!1){return this.normalize(this._platformStrategy.path(i))}getState(){return this._platformLocation.getState()}isCurrentPathEqualTo(i,r=""){return this.path()==this.normalize(i+Ra(r))}normalize(i){return t.stripTrailingSlash(function XI(t,e){return t&&e.startsWith(t)?e.substring(t.length):e}(this._baseHref,VT(i)))}prepareExternalUrl(i){return i&&"/"!==i[0]&&(i="/"+i),this._platformStrategy.prepareExternalUrl(i)}go(i,r="",o=null){this._platformStrategy.pushState(o,"",i,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+Ra(r)),o)}replaceState(i,r="",o=null){this._platformStrategy.replaceState(o,"",i,r),this._notifyUrlChangeListeners(this.prepareExternalUrl(i+Ra(r)),o)}forward(){this._platformStrategy.forward()}back(){this._platformStrategy.back()}historyGo(i=0){var r,o;null===(o=(r=this._platformStrategy).historyGo)||void 0===o||o.call(r,i)}onUrlChange(i){this._urlChangeListeners.push(i),this._urlChangeSubscription||(this._urlChangeSubscription=this.subscribe(r=>{this._notifyUrlChangeListeners(r.url,r.state)}))}_notifyUrlChangeListeners(i="",r){this._urlChangeListeners.forEach(o=>o(i,r))}subscribe(i,r,o){return this._subject.subscribe({next:i,error:r,complete:o})}}return t.normalizeQueryParams=Ra,t.joinWithSlash=Eb,t.stripTrailingSlash=UT,t.\u0275fac=function(i){return new(i||t)(Ee(Rh),Ee(ku))},t.\u0275prov=at({token:t,factory:function(){return function qI(){return new Tb(Ee(Rh),Ee(ku))}()},providedIn:"root"}),t})();function VT(t){return t.replace(/\/index.html$/,"")}let QT=(()=>{class t{constructor(i,r){this._viewContainer=i,this._context=new OP,this._thenTemplateRef=null,this._elseTemplateRef=null,this._thenViewRef=null,this._elseViewRef=null,this._thenTemplateRef=r}set ngIf(i){this._context.$implicit=this._context.ngIf=i,this._updateView()}set ngIfThen(i){KT("ngIfThen",i),this._thenTemplateRef=i,this._thenViewRef=null,this._updateView()}set ngIfElse(i){KT("ngIfElse",i),this._elseTemplateRef=i,this._elseViewRef=null,this._updateView()}_updateView(){this._context.$implicit?this._thenViewRef||(this._viewContainer.clear(),this._elseViewRef=null,this._thenTemplateRef&&(this._thenViewRef=this._viewContainer.createEmbeddedView(this._thenTemplateRef,this._context))):this._elseViewRef||(this._viewContainer.clear(),this._thenViewRef=null,this._elseTemplateRef&&(this._elseViewRef=this._viewContainer.createEmbeddedView(this._elseTemplateRef,this._context)))}static ngTemplateContextGuard(i,r){return!0}}return t.\u0275fac=function(i){return new(i||t)(We(io),We(Aa))},t.\u0275dir=Jn({type:t,selectors:[["","ngIf",""]],inputs:{ngIf:"ngIf",ngIfThen:"ngIfThen",ngIfElse:"ngIfElse"}}),t})();class OP{constructor(){this.$implicit=null,this.ngIf=null}}function KT(t,e){if(e&&!e.createEmbeddedView)throw new Error(`${t} must be a TemplateRef, but received '${Kt(e)}'.`)}let cL=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({}),t})();let fL=(()=>{class t{}return t.\u0275prov=at({token:t,providedIn:"root",factory:()=>new pL(Ee(Zi),window)}),t})();class pL{constructor(e,i){this.document=e,this.window=i,this.offset=()=>[0,0]}setOffset(e){this.offset=Array.isArray(e)?()=>e:e}getScrollPosition(){return this.supportsScrolling()?[this.window.pageXOffset,this.window.pageYOffset]:[0,0]}scrollToPosition(e){this.supportsScrolling()&&this.window.scrollTo(e[0],e[1])}scrollToAnchor(e){if(!this.supportsScrolling())return;const i=function mL(t,e){const i=t.getElementById(e)||t.getElementsByName(e)[0];if(i)return i;if("function"==typeof t.createTreeWalker&&t.body&&(t.body.createShadowRoot||t.body.attachShadow)){const r=t.createTreeWalker(t.body,NodeFilter.SHOW_ELEMENT);let o=r.currentNode;for(;o;){const l=o.shadowRoot;if(l){const d=l.getElementById(e)||l.querySelector(`[name="${e}"]`);if(d)return d}o=r.nextNode()}}return null}(this.document,e);i&&(this.scrollToElement(i),i.focus())}setHistoryScrollRestoration(e){if(this.supportScrollRestoration()){const i=this.window.history;i&&i.scrollRestoration&&(i.scrollRestoration=e)}}scrollToElement(e){const i=e.getBoundingClientRect(),r=i.left+this.window.pageXOffset,o=i.top+this.window.pageYOffset,l=this.offset();this.window.scrollTo(r-l[0],o-l[1])}supportScrollRestoration(){try{if(!this.supportsScrolling())return!1;const e=nC(this.window.history)||nC(Object.getPrototypeOf(this.window.history));return!(!e||!e.writable&&!e.set)}catch(e){return!1}}supportsScrolling(){try{return!!this.window&&!!this.window.scrollTo&&"pageXOffset"in this.window}catch(e){return!1}}}function nC(t){return Object.getOwnPropertyDescriptor(t,"scrollRestoration")}class Hb extends class yL extends class VI{}{constructor(){super(...arguments),this.supportsDOMEvents=!0}}{static makeCurrent(){!function HI(t){yv||(yv=t)}(new Hb)}onAndCancel(e,i,r){return e.addEventListener(i,r,!1),()=>{e.removeEventListener(i,r,!1)}}dispatchEvent(e,i){e.dispatchEvent(i)}remove(e){e.parentNode&&e.parentNode.removeChild(e)}createElement(e,i){return(i=i||this.getDefaultDocument()).createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,i){return"window"===i?window:"document"===i?e:"body"===i?e.body:null}getBaseHref(e){const i=function vL(){return im=im||document.querySelector("base"),im?im.getAttribute("href"):null}();return null==i?null:function _L(t){Cv=Cv||document.createElement("a"),Cv.setAttribute("href",t);const e=Cv.pathname;return"/"===e.charAt(0)?e:`/${e}`}(i)}resetBaseElement(){im=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return function IP(t,e){e=encodeURIComponent(e);for(const i of t.split(";")){const r=i.indexOf("="),[o,l]=-1==r?[i,""]:[i.slice(0,r),i.slice(r+1)];if(o.trim()===e)return decodeURIComponent(l)}return null}(document.cookie,e)}}let Cv,im=null;const iC=new ze("TRANSITION_ID"),wL=[{provide:lb,useFactory:function xL(t,e,i){return()=>{i.get(cb).donePromise.then(()=>{const r=Zl(),o=e.querySelectorAll(`style[ng-transition="${t}"]`);for(let l=0;l<o.length;l++)r.remove(o[l])})}},deps:[iC,Zi,mi],multi:!0}];class Vb{static init(){!function fI(t){gb=t}(new Vb)}addToWindow(e){ft.getAngularTestability=(r,o=!0)=>{const l=e.findTestabilityInTree(r,o);if(null==l)throw new Error("Could not find testability for element.");return l},ft.getAllAngularTestabilities=()=>e.getAllTestabilities(),ft.getAllAngularRootElements=()=>e.getAllRootElements(),ft.frameworkStabilizers||(ft.frameworkStabilizers=[]),ft.frameworkStabilizers.push(r=>{const o=ft.getAllAngularTestabilities();let l=o.length,d=!1;const p=function(g){d=d||g,l--,0==l&&r(d)};o.forEach(function(g){g.whenStable(p)})})}findTestabilityInTree(e,i,r){if(null==i)return null;const o=e.getTestability(i);return null!=o?o:r?Zl().isShadowRoot(i)?this.findTestabilityInTree(e,i.host,!0):this.findTestabilityInTree(e,i.parentElement,!0):null}}let bL=(()=>{class t{build(){return new XMLHttpRequest}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const Dv=new ze("EventManagerPlugins");let Av=(()=>{class t{constructor(i,r){this._zone=r,this._eventNameToPlugin=new Map,i.forEach(o=>o.manager=this),this._plugins=i.slice().reverse()}addEventListener(i,r,o){return this._findPluginFor(r).addEventListener(i,r,o)}addGlobalEventListener(i,r,o){return this._findPluginFor(r).addGlobalEventListener(i,r,o)}getZone(){return this._zone}_findPluginFor(i){const r=this._eventNameToPlugin.get(i);if(r)return r;const o=this._plugins;for(let l=0;l<o.length;l++){const d=o[l];if(d.supports(i))return this._eventNameToPlugin.set(i,d),d}throw new Error(`No event manager plugin found for event ${i}`)}}return t.\u0275fac=function(i){return new(i||t)(Ee(Dv),Ee(yi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class rC{constructor(e){this._doc=e}addGlobalEventListener(e,i,r){const o=Zl().getGlobalEventTarget(this._doc,e);if(!o)throw new Error(`Unsupported event target ${o} for event ${i}`);return this.addEventListener(o,i,r)}}let sC=(()=>{class t{constructor(){this._stylesSet=new Set}addStyles(i){const r=new Set;i.forEach(o=>{this._stylesSet.has(o)||(this._stylesSet.add(o),r.add(o))}),this.onStylesAdded(r)}onStylesAdded(i){}getAllStyles(){return Array.from(this._stylesSet)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),rm=(()=>{class t extends sC{constructor(i){super(),this._doc=i,this._hostNodes=new Map,this._hostNodes.set(i.head,[])}_addStylesToHost(i,r,o){i.forEach(l=>{const d=this._doc.createElement("style");d.textContent=l,o.push(r.appendChild(d))})}addHost(i){const r=[];this._addStylesToHost(this._stylesSet,i,r),this._hostNodes.set(i,r)}removeHost(i){const r=this._hostNodes.get(i);r&&r.forEach(oC),this._hostNodes.delete(i)}onStylesAdded(i){this._hostNodes.forEach((r,o)=>{this._addStylesToHost(i,o,r)})}ngOnDestroy(){this._hostNodes.forEach(i=>i.forEach(oC))}}return t.\u0275fac=function(i){return new(i||t)(Ee(Zi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function oC(t){Zl().remove(t)}const zb={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/MathML/"},Gb=/%COMP%/g;function Rv(t,e,i){for(let r=0;r<e.length;r++){let o=e[r];Array.isArray(o)?Rv(t,o,i):(o=o.replace(Gb,t),i.push(o))}return i}function cC(t){return e=>{if("__ngUnwrap__"===e)return t;!1===t(e)&&(e.preventDefault(),e.returnValue=!1)}}let Iv=(()=>{class t{constructor(i,r,o){this.eventManager=i,this.sharedStylesHost=r,this.appId=o,this.rendererByCompId=new Map,this.defaultRenderer=new Wb(i)}createRenderer(i,r){if(!i||!r)return this.defaultRenderer;switch(r.encapsulation){case os.Emulated:{let o=this.rendererByCompId.get(r.id);return o||(o=new DL(this.eventManager,this.sharedStylesHost,r,this.appId),this.rendererByCompId.set(r.id,o)),o.applyToHost(i),o}case 1:case os.ShadowDom:return new AL(this.eventManager,this.sharedStylesHost,i,r);default:if(!this.rendererByCompId.has(r.id)){const o=Rv(r.id,r.styles,[]);this.sharedStylesHost.addStyles(o),this.rendererByCompId.set(r.id,this.defaultRenderer)}return this.defaultRenderer}}begin(){}end(){}}return t.\u0275fac=function(i){return new(i||t)(Ee(Av),Ee(rm),Ee(Jp))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class Wb{constructor(e){this.eventManager=e,this.data=Object.create(null),this.destroyNode=null}destroy(){}createElement(e,i){return i?document.createElementNS(zb[i]||i,e):document.createElement(e)}createComment(e){return document.createComment(e)}createText(e){return document.createTextNode(e)}appendChild(e,i){e.appendChild(i)}insertBefore(e,i,r){e&&e.insertBefore(i,r)}removeChild(e,i){e&&e.removeChild(i)}selectRootElement(e,i){let r="string"==typeof e?document.querySelector(e):e;if(!r)throw new Error(`The selector "${e}" did not match any elements`);return i||(r.textContent=""),r}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,i,r,o){if(o){i=o+":"+i;const l=zb[o];l?e.setAttributeNS(l,i,r):e.setAttribute(i,r)}else e.setAttribute(i,r)}removeAttribute(e,i,r){if(r){const o=zb[r];o?e.removeAttributeNS(o,i):e.removeAttribute(`${r}:${i}`)}else e.removeAttribute(i)}addClass(e,i){e.classList.add(i)}removeClass(e,i){e.classList.remove(i)}setStyle(e,i,r,o){o&(ar.DashCase|ar.Important)?e.style.setProperty(i,r,o&ar.Important?"important":""):e.style[i]=r}removeStyle(e,i,r){r&ar.DashCase?e.style.removeProperty(i):e.style[i]=""}setProperty(e,i,r){e[i]=r}setValue(e,i){e.nodeValue=i}listen(e,i,r){return"string"==typeof e?this.eventManager.addGlobalEventListener(e,i,cC(r)):this.eventManager.addEventListener(e,i,cC(r))}}class DL extends Wb{constructor(e,i,r,o){super(e),this.component=r;const l=Rv(o+"-"+r.id,r.styles,[]);i.addStyles(l),this.contentAttr=function SL(t){return"_ngcontent-%COMP%".replace(Gb,t)}(o+"-"+r.id),this.hostAttr=function TL(t){return"_nghost-%COMP%".replace(Gb,t)}(o+"-"+r.id)}applyToHost(e){super.setAttribute(e,this.hostAttr,"")}createElement(e,i){const r=super.createElement(e,i);return super.setAttribute(r,this.contentAttr,""),r}}class AL extends Wb{constructor(e,i,r,o){super(e),this.sharedStylesHost=i,this.hostEl=r,this.shadowRoot=r.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);const l=Rv(o.id,o.styles,[]);for(let d=0;d<l.length;d++){const p=document.createElement("style");p.textContent=l[d],this.shadowRoot.appendChild(p)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}appendChild(e,i){return super.appendChild(this.nodeOrShadowRoot(e),i)}insertBefore(e,i,r){return super.insertBefore(this.nodeOrShadowRoot(e),i,r)}removeChild(e,i){return super.removeChild(this.nodeOrShadowRoot(e),i)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}}let RL=(()=>{class t extends rC{constructor(i){super(i)}supports(i){return!0}addEventListener(i,r,o){return i.addEventListener(r,o,!1),()=>this.removeEventListener(i,r,o)}removeEventListener(i,r,o){return i.removeEventListener(r,o)}}return t.\u0275fac=function(i){return new(i||t)(Ee(Zi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const dC=["alt","control","meta","shift"],PL={"\b":"Backspace","\t":"Tab","\x7f":"Delete","\x1b":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},hC={A:"1",B:"2",C:"3",D:"4",E:"5",F:"6",G:"7",H:"8",I:"9",J:"*",K:"+",M:"-",N:".",O:"/","`":"0","\x90":"NumLock"},LL={alt:t=>t.altKey,control:t=>t.ctrlKey,meta:t=>t.metaKey,shift:t=>t.shiftKey};let FL=(()=>{class t extends rC{constructor(i){super(i)}supports(i){return null!=t.parseEventName(i)}addEventListener(i,r,o){const l=t.parseEventName(r),d=t.eventCallback(l.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Zl().onAndCancel(i,l.domEventName,d))}static parseEventName(i){const r=i.toLowerCase().split("."),o=r.shift();if(0===r.length||"keydown"!==o&&"keyup"!==o)return null;const l=t._normalizeKey(r.pop());let d="";if(dC.forEach(g=>{const x=r.indexOf(g);x>-1&&(r.splice(x,1),d+=g+".")}),d+=l,0!=r.length||0===l.length)return null;const p={};return p.domEventName=o,p.fullKey=d,p}static getEventFullKey(i){let r="",o=function NL(t){let e=t.key;if(null==e){if(e=t.keyIdentifier,null==e)return"Unidentified";e.startsWith("U+")&&(e=String.fromCharCode(parseInt(e.substring(2),16)),3===t.location&&hC.hasOwnProperty(e)&&(e=hC[e]))}return PL[e]||e}(i);return o=o.toLowerCase()," "===o?o="space":"."===o&&(o="dot"),dC.forEach(l=>{l!=o&&LL[l](i)&&(r+=l+".")}),r+=o,r}static eventCallback(i,r,o){return l=>{t.getEventFullKey(l)===i&&o.runGuarded(()=>r(l))}}static _normalizeKey(i){return"esc"===i?"escape":i}}return t.\u0275fac=function(i){return new(i||t)(Ee(Zi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const UL=wT(kI,"browser",[{provide:db,useValue:"browser"},{provide:hT,useValue:function OL(){Hb.makeCurrent(),Vb.init()},multi:!0},{provide:Zi,useFactory:function BL(){return function tl(t){ld=t}(document),document},deps:[]}]),HL=[{provide:sh,useValue:"root"},{provide:$c,useFactory:function kL(){return new $c},deps:[]},{provide:Dv,useClass:RL,multi:!0,deps:[Zi,yi,db]},{provide:Dv,useClass:FL,multi:!0,deps:[Zi]},{provide:Iv,useClass:Iv,deps:[Av,rm,Jp]},{provide:Xp,useExisting:Iv},{provide:sC,useExisting:rm},{provide:rm,useClass:rm,deps:[Zi]},{provide:mb,useClass:mb,deps:[yi]},{provide:Av,useClass:Av,deps:[Dv,yi]},{provide:class gL{},useClass:bL,deps:[]}];let fC=(()=>{class t{constructor(i){if(i)throw new Error("BrowserModule has already been loaded. If you need access to common directives such as NgIf and NgFor from a lazy loaded module, import CommonModule instead.")}static withServerTransition(i){return{ngModule:t,providers:[{provide:Jp,useValue:i.appId},{provide:iC,useExisting:Jp},wL]}}}return t.\u0275fac=function(i){return new(i||t)(Ee(t,12))},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({providers:HL,imports:[cL,BI]}),t})(),pC=(()=>{class t{constructor(i){this._doc=i}getTitle(){return this._doc.title}setTitle(i){this._doc.title=i||""}}return t.\u0275fac=function(i){return new(i||t)(Ee(Zi))},t.\u0275prov=at({token:t,factory:function(i){let r=null;return r=i?new i:function zL(){return new pC(Ee(Zi))}(),r},providedIn:"root"}),t})();"undefined"!=typeof window&&window;class yC{}const Pa="*";function vC(t,e=null){return{type:2,steps:t,options:e}}function _C(t){return{type:6,styles:t,offset:null}}function xC(t){Promise.resolve(null).then(t)}class sm{constructor(e=0,i=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+i}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){xC(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){const i="start"==e?this._onStartFns:this._onDoneFns;i.forEach(r=>r()),i.length=0}}class wC{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let i=0,r=0,o=0;const l=this.players.length;0==l?xC(()=>this._onFinish()):this.players.forEach(d=>{d.onDone(()=>{++i==l&&this._onFinish()}),d.onDestroy(()=>{++r==l&&this._onDestroy()}),d.onStart(()=>{++o==l&&this._onStart()})}),this.totalTime=this.players.reduce((d,p)=>Math.max(d,p.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){const i=e*this.totalTime;this.players.forEach(r=>{const o=r.totalTime?Math.min(1,i/r.totalTime):1;r.setPosition(o)})}getPosition(){const e=this.players.reduce((i,r)=>null===i||r.totalTime>i.totalTime?r:i,null);return null!=e?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){const i="start"==e?this._onStartFns:this._onDoneFns;i.forEach(r=>r()),i.length=0}}const Vt=!1;function bC(t){return new Be(3e3,Vt)}function IF(){return"undefined"!=typeof window&&void 0!==window.document}function qb(){return"undefined"!=typeof process&&"[object process]"==={}.toString.call(process)}function Ql(t){switch(t.length){case 0:return new sm;case 1:return t[0];default:return new wC(t)}}function MC(t,e,i,r,o={},l={}){const d=[],p=[];let g=-1,x=null;if(r.forEach(T=>{const D=T.offset,P=D==g,B=P&&x||{};Object.keys(T).forEach(z=>{let Z=z,re=T[z];if("offset"!==z)switch(Z=e.normalizePropertyName(Z,d),re){case"!":re=o[z];break;case Pa:re=l[z];break;default:re=e.normalizeStyleValue(z,Z,re,d)}B[Z]=re}),P||p.push(B),x=B,g=D}),d.length)throw function xF(t){return new Be(3502,Vt)}();return p}function Xb(t,e,i,r){switch(e){case"start":t.onStart(()=>r(i&&Zb(i,"start",t)));break;case"done":t.onDone(()=>r(i&&Zb(i,"done",t)));break;case"destroy":t.onDestroy(()=>r(i&&Zb(i,"destroy",t)))}}function Zb(t,e,i){const r=i.totalTime,l=Yb(t.element,t.triggerName,t.fromState,t.toState,e||t.phaseName,null==r?t.totalTime:r,!!i.disabled),d=t._data;return null!=d&&(l._data=d),l}function Yb(t,e,i,r,o="",l=0,d){return{element:t,triggerName:e,fromState:i,toState:r,phaseName:o,totalTime:l,disabled:!!d}}function Xr(t,e,i){let r;return t instanceof Map?(r=t.get(e),r||t.set(e,r=i)):(r=t[e],r||(r=t[e]=i)),r}function EC(t){const e=t.indexOf(":");return[t.substring(1,e),t.substr(e+1)]}let Qb=(t,e)=>!1,SC=(t,e,i)=>[],TC=null;function Kb(t){const e=t.parentNode||t.host;return e===TC?null:e}(qb()||"undefined"!=typeof Element)&&(IF()?(TC=(()=>document.documentElement)(),Qb=(t,e)=>{for(;e;){if(e===t)return!0;e=Kb(e)}return!1}):Qb=(t,e)=>t.contains(e),SC=(t,e,i)=>{if(i)return Array.from(t.querySelectorAll(e));const r=t.querySelector(e);return r?[r]:[]});let Bu=null,CC=!1;function DC(t){Bu||(Bu=function LF(){return"undefined"!=typeof document?document.body:null}()||{},CC=!!Bu.style&&"WebkitAppearance"in Bu.style);let e=!0;return Bu.style&&!function PF(t){return"ebkit"==t.substring(1,6)}(t)&&(e=t in Bu.style,!e&&CC&&(e="Webkit"+t.charAt(0).toUpperCase()+t.substr(1)in Bu.style)),e}const AC=Qb,RC=SC;let IC=(()=>{class t{validateStyleProperty(i){return DC(i)}matchesElement(i,r){return!1}containsElement(i,r){return AC(i,r)}getParentElement(i){return Kb(i)}query(i,r,o){return RC(i,r,o)}computeStyle(i,r,o){return o||""}animate(i,r,o,l,d,p=[],g){return new sm(o,l)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),Jb=(()=>{class t{}return t.NOOP=new IC,t})();const eM="ng-enter",Lv="ng-leave",Fv="ng-trigger",Nv=".ng-trigger",LC="ng-animating",tM=".ng-animating";function Uu(t){if("number"==typeof t)return t;const e=t.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:nM(parseFloat(e[1]),e[2])}function nM(t,e){return"s"===e?1e3*t:t}function Ov(t,e,i){return t.hasOwnProperty("duration")?t:function OF(t,e,i){let o,l=0,d="";if("string"==typeof t){const p=t.match(/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i);if(null===p)return e.push(bC()),{duration:0,delay:0,easing:""};o=nM(parseFloat(p[1]),p[2]);const g=p[3];null!=g&&(l=nM(parseFloat(g),p[4]));const x=p[5];x&&(d=x)}else o=t;if(!i){let p=!1,g=e.length;o<0&&(e.push(function KL(){return new Be(3100,Vt)}()),p=!0),l<0&&(e.push(function JL(){return new Be(3101,Vt)}()),p=!0),p&&e.splice(g,0,bC())}return{duration:o,delay:l,easing:d}}(t,e,i)}function Ih(t,e={}){return Object.keys(t).forEach(i=>{e[i]=t[i]}),e}function Kl(t,e,i={}){if(e)for(let r in t)i[r]=t[r];else Ih(t,i);return i}function NC(t,e,i){return i?e+":"+i+";":""}function OC(t){let e="";for(let i=0;i<t.style.length;i++){const r=t.style.item(i);e+=NC(0,r,t.style.getPropertyValue(r))}for(const i in t.style)t.style.hasOwnProperty(i)&&!i.startsWith("_")&&(e+=NC(0,UF(i),t.style[i]));t.setAttribute("style",e)}function Vo(t,e,i){t.style&&(Object.keys(e).forEach(r=>{const o=rM(r);i&&!i.hasOwnProperty(r)&&(i[r]=t.style[o]),t.style[o]=e[r]}),qb()&&OC(t))}function Hu(t,e){t.style&&(Object.keys(e).forEach(i=>{const r=rM(i);t.style[r]=""}),qb()&&OC(t))}function om(t){return Array.isArray(t)?1==t.length?t[0]:vC(t):t}const iM=new RegExp("{{\\s*(.+?)\\s*}}","g");function kC(t){let e=[];if("string"==typeof t){let i;for(;i=iM.exec(t);)e.push(i[1]);iM.lastIndex=0}return e}function kv(t,e,i){const r=t.toString(),o=r.replace(iM,(l,d)=>{let p=e[d];return e.hasOwnProperty(d)||(i.push(function tF(t){return new Be(3003,Vt)}()),p=""),p.toString()});return o==r?t:o}function Bv(t){const e=[];let i=t.next();for(;!i.done;)e.push(i.value),i=t.next();return e}const BF=/-+([a-z0-9])/g;function rM(t){return t.replace(BF,(...e)=>e[1].toUpperCase())}function UF(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function Zr(t,e,i){switch(e.type){case 7:return t.visitTrigger(e,i);case 0:return t.visitState(e,i);case 1:return t.visitTransition(e,i);case 2:return t.visitSequence(e,i);case 3:return t.visitGroup(e,i);case 4:return t.visitAnimate(e,i);case 5:return t.visitKeyframes(e,i);case 6:return t.visitStyle(e,i);case 8:return t.visitReference(e,i);case 9:return t.visitAnimateChild(e,i);case 10:return t.visitAnimateRef(e,i);case 11:return t.visitQuery(e,i);case 12:return t.visitStagger(e,i);default:throw function nF(t){return new Be(3004,Vt)}()}}function BC(t,e){return window.getComputedStyle(t)[e]}function jF(t,e){const i=[];return"string"==typeof t?t.split(/\s*,\s*/).forEach(r=>function $F(t,e,i){if(":"==t[0]){const g=function qF(t,e){switch(t){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(i,r)=>parseFloat(r)>parseFloat(i);case":decrement":return(i,r)=>parseFloat(r)<parseFloat(i);default:return e.push(function gF(t){return new Be(3016,Vt)}()),"* => *"}}(t,i);if("function"==typeof g)return void e.push(g);t=g}const r=t.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(null==r||r.length<4)return i.push(function mF(t){return new Be(3015,Vt)}()),e;const o=r[1],l=r[2],d=r[3];e.push(UC(o,d));"<"==l[0]&&!("*"==o&&"*"==d)&&e.push(UC(d,o))}(r,i,e)):i.push(t),i}const zv=new Set(["true","1"]),Gv=new Set(["false","0"]);function UC(t,e){const i=zv.has(t)||Gv.has(t),r=zv.has(e)||Gv.has(e);return(o,l)=>{let d="*"==t||t==o,p="*"==e||e==l;return!d&&i&&"boolean"==typeof o&&(d=o?zv.has(t):Gv.has(t)),!p&&r&&"boolean"==typeof l&&(p=l?zv.has(e):Gv.has(e)),d&&p}}const XF=new RegExp("s*:selfs*,?","g");function sM(t,e,i,r){return new ZF(t).build(e,i,r)}class ZF{constructor(e){this._driver=e}build(e,i,r){const o=new KF(i);this._resetContextStyleTimingState(o);const l=Zr(this,om(e),o);return o.unsupportedCSSPropertiesFound.size&&o.unsupportedCSSPropertiesFound.keys(),l}_resetContextStyleTimingState(e){e.currentQuerySelector="",e.collectedStyles={},e.collectedStyles[""]={},e.currentTime=0}visitTrigger(e,i){let r=i.queryCount=0,o=i.depCount=0;const l=[],d=[];return"@"==e.name.charAt(0)&&i.errors.push(function rF(){return new Be(3006,Vt)}()),e.definitions.forEach(p=>{if(this._resetContextStyleTimingState(i),0==p.type){const g=p,x=g.name;x.toString().split(/\s*,\s*/).forEach(T=>{g.name=T,l.push(this.visitState(g,i))}),g.name=x}else if(1==p.type){const g=this.visitTransition(p,i);r+=g.queryCount,o+=g.depCount,d.push(g)}else i.errors.push(function sF(){return new Be(3007,Vt)}())}),{type:7,name:e.name,states:l,transitions:d,queryCount:r,depCount:o,options:null}}visitState(e,i){const r=this.visitStyle(e.styles,i),o=e.options&&e.options.params||null;if(r.containsDynamicStyles){const l=new Set,d=o||{};r.styles.forEach(p=>{if(Wv(p)){const g=p;Object.keys(g).forEach(x=>{kC(g[x]).forEach(T=>{d.hasOwnProperty(T)||l.add(T)})})}}),l.size&&(Bv(l.values()),i.errors.push(function oF(t,e){return new Be(3008,Vt)}()))}return{type:0,name:e.name,style:r,options:o?{params:o}:null}}visitTransition(e,i){i.queryCount=0,i.depCount=0;const r=Zr(this,om(e.animation),i);return{type:1,matchers:jF(e.expr,i.errors),animation:r,queryCount:i.queryCount,depCount:i.depCount,options:Vu(e.options)}}visitSequence(e,i){return{type:2,steps:e.steps.map(r=>Zr(this,r,i)),options:Vu(e.options)}}visitGroup(e,i){const r=i.currentTime;let o=0;const l=e.steps.map(d=>{i.currentTime=r;const p=Zr(this,d,i);return o=Math.max(o,i.currentTime),p});return i.currentTime=o,{type:3,steps:l,options:Vu(e.options)}}visitAnimate(e,i){const r=function eN(t,e){let i=null;if(t.hasOwnProperty("duration"))i=t;else if("number"==typeof t)return oM(Ov(t,e).duration,0,"");const r=t;if(r.split(/\s+/).some(l=>"{"==l.charAt(0)&&"{"==l.charAt(1))){const l=oM(0,0,"");return l.dynamic=!0,l.strValue=r,l}return i=i||Ov(r,e),oM(i.duration,i.delay,i.easing)}(e.timings,i.errors);i.currentAnimateTimings=r;let o,l=e.styles?e.styles:_C({});if(5==l.type)o=this.visitKeyframes(l,i);else{let d=e.styles,p=!1;if(!d){p=!0;const x={};r.easing&&(x.easing=r.easing),d=_C(x)}i.currentTime+=r.duration+r.delay;const g=this.visitStyle(d,i);g.isEmptyStep=p,o=g}return i.currentAnimateTimings=null,{type:4,timings:r,style:o,options:null}}visitStyle(e,i){const r=this._makeStyleAst(e,i);return this._validateStyleAst(r,i),r}_makeStyleAst(e,i){const r=[];Array.isArray(e.styles)?e.styles.forEach(d=>{"string"==typeof d?d==Pa?r.push(d):i.errors.push(function aF(t){return new Be(3002,Vt)}()):r.push(d)}):r.push(e.styles);let o=!1,l=null;return r.forEach(d=>{if(Wv(d)){const p=d,g=p.easing;if(g&&(l=g,delete p.easing),!o)for(let x in p)if(p[x].toString().indexOf("{{")>=0){o=!0;break}}}),{type:6,styles:r,easing:l,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,i){const r=i.currentAnimateTimings;let o=i.currentTime,l=i.currentTime;r&&l>0&&(l-=r.duration+r.delay),e.styles.forEach(d=>{"string"!=typeof d&&Object.keys(d).forEach(p=>{if(!this._driver.validateStyleProperty(p))return delete d[p],void i.unsupportedCSSPropertiesFound.add(p);const g=i.collectedStyles[i.currentQuerySelector],x=g[p];let T=!0;x&&(l!=o&&l>=x.startTime&&o<=x.endTime&&(i.errors.push(function lF(t,e,i,r,o){return new Be(3010,Vt)}()),T=!1),l=x.startTime),T&&(g[p]={startTime:l,endTime:o}),i.options&&function kF(t,e,i){const r=e.params||{},o=kC(t);o.length&&o.forEach(l=>{r.hasOwnProperty(l)||i.push(function eF(t){return new Be(3001,Vt)}())})}(d[p],i.options,i.errors)})})}visitKeyframes(e,i){const r={type:5,styles:[],options:null};if(!i.currentAnimateTimings)return i.errors.push(function cF(){return new Be(3011,Vt)}()),r;let l=0;const d=[];let p=!1,g=!1,x=0;const T=e.steps.map(me=>{const K=this._makeStyleAst(me,i);let Le=null!=K.offset?K.offset:function JF(t){if("string"==typeof t)return null;let e=null;if(Array.isArray(t))t.forEach(i=>{if(Wv(i)&&i.hasOwnProperty("offset")){const r=i;e=parseFloat(r.offset),delete r.offset}});else if(Wv(t)&&t.hasOwnProperty("offset")){const i=t;e=parseFloat(i.offset),delete i.offset}return e}(K.styles),Ze=0;return null!=Le&&(l++,Ze=K.offset=Le),g=g||Ze<0||Ze>1,p=p||Ze<x,x=Ze,d.push(Ze),K});g&&i.errors.push(function uF(){return new Be(3012,Vt)}()),p&&i.errors.push(function dF(){return new Be(3200,Vt)}());const D=e.steps.length;let P=0;l>0&&l<D?i.errors.push(function hF(){return new Be(3202,Vt)}()):0==l&&(P=1/(D-1));const B=D-1,z=i.currentTime,Z=i.currentAnimateTimings,re=Z.duration;return T.forEach((me,K)=>{const Le=P>0?K==B?1:P*K:d[K],Ze=Le*re;i.currentTime=z+Z.delay+Ze,Z.duration=Ze,this._validateStyleAst(me,i),me.offset=Le,r.styles.push(me)}),r}visitReference(e,i){return{type:8,animation:Zr(this,om(e.animation),i),options:Vu(e.options)}}visitAnimateChild(e,i){return i.depCount++,{type:9,options:Vu(e.options)}}visitAnimateRef(e,i){return{type:10,animation:this.visitReference(e.animation,i),options:Vu(e.options)}}visitQuery(e,i){const r=i.currentQuerySelector,o=e.options||{};i.queryCount++,i.currentQuery=e;const[l,d]=function YF(t){const e=!!t.split(/\s*,\s*/).find(i=>":self"==i);return e&&(t=t.replace(XF,"")),t=t.replace(/@\*/g,Nv).replace(/@\w+/g,i=>Nv+"-"+i.substr(1)).replace(/:animating/g,tM),[t,e]}(e.selector);i.currentQuerySelector=r.length?r+" "+l:l,Xr(i.collectedStyles,i.currentQuerySelector,{});const p=Zr(this,om(e.animation),i);return i.currentQuery=null,i.currentQuerySelector=r,{type:11,selector:l,limit:o.limit||0,optional:!!o.optional,includeSelf:d,animation:p,originalSelector:e.selector,options:Vu(e.options)}}visitStagger(e,i){i.currentQuery||i.errors.push(function fF(){return new Be(3013,Vt)}());const r="full"===e.timings?{duration:0,delay:0,easing:"full"}:Ov(e.timings,i.errors,!0);return{type:12,animation:Zr(this,om(e.animation),i),timings:r,options:null}}}class KF{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles={},this.options=null,this.unsupportedCSSPropertiesFound=new Set}}function Wv(t){return!Array.isArray(t)&&"object"==typeof t}function Vu(t){return t?(t=Ih(t)).params&&(t.params=function QF(t){return t?Ih(t):null}(t.params)):t={},t}function oM(t,e,i){return{duration:t,delay:e,easing:i}}function aM(t,e,i,r,o,l,d=null,p=!1){return{type:1,element:t,keyframes:e,preStyleProps:i,postStyleProps:r,duration:o,delay:l,totalTime:o+l,easing:d,subTimeline:p}}class jv{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,i){let r=this._map.get(e);r||this._map.set(e,r=[]),r.push(...i)}has(e){return this._map.has(e)}clear(){this._map.clear()}}const iN=new RegExp(":enter","g"),sN=new RegExp(":leave","g");function lM(t,e,i,r,o,l={},d={},p,g,x=[]){return(new oN).buildKeyframes(t,e,i,r,o,l,d,p,g,x)}class oN{buildKeyframes(e,i,r,o,l,d,p,g,x,T=[]){x=x||new jv;const D=new cM(e,i,x,o,l,T,[]);D.options=g,D.currentTimeline.setStyles([d],null,D.errors,g),Zr(this,r,D);const P=D.timelines.filter(B=>B.containsAnimation());if(Object.keys(p).length){let B;for(let z=P.length-1;z>=0;z--){const Z=P[z];if(Z.element===i){B=Z;break}}B&&!B.allowOnlyTimelineStyles()&&B.setStyles([p],null,D.errors,g)}return P.length?P.map(B=>B.buildKeyframes()):[aM(i,[],[],[],0,0,"",!1)]}visitTrigger(e,i){}visitState(e,i){}visitTransition(e,i){}visitAnimateChild(e,i){const r=i.subInstructions.get(i.element);if(r){const o=i.createSubContext(e.options),l=i.currentTimeline.currentTime,d=this._visitSubInstructions(r,o,o.options);l!=d&&i.transformIntoNewTimeline(d)}i.previousNode=e}visitAnimateRef(e,i){const r=i.createSubContext(e.options);r.transformIntoNewTimeline(),this.visitReference(e.animation,r),i.transformIntoNewTimeline(r.currentTimeline.currentTime),i.previousNode=e}_visitSubInstructions(e,i,r){let l=i.currentTimeline.currentTime;const d=null!=r.duration?Uu(r.duration):null,p=null!=r.delay?Uu(r.delay):null;return 0!==d&&e.forEach(g=>{const x=i.appendInstructionToTimeline(g,d,p);l=Math.max(l,x.duration+x.delay)}),l}visitReference(e,i){i.updateOptions(e.options,!0),Zr(this,e.animation,i),i.previousNode=e}visitSequence(e,i){const r=i.subContextCount;let o=i;const l=e.options;if(l&&(l.params||l.delay)&&(o=i.createSubContext(l),o.transformIntoNewTimeline(),null!=l.delay)){6==o.previousNode.type&&(o.currentTimeline.snapshotCurrentStyles(),o.previousNode=$v);const d=Uu(l.delay);o.delayNextStep(d)}e.steps.length&&(e.steps.forEach(d=>Zr(this,d,o)),o.currentTimeline.applyStylesToKeyframe(),o.subContextCount>r&&o.transformIntoNewTimeline()),i.previousNode=e}visitGroup(e,i){const r=[];let o=i.currentTimeline.currentTime;const l=e.options&&e.options.delay?Uu(e.options.delay):0;e.steps.forEach(d=>{const p=i.createSubContext(e.options);l&&p.delayNextStep(l),Zr(this,d,p),o=Math.max(o,p.currentTimeline.currentTime),r.push(p.currentTimeline)}),r.forEach(d=>i.currentTimeline.mergeTimelineCollectedStyles(d)),i.transformIntoNewTimeline(o),i.previousNode=e}_visitTiming(e,i){if(e.dynamic){const r=e.strValue;return Ov(i.params?kv(r,i.params,i.errors):r,i.errors)}return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,i){const r=i.currentAnimateTimings=this._visitTiming(e.timings,i),o=i.currentTimeline;r.delay&&(i.incrementTime(r.delay),o.snapshotCurrentStyles());const l=e.style;5==l.type?this.visitKeyframes(l,i):(i.incrementTime(r.duration),this.visitStyle(l,i),o.applyStylesToKeyframe()),i.currentAnimateTimings=null,i.previousNode=e}visitStyle(e,i){const r=i.currentTimeline,o=i.currentAnimateTimings;!o&&r.getCurrentStyleProperties().length&&r.forwardFrame();const l=o&&o.easing||e.easing;e.isEmptyStep?r.applyEmptyStep(l):r.setStyles(e.styles,l,i.errors,i.options),i.previousNode=e}visitKeyframes(e,i){const r=i.currentAnimateTimings,o=i.currentTimeline.duration,l=r.duration,p=i.createSubContext().currentTimeline;p.easing=r.easing,e.styles.forEach(g=>{p.forwardTime((g.offset||0)*l),p.setStyles(g.styles,g.easing,i.errors,i.options),p.applyStylesToKeyframe()}),i.currentTimeline.mergeTimelineCollectedStyles(p),i.transformIntoNewTimeline(o+l),i.previousNode=e}visitQuery(e,i){const r=i.currentTimeline.currentTime,o=e.options||{},l=o.delay?Uu(o.delay):0;l&&(6===i.previousNode.type||0==r&&i.currentTimeline.getCurrentStyleProperties().length)&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=$v);let d=r;const p=i.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!o.optional,i.errors);i.currentQueryTotal=p.length;let g=null;p.forEach((x,T)=>{i.currentQueryIndex=T;const D=i.createSubContext(e.options,x);l&&D.delayNextStep(l),x===i.element&&(g=D.currentTimeline),Zr(this,e.animation,D),D.currentTimeline.applyStylesToKeyframe(),d=Math.max(d,D.currentTimeline.currentTime)}),i.currentQueryIndex=0,i.currentQueryTotal=0,i.transformIntoNewTimeline(d),g&&(i.currentTimeline.mergeTimelineCollectedStyles(g),i.currentTimeline.snapshotCurrentStyles()),i.previousNode=e}visitStagger(e,i){const r=i.parentContext,o=i.currentTimeline,l=e.timings,d=Math.abs(l.duration),p=d*(i.currentQueryTotal-1);let g=d*i.currentQueryIndex;switch(l.duration<0?"reverse":l.easing){case"reverse":g=p-g;break;case"full":g=r.currentStaggerTime}const T=i.currentTimeline;g&&T.delayNextStep(g);const D=T.currentTime;Zr(this,e.animation,i),i.previousNode=e,r.currentStaggerTime=o.currentTime-D+(o.startTime-r.currentTimeline.startTime)}}const $v={};class cM{constructor(e,i,r,o,l,d,p,g){this._driver=e,this.element=i,this.subInstructions=r,this._enterClassName=o,this._leaveClassName=l,this.errors=d,this.timelines=p,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=$v,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=g||new qv(this._driver,i,0),p.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,i){if(!e)return;const r=e;let o=this.options;null!=r.duration&&(o.duration=Uu(r.duration)),null!=r.delay&&(o.delay=Uu(r.delay));const l=r.params;if(l){let d=o.params;d||(d=this.options.params={}),Object.keys(l).forEach(p=>{(!i||!d.hasOwnProperty(p))&&(d[p]=kv(l[p],d,this.errors))})}}_copyOptions(){const e={};if(this.options){const i=this.options.params;if(i){const r=e.params={};Object.keys(i).forEach(o=>{r[o]=i[o]})}}return e}createSubContext(e=null,i,r){const o=i||this.element,l=new cM(this._driver,o,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(o,r||0));return l.previousNode=this.previousNode,l.currentAnimateTimings=this.currentAnimateTimings,l.options=this._copyOptions(),l.updateOptions(e),l.currentQueryIndex=this.currentQueryIndex,l.currentQueryTotal=this.currentQueryTotal,l.parentContext=this,this.subContextCount++,l}transformIntoNewTimeline(e){return this.previousNode=$v,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,i,r){const o={duration:null!=i?i:e.duration,delay:this.currentTimeline.currentTime+(null!=r?r:0)+e.delay,easing:""},l=new aN(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,o,e.stretchStartingKeyframe);return this.timelines.push(l),o}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,i,r,o,l,d){let p=[];if(o&&p.push(this.element),e.length>0){e=(e=e.replace(iN,"."+this._enterClassName)).replace(sN,"."+this._leaveClassName);let x=this._driver.query(this.element,e,1!=r);0!==r&&(x=r<0?x.slice(x.length+r,x.length):x.slice(0,r)),p.push(...x)}return!l&&0==p.length&&d.push(function pF(t){return new Be(3014,Vt)}()),p}}class qv{constructor(e,i,r,o){this._driver=e,this.element=i,this.startTime=r,this._elementTimelineStylesLookup=o,this.duration=0,this._previousKeyframe={},this._currentKeyframe={},this._keyframes=new Map,this._styleSummary={},this._pendingStyles={},this._backFill={},this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._localTimelineStyles=Object.create(this._backFill,{}),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(i),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(i,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.getCurrentStyleProperties().length>0;default:return!0}}getCurrentStyleProperties(){return Object.keys(this._currentKeyframe)}get currentTime(){return this.startTime+this.duration}delayNextStep(e){const i=1==this._keyframes.size&&Object.keys(this._pendingStyles).length;this.duration||i?(this.forwardTime(this.currentTime+e),i&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,i){return this.applyStylesToKeyframe(),new qv(this._driver,e,i||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=Object.create(this._backFill,{}),this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=1,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,i){this._localTimelineStyles[e]=i,this._globalTimelineStyles[e]=i,this._styleSummary[e]={time:this.currentTime,value:i}}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&(this._previousKeyframe.easing=e),Object.keys(this._globalTimelineStyles).forEach(i=>{this._backFill[i]=this._globalTimelineStyles[i]||Pa,this._currentKeyframe[i]=Pa}),this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,i,r,o){i&&(this._previousKeyframe.easing=i);const l=o&&o.params||{},d=function lN(t,e){const i={};let r;return t.forEach(o=>{"*"===o?(r=r||Object.keys(e),r.forEach(l=>{i[l]=Pa})):Kl(o,!1,i)}),i}(e,this._globalTimelineStyles);Object.keys(d).forEach(p=>{const g=kv(d[p],l,r);this._pendingStyles[p]=g,this._localTimelineStyles.hasOwnProperty(p)||(this._backFill[p]=this._globalTimelineStyles.hasOwnProperty(p)?this._globalTimelineStyles[p]:Pa),this._updateStyle(p,g)})}applyStylesToKeyframe(){const e=this._pendingStyles,i=Object.keys(e);0!=i.length&&(this._pendingStyles={},i.forEach(r=>{this._currentKeyframe[r]=e[r]}),Object.keys(this._localTimelineStyles).forEach(r=>{this._currentKeyframe.hasOwnProperty(r)||(this._currentKeyframe[r]=this._localTimelineStyles[r])}))}snapshotCurrentStyles(){Object.keys(this._localTimelineStyles).forEach(e=>{const i=this._localTimelineStyles[e];this._pendingStyles[e]=i,this._updateStyle(e,i)})}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){const e=[];for(let i in this._currentKeyframe)e.push(i);return e}mergeTimelineCollectedStyles(e){Object.keys(e._styleSummary).forEach(i=>{const r=this._styleSummary[i],o=e._styleSummary[i];(!r||o.time>r.time)&&this._updateStyle(i,o.value)})}buildKeyframes(){this.applyStylesToKeyframe();const e=new Set,i=new Set,r=1===this._keyframes.size&&0===this.duration;let o=[];this._keyframes.forEach((p,g)=>{const x=Kl(p,!0);Object.keys(x).forEach(T=>{const D=x[T];"!"==D?e.add(T):D==Pa&&i.add(T)}),r||(x.offset=g/this.duration),o.push(x)});const l=e.size?Bv(e.values()):[],d=i.size?Bv(i.values()):[];if(r){const p=o[0],g=Ih(p);p.offset=0,g.offset=1,o=[p,g]}return aM(this.element,o,l,d,this.duration,this.startTime,this.easing,!1)}}class aN extends qv{constructor(e,i,r,o,l,d,p=!1){super(e,i,d.delay),this.keyframes=r,this.preStyleProps=o,this.postStyleProps=l,this._stretchStartingKeyframe=p,this.timings={duration:d.duration,delay:d.delay,easing:d.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:i,duration:r,easing:o}=this.timings;if(this._stretchStartingKeyframe&&i){const l=[],d=r+i,p=i/d,g=Kl(e[0],!1);g.offset=0,l.push(g);const x=Kl(e[0],!1);x.offset=zC(p),l.push(x);const T=e.length-1;for(let D=1;D<=T;D++){let P=Kl(e[D],!1);P.offset=zC((i+P.offset*r)/d),l.push(P)}r=d,i=0,o="",e=l}return aM(this.element,e,this.preStyleProps,this.postStyleProps,r,i,o,!0)}}function zC(t,e=3){const i=Math.pow(10,e-1);return Math.round(t*i)/i}class uM{}class cN extends uM{normalizePropertyName(e,i){return rM(e)}normalizeStyleValue(e,i,r,o){let l="";const d=r.toString().trim();if(uN[i]&&0!==r&&"0"!==r)if("number"==typeof r)l="px";else{const p=r.match(/^[+-]?[\d\.]+([a-z]*)$/);p&&0==p[1].length&&o.push(function iF(t,e){return new Be(3005,Vt)}())}return d+l}}const uN=(()=>function dN(t){const e={};return t.forEach(i=>e[i]=!0),e}("width,height,minWidth,minHeight,maxWidth,maxHeight,left,top,bottom,right,fontSize,outlineWidth,outlineOffset,paddingTop,paddingLeft,paddingBottom,paddingRight,marginTop,marginLeft,marginBottom,marginRight,borderRadius,borderWidth,borderTopWidth,borderLeftWidth,borderRightWidth,borderBottomWidth,textIndent,perspective".split(",")))();function GC(t,e,i,r,o,l,d,p,g,x,T,D,P){return{type:0,element:t,triggerName:e,isRemovalTransition:o,fromState:i,fromStyles:l,toState:r,toStyles:d,timelines:p,queriedElements:g,preStyleProps:x,postStyleProps:T,totalTime:D,errors:P}}const dM={};class WC{constructor(e,i,r){this._triggerName=e,this.ast=i,this._stateStyles=r}match(e,i,r,o){return function hN(t,e,i,r,o){return t.some(l=>l(e,i,r,o))}(this.ast.matchers,e,i,r,o)}buildStyles(e,i,r){const o=this._stateStyles["*"],l=this._stateStyles[e],d=o?o.buildStyles(i,r):{};return l?l.buildStyles(i,r):d}build(e,i,r,o,l,d,p,g,x,T){const D=[],P=this.ast.options&&this.ast.options.params||dM,z=this.buildStyles(r,p&&p.params||dM,D),Z=g&&g.params||dM,re=this.buildStyles(o,Z,D),me=new Set,K=new Map,Le=new Map,Ze="void"===o,Ft={params:Object.assign(Object.assign({},P),Z)},Nn=T?[]:lM(e,i,this.ast.animation,l,d,z,re,Ft,x,D);let jn=0;if(Nn.forEach(Kr=>{jn=Math.max(Kr.duration+Kr.delay,jn)}),D.length)return GC(i,this._triggerName,r,o,Ze,z,re,[],[],K,Le,jn,D);Nn.forEach(Kr=>{const Jr=Kr.element,Vh=Xr(K,Jr,{});Kr.preStyleProps.forEach(ao=>Vh[ao]=!0);const Na=Xr(Le,Jr,{});Kr.postStyleProps.forEach(ao=>Na[ao]=!0),Jr!==i&&me.add(Jr)});const Qr=Bv(me.values());return GC(i,this._triggerName,r,o,Ze,z,re,Nn,Qr,K,Le,jn)}}class fN{constructor(e,i,r){this.styles=e,this.defaultParams=i,this.normalizer=r}buildStyles(e,i){const r={},o=Ih(this.defaultParams);return Object.keys(e).forEach(l=>{const d=e[l];null!=d&&(o[l]=d)}),this.styles.styles.forEach(l=>{if("string"!=typeof l){const d=l;Object.keys(d).forEach(p=>{let g=d[p];g.length>1&&(g=kv(g,o,i));const x=this.normalizer.normalizePropertyName(p,i);g=this.normalizer.normalizeStyleValue(p,x,g,i),r[x]=g})}}),r}}class mN{constructor(e,i,r){this.name=e,this.ast=i,this._normalizer=r,this.transitionFactories=[],this.states={},i.states.forEach(o=>{this.states[o.name]=new fN(o.style,o.options&&o.options.params||{},r)}),jC(this.states,"true","1"),jC(this.states,"false","0"),i.transitions.forEach(o=>{this.transitionFactories.push(new WC(e,o,this.states))}),this.fallbackTransition=function gN(t,e,i){return new WC(t,{type:1,animation:{type:2,steps:[],options:null},matchers:[(d,p)=>!0],options:null,queryCount:0,depCount:0},e)}(e,this.states)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,i,r,o){return this.transitionFactories.find(d=>d.match(e,i,r,o))||null}matchStyles(e,i,r){return this.fallbackTransition.buildStyles(e,i,r)}}function jC(t,e,i){t.hasOwnProperty(e)?t.hasOwnProperty(i)||(t[i]=t[e]):t.hasOwnProperty(i)&&(t[e]=t[i])}const yN=new jv;class vN{constructor(e,i,r){this.bodyNode=e,this._driver=i,this._normalizer=r,this._animations={},this._playersById={},this.players=[]}register(e,i){const r=[],l=sM(this._driver,i,r,[]);if(r.length)throw function wF(t){return new Be(3503,Vt)}();this._animations[e]=l}_buildPlayer(e,i,r){const o=e.element,l=MC(0,this._normalizer,0,e.keyframes,i,r);return this._driver.animate(o,l,e.duration,e.delay,e.easing,[],!0)}create(e,i,r={}){const o=[],l=this._animations[e];let d;const p=new Map;if(l?(d=lM(this._driver,i,l,eM,Lv,{},{},r,yN,o),d.forEach(T=>{const D=Xr(p,T.element,{});T.postStyleProps.forEach(P=>D[P]=null)})):(o.push(function bF(){return new Be(3300,Vt)}()),d=[]),o.length)throw function MF(t){return new Be(3504,Vt)}();p.forEach((T,D)=>{Object.keys(T).forEach(P=>{T[P]=this._driver.computeStyle(D,P,Pa)})});const x=Ql(d.map(T=>{const D=p.get(T.element);return this._buildPlayer(T,{},D)}));return this._playersById[e]=x,x.onDestroy(()=>this.destroy(e)),this.players.push(x),x}destroy(e){const i=this._getPlayer(e);i.destroy(),delete this._playersById[e];const r=this.players.indexOf(i);r>=0&&this.players.splice(r,1)}_getPlayer(e){const i=this._playersById[e];if(!i)throw function EF(t){return new Be(3301,Vt)}();return i}listen(e,i,r,o){const l=Yb(i,"","","");return Xb(this._getPlayer(e),r,l,o),()=>{}}command(e,i,r,o){if("register"==r)return void this.register(e,o[0]);if("create"==r)return void this.create(e,i,o[0]||{});const l=this._getPlayer(e);switch(r){case"play":l.play();break;case"pause":l.pause();break;case"reset":l.reset();break;case"restart":l.restart();break;case"finish":l.finish();break;case"init":l.init();break;case"setPosition":l.setPosition(parseFloat(o[0]));break;case"destroy":this.destroy(e)}}}const $C="ng-animate-queued",hM="ng-animate-disabled",MN=[],qC={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},EN={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},Ts="__ng_removed";class fM{constructor(e,i=""){this.namespaceId=i;const r=e&&e.hasOwnProperty("value");if(this.value=function DN(t){return null!=t?t:null}(r?e.value:e),r){const l=Ih(e);delete l.value,this.options=l}else this.options={};this.options.params||(this.options.params={})}get params(){return this.options.params}absorbOptions(e){const i=e.params;if(i){const r=this.options.params;Object.keys(i).forEach(o=>{null==r[o]&&(r[o]=i[o])})}}}const am="void",pM=new fM(am);class SN{constructor(e,i,r){this.id=e,this.hostElement=i,this._engine=r,this.players=[],this._triggers={},this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,Cs(i,this._hostClassName)}listen(e,i,r,o){if(!this._triggers.hasOwnProperty(i))throw function SF(t,e){return new Be(3302,Vt)}();if(null==r||0==r.length)throw function TF(t){return new Be(3303,Vt)}();if(!function AN(t){return"start"==t||"done"==t}(r))throw function CF(t,e){return new Be(3400,Vt)}();const l=Xr(this._elementListeners,e,[]),d={name:i,phase:r,callback:o};l.push(d);const p=Xr(this._engine.statesByElement,e,{});return p.hasOwnProperty(i)||(Cs(e,Fv),Cs(e,Fv+"-"+i),p[i]=pM),()=>{this._engine.afterFlush(()=>{const g=l.indexOf(d);g>=0&&l.splice(g,1),this._triggers[i]||delete p[i]})}}register(e,i){return!this._triggers[e]&&(this._triggers[e]=i,!0)}_getTrigger(e){const i=this._triggers[e];if(!i)throw function DF(t){return new Be(3401,Vt)}();return i}trigger(e,i,r,o=!0){const l=this._getTrigger(i),d=new mM(this.id,i,e);let p=this._engine.statesByElement.get(e);p||(Cs(e,Fv),Cs(e,Fv+"-"+i),this._engine.statesByElement.set(e,p={}));let g=p[i];const x=new fM(r,this.id);if(!(r&&r.hasOwnProperty("value"))&&g&&x.absorbOptions(g.options),p[i]=x,g||(g=pM),x.value!==am&&g.value===x.value){if(!function PN(t,e){const i=Object.keys(t),r=Object.keys(e);if(i.length!=r.length)return!1;for(let o=0;o<i.length;o++){const l=i[o];if(!e.hasOwnProperty(l)||t[l]!==e[l])return!1}return!0}(g.params,x.params)){const Z=[],re=l.matchStyles(g.value,g.params,Z),me=l.matchStyles(x.value,x.params,Z);Z.length?this._engine.reportError(Z):this._engine.afterFlush(()=>{Hu(e,re),Vo(e,me)})}return}const P=Xr(this._engine.playersByElement,e,[]);P.forEach(Z=>{Z.namespaceId==this.id&&Z.triggerName==i&&Z.queued&&Z.destroy()});let B=l.matchTransition(g.value,x.value,e,x.params),z=!1;if(!B){if(!o)return;B=l.fallbackTransition,z=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:i,transition:B,fromState:g,toState:x,player:d,isFallbackTransition:z}),z||(Cs(e,$C),d.onStart(()=>{Ph(e,$C)})),d.onDone(()=>{let Z=this.players.indexOf(d);Z>=0&&this.players.splice(Z,1);const re=this._engine.playersByElement.get(e);if(re){let me=re.indexOf(d);me>=0&&re.splice(me,1)}}),this.players.push(d),P.push(d),d}deregister(e){delete this._triggers[e],this._engine.statesByElement.forEach((i,r)=>{delete i[e]}),this._elementListeners.forEach((i,r)=>{this._elementListeners.set(r,i.filter(o=>o.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);const i=this._engine.playersByElement.get(e);i&&(i.forEach(r=>r.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,i){const r=this._engine.driver.query(e,Nv,!0);r.forEach(o=>{if(o[Ts])return;const l=this._engine.fetchNamespacesByElement(o);l.size?l.forEach(d=>d.triggerLeaveAnimation(o,i,!1,!0)):this.clearElementCache(o)}),this._engine.afterFlushAnimationsDone(()=>r.forEach(o=>this.clearElementCache(o)))}triggerLeaveAnimation(e,i,r,o){const l=this._engine.statesByElement.get(e),d=new Map;if(l){const p=[];if(Object.keys(l).forEach(g=>{if(d.set(g,l[g].value),this._triggers[g]){const x=this.trigger(e,g,am,o);x&&p.push(x)}}),p.length)return this._engine.markElementAsRemoved(this.id,e,!0,i,d),r&&Ql(p).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){const i=this._elementListeners.get(e),r=this._engine.statesByElement.get(e);if(i&&r){const o=new Set;i.forEach(l=>{const d=l.name;if(o.has(d))return;o.add(d);const g=this._triggers[d].fallbackTransition,x=r[d]||pM,T=new fM(am),D=new mM(this.id,d,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:d,transition:g,fromState:x,toState:T,player:D,isFallbackTransition:!0})})}}removeNode(e,i){const r=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,i),this.triggerLeaveAnimation(e,i,!0))return;let o=!1;if(r.totalAnimations){const l=r.players.length?r.playersByQueriedElement.get(e):[];if(l&&l.length)o=!0;else{let d=e;for(;d=d.parentNode;)if(r.statesByElement.get(d)){o=!0;break}}}if(this.prepareLeaveAnimationListeners(e),o)r.markElementAsRemoved(this.id,e,!1,i);else{const l=e[Ts];(!l||l===qC)&&(r.afterFlush(()=>this.clearElementCache(e)),r.destroyInnerAnimations(e),r._onRemovalComplete(e,i))}}insertNode(e,i){Cs(e,this._hostClassName)}drainQueuedTransitions(e){const i=[];return this._queue.forEach(r=>{const o=r.player;if(o.destroyed)return;const l=r.element,d=this._elementListeners.get(l);d&&d.forEach(p=>{if(p.name==r.triggerName){const g=Yb(l,r.triggerName,r.fromState.value,r.toState.value);g._data=e,Xb(r.player,p.phase,g,p.callback)}}),o.markedForDestroy?this._engine.afterFlush(()=>{o.destroy()}):i.push(r)}),this._queue=[],i.sort((r,o)=>{const l=r.transition.ast.depCount,d=o.transition.ast.depCount;return 0==l||0==d?l-d:this._engine.driver.containsElement(r.element,o.element)?1:-1})}destroy(e){this.players.forEach(i=>i.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}elementContainsData(e){let i=!1;return this._elementListeners.has(e)&&(i=!0),i=!!this._queue.find(r=>r.element===e)||i,i}}class TN{constructor(e,i,r){this.bodyNode=e,this.driver=i,this._normalizer=r,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(o,l)=>{}}_onRemovalComplete(e,i){this.onRemovalComplete(e,i)}get queuedPlayers(){const e=[];return this._namespaceList.forEach(i=>{i.players.forEach(r=>{r.queued&&e.push(r)})}),e}createNamespace(e,i){const r=new SN(e,i,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,i)?this._balanceNamespaceList(r,i):(this.newHostElements.set(i,r),this.collectEnterElement(i)),this._namespaceLookup[e]=r}_balanceNamespaceList(e,i){const r=this._namespaceList,o=this.namespacesByHostElement,l=r.length-1;if(l>=0){let d=!1;if(void 0!==this.driver.getParentElement){let p=this.driver.getParentElement(i);for(;p;){const g=o.get(p);if(g){const x=r.indexOf(g);r.splice(x+1,0,e),d=!0;break}p=this.driver.getParentElement(p)}}else for(let p=l;p>=0;p--)if(this.driver.containsElement(r[p].hostElement,i)){r.splice(p+1,0,e),d=!0;break}d||r.unshift(e)}else r.push(e);return o.set(i,e),e}register(e,i){let r=this._namespaceLookup[e];return r||(r=this.createNamespace(e,i)),r}registerTrigger(e,i,r){let o=this._namespaceLookup[e];o&&o.register(i,r)&&this.totalAnimations++}destroy(e,i){if(!e)return;const r=this._fetchNamespace(e);this.afterFlush(()=>{this.namespacesByHostElement.delete(r.hostElement),delete this._namespaceLookup[e];const o=this._namespaceList.indexOf(r);o>=0&&this._namespaceList.splice(o,1)}),this.afterFlushAnimationsDone(()=>r.destroy(i))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){const i=new Set,r=this.statesByElement.get(e);if(r){const o=Object.keys(r);for(let l=0;l<o.length;l++){const d=r[o[l]].namespaceId;if(d){const p=this._fetchNamespace(d);p&&i.add(p)}}}return i}trigger(e,i,r,o){if(Xv(i)){const l=this._fetchNamespace(e);if(l)return l.trigger(i,r,o),!0}return!1}insertNode(e,i,r,o){if(!Xv(i))return;const l=i[Ts];if(l&&l.setForRemoval){l.setForRemoval=!1,l.setForMove=!0;const d=this.collectedLeaveElements.indexOf(i);d>=0&&this.collectedLeaveElements.splice(d,1)}if(e){const d=this._fetchNamespace(e);d&&d.insertNode(i,r)}o&&this.collectEnterElement(i)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,i){i?this.disabledNodes.has(e)||(this.disabledNodes.add(e),Cs(e,hM)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Ph(e,hM))}removeNode(e,i,r,o){if(Xv(i)){const l=e?this._fetchNamespace(e):null;if(l?l.removeNode(i,o):this.markElementAsRemoved(e,i,!1,o),r){const d=this.namespacesByHostElement.get(i);d&&d.id!==e&&d.removeNode(i,o)}}else this._onRemovalComplete(i,o)}markElementAsRemoved(e,i,r,o,l){this.collectedLeaveElements.push(i),i[Ts]={namespaceId:e,setForRemoval:o,hasAnimation:r,removedBeforeQueried:!1,previousTriggersValues:l}}listen(e,i,r,o,l){return Xv(i)?this._fetchNamespace(e).listen(i,r,o,l):()=>{}}_buildInstruction(e,i,r,o,l){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,r,o,e.fromState.options,e.toState.options,i,l)}destroyInnerAnimations(e){let i=this.driver.query(e,Nv,!0);i.forEach(r=>this.destroyActiveAnimationsForElement(r)),0!=this.playersByQueriedElement.size&&(i=this.driver.query(e,tM,!0),i.forEach(r=>this.finishActiveQueriedAnimationOnElement(r)))}destroyActiveAnimationsForElement(e){const i=this.playersByElement.get(e);i&&i.forEach(r=>{r.queued?r.markedForDestroy=!0:r.destroy()})}finishActiveQueriedAnimationOnElement(e){const i=this.playersByQueriedElement.get(e);i&&i.forEach(r=>r.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return Ql(this.players).onDone(()=>e());e()})}processLeaveNode(e){var i;const r=e[Ts];if(r&&r.setForRemoval){if(e[Ts]=qC,r.namespaceId){this.destroyInnerAnimations(e);const o=this._fetchNamespace(r.namespaceId);o&&o.clearElementCache(e)}this._onRemovalComplete(e,r.setForRemoval)}(null===(i=e.classList)||void 0===i?void 0:i.contains(hM))&&this.markElementAsDisabled(e,!1),this.driver.query(e,".ng-animate-disabled",!0).forEach(o=>{this.markElementAsDisabled(o,!1)})}flush(e=-1){let i=[];if(this.newHostElements.size&&(this.newHostElements.forEach((r,o)=>this._balanceNamespaceList(r,o)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let r=0;r<this.collectedEnterElements.length;r++)Cs(this.collectedEnterElements[r],"ng-star-inserted");if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){const r=[];try{i=this._flushAnimations(r,e)}finally{for(let o=0;o<r.length;o++)r[o]()}}else for(let r=0;r<this.collectedLeaveElements.length;r++)this.processLeaveNode(this.collectedLeaveElements[r]);if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(r=>r()),this._flushFns=[],this._whenQuietFns.length){const r=this._whenQuietFns;this._whenQuietFns=[],i.length?Ql(i).onDone(()=>{r.forEach(o=>o())}):r.forEach(o=>o())}}reportError(e){throw function AF(t){return new Be(3402,Vt)}()}_flushAnimations(e,i){const r=new jv,o=[],l=new Map,d=[],p=new Map,g=new Map,x=new Map,T=new Set;this.disabledNodes.forEach(He=>{T.add(He);const Je=this.driver.query(He,".ng-animate-queued",!0);for(let ut=0;ut<Je.length;ut++)T.add(Je[ut])});const D=this.bodyNode,P=Array.from(this.statesByElement.keys()),B=YC(P,this.collectedEnterElements),z=new Map;let Z=0;B.forEach((He,Je)=>{const ut=eM+Z++;z.set(Je,ut),He.forEach(Yt=>Cs(Yt,ut))});const re=[],me=new Set,K=new Set;for(let He=0;He<this.collectedLeaveElements.length;He++){const Je=this.collectedLeaveElements[He],ut=Je[Ts];ut&&ut.setForRemoval&&(re.push(Je),me.add(Je),ut.hasAnimation?this.driver.query(Je,".ng-star-inserted",!0).forEach(Yt=>me.add(Yt)):K.add(Je))}const Le=new Map,Ze=YC(P,Array.from(me));Ze.forEach((He,Je)=>{const ut=Lv+Z++;Le.set(Je,ut),He.forEach(Yt=>Cs(Yt,ut))}),e.push(()=>{B.forEach((He,Je)=>{const ut=z.get(Je);He.forEach(Yt=>Ph(Yt,ut))}),Ze.forEach((He,Je)=>{const ut=Le.get(Je);He.forEach(Yt=>Ph(Yt,ut))}),re.forEach(He=>{this.processLeaveNode(He)})});const Ft=[],Nn=[];for(let He=this._namespaceList.length-1;He>=0;He--)this._namespaceList[He].drainQueuedTransitions(i).forEach(ut=>{const Yt=ut.player,Ai=ut.element;if(Ft.push(Yt),this.collectedEnterElements.length){const ur=Ai[Ts];if(ur&&ur.setForMove){if(ur.previousTriggersValues&&ur.previousTriggersValues.has(ut.triggerName)){const qu=ur.previousTriggersValues.get(ut.triggerName),nc=this.statesByElement.get(ut.element);nc&&nc[ut.triggerName]&&(nc[ut.triggerName].value=qu)}return void Yt.destroy()}}const Wo=!D||!this.driver.containsElement(D,Ai),es=Le.get(Ai),tc=z.get(Ai),$n=this._buildInstruction(ut,r,tc,es,Wo);if($n.errors&&$n.errors.length)return void Nn.push($n);if(Wo)return Yt.onStart(()=>Hu(Ai,$n.fromStyles)),Yt.onDestroy(()=>Vo(Ai,$n.toStyles)),void o.push(Yt);if(ut.isFallbackTransition)return Yt.onStart(()=>Hu(Ai,$n.fromStyles)),Yt.onDestroy(()=>Vo(Ai,$n.toStyles)),void o.push(Yt);const ZA=[];$n.timelines.forEach(ur=>{ur.stretchStartingKeyframe=!0,this.disabledNodes.has(ur.element)||ZA.push(ur)}),$n.timelines=ZA,r.append(Ai,$n.timelines),d.push({instruction:$n,player:Yt,element:Ai}),$n.queriedElements.forEach(ur=>Xr(p,ur,[]).push(Yt)),$n.preStyleProps.forEach((ur,qu)=>{const nc=Object.keys(ur);if(nc.length){let Xu=g.get(qu);Xu||g.set(qu,Xu=new Set),nc.forEach(iE=>Xu.add(iE))}}),$n.postStyleProps.forEach((ur,qu)=>{const nc=Object.keys(ur);let Xu=x.get(qu);Xu||x.set(qu,Xu=new Set),nc.forEach(iE=>Xu.add(iE))})});if(Nn.length){const He=[];Nn.forEach(Je=>{He.push(function RF(t,e){return new Be(3505,Vt)}())}),Ft.forEach(Je=>Je.destroy()),this.reportError(He)}const jn=new Map,Qr=new Map;d.forEach(He=>{const Je=He.element;r.has(Je)&&(Qr.set(Je,Je),this._beforeAnimationBuild(He.player.namespaceId,He.instruction,jn))}),o.forEach(He=>{const Je=He.element;this._getPreviousPlayers(Je,!1,He.namespaceId,He.triggerName,null).forEach(Yt=>{Xr(jn,Je,[]).push(Yt),Yt.destroy()})});const Kr=re.filter(He=>KC(He,g,x)),Jr=new Map;ZC(Jr,this.driver,K,x,Pa).forEach(He=>{KC(He,g,x)&&Kr.push(He)});const Na=new Map;B.forEach((He,Je)=>{ZC(Na,this.driver,new Set(He),g,"!")}),Kr.forEach(He=>{const Je=Jr.get(He),ut=Na.get(He);Jr.set(He,Object.assign(Object.assign({},Je),ut))});const ao=[],zh=[],Gh={};d.forEach(He=>{const{element:Je,player:ut,instruction:Yt}=He;if(r.has(Je)){if(T.has(Je))return ut.onDestroy(()=>Vo(Je,Yt.toStyles)),ut.disabled=!0,ut.overrideTotalTime(Yt.totalTime),void o.push(ut);let Ai=Gh;if(Qr.size>1){let es=Je;const tc=[];for(;es=es.parentNode;){const $n=Qr.get(es);if($n){Ai=$n;break}tc.push(es)}tc.forEach($n=>Qr.set($n,Ai))}const Wo=this._buildAnimation(ut.namespaceId,Yt,jn,l,Na,Jr);if(ut.setRealPlayer(Wo),Ai===Gh)ao.push(ut);else{const es=this.playersByElement.get(Ai);es&&es.length&&(ut.parentPlayer=Ql(es)),o.push(ut)}}else Hu(Je,Yt.fromStyles),ut.onDestroy(()=>Vo(Je,Yt.toStyles)),zh.push(ut),T.has(Je)&&o.push(ut)}),zh.forEach(He=>{const Je=l.get(He.element);if(Je&&Je.length){const ut=Ql(Je);He.setRealPlayer(ut)}}),o.forEach(He=>{He.parentPlayer?He.syncPlayerEvents(He.parentPlayer):He.destroy()});for(let He=0;He<re.length;He++){const Je=re[He],ut=Je[Ts];if(Ph(Je,Lv),ut&&ut.hasAnimation)continue;let Yt=[];if(p.size){let Wo=p.get(Je);Wo&&Wo.length&&Yt.push(...Wo);let es=this.driver.query(Je,tM,!0);for(let tc=0;tc<es.length;tc++){let $n=p.get(es[tc]);$n&&$n.length&&Yt.push(...$n)}}const Ai=Yt.filter(Wo=>!Wo.destroyed);Ai.length?RN(this,Je,Ai):this.processLeaveNode(Je)}return re.length=0,ao.forEach(He=>{this.players.push(He),He.onDone(()=>{He.destroy();const Je=this.players.indexOf(He);this.players.splice(Je,1)}),He.play()}),ao}elementContainsData(e,i){let r=!1;const o=i[Ts];return o&&o.setForRemoval&&(r=!0),this.playersByElement.has(i)&&(r=!0),this.playersByQueriedElement.has(i)&&(r=!0),this.statesByElement.has(i)&&(r=!0),this._fetchNamespace(e).elementContainsData(i)||r}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,i,r,o,l){let d=[];if(i){const p=this.playersByQueriedElement.get(e);p&&(d=p)}else{const p=this.playersByElement.get(e);if(p){const g=!l||l==am;p.forEach(x=>{x.queued||!g&&x.triggerName!=o||d.push(x)})}}return(r||o)&&(d=d.filter(p=>!(r&&r!=p.namespaceId||o&&o!=p.triggerName))),d}_beforeAnimationBuild(e,i,r){const l=i.element,d=i.isRemovalTransition?void 0:e,p=i.isRemovalTransition?void 0:i.triggerName;for(const g of i.timelines){const x=g.element,T=x!==l,D=Xr(r,x,[]);this._getPreviousPlayers(x,T,d,p,i.toState).forEach(B=>{const z=B.getRealPlayer();z.beforeDestroy&&z.beforeDestroy(),B.destroy(),D.push(B)})}Hu(l,i.fromStyles)}_buildAnimation(e,i,r,o,l,d){const p=i.triggerName,g=i.element,x=[],T=new Set,D=new Set,P=i.timelines.map(z=>{const Z=z.element;T.add(Z);const re=Z[Ts];if(re&&re.removedBeforeQueried)return new sm(z.duration,z.delay);const me=Z!==g,K=function IN(t){const e=[];return QC(t,e),e}((r.get(Z)||MN).map(jn=>jn.getRealPlayer())).filter(jn=>!!jn.element&&jn.element===Z),Le=l.get(Z),Ze=d.get(Z),Ft=MC(0,this._normalizer,0,z.keyframes,Le,Ze),Nn=this._buildPlayer(z,Ft,K);if(z.subTimeline&&o&&D.add(Z),me){const jn=new mM(e,p,Z);jn.setRealPlayer(Nn),x.push(jn)}return Nn});x.forEach(z=>{Xr(this.playersByQueriedElement,z.element,[]).push(z),z.onDone(()=>function CN(t,e,i){let r;if(t instanceof Map){if(r=t.get(e),r){if(r.length){const o=r.indexOf(i);r.splice(o,1)}0==r.length&&t.delete(e)}}else if(r=t[e],r){if(r.length){const o=r.indexOf(i);r.splice(o,1)}0==r.length&&delete t[e]}return r}(this.playersByQueriedElement,z.element,z))}),T.forEach(z=>Cs(z,LC));const B=Ql(P);return B.onDestroy(()=>{T.forEach(z=>Ph(z,LC)),Vo(g,i.toStyles)}),D.forEach(z=>{Xr(o,z,[]).push(B)}),B}_buildPlayer(e,i,r){return i.length>0?this.driver.animate(e.element,i,e.duration,e.delay,e.easing,r):new sm(e.duration,e.delay)}}class mM{constructor(e,i,r){this.namespaceId=e,this.triggerName=i,this.element=r,this._player=new sm,this._containsRealPlayer=!1,this._queuedCallbacks={},this.destroyed=!1,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,Object.keys(this._queuedCallbacks).forEach(i=>{this._queuedCallbacks[i].forEach(r=>Xb(e,i,void 0,r))}),this._queuedCallbacks={},this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){const i=this._player;i.triggerCallback&&e.onStart(()=>i.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,i){Xr(this._queuedCallbacks,e,[]).push(i)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return!this.queued&&this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){const i=this._player;i.triggerCallback&&i.triggerCallback(e)}}function Xv(t){return t&&1===t.nodeType}function XC(t,e){const i=t.style.display;return t.style.display=null!=e?e:"none",i}function ZC(t,e,i,r,o){const l=[];i.forEach(g=>l.push(XC(g)));const d=[];r.forEach((g,x)=>{const T={};g.forEach(D=>{const P=T[D]=e.computeStyle(x,D,o);(!P||0==P.length)&&(x[Ts]=EN,d.push(x))}),t.set(x,T)});let p=0;return i.forEach(g=>XC(g,l[p++])),d}function YC(t,e){const i=new Map;if(t.forEach(p=>i.set(p,[])),0==e.length)return i;const o=new Set(e),l=new Map;function d(p){if(!p)return 1;let g=l.get(p);if(g)return g;const x=p.parentNode;return g=i.has(x)?x:o.has(x)?1:d(x),l.set(p,g),g}return e.forEach(p=>{const g=d(p);1!==g&&i.get(g).push(p)}),i}function Cs(t,e){var i;null===(i=t.classList)||void 0===i||i.add(e)}function Ph(t,e){var i;null===(i=t.classList)||void 0===i||i.remove(e)}function RN(t,e,i){Ql(i).onDone(()=>t.processLeaveNode(e))}function QC(t,e){for(let i=0;i<t.length;i++){const r=t[i];r instanceof wC?QC(r.players,e):e.push(r)}}function KC(t,e,i){const r=i.get(t);if(!r)return!1;let o=e.get(t);return o?r.forEach(l=>o.add(l)):e.set(t,r),i.delete(t),!0}class Zv{constructor(e,i,r){this.bodyNode=e,this._driver=i,this._normalizer=r,this._triggerCache={},this.onRemovalComplete=(o,l)=>{},this._transitionEngine=new TN(e,i,r),this._timelineEngine=new vN(e,i,r),this._transitionEngine.onRemovalComplete=(o,l)=>this.onRemovalComplete(o,l)}registerTrigger(e,i,r,o,l){const d=e+"-"+o;let p=this._triggerCache[d];if(!p){const g=[],T=sM(this._driver,l,g,[]);if(g.length)throw function _F(t,e){return new Be(3404,Vt)}();p=function pN(t,e,i){return new mN(t,e,i)}(o,T,this._normalizer),this._triggerCache[d]=p}this._transitionEngine.registerTrigger(i,o,p)}register(e,i){this._transitionEngine.register(e,i)}destroy(e,i){this._transitionEngine.destroy(e,i)}onInsert(e,i,r,o){this._transitionEngine.insertNode(e,i,r,o)}onRemove(e,i,r,o){this._transitionEngine.removeNode(e,i,o||!1,r)}disableAnimations(e,i){this._transitionEngine.markElementAsDisabled(e,i)}process(e,i,r,o){if("@"==r.charAt(0)){const[l,d]=EC(r);this._timelineEngine.command(l,i,d,o)}else this._transitionEngine.trigger(e,i,r,o)}listen(e,i,r,o,l){if("@"==r.charAt(0)){const[d,p]=EC(r);return this._timelineEngine.listen(d,i,p,l)}return this._transitionEngine.listen(e,i,r,o,l)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return this._transitionEngine.players.concat(this._timelineEngine.players)}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}}let FN=(()=>{class t{constructor(i,r,o){this._element=i,this._startStyles=r,this._endStyles=o,this._state=0;let l=t.initialStylesByElement.get(i);l||t.initialStylesByElement.set(i,l={}),this._initialStyles=l}start(){this._state<1&&(this._startStyles&&Vo(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Vo(this._element,this._initialStyles),this._endStyles&&(Vo(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(t.initialStylesByElement.delete(this._element),this._startStyles&&(Hu(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(Hu(this._element,this._endStyles),this._endStyles=null),Vo(this._element,this._initialStyles),this._state=3)}}return t.initialStylesByElement=new WeakMap,t})();function gM(t){let e=null;const i=Object.keys(t);for(let r=0;r<i.length;r++){const o=i[r];NN(o)&&(e=e||{},e[o]=t[o])}return e}function NN(t){return"display"===t||"position"===t}class JC{constructor(e,i,r,o){this.element=e,this.keyframes=i,this.options=r,this._specialStyles=o,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this.time=0,this.parentPlayer=null,this.currentSnapshot={},this._duration=r.duration,this._delay=r.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;const e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:{},this.domPlayer.addEventListener("finish",()=>this._onFinish())}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_triggerWebAnimation(e,i,r){return e.animate(i,r)}onStart(e){this._onStartFns.push(e)}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){void 0===this.domPlayer&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return this.domPlayer.currentTime/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){const e={};if(this.hasStarted()){const i=this._finalKeyframe;Object.keys(i).forEach(r=>{"offset"!=r&&(e[r]=this._finished?i[r]:BC(this.element,r))})}this.currentSnapshot=e}triggerCallback(e){const i="start"==e?this._onStartFns:this._onDoneFns;i.forEach(r=>r()),i.length=0}}class ON{validateStyleProperty(e){return DC(e)}matchesElement(e,i){return!1}containsElement(e,i){return AC(e,i)}getParentElement(e){return Kb(e)}query(e,i,r){return RC(e,i,r)}computeStyle(e,i,r){return window.getComputedStyle(e)[i]}animate(e,i,r,o,l,d=[]){const g={duration:r,delay:o,fill:0==o?"both":"forwards"};l&&(g.easing=l);const x={},T=d.filter(P=>P instanceof JC);(function HF(t,e){return 0===t||0===e})(r,o)&&T.forEach(P=>{let B=P.currentSnapshot;Object.keys(B).forEach(z=>x[z]=B[z])}),i=function VF(t,e,i){const r=Object.keys(i);if(r.length&&e.length){let l=e[0],d=[];if(r.forEach(p=>{l.hasOwnProperty(p)||d.push(p),l[p]=i[p]}),d.length)for(var o=1;o<e.length;o++){let p=e[o];d.forEach(function(g){p[g]=BC(t,g)})}}return e}(e,i=i.map(P=>Kl(P,!1)),x);const D=function LN(t,e){let i=null,r=null;return Array.isArray(e)&&e.length?(i=gM(e[0]),e.length>1&&(r=gM(e[e.length-1]))):e&&(i=gM(e)),i||r?new FN(t,i,r):null}(e,i);return new JC(e,i,g,D)}}let kN=(()=>{class t extends yC{constructor(i,r){super(),this._nextAnimationId=0,this._renderer=i.createRenderer(r.body,{id:"0",encapsulation:os.None,styles:[],data:{animation:[]}})}build(i){const r=this._nextAnimationId.toString();this._nextAnimationId++;const o=Array.isArray(i)?vC(i):i;return eD(this._renderer,null,r,"register",[o]),new BN(r,this._renderer)}}return t.\u0275fac=function(i){return new(i||t)(Ee(Xp),Ee(Zi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class BN extends class QL{}{constructor(e,i){super(),this._id=e,this._renderer=i}create(e,i){return new UN(this._id,e,i||{},this._renderer)}}class UN{constructor(e,i,r,o){this.id=e,this.element=i,this._renderer=o,this.parentPlayer=null,this._started=!1,this.totalTime=0,this._command("create",r)}_listen(e,i){return this._renderer.listen(this.element,`@@${this.id}:${e}`,i)}_command(e,...i){return eD(this._renderer,this.element,this.id,e,i)}onDone(e){this._listen("done",e)}onStart(e){this._listen("start",e)}onDestroy(e){this._listen("destroy",e)}init(){this._command("init")}hasStarted(){return this._started}play(){this._command("play"),this._started=!0}pause(){this._command("pause")}restart(){this._command("restart")}finish(){this._command("finish")}destroy(){this._command("destroy")}reset(){this._command("reset"),this._started=!1}setPosition(e){this._command("setPosition",e)}getPosition(){var e,i;return null!==(i=null===(e=this._renderer.engine.players[+this.id])||void 0===e?void 0:e.getPosition())&&void 0!==i?i:0}}function eD(t,e,i,r,o){return t.setProperty(e,`@@${i}:${r}`,o)}const tD="@.disabled";let HN=(()=>{class t{constructor(i,r,o){this.delegate=i,this.engine=r,this._zone=o,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,this.promise=Promise.resolve(0),r.onRemovalComplete=(l,d)=>{const p=null==d?void 0:d.parentNode(l);p&&d.removeChild(p,l)}}createRenderer(i,r){const l=this.delegate.createRenderer(i,r);if(!(i&&r&&r.data&&r.data.animation)){let T=this._rendererCache.get(l);return T||(T=new nD("",l,this.engine),this._rendererCache.set(l,T)),T}const d=r.id,p=r.id+"-"+this._currentId;this._currentId++,this.engine.register(p,i);const g=T=>{Array.isArray(T)?T.forEach(g):this.engine.registerTrigger(d,p,i,T.name,T)};return r.data.animation.forEach(g),new VN(this,p,l,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){this.promise.then(()=>{this._microtaskId++})}scheduleListenerCallback(i,r,o){i>=0&&i<this._microtaskId?this._zone.run(()=>r(o)):(0==this._animationCallbacksBuffer.length&&Promise.resolve(null).then(()=>{this._zone.run(()=>{this._animationCallbacksBuffer.forEach(l=>{const[d,p]=l;d(p)}),this._animationCallbacksBuffer=[]})}),this._animationCallbacksBuffer.push([r,o]))}end(){this._cdRecurDepth--,0==this._cdRecurDepth&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}}return t.\u0275fac=function(i){return new(i||t)(Ee(Xp),Ee(Zv),Ee(yi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();class nD{constructor(e,i,r){this.namespaceId=e,this.delegate=i,this.engine=r,this.destroyNode=this.delegate.destroyNode?o=>i.destroyNode(o):null}get data(){return this.delegate.data}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.delegate.destroy()}createElement(e,i){return this.delegate.createElement(e,i)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,i){this.delegate.appendChild(e,i),this.engine.onInsert(this.namespaceId,i,e,!1)}insertBefore(e,i,r,o=!0){this.delegate.insertBefore(e,i,r),this.engine.onInsert(this.namespaceId,i,e,o)}removeChild(e,i,r){this.engine.onRemove(this.namespaceId,i,this.delegate,r)}selectRootElement(e,i){return this.delegate.selectRootElement(e,i)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,i,r,o){this.delegate.setAttribute(e,i,r,o)}removeAttribute(e,i,r){this.delegate.removeAttribute(e,i,r)}addClass(e,i){this.delegate.addClass(e,i)}removeClass(e,i){this.delegate.removeClass(e,i)}setStyle(e,i,r,o){this.delegate.setStyle(e,i,r,o)}removeStyle(e,i,r){this.delegate.removeStyle(e,i,r)}setProperty(e,i,r){"@"==i.charAt(0)&&i==tD?this.disableAnimations(e,!!r):this.delegate.setProperty(e,i,r)}setValue(e,i){this.delegate.setValue(e,i)}listen(e,i,r){return this.delegate.listen(e,i,r)}disableAnimations(e,i){this.engine.disableAnimations(e,i)}}class VN extends nD{constructor(e,i,r,o){super(i,r,o),this.factory=e,this.namespaceId=i}setProperty(e,i,r){"@"==i.charAt(0)?"."==i.charAt(1)&&i==tD?this.disableAnimations(e,r=void 0===r||!!r):this.engine.process(this.namespaceId,e,i.substr(1),r):this.delegate.setProperty(e,i,r)}listen(e,i,r){if("@"==i.charAt(0)){const o=function zN(t){switch(t){case"body":return document.body;case"document":return document;case"window":return window;default:return t}}(e);let l=i.substr(1),d="";return"@"!=l.charAt(0)&&([l,d]=function GN(t){const e=t.indexOf(".");return[t.substring(0,e),t.substr(e+1)]}(l)),this.engine.listen(this.namespaceId,o,l,d,p=>{this.factory.scheduleListenerCallback(p._data||-1,r,p)})}return this.delegate.listen(e,i,r)}}let WN=(()=>{class t extends Zv{constructor(i,r,o){super(i.body,r,o)}ngOnDestroy(){this.flush()}}return t.\u0275fac=function(i){return new(i||t)(Ee(Zi),Ee(Jb),Ee(uM))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const iD=new ze("AnimationModuleType"),rD=[{provide:yC,useClass:kN},{provide:uM,useFactory:function jN(){return new cN}},{provide:Zv,useClass:WN},{provide:Xp,useFactory:function $N(t,e,i){return new HN(t,e,i)},deps:[Iv,Zv,yi]}],sD=[{provide:Jb,useFactory:()=>new ON},{provide:iD,useValue:"BrowserAnimations"},...rD],qN=[{provide:Jb,useClass:IC},{provide:iD,useValue:"NoopAnimations"},...rD];let XN=(()=>{class t{static withConfig(i){return{ngModule:t,providers:i.disableAnimations?qN:sD}}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({providers:sD,imports:[fC]}),t})();class Sr extends Ri{constructor(e){super(),this._value=e}get value(){return this.getValue()}_subscribe(e){const i=super._subscribe(e);return!i.closed&&e.next(this._value),i}getValue(){const{hasError:e,thrownError:i,_value:r}=this;if(e)throw i;return this._throwIfClosed(),r}next(e){super.next(this._value=e)}}class ZN extends ci{constructor(e,i){super()}schedule(e,i=0){return this}}const Qv={setInterval(t,e,...i){const{delegate:r}=Qv;return(null==r?void 0:r.setInterval)?r.setInterval(t,e,...i):setInterval(t,e,...i)},clearInterval(t){const{delegate:e}=Qv;return((null==e?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0};class YN extends ZN{constructor(e,i){super(e,i),this.scheduler=e,this.work=i,this.pending=!1}schedule(e,i=0){if(this.closed)return this;this.state=e;const r=this.id,o=this.scheduler;return null!=r&&(this.id=this.recycleAsyncId(o,r,i)),this.pending=!0,this.delay=i,this.id=this.id||this.requestAsyncId(o,this.id,i),this}requestAsyncId(e,i,r=0){return Qv.setInterval(e.flush.bind(e,this),r)}recycleAsyncId(e,i,r=0){if(null!=r&&this.delay===r&&!1===this.pending)return i;Qv.clearInterval(i)}execute(e,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;const r=this._execute(e,i);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))}_execute(e,i){let o,r=!1;try{this.work(e)}catch(l){r=!0,o=l||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),o}unsubscribe(){if(!this.closed){const{id:e,scheduler:i}=this,{actions:r}=i;this.work=this.state=this.scheduler=null,this.pending=!1,Cr(r,this),null!=e&&(this.id=this.recycleAsyncId(i,e,null)),this.delay=null,super.unsubscribe()}}}const oD={now:()=>(oD.delegate||Date).now(),delegate:void 0};class lm{constructor(e,i=lm.now){this.schedulerActionCtor=e,this.now=i}schedule(e,i=0,r){return new this.schedulerActionCtor(this,e).schedule(r,i)}}lm.now=oD.now;class KN extends lm{constructor(e,i=lm.now){super(e,i),this.actions=[],this._active=!1,this._scheduled=void 0}flush(e){const{actions:i}=this;if(this._active)return void i.push(e);let r;this._active=!0;do{if(r=e.execute(e.state,e.delay))break}while(e=i.shift());if(this._active=!1,r){for(;e=i.shift();)e.unsubscribe();throw r}}}const eO=new class JN extends KN{}(class QN extends YN{constructor(e,i){super(e,i),this.scheduler=e,this.work=i}schedule(e,i=0){return i>0?super.schedule(e,i):(this.delay=i,this.state=e,this.scheduler.flush(this),this)}execute(e,i){return i>0||this.closed?super.execute(e,i):this._execute(e,i)}requestAsyncId(e,i,r=0){return null!=r&&r>0||null==r&&this.delay>0?super.requestAsyncId(e,i,r):e.flush(this)}});function nO(t,e,i,r,o){return(l,d)=>{let p=i,g=e,x=0;l.subscribe(In(d,T=>{const D=x++;g=p?t(g,T,D):(p=!0,T),r&&d.next(g)},o&&(()=>{p&&d.next(g),d.complete()})))}}function yM(t,e){return On(nO(t,e,arguments.length>=2,!0))}function sO(t,e){return t===e}const cm={},aD="@ngrx/store/init";let Lh=(()=>{class t extends Sr{constructor(){super({type:aD})}next(i){if("function"==typeof i)throw new TypeError("\n        Dispatch expected an object, instead it received a function.\n        If you're using the createAction function, make sure to invoke the function\n        before dispatching the action. For example, someAction should be someAction().");if(void 0===i)throw new TypeError("Actions must be objects");if(void 0===i.type)throw new TypeError("Actions must have a type property");super.next(i)}complete(){}ngOnDestroy(){super.complete()}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const oO=[Lh],lD=new ze("@ngrx/store Internal Root Guard"),cD=new ze("@ngrx/store Internal Initial State"),_M=new ze("@ngrx/store Initial State"),uD=new ze("@ngrx/store Reducer Factory"),dD=new ze("@ngrx/store Internal Reducer Factory Provider"),hD=new ze("@ngrx/store Initial Reducers"),xM=new ze("@ngrx/store Internal Initial Reducers"),fD=new ze("@ngrx/store Store Features"),pD=new ze("@ngrx/store Internal Store Reducers"),wM=new ze("@ngrx/store Internal Feature Reducers"),mD=new ze("@ngrx/store Internal Feature Configs"),gD=new ze("@ngrx/store Internal Store Features"),yD=new ze("@ngrx/store Internal Feature Reducers Token"),vD=new ze("@ngrx/store Feature Reducers"),_D=new ze("@ngrx/store User Provided Meta Reducers"),Kv=new ze("@ngrx/store Meta Reducers"),xD=new ze("@ngrx/store Internal Resolved Meta Reducers"),wD=new ze("@ngrx/store User Runtime Checks Config"),bD=new ze("@ngrx/store Internal User Runtime Checks Config"),um=new ze("@ngrx/store Internal Runtime Checks"),bM=new ze("@ngrx/store Check if Action types are unique");function MM(t,e={}){const i=Object.keys(t),r={};for(let l=0;l<i.length;l++){const d=i[l];"function"==typeof t[d]&&(r[d]=t[d])}const o=Object.keys(r);return function(d,p){d=void 0===d?e:d;let g=!1;const x={};for(let T=0;T<o.length;T++){const D=o[T],B=d[D],z=(0,r[D])(B,p);x[D]=z,g=g||z!==B}return g?x:d}}function MD(...t){return function(e){if(0===t.length)return e;const i=t[t.length-1];return t.slice(0,-1).reduceRight((o,l)=>l(o),i(e))}}function ED(t,e){return Array.isArray(e)&&e.length>0&&(t=MD.apply(null,[...e,t])),(i,r)=>{const o=t(i);return(l,d)=>o(l=void 0===l?r:l,d)}}class EM extends Oe{}class SD extends Lh{}let Jv=(()=>{class t extends Sr{constructor(i,r,o,l){super(l(o,r)),this.dispatcher=i,this.initialState=r,this.reducers=o,this.reducerFactory=l}get currentReducers(){return this.reducers}addFeature(i){this.addFeatures([i])}addFeatures(i){const r=i.reduce((o,{reducers:l,reducerFactory:d,metaReducers:p,initialState:g,key:x})=>{const T="function"==typeof l?function lO(t){const e=Array.isArray(t)&&t.length>0?MD(...t):i=>i;return(i,r)=>(i=e(i),(o,l)=>i(o=void 0===o?r:o,l))}(p)(l,g):ED(d,p)(l,g);return o[x]=T,o},{});this.addReducers(r)}removeFeature(i){this.removeFeatures([i])}removeFeatures(i){this.removeReducers(i.map(r=>r.key))}addReducer(i,r){this.addReducers({[i]:r})}addReducers(i){this.reducers=Object.assign(Object.assign({},this.reducers),i),this.updateReducers(Object.keys(i))}removeReducer(i){this.removeReducers([i])}removeReducers(i){i.forEach(r=>{this.reducers=function aO(t,e){return Object.keys(t).filter(i=>i!==e).reduce((i,r)=>Object.assign(i,{[r]:t[r]}),{})}(this.reducers,r)}),this.updateReducers(i)}updateReducers(i){this.next(this.reducerFactory(this.reducers,this.initialState)),this.dispatcher.next({type:"@ngrx/store/update-reducers",features:i})}ngOnDestroy(){this.complete()}}return t.\u0275fac=function(i){return new(i||t)(Ee(SD),Ee(_M),Ee(hD),Ee(uD))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const uO=[Jv,{provide:EM,useExisting:Jv},{provide:SD,useExisting:Lh}];let SM=(()=>{class t extends Ri{ngOnDestroy(){this.complete()}}return t.\u0275fac=function(){let e;return function(r){return(e||(e=function mg(t){return na(()=>{const e=t.prototype.constructor,i=e[tr]||bf(e),r=Object.prototype;let o=Object.getPrototypeOf(t.prototype).constructor;for(;o&&o!==r;){const l=o[tr]||bf(o);if(l&&l!==i)return l;o=Object.getPrototypeOf(o)}return l=>new l})}(t)))(r||t)}}(),t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const dO=[SM];class TD extends Oe{}let CD=(()=>{class t extends Sr{constructor(i,r,o,l){super(l);const p=i.pipe(ac(eO)).pipe(function tO(...t){const e=Dm(t);return On((i,r)=>{const o=t.length,l=new Array(o);let d=t.map(()=>!1),p=!1;for(let g=0;g<o;g++)Ji(t[g]).subscribe(In(r,x=>{l[g]=x,!p&&!d[g]&&(d[g]=!0,(p=d.every(Se))&&(d=null))},ts));i.subscribe(In(r,g=>{if(p){const x=[g,...l];r.next(e?e(...x):x)}}))})}(r)),x=p.pipe(yM(hO,{state:l}));this.stateSubscription=x.subscribe(({state:T,action:D})=>{this.next(T),o.next(D)})}ngOnDestroy(){this.stateSubscription.unsubscribe(),this.complete()}}return t.INIT=aD,t.\u0275fac=function(i){return new(i||t)(Ee(Lh),Ee(EM),Ee(SM),Ee(_M))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function hO(t={state:void 0},[e,i]){const{state:r}=t;return{state:i(r,e),action:e}}const fO=[CD,{provide:TD,useExisting:CD}];let TM=(()=>{class t extends Oe{constructor(i,r,o){super(),this.actionsObserver=r,this.reducerManager=o,this.source=i}select(i,...r){return mO.call(null,i,...r)(this)}lift(i){const r=new t(this,this.actionsObserver,this.reducerManager);return r.operator=i,r}dispatch(i){this.actionsObserver.next(i)}next(i){this.actionsObserver.next(i)}error(i){this.actionsObserver.error(i)}complete(){this.actionsObserver.complete()}addReducer(i,r){this.reducerManager.addReducer(i,r)}removeReducer(i){this.reducerManager.removeReducer(i)}}return t.\u0275fac=function(i){return new(i||t)(Ee(TD),Ee(Lh),Ee(Jv))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const pO=[TM];function mO(t,e,...i){return function(o){let l;if("string"==typeof t){const d=[e,...i].filter(Boolean);l=o.pipe(function iO(...t){const e=t.length;if(0===e)throw new Error("list of properties cannot be empty.");return nn(i=>{let r=i;for(let o=0;o<e;o++){const l=null==r?void 0:r[t[o]];if(void 0===l)return;r=l}return r})}(t,...d))}else{if("function"!=typeof t)throw new TypeError(`Unexpected type '${typeof t}' in select operator, expected 'string' or 'function'`);l=o.pipe(nn(d=>t(d,e)))}return l.pipe(function rO(t,e=Se){return t=null!=t?t:sO,On((i,r)=>{let o,l=!0;i.subscribe(In(r,d=>{const p=e(d);(l||!t(o,p))&&(l=!1,o=p,r.next(d))}))})}())}}const CM="https://ngrx.io/guide/store/configuration/runtime-checks";function AD(t){return void 0===t}function RD(t){return null===t}function ID(t){return Array.isArray(t)}function PD(t){return"object"==typeof t&&null!==t}function DM(t){return"function"==typeof t}function IM(t){Object.freeze(t);const e=DM(t);return Object.getOwnPropertyNames(t).forEach(i=>{if(!i.startsWith("\u0275")&&function wO(t,e){return Object.prototype.hasOwnProperty.call(t,e)}(t,i)&&(!e||"caller"!==i&&"callee"!==i&&"arguments"!==i)){const r=t[i];(PD(r)||DM(r))&&!Object.isFrozen(r)&&IM(r)}}),t}function PM(t,e=[]){return(AD(t)||RD(t))&&0===e.length?{path:["root"],value:t}:Object.keys(t).reduce((r,o)=>{if(r)return r;const l=t[o];return function xO(t){return DM(t)&&t.hasOwnProperty("\u0275cmp")}(l)?r:!(AD(l)||RD(l)||function vO(t){return"number"==typeof t}(l)||function yO(t){return"boolean"==typeof t}(l)||function gO(t){return"string"==typeof t}(l)||ID(l))&&(function LD(t){if(!function _O(t){return PD(t)&&!ID(t)}(t))return!1;const e=Object.getPrototypeOf(t);return e===Object.prototype||null===e}(l)?PM(l,[...e,o]):{path:[...e,o],value:l})},!1)}function OD(t,e){if(!1===t)return;const i=t.path.join("."),r=new Error(`Detected unserializable ${e} at "${i}". ${CM}#strict${e}serializability`);throw r.value=t.value,r.unserializablePath=i,r}function PO(t){return function wI(){return CT=!0,TT}()?Object.assign({strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!0,strictActionImmutability:!0,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1},t):{strictStateSerializability:!1,strictActionSerializability:!1,strictStateImmutability:!1,strictActionImmutability:!1,strictActionWithinNgZone:!1,strictActionTypeUniqueness:!1}}function LO({strictActionSerializability:t,strictStateSerializability:e}){return i=>t||e?function RO(t,e){return function(i,r){e.action(r)&&OD(PM(r),"action");const o=t(i,r);return e.state()&&OD(PM(o),"state"),o}}(i,{action:r=>t&&!LM(r),state:()=>e}):i}function FO({strictActionImmutability:t,strictStateImmutability:e}){return i=>t||e?function AO(t,e){return function(i,r){const o=e.action(r)?IM(r):r,l=t(i,o);return e.state()?IM(l):l}}(i,{action:r=>t&&!LM(r),state:()=>e}):i}function LM(t){return t.type.startsWith("@ngrx")}function NO({strictActionWithinNgZone:t}){return e=>t?function IO(t,e){return function(i,r){if(e.action(r)&&!yi.isInAngularZone())throw new Error(`Action '${r.type}' running outside NgZone. ${CM}#strictactionwithinngzone`);return t(i,r)}}(e,{action:i=>t&&!LM(i)}):e}function OO(t){return[{provide:bD,useValue:t},{provide:wD,useFactory:kO,deps:[bD]},{provide:um,deps:[wD],useFactory:PO},{provide:Kv,multi:!0,deps:[um],useFactory:FO},{provide:Kv,multi:!0,deps:[um],useFactory:LO},{provide:Kv,multi:!0,deps:[um],useFactory:NO}]}function kD(){return[{provide:bM,multi:!0,deps:[um],useFactory:BO}]}function kO(t){return t}function BO(t){if(!t.strictActionTypeUniqueness)return;const e=Object.entries(cm).filter(([,i])=>i>1).map(([i])=>i);if(e.length)throw new Error(`Action types are registered more than once, ${e.map(i=>`"${i}"`).join(", ")}. ${CM}#strictactiontypeuniqueness`)}let BD=(()=>{class t{constructor(i,r,o,l,d,p){}}return t.\u0275fac=function(i){return new(i||t)(Ee(Lh),Ee(EM),Ee(SM),Ee(TM),Ee(lD,8),Ee(bM,8))},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({}),t})(),UO=(()=>{class t{constructor(i,r,o,l,d){this.features=i,this.featureReducers=r,this.reducerManager=o;const p=i.map((g,x)=>{const D=r.shift()[x];return Object.assign(Object.assign({},g),{reducers:D,initialState:UD(g.initialState)})});o.addFeatures(p)}ngOnDestroy(){this.reducerManager.removeFeatures(this.features)}}return t.\u0275fac=function(i){return new(i||t)(Ee(gD),Ee(vD),Ee(Jv),Ee(BD),Ee(bM,8))},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({}),t})(),HO=(()=>{class t{static forRoot(i,r={}){return{ngModule:BD,providers:[{provide:lD,useFactory:jO,deps:[[TM,new Eo,new Oc]]},{provide:cD,useValue:r.initialState},{provide:_M,useFactory:UD,deps:[cD]},{provide:xM,useValue:i},{provide:pD,useExisting:i instanceof ze?i:xM},{provide:hD,deps:[mi,xM,[new Nc(pD)]],useFactory:VO},{provide:_D,useValue:r.metaReducers?r.metaReducers:[]},{provide:xD,deps:[Kv,_D],useFactory:WO},{provide:dD,useValue:r.reducerFactory?r.reducerFactory:MM},{provide:uD,deps:[dD,xD],useFactory:ED},oO,uO,dO,fO,pO,OO(r.runtimeChecks),kD()]}}static forFeature(i,r,o={}){return{ngModule:UO,providers:[{provide:mD,multi:!0,useValue:i instanceof Object?{}:o},{provide:fD,multi:!0,useValue:{key:i instanceof Object?i.name:i,reducerFactory:o instanceof ze||!o.reducerFactory?MM:o.reducerFactory,metaReducers:o instanceof ze||!o.metaReducers?[]:o.metaReducers,initialState:o instanceof ze||!o.initialState?void 0:o.initialState}},{provide:gD,deps:[mi,mD,fD],useFactory:zO},{provide:wM,multi:!0,useValue:i instanceof Object?i.reducer:r},{provide:yD,multi:!0,useExisting:r instanceof ze?r:wM},{provide:vD,multi:!0,deps:[mi,wM,[new Nc(yD)]],useFactory:GO},kD()]}}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({}),t})();function VO(t,e){return e instanceof ze?t.get(e):e}function zO(t,e,i){return i.map((r,o)=>{if(e[o]instanceof ze){const l=t.get(e[o]);return{key:r.key,reducerFactory:l.reducerFactory?l.reducerFactory:MM,metaReducers:l.metaReducers?l.metaReducers:[],initialState:l.initialState}}return r})}function GO(t,e){return e.map(r=>r instanceof ze?t.get(r):r)}function UD(t){return"function"==typeof t?t():t}function WO(t,e){return t.concat(e)}function jO(t){if(t)throw new TypeError("StoreModule.forRoot() called twice. Feature modules should use StoreModule.forFeature() instead.");return"guarded"}function Dt(...t){return di(t,ta(t))}const{isArray:$O}=Array,{getPrototypeOf:qO,prototype:XO,keys:ZO}=Object;const{isArray:KO}=Array;function n2(...t){const e=ta(t),i=Dm(t),{args:r,keys:o}=function YO(t){if(1===t.length){const e=t[0];if($O(e))return{args:e,keys:null};if(function QO(t){return t&&"object"==typeof t&&qO(t)===XO}(e)){const i=ZO(e);return{args:i.map(r=>e[r]),keys:i}}}return{args:t,keys:null}}(t);if(0===r.length)return di([],e);const l=new Oe(function i2(t,e,i=Se){return r=>{HD(e,()=>{const{length:o}=t,l=new Array(o);let d=o,p=o;for(let g=0;g<o;g++)HD(e,()=>{const x=di(t[g],e);let T=!1;x.subscribe(In(r,D=>{l[g]=D,T||(T=!0,p--),p||r.next(i(l.slice()))},()=>{--d||r.complete()}))},r)},r)}}(r,e,o?d=>function t2(t,e){return t.reduce((i,r,o)=>(i[r]=e[o],i),{})}(o,d):Se));return i?l.pipe(function e2(t){return nn(e=>function JO(t,e){return KO(e)?t(...e):t(e)}(t,e))}(i)):l}function HD(t,e,i){t?Xn(i,t,e):e()}function e_(t,e){const i=it(t)?t:()=>t,r=o=>o.error(i());return new Oe(e?o=>e.schedule(r,0,o):r)}const t_=As(t=>function(){t(this),this.name="EmptyError",this.message="no elements in sequence"});function FM(...t){return function r2(){return Ir(1)}()(di(t,ta(t)))}function VD(t){return new Oe(e=>{Ji(t()).subscribe(e)})}function zD(){return On((t,e)=>{let i=null;t._refCount++;const r=In(e,void 0,void 0,void 0,()=>{if(!t||t._refCount<=0||0<--t._refCount)return void(i=null);const o=t._connection,l=i;i=null,o&&(!l||o===l)&&o.unsubscribe(),e.unsubscribe()});t.subscribe(r),r.closed||(i=t.connect())})}class s2 extends Oe{constructor(e,i){super(),this.source=e,this.subjectFactory=i,this._subject=null,this._refCount=0,this._connection=null,Ua(e)&&(this.lift=e.lift)}_subscribe(e){return this.getSubject().subscribe(e)}getSubject(){const e=this._subject;return(!e||e.isStopped)&&(this._subject=this.subjectFactory()),this._subject}_teardown(){this._refCount=0;const{_connection:e}=this;this._subject=this._connection=null,null==e||e.unsubscribe()}connect(){let e=this._connection;if(!e){e=this._connection=new ci;const i=this.getSubject();e.add(this.source.subscribe(In(i,void 0,()=>{this._teardown(),i.complete()},r=>{this._teardown(),i.error(r)},()=>this._teardown()))),e.closed&&(this._connection=null,e=ci.EMPTY)}return e}refCount(){return zD()(this)}}function zu(t,e){return On((i,r)=>{let o=null,l=0,d=!1;const p=()=>d&&!o&&r.complete();i.subscribe(In(r,g=>{null==o||o.unsubscribe();let x=0;const T=l++;Ji(t(g,T)).subscribe(o=In(r,D=>r.next(e?e(g,D,T,x++):D),()=>{o=null,p()}))},()=>{d=!0,p()}))})}function Fh(t,e){return On((i,r)=>{let o=0;i.subscribe(In(r,l=>t.call(e,l,o++)&&r.next(l)))})}function Jl(t){return On((e,i)=>{let l,r=null,o=!1;r=e.subscribe(In(i,void 0,void 0,d=>{l=Ji(t(d,Jl(t)(e))),r?(r.unsubscribe(),r=null,l.subscribe(i)):o=!0})),o&&(r.unsubscribe(),r=null,l.subscribe(i))})}function dm(t,e){return it(e)?ui(t,e,1):ui(t,1)}function NM(t){return t<=0?()=>zi:On((e,i)=>{let r=[];e.subscribe(In(i,o=>{r.push(o),t<r.length&&r.shift()},()=>{for(const o of r)i.next(o);i.complete()},void 0,()=>{r=null}))})}function GD(t=a2){return On((e,i)=>{let r=!1;e.subscribe(In(i,o=>{r=!0,i.next(o)},()=>r?i.complete():i.error(t())))})}function a2(){return new t_}function WD(t){return On((e,i)=>{let r=!1;e.subscribe(In(i,o=>{r=!0,i.next(o)},()=>{r||i.next(t),i.complete()}))})}function Nh(t,e){const i=arguments.length>=2;return r=>r.pipe(t?Fh((o,l)=>t(o,l,r)):Se,lc(1),i?WD(e):GD(()=>new t_))}function Yr(t,e,i){const r=it(t)||e||i?{next:t,error:e,complete:i}:t;return r?On((o,l)=>{var d;null===(d=r.subscribe)||void 0===d||d.call(r);let p=!0;o.subscribe(In(l,g=>{var x;null===(x=r.next)||void 0===x||x.call(r,g),l.next(g)},()=>{var g;p=!1,null===(g=r.complete)||void 0===g||g.call(r),l.complete()},g=>{var x;p=!1,null===(x=r.error)||void 0===x||x.call(r,g),l.error(g)},()=>{var g,x;p&&(null===(g=r.unsubscribe)||void 0===g||g.call(r)),null===(x=r.finalize)||void 0===x||x.call(r)}))}):Se}class La{constructor(e,i){this.id=e,this.url=i}}class OM extends La{constructor(e,i,r="imperative",o=null){super(e,i),this.navigationTrigger=r,this.restoredState=o}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}}class Oh extends La{constructor(e,i,r){super(e,i),this.urlAfterRedirects=r}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}}class jD extends La{constructor(e,i,r){super(e,i),this.reason=r}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}}class u2 extends La{constructor(e,i,r){super(e,i),this.error=r}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}}class d2 extends La{constructor(e,i,r,o){super(e,i),this.urlAfterRedirects=r,this.state=o}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class h2 extends La{constructor(e,i,r,o){super(e,i),this.urlAfterRedirects=r,this.state=o}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class f2 extends La{constructor(e,i,r,o,l){super(e,i),this.urlAfterRedirects=r,this.state=o,this.shouldActivate=l}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}}class p2 extends La{constructor(e,i,r,o){super(e,i),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class m2 extends La{constructor(e,i,r,o){super(e,i),this.urlAfterRedirects=r,this.state=o}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}}class $D{constructor(e){this.route=e}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}}class qD{constructor(e){this.route=e}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}}class g2{constructor(e){this.snapshot=e}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class y2{constructor(e){this.snapshot=e}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class v2{constructor(e){this.snapshot=e}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class _2{constructor(e){this.snapshot=e}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}}class XD{constructor(e,i,r){this.routerEvent=e,this.position=i,this.anchor=r}toString(){return`Scroll(anchor: '${this.anchor}', position: '${this.position?`${this.position[0]}, ${this.position[1]}`:null}')`}}const Ot="primary";class x2{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){const i=this.params[e];return Array.isArray(i)?i[0]:i}return null}getAll(e){if(this.has(e)){const i=this.params[e];return Array.isArray(i)?i:[i]}return[]}get keys(){return Object.keys(this.params)}}function kh(t){return new x2(t)}const ZD="ngNavigationCancelingError";function kM(t){const e=Error("NavigationCancelingError: "+t);return e[ZD]=!0,e}function b2(t,e,i){const r=i.path.split("/");if(r.length>t.length||"full"===i.pathMatch&&(e.hasChildren()||r.length<t.length))return null;const o={};for(let l=0;l<r.length;l++){const d=r[l],p=t[l];if(d.startsWith(":"))o[d.substring(1)]=p;else if(d!==p.path)return null}return{consumed:t.slice(0,r.length),posParams:o}}function zo(t,e){const i=t?Object.keys(t):void 0,r=e?Object.keys(e):void 0;if(!i||!r||i.length!=r.length)return!1;let o;for(let l=0;l<i.length;l++)if(o=i[l],!YD(t[o],e[o]))return!1;return!0}function YD(t,e){if(Array.isArray(t)&&Array.isArray(e)){if(t.length!==e.length)return!1;const i=[...t].sort(),r=[...e].sort();return i.every((o,l)=>r[l]===o)}return t===e}function QD(t){return Array.prototype.concat.apply([],t)}function KD(t){return t.length>0?t[t.length-1]:null}function Ui(t,e){for(const i in t)t.hasOwnProperty(i)&&e(t[i],i)}function Go(t){return zp(t)?t:Vp(t)?di(Promise.resolve(t)):Dt(t)}const S2={exact:function tA(t,e,i){if(!Wu(t.segments,e.segments)||!n_(t.segments,e.segments,i)||t.numberOfChildren!==e.numberOfChildren)return!1;for(const r in e.children)if(!t.children[r]||!tA(t.children[r],e.children[r],i))return!1;return!0},subset:nA},JD={exact:function T2(t,e){return zo(t,e)},subset:function C2(t,e){return Object.keys(e).length<=Object.keys(t).length&&Object.keys(e).every(i=>YD(t[i],e[i]))},ignored:()=>!0};function eA(t,e,i){return S2[i.paths](t.root,e.root,i.matrixParams)&&JD[i.queryParams](t.queryParams,e.queryParams)&&!("exact"===i.fragment&&t.fragment!==e.fragment)}function nA(t,e,i){return iA(t,e,e.segments,i)}function iA(t,e,i,r){if(t.segments.length>i.length){const o=t.segments.slice(0,i.length);return!(!Wu(o,i)||e.hasChildren()||!n_(o,i,r))}if(t.segments.length===i.length){if(!Wu(t.segments,i)||!n_(t.segments,i,r))return!1;for(const o in e.children)if(!t.children[o]||!nA(t.children[o],e.children[o],r))return!1;return!0}{const o=i.slice(0,t.segments.length),l=i.slice(t.segments.length);return!!(Wu(t.segments,o)&&n_(t.segments,o,r)&&t.children[Ot])&&iA(t.children[Ot],e,l,r)}}function n_(t,e,i){return e.every((r,o)=>JD[i](t[o].parameters,r.parameters))}class Gu{constructor(e,i,r){this.root=e,this.queryParams=i,this.fragment=r}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=kh(this.queryParams)),this._queryParamMap}toString(){return R2.serialize(this)}}class zt{constructor(e,i){this.segments=e,this.children=i,this.parent=null,Ui(i,(r,o)=>r.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return i_(this)}}class hm{constructor(e,i){this.path=e,this.parameters=i}get parameterMap(){return this._parameterMap||(this._parameterMap=kh(this.parameters)),this._parameterMap}toString(){return lA(this)}}function Wu(t,e){return t.length===e.length&&t.every((i,r)=>i.path===e[r].path)}class rA{}class sA{parse(e){const i=new U2(e);return new Gu(i.parseRootSegment(),i.parseQueryParams(),i.parseFragment())}serialize(e){const i=`/${fm(e.root,!0)}`,r=function L2(t){const e=Object.keys(t).map(i=>{const r=t[i];return Array.isArray(r)?r.map(o=>`${r_(i)}=${r_(o)}`).join("&"):`${r_(i)}=${r_(r)}`}).filter(i=>!!i);return e.length?`?${e.join("&")}`:""}(e.queryParams);return`${i}${r}${"string"==typeof e.fragment?`#${function I2(t){return encodeURI(t)}(e.fragment)}`:""}`}}const R2=new sA;function i_(t){return t.segments.map(e=>lA(e)).join("/")}function fm(t,e){if(!t.hasChildren())return i_(t);if(e){const i=t.children[Ot]?fm(t.children[Ot],!1):"",r=[];return Ui(t.children,(o,l)=>{l!==Ot&&r.push(`${l}:${fm(o,!1)}`)}),r.length>0?`${i}(${r.join("//")})`:i}{const i=function A2(t,e){let i=[];return Ui(t.children,(r,o)=>{o===Ot&&(i=i.concat(e(r,o)))}),Ui(t.children,(r,o)=>{o!==Ot&&(i=i.concat(e(r,o)))}),i}(t,(r,o)=>o===Ot?[fm(t.children[Ot],!1)]:[`${o}:${fm(r,!1)}`]);return 1===Object.keys(t.children).length&&null!=t.children[Ot]?`${i_(t)}/${i[0]}`:`${i_(t)}/(${i.join("//")})`}}function oA(t){return encodeURIComponent(t).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function r_(t){return oA(t).replace(/%3B/gi,";")}function BM(t){return oA(t).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function s_(t){return decodeURIComponent(t)}function aA(t){return s_(t.replace(/\+/g,"%20"))}function lA(t){return`${BM(t.path)}${function P2(t){return Object.keys(t).map(e=>`;${BM(e)}=${BM(t[e])}`).join("")}(t.parameters)}`}const F2=/^[^\/()?;=#]+/;function o_(t){const e=t.match(F2);return e?e[0]:""}const N2=/^[^=?&#]+/,k2=/^[^&#]+/;class U2{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),""===this.remaining||this.peekStartsWith("?")||this.peekStartsWith("#")?new zt([],{}):new zt([],this.parseChildren())}parseQueryParams(){const e={};if(this.consumeOptional("?"))do{this.parseQueryParam(e)}while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(""===this.remaining)return{};this.consumeOptional("/");const e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let i={};this.peekStartsWith("/(")&&(this.capture("/"),i=this.parseParens(!0));let r={};return this.peekStartsWith("(")&&(r=this.parseParens(!1)),(e.length>0||Object.keys(i).length>0)&&(r[Ot]=new zt(e,i)),r}parseSegment(){const e=o_(this.remaining);if(""===e&&this.peekStartsWith(";"))throw new Error(`Empty path url segment cannot have parameters: '${this.remaining}'.`);return this.capture(e),new hm(s_(e),this.parseMatrixParams())}parseMatrixParams(){const e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){const i=o_(this.remaining);if(!i)return;this.capture(i);let r="";if(this.consumeOptional("=")){const o=o_(this.remaining);o&&(r=o,this.capture(r))}e[s_(i)]=s_(r)}parseQueryParam(e){const i=function O2(t){const e=t.match(N2);return e?e[0]:""}(this.remaining);if(!i)return;this.capture(i);let r="";if(this.consumeOptional("=")){const d=function B2(t){const e=t.match(k2);return e?e[0]:""}(this.remaining);d&&(r=d,this.capture(r))}const o=aA(i),l=aA(r);if(e.hasOwnProperty(o)){let d=e[o];Array.isArray(d)||(d=[d],e[o]=d),d.push(l)}else e[o]=l}parseParens(e){const i={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){const r=o_(this.remaining),o=this.remaining[r.length];if("/"!==o&&")"!==o&&";"!==o)throw new Error(`Cannot parse url '${this.url}'`);let l;r.indexOf(":")>-1?(l=r.substr(0,r.indexOf(":")),this.capture(l),this.capture(":")):e&&(l=Ot);const d=this.parseChildren();i[l]=1===Object.keys(d).length?d[Ot]:new zt([],d),this.consumeOptional("//")}return i}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return!!this.peekStartsWith(e)&&(this.remaining=this.remaining.substring(e.length),!0)}capture(e){if(!this.consumeOptional(e))throw new Error(`Expected "${e}".`)}}class cA{constructor(e){this._root=e}get root(){return this._root.value}parent(e){const i=this.pathFromRoot(e);return i.length>1?i[i.length-2]:null}children(e){const i=UM(e,this._root);return i?i.children.map(r=>r.value):[]}firstChild(e){const i=UM(e,this._root);return i&&i.children.length>0?i.children[0].value:null}siblings(e){const i=HM(e,this._root);return i.length<2?[]:i[i.length-2].children.map(o=>o.value).filter(o=>o!==e)}pathFromRoot(e){return HM(e,this._root).map(i=>i.value)}}function UM(t,e){if(t===e.value)return e;for(const i of e.children){const r=UM(t,i);if(r)return r}return null}function HM(t,e){if(t===e.value)return[e];for(const i of e.children){const r=HM(t,i);if(r.length)return r.unshift(e),r}return[]}class Fa{constructor(e,i){this.value=e,this.children=i}toString(){return`TreeNode(${this.value})`}}function Bh(t){const e={};return t&&t.children.forEach(i=>e[i.value.outlet]=i),e}class uA extends cA{constructor(e,i){super(e),this.snapshot=i,VM(this,e)}toString(){return this.snapshot.toString()}}function dA(t,e){const i=function H2(t,e){const d=new a_([],{},{},"",{},Ot,e,null,t.root,-1,{});return new fA("",new Fa(d,[]))}(t,e),r=new Sr([new hm("",{})]),o=new Sr({}),l=new Sr({}),d=new Sr({}),p=new Sr(""),g=new Uh(r,o,d,p,l,Ot,e,i.root);return g.snapshot=i.root,new uA(new Fa(g,[]),i)}class Uh{constructor(e,i,r,o,l,d,p,g){this.url=e,this.params=i,this.queryParams=r,this.fragment=o,this.data=l,this.outlet=d,this.component=p,this._futureSnapshot=g}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=this.params.pipe(nn(e=>kh(e)))),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=this.queryParams.pipe(nn(e=>kh(e)))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}}function hA(t,e="emptyOnly"){const i=t.pathFromRoot;let r=0;if("always"!==e)for(r=i.length-1;r>=1;){const o=i[r],l=i[r-1];if(o.routeConfig&&""===o.routeConfig.path)r--;else{if(l.component)break;r--}}return function V2(t){return t.reduce((e,i)=>({params:Object.assign(Object.assign({},e.params),i.params),data:Object.assign(Object.assign({},e.data),i.data),resolve:Object.assign(Object.assign({},e.resolve),i._resolvedData)}),{params:{},data:{},resolve:{}})}(i.slice(r))}class a_{constructor(e,i,r,o,l,d,p,g,x,T,D){this.url=e,this.params=i,this.queryParams=r,this.fragment=o,this.data=l,this.outlet=d,this.component=p,this.routeConfig=g,this._urlSegment=x,this._lastPathIndex=T,this._resolve=D}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap||(this._paramMap=kh(this.params)),this._paramMap}get queryParamMap(){return this._queryParamMap||(this._queryParamMap=kh(this.queryParams)),this._queryParamMap}toString(){return`Route(url:'${this.url.map(r=>r.toString()).join("/")}', path:'${this.routeConfig?this.routeConfig.path:""}')`}}class fA extends cA{constructor(e,i){super(i),this.url=e,VM(this,i)}toString(){return pA(this._root)}}function VM(t,e){e.value._routerState=t,e.children.forEach(i=>VM(t,i))}function pA(t){const e=t.children.length>0?` { ${t.children.map(pA).join(", ")} } `:"";return`${t.value}${e}`}function zM(t){if(t.snapshot){const e=t.snapshot,i=t._futureSnapshot;t.snapshot=i,zo(e.queryParams,i.queryParams)||t.queryParams.next(i.queryParams),e.fragment!==i.fragment&&t.fragment.next(i.fragment),zo(e.params,i.params)||t.params.next(i.params),function M2(t,e){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!zo(t[i],e[i]))return!1;return!0}(e.url,i.url)||t.url.next(i.url),zo(e.data,i.data)||t.data.next(i.data)}else t.snapshot=t._futureSnapshot,t.data.next(t._futureSnapshot.data)}function GM(t,e){const i=zo(t.params,e.params)&&function D2(t,e){return Wu(t,e)&&t.every((i,r)=>zo(i.parameters,e[r].parameters))}(t.url,e.url);return i&&!(!t.parent!=!e.parent)&&(!t.parent||GM(t.parent,e.parent))}function pm(t,e,i){if(i&&t.shouldReuseRoute(e.value,i.value.snapshot)){const r=i.value;r._futureSnapshot=e.value;const o=function G2(t,e,i){return e.children.map(r=>{for(const o of i.children)if(t.shouldReuseRoute(r.value,o.value.snapshot))return pm(t,r,o);return pm(t,r)})}(t,e,i);return new Fa(r,o)}{if(t.shouldAttach(e.value)){const l=t.retrieve(e.value);if(null!==l){const d=l.route;return d.value._futureSnapshot=e.value,d.children=e.children.map(p=>pm(t,p)),d}}const r=function W2(t){return new Uh(new Sr(t.url),new Sr(t.params),new Sr(t.queryParams),new Sr(t.fragment),new Sr(t.data),t.outlet,t.component,t)}(e.value),o=e.children.map(l=>pm(t,l));return new Fa(r,o)}}function l_(t){return"object"==typeof t&&null!=t&&!t.outlets&&!t.segmentPath}function mm(t){return"object"==typeof t&&null!=t&&t.outlets}function WM(t,e,i,r,o){let l={};if(r&&Ui(r,(p,g)=>{l[g]=Array.isArray(p)?p.map(x=>`${x}`):`${p}`}),t===e)return new Gu(i,l,o);const d=mA(t,e,i);return new Gu(d,l,o)}function mA(t,e,i){const r={};return Ui(t.children,(o,l)=>{r[l]=o===e?i:mA(o,e,i)}),new zt(t.segments,r)}class gA{constructor(e,i,r){if(this.isAbsolute=e,this.numberOfDoubleDots=i,this.commands=r,e&&r.length>0&&l_(r[0]))throw new Error("Root segment cannot have matrix parameters");const o=r.find(mm);if(o&&o!==KD(r))throw new Error("{outlets:{}} has to be the last command")}toRoot(){return this.isAbsolute&&1===this.commands.length&&"/"==this.commands[0]}}class jM{constructor(e,i,r){this.segmentGroup=e,this.processChildren=i,this.index=r}}function yA(t,e,i){if(t||(t=new zt([],{})),0===t.segments.length&&t.hasChildren())return c_(t,e,i);const r=function Y2(t,e,i){let r=0,o=e;const l={match:!1,pathIndex:0,commandIndex:0};for(;o<t.segments.length;){if(r>=i.length)return l;const d=t.segments[o],p=i[r];if(mm(p))break;const g=`${p}`,x=r<i.length-1?i[r+1]:null;if(o>0&&void 0===g)break;if(g&&x&&"object"==typeof x&&void 0===x.outlets){if(!_A(g,x,d))return l;r+=2}else{if(!_A(g,{},d))return l;r++}o++}return{match:!0,pathIndex:o,commandIndex:r}}(t,e,i),o=i.slice(r.commandIndex);if(r.match&&r.pathIndex<t.segments.length){const l=new zt(t.segments.slice(0,r.pathIndex),{});return l.children[Ot]=new zt(t.segments.slice(r.pathIndex),t.children),c_(l,0,o)}return r.match&&0===o.length?new zt(t.segments,{}):r.match&&!t.hasChildren()?$M(t,e,i):r.match?c_(t,0,o):$M(t,e,i)}function c_(t,e,i){if(0===i.length)return new zt(t.segments,{});{const r=function Z2(t){return mm(t[0])?t[0].outlets:{[Ot]:t}}(i),o={};return Ui(r,(l,d)=>{"string"==typeof l&&(l=[l]),null!==l&&(o[d]=yA(t.children[d],e,l))}),Ui(t.children,(l,d)=>{void 0===r[d]&&(o[d]=l)}),new zt(t.segments,o)}}function $M(t,e,i){const r=t.segments.slice(0,e);let o=0;for(;o<i.length;){const l=i[o];if(mm(l)){const g=Q2(l.outlets);return new zt(r,g)}if(0===o&&l_(i[0])){r.push(new hm(t.segments[e].path,vA(i[0]))),o++;continue}const d=mm(l)?l.outlets[Ot]:`${l}`,p=o<i.length-1?i[o+1]:null;d&&p&&l_(p)?(r.push(new hm(d,vA(p))),o+=2):(r.push(new hm(d,{})),o++)}return new zt(r,{})}function Q2(t){const e={};return Ui(t,(i,r)=>{"string"==typeof i&&(i=[i]),null!==i&&(e[r]=$M(new zt([],{}),0,i))}),e}function vA(t){const e={};return Ui(t,(i,r)=>e[r]=`${i}`),e}function _A(t,e,i){return t==i.path&&zo(e,i.parameters)}class J2{constructor(e,i,r,o){this.routeReuseStrategy=e,this.futureState=i,this.currState=r,this.forwardEvent=o}activate(e){const i=this.futureState._root,r=this.currState?this.currState._root:null;this.deactivateChildRoutes(i,r,e),zM(this.futureState.root),this.activateChildRoutes(i,r,e)}deactivateChildRoutes(e,i,r){const o=Bh(i);e.children.forEach(l=>{const d=l.value.outlet;this.deactivateRoutes(l,o[d],r),delete o[d]}),Ui(o,(l,d)=>{this.deactivateRouteAndItsChildren(l,r)})}deactivateRoutes(e,i,r){const o=e.value,l=i?i.value:null;if(o===l)if(o.component){const d=r.getContext(o.outlet);d&&this.deactivateChildRoutes(e,i,d.children)}else this.deactivateChildRoutes(e,i,r);else l&&this.deactivateRouteAndItsChildren(i,r)}deactivateRouteAndItsChildren(e,i){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,i):this.deactivateRouteAndOutlet(e,i)}detachAndStoreRouteSubtree(e,i){const r=i.getContext(e.value.outlet),o=r&&e.value.component?r.children:i,l=Bh(e);for(const d of Object.keys(l))this.deactivateRouteAndItsChildren(l[d],o);if(r&&r.outlet){const d=r.outlet.detach(),p=r.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:d,route:e,contexts:p})}}deactivateRouteAndOutlet(e,i){const r=i.getContext(e.value.outlet),o=r&&e.value.component?r.children:i,l=Bh(e);for(const d of Object.keys(l))this.deactivateRouteAndItsChildren(l[d],o);r&&r.outlet&&(r.outlet.deactivate(),r.children.onOutletDeactivated(),r.attachRef=null,r.resolver=null,r.route=null)}activateChildRoutes(e,i,r){const o=Bh(i);e.children.forEach(l=>{this.activateRoutes(l,o[l.value.outlet],r),this.forwardEvent(new _2(l.value.snapshot))}),e.children.length&&this.forwardEvent(new y2(e.value.snapshot))}activateRoutes(e,i,r){const o=e.value,l=i?i.value:null;if(zM(o),o===l)if(o.component){const d=r.getOrCreateContext(o.outlet);this.activateChildRoutes(e,i,d.children)}else this.activateChildRoutes(e,i,r);else if(o.component){const d=r.getOrCreateContext(o.outlet);if(this.routeReuseStrategy.shouldAttach(o.snapshot)){const p=this.routeReuseStrategy.retrieve(o.snapshot);this.routeReuseStrategy.store(o.snapshot,null),d.children.onOutletReAttached(p.contexts),d.attachRef=p.componentRef,d.route=p.route.value,d.outlet&&d.outlet.attach(p.componentRef,p.route.value),zM(p.route.value),this.activateChildRoutes(e,null,d.children)}else{const p=function e3(t){for(let e=t.parent;e;e=e.parent){const i=e.routeConfig;if(i&&i._loadedConfig)return i._loadedConfig;if(i&&i.component)return null}return null}(o.snapshot),g=p?p.module.componentFactoryResolver:null;d.attachRef=null,d.route=o,d.resolver=g,d.outlet&&d.outlet.activateWith(o,g),this.activateChildRoutes(e,null,d.children)}}else this.activateChildRoutes(e,null,r)}}class qM{constructor(e,i){this.routes=e,this.module=i}}function ec(t){return"function"==typeof t}function ju(t){return t instanceof Gu}const gm=Symbol("INITIAL_VALUE");function ym(){return zu(t=>n2(t.map(e=>e.pipe(lc(1),function o2(...t){const e=ta(t);return On((i,r)=>{(e?FM(t,i,e):FM(t,i)).subscribe(r)})}(gm)))).pipe(yM((e,i)=>{let r=!1;return i.reduce((o,l,d)=>o!==gm?o:(l===gm&&(r=!0),r||!1!==l&&d!==i.length-1&&!ju(l)?o:l),e)},gm),Fh(e=>e!==gm),nn(e=>ju(e)?e:!0===e),lc(1)))}class o3{constructor(){this.outlet=null,this.route=null,this.resolver=null,this.children=new vm,this.attachRef=null}}class vm{constructor(){this.contexts=new Map}onChildOutletCreated(e,i){const r=this.getOrCreateContext(e);r.outlet=i,this.contexts.set(e,r)}onChildOutletDestroyed(e){const i=this.getContext(e);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){const e=this.contexts;return this.contexts=new Map,e}onOutletReAttached(e){this.contexts=e}getOrCreateContext(e){let i=this.getContext(e);return i||(i=new o3,this.contexts.set(e,i)),i}getContext(e){return this.contexts.get(e)||null}}let xA=(()=>{class t{constructor(i,r,o,l,d){this.parentContexts=i,this.location=r,this.resolver=o,this.changeDetector=d,this.activated=null,this._activatedRoute=null,this.activateEvents=new Xi,this.deactivateEvents=new Xi,this.attachEvents=new Xi,this.detachEvents=new Xi,this.name=l||Ot,i.onChildOutletCreated(this.name,this)}ngOnDestroy(){this.parentContexts.onChildOutletDestroyed(this.name)}ngOnInit(){if(!this.activated){const i=this.parentContexts.getContext(this.name);i&&i.route&&(i.attachRef?this.attach(i.attachRef,i.route):this.activateWith(i.route,i.resolver||null))}}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Error("Outlet is not activated");return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Error("Outlet is not activated");return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Error("Outlet is not activated");this.location.detach();const i=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(i.instance),i}attach(i,r){this.activated=i,this._activatedRoute=r,this.location.insert(i.hostView),this.attachEvents.emit(i.instance)}deactivate(){if(this.activated){const i=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(i)}}activateWith(i,r){if(this.isActivated)throw new Error("Cannot activate an already activated outlet");this._activatedRoute=i;const d=(r=r||this.resolver).resolveComponentFactory(i._futureSnapshot.routeConfig.component),p=this.parentContexts.getOrCreateContext(this.name).children,g=new a3(i,p,this.location.injector);this.activated=this.location.createComponent(d,this.location.length,g),this.changeDetector.markForCheck(),this.activateEvents.emit(this.activated.instance)}}return t.\u0275fac=function(i){return new(i||t)(We(vm),We(io),We(qp),function Dc(t){return function J_(t,e){if("class"===e)return t.classes;if("style"===e)return t.styles;const i=t.attrs;if(i){const r=i.length;let o=0;for(;o<r;){const l=i[o];if(rg(l))break;if(0===l)o+=2;else if("number"==typeof l)for(o++;o<r&&"string"==typeof i[o];)o++;else{if(l===e)return i[o+1];o+=2}}}return null}(pi(),t)}("name"),We(_b))},t.\u0275dir=Jn({type:t,selectors:[["router-outlet"]],outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"]}),t})();class a3{constructor(e,i,r){this.route=e,this.childContexts=i,this.parent=r}get(e,i){return e===Uh?this.route:e===vm?this.childContexts:this.parent.get(e,i)}}let wA=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275cmp=qa({type:t,selectors:[["ng-component"]],decls:1,vars:0,template:function(i,r){1&i&&bh(0,"router-outlet")},directives:[xA],encapsulation:2}),t})();function bA(t,e=""){for(let i=0;i<t.length;i++){const r=t[i];l3(r,c3(e,r))}}function l3(t,e){t.children&&bA(t.children,e)}function c3(t,e){return e?t||e.path?t&&!e.path?`${t}/`:!t&&e.path?e.path:`${t}/${e.path}`:"":t}function XM(t){const e=t.children&&t.children.map(XM),i=e?Object.assign(Object.assign({},t),{children:e}):Object.assign({},t);return!i.component&&(e||i.loadChildren)&&i.outlet&&i.outlet!==Ot&&(i.component=wA),i}function Ds(t){return t.outlet||Ot}function MA(t,e){const i=t.filter(r=>Ds(r)===e);return i.push(...t.filter(r=>Ds(r)!==e)),i}const EA={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function u_(t,e,i){var r;if(""===e.path)return"full"===e.pathMatch&&(t.hasChildren()||i.length>0)?Object.assign({},EA):{matched:!0,consumedSegments:[],remainingSegments:i,parameters:{},positionalParamSegments:{}};const l=(e.matcher||b2)(i,t,e);if(!l)return Object.assign({},EA);const d={};Ui(l.posParams,(g,x)=>{d[x]=g.path});const p=l.consumed.length>0?Object.assign(Object.assign({},d),l.consumed[l.consumed.length-1].parameters):d;return{matched:!0,consumedSegments:l.consumed,remainingSegments:i.slice(l.consumed.length),parameters:p,positionalParamSegments:null!==(r=l.posParams)&&void 0!==r?r:{}}}function d_(t,e,i,r,o="corrected"){if(i.length>0&&function h3(t,e,i){return i.some(r=>h_(t,e,r)&&Ds(r)!==Ot)}(t,i,r)){const d=new zt(e,function d3(t,e,i,r){const o={};o[Ot]=r,r._sourceSegment=t,r._segmentIndexShift=e.length;for(const l of i)if(""===l.path&&Ds(l)!==Ot){const d=new zt([],{});d._sourceSegment=t,d._segmentIndexShift=e.length,o[Ds(l)]=d}return o}(t,e,r,new zt(i,t.children)));return d._sourceSegment=t,d._segmentIndexShift=e.length,{segmentGroup:d,slicedSegments:[]}}if(0===i.length&&function f3(t,e,i){return i.some(r=>h_(t,e,r))}(t,i,r)){const d=new zt(t.segments,function u3(t,e,i,r,o,l){const d={};for(const p of r)if(h_(t,i,p)&&!o[Ds(p)]){const g=new zt([],{});g._sourceSegment=t,g._segmentIndexShift="legacy"===l?t.segments.length:e.length,d[Ds(p)]=g}return Object.assign(Object.assign({},o),d)}(t,e,i,r,t.children,o));return d._sourceSegment=t,d._segmentIndexShift=e.length,{segmentGroup:d,slicedSegments:i}}const l=new zt(t.segments,t.children);return l._sourceSegment=t,l._segmentIndexShift=e.length,{segmentGroup:l,slicedSegments:i}}function h_(t,e,i){return(!(t.hasChildren()||e.length>0)||"full"!==i.pathMatch)&&""===i.path}function SA(t,e,i,r){return!!(Ds(t)===r||r!==Ot&&h_(e,i,t))&&("**"===t.path||u_(e,t,i).matched)}function TA(t,e,i){return 0===e.length&&!t.children[i]}class f_{constructor(e){this.segmentGroup=e||null}}class CA{constructor(e){this.urlTree=e}}function _m(t){return e_(new f_(t))}function DA(t){return e_(new CA(t))}class y3{constructor(e,i,r,o,l){this.configLoader=i,this.urlSerializer=r,this.urlTree=o,this.config=l,this.allowRedirects=!0,this.ngModule=e.get(Da)}apply(){const e=d_(this.urlTree.root,[],[],this.config).segmentGroup,i=new zt(e.segments,e.children);return this.expandSegmentGroup(this.ngModule,this.config,i,Ot).pipe(nn(l=>this.createUrlTree(ZM(l),this.urlTree.queryParams,this.urlTree.fragment))).pipe(Jl(l=>{if(l instanceof CA)return this.allowRedirects=!1,this.match(l.urlTree);throw l instanceof f_?this.noMatchError(l):l}))}match(e){return this.expandSegmentGroup(this.ngModule,this.config,e.root,Ot).pipe(nn(o=>this.createUrlTree(ZM(o),e.queryParams,e.fragment))).pipe(Jl(o=>{throw o instanceof f_?this.noMatchError(o):o}))}noMatchError(e){return new Error(`Cannot match any routes. URL Segment: '${e.segmentGroup}'`)}createUrlTree(e,i,r){const o=e.segments.length>0?new zt([],{[Ot]:e}):e;return new Gu(o,i,r)}expandSegmentGroup(e,i,r,o){return 0===r.segments.length&&r.hasChildren()?this.expandChildren(e,i,r).pipe(nn(l=>new zt([],l))):this.expandSegment(e,r,i,r.segments,o,!0)}expandChildren(e,i,r){const o=[];for(const l of Object.keys(r.children))"primary"===l?o.unshift(l):o.push(l);return di(o).pipe(dm(l=>{const d=r.children[l],p=MA(i,l);return this.expandSegmentGroup(e,p,d,l).pipe(nn(g=>({segment:g,outlet:l})))}),yM((l,d)=>(l[d.outlet]=d.segment,l),{}),function l2(t,e){const i=arguments.length>=2;return r=>r.pipe(t?Fh((o,l)=>t(o,l,r)):Se,NM(1),i?WD(e):GD(()=>new t_))}())}expandSegment(e,i,r,o,l,d){return di(r).pipe(dm(p=>this.expandSegmentAgainstRoute(e,i,r,p,o,l,d).pipe(Jl(x=>{if(x instanceof f_)return Dt(null);throw x}))),Nh(p=>!!p),Jl((p,g)=>{if(p instanceof t_||"EmptyError"===p.name)return TA(i,o,l)?Dt(new zt([],{})):_m(i);throw p}))}expandSegmentAgainstRoute(e,i,r,o,l,d,p){return SA(o,i,l,d)?void 0===o.redirectTo?this.matchSegmentAgainstRoute(e,i,o,l,d):p&&this.allowRedirects?this.expandSegmentAgainstRouteUsingRedirect(e,i,r,o,l,d):_m(i):_m(i)}expandSegmentAgainstRouteUsingRedirect(e,i,r,o,l,d){return"**"===o.path?this.expandWildCardWithParamsAgainstRouteUsingRedirect(e,r,o,d):this.expandRegularSegmentAgainstRouteUsingRedirect(e,i,r,o,l,d)}expandWildCardWithParamsAgainstRouteUsingRedirect(e,i,r,o){const l=this.applyRedirectCommands([],r.redirectTo,{});return r.redirectTo.startsWith("/")?DA(l):this.lineralizeSegments(r,l).pipe(ui(d=>{const p=new zt(d,{});return this.expandSegment(e,p,i,d,o,!1)}))}expandRegularSegmentAgainstRouteUsingRedirect(e,i,r,o,l,d){const{matched:p,consumedSegments:g,remainingSegments:x,positionalParamSegments:T}=u_(i,o,l);if(!p)return _m(i);const D=this.applyRedirectCommands(g,o.redirectTo,T);return o.redirectTo.startsWith("/")?DA(D):this.lineralizeSegments(o,D).pipe(ui(P=>this.expandSegment(e,i,r,P.concat(x),d,!1)))}matchSegmentAgainstRoute(e,i,r,o,l){if("**"===r.path)return r.loadChildren?(r._loadedConfig?Dt(r._loadedConfig):this.configLoader.load(e.injector,r)).pipe(nn(D=>(r._loadedConfig=D,new zt(o,{})))):Dt(new zt(o,{}));const{matched:d,consumedSegments:p,remainingSegments:g}=u_(i,r,o);return d?this.getChildConfig(e,r,o).pipe(ui(T=>{const D=T.module,P=T.routes,{segmentGroup:B,slicedSegments:z}=d_(i,p,g,P),Z=new zt(B.segments,B.children);if(0===z.length&&Z.hasChildren())return this.expandChildren(D,P,Z).pipe(nn(Le=>new zt(p,Le)));if(0===P.length&&0===z.length)return Dt(new zt(p,{}));const re=Ds(r)===l;return this.expandSegment(D,Z,P,z,re?Ot:l,!0).pipe(nn(K=>new zt(p.concat(K.segments),K.children)))})):_m(i)}getChildConfig(e,i,r){return i.children?Dt(new qM(i.children,e)):i.loadChildren?void 0!==i._loadedConfig?Dt(i._loadedConfig):this.runCanLoadGuards(e.injector,i,r).pipe(ui(o=>o?this.configLoader.load(e.injector,i).pipe(nn(l=>(i._loadedConfig=l,l))):function m3(t){return e_(kM(`Cannot load children because the guard of the route "path: '${t.path}'" returned false`))}(i))):Dt(new qM([],e))}runCanLoadGuards(e,i,r){const o=i.canLoad;return o&&0!==o.length?Dt(o.map(d=>{const p=e.get(d);let g;if(function n3(t){return t&&ec(t.canLoad)}(p))g=p.canLoad(i,r);else{if(!ec(p))throw new Error("Invalid CanLoad guard");g=p(i,r)}return Go(g)})).pipe(ym(),Yr(d=>{if(!ju(d))return;const p=kM(`Redirecting to "${this.urlSerializer.serialize(d)}"`);throw p.url=d,p}),nn(d=>!0===d)):Dt(!0)}lineralizeSegments(e,i){let r=[],o=i.root;for(;;){if(r=r.concat(o.segments),0===o.numberOfChildren)return Dt(r);if(o.numberOfChildren>1||!o.children[Ot])return e_(new Error(`Only absolute redirects can have named outlets. redirectTo: '${e.redirectTo}'`));o=o.children[Ot]}}applyRedirectCommands(e,i,r){return this.applyRedirectCreatreUrlTree(i,this.urlSerializer.parse(i),e,r)}applyRedirectCreatreUrlTree(e,i,r,o){const l=this.createSegmentGroup(e,i.root,r,o);return new Gu(l,this.createQueryParams(i.queryParams,this.urlTree.queryParams),i.fragment)}createQueryParams(e,i){const r={};return Ui(e,(o,l)=>{if("string"==typeof o&&o.startsWith(":")){const p=o.substring(1);r[l]=i[p]}else r[l]=o}),r}createSegmentGroup(e,i,r,o){const l=this.createSegments(e,i.segments,r,o);let d={};return Ui(i.children,(p,g)=>{d[g]=this.createSegmentGroup(e,p,r,o)}),new zt(l,d)}createSegments(e,i,r,o){return i.map(l=>l.path.startsWith(":")?this.findPosParam(e,l,o):this.findOrReturn(l,r))}findPosParam(e,i,r){const o=r[i.path.substring(1)];if(!o)throw new Error(`Cannot redirect to '${e}'. Cannot find '${i.path}'.`);return o}findOrReturn(e,i){let r=0;for(const o of i){if(o.path===e.path)return i.splice(r),o;r++}return e}}function ZM(t){const e={};for(const r of Object.keys(t.children)){const l=ZM(t.children[r]);(l.segments.length>0||l.hasChildren())&&(e[r]=l)}return function v3(t){if(1===t.numberOfChildren&&t.children[Ot]){const e=t.children[Ot];return new zt(t.segments.concat(e.segments),e.children)}return t}(new zt(t.segments,e))}class AA{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}}class p_{constructor(e,i){this.component=e,this.route=i}}function x3(t,e,i){const r=t._root;return xm(r,e?e._root:null,i,[r.value])}function m_(t,e,i){const r=function b3(t){if(!t)return null;for(let e=t.parent;e;e=e.parent){const i=e.routeConfig;if(i&&i._loadedConfig)return i._loadedConfig}return null}(e);return(r?r.module.injector:i).get(t)}function xm(t,e,i,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const l=Bh(e);return t.children.forEach(d=>{(function M3(t,e,i,r,o={canDeactivateChecks:[],canActivateChecks:[]}){const l=t.value,d=e?e.value:null,p=i?i.getContext(t.value.outlet):null;if(d&&l.routeConfig===d.routeConfig){const g=function E3(t,e,i){if("function"==typeof i)return i(t,e);switch(i){case"pathParamsChange":return!Wu(t.url,e.url);case"pathParamsOrQueryParamsChange":return!Wu(t.url,e.url)||!zo(t.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!GM(t,e)||!zo(t.queryParams,e.queryParams);default:return!GM(t,e)}}(d,l,l.routeConfig.runGuardsAndResolvers);g?o.canActivateChecks.push(new AA(r)):(l.data=d.data,l._resolvedData=d._resolvedData),xm(t,e,l.component?p?p.children:null:i,r,o),g&&p&&p.outlet&&p.outlet.isActivated&&o.canDeactivateChecks.push(new p_(p.outlet.component,d))}else d&&wm(e,p,o),o.canActivateChecks.push(new AA(r)),xm(t,null,l.component?p?p.children:null:i,r,o)})(d,l[d.value.outlet],i,r.concat([d.value]),o),delete l[d.value.outlet]}),Ui(l,(d,p)=>wm(d,i.getContext(p),o)),o}function wm(t,e,i){const r=Bh(t),o=t.value;Ui(r,(l,d)=>{wm(l,o.component?e?e.children.getContext(d):null:e,i)}),i.canDeactivateChecks.push(new p_(o.component&&e&&e.outlet&&e.outlet.isActivated?e.outlet.component:null,o))}class L3{}function RA(t){return new Oe(e=>e.error(t))}class N3{constructor(e,i,r,o,l,d){this.rootComponentType=e,this.config=i,this.urlTree=r,this.url=o,this.paramsInheritanceStrategy=l,this.relativeLinkResolution=d}recognize(){const e=d_(this.urlTree.root,[],[],this.config.filter(d=>void 0===d.redirectTo),this.relativeLinkResolution).segmentGroup,i=this.processSegmentGroup(this.config,e,Ot);if(null===i)return null;const r=new a_([],Object.freeze({}),Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,{},Ot,this.rootComponentType,null,this.urlTree.root,-1,{}),o=new Fa(r,i),l=new fA(this.url,o);return this.inheritParamsAndData(l._root),l}inheritParamsAndData(e){const i=e.value,r=hA(i,this.paramsInheritanceStrategy);i.params=Object.freeze(r.params),i.data=Object.freeze(r.data),e.children.forEach(o=>this.inheritParamsAndData(o))}processSegmentGroup(e,i,r){return 0===i.segments.length&&i.hasChildren()?this.processChildren(e,i):this.processSegment(e,i,i.segments,r)}processChildren(e,i){const r=[];for(const l of Object.keys(i.children)){const d=i.children[l],p=MA(e,l),g=this.processSegmentGroup(p,d,l);if(null===g)return null;r.push(...g)}const o=IA(r);return function O3(t){t.sort((e,i)=>e.value.outlet===Ot?-1:i.value.outlet===Ot?1:e.value.outlet.localeCompare(i.value.outlet))}(o),o}processSegment(e,i,r,o){for(const l of e){const d=this.processSegmentAgainstRoute(l,i,r,o);if(null!==d)return d}return TA(i,r,o)?[]:null}processSegmentAgainstRoute(e,i,r,o){if(e.redirectTo||!SA(e,i,r,o))return null;let l,d=[],p=[];if("**"===e.path){const B=r.length>0?KD(r).parameters:{};l=new a_(r,B,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,FA(e),Ds(e),e.component,e,PA(i),LA(i)+r.length,NA(e))}else{const B=u_(i,e,r);if(!B.matched)return null;d=B.consumedSegments,p=B.remainingSegments,l=new a_(d,B.parameters,Object.freeze(Object.assign({},this.urlTree.queryParams)),this.urlTree.fragment,FA(e),Ds(e),e.component,e,PA(i),LA(i)+d.length,NA(e))}const g=function k3(t){return t.children?t.children:t.loadChildren?t._loadedConfig.routes:[]}(e),{segmentGroup:x,slicedSegments:T}=d_(i,d,p,g.filter(B=>void 0===B.redirectTo),this.relativeLinkResolution);if(0===T.length&&x.hasChildren()){const B=this.processChildren(g,x);return null===B?null:[new Fa(l,B)]}if(0===g.length&&0===T.length)return[new Fa(l,[])];const D=Ds(e)===o,P=this.processSegment(g,x,T,D?Ot:o);return null===P?null:[new Fa(l,P)]}}function B3(t){const e=t.value.routeConfig;return e&&""===e.path&&void 0===e.redirectTo}function IA(t){const e=[],i=new Set;for(const r of t){if(!B3(r)){e.push(r);continue}const o=e.find(l=>r.value.routeConfig===l.value.routeConfig);void 0!==o?(o.children.push(...r.children),i.add(o)):e.push(r)}for(const r of i){const o=IA(r.children);e.push(new Fa(r.value,o))}return e.filter(r=>!i.has(r))}function PA(t){let e=t;for(;e._sourceSegment;)e=e._sourceSegment;return e}function LA(t){let e=t,i=e._segmentIndexShift?e._segmentIndexShift:0;for(;e._sourceSegment;)e=e._sourceSegment,i+=e._segmentIndexShift?e._segmentIndexShift:0;return i-1}function FA(t){return t.data||{}}function NA(t){return t.resolve||{}}function OA(t){return[...Object.keys(t),...Object.getOwnPropertySymbols(t)]}function YM(t){return zu(e=>{const i=t(e);return i?di(i).pipe(nn(()=>e)):Dt(e)})}class $3 extends class j3{shouldDetach(e){return!1}store(e,i){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,i){return e.routeConfig===i.routeConfig}}{}const QM=new ze("ROUTES");class kA{constructor(e,i,r,o){this.injector=e,this.compiler=i,this.onLoadStartListener=r,this.onLoadEndListener=o}load(e,i){if(i._loader$)return i._loader$;this.onLoadStartListener&&this.onLoadStartListener(i);const o=this.loadModuleFactory(i.loadChildren).pipe(nn(l=>{this.onLoadEndListener&&this.onLoadEndListener(i);const d=l.create(e);return new qM(QD(d.injector.get(QM,void 0,ht.Self|ht.Optional)).map(XM),d)}),Jl(l=>{throw i._loader$=void 0,l}));return i._loader$=new s2(o,()=>new Ri).pipe(zD()),i._loader$}loadModuleFactory(e){return Go(e()).pipe(ui(i=>i instanceof PS?Dt(i):di(this.compiler.compileModuleAsync(i))))}}class X3{shouldProcessUrl(e){return!0}extract(e){return e}merge(e,i){return e}}function Z3(t){throw t}function Y3(t,e,i){return e.parse("/")}function BA(t,e){return Dt(null)}const Q3={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},K3={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"};let Tr=(()=>{class t{constructor(i,r,o,l,d,p,g){this.rootComponentType=i,this.urlSerializer=r,this.rootContexts=o,this.location=l,this.config=g,this.lastSuccessfulNavigation=null,this.currentNavigation=null,this.disposed=!1,this.navigationId=0,this.currentPageId=0,this.isNgZoneEnabled=!1,this.events=new Ri,this.errorHandler=Z3,this.malformedUriErrorHandler=Y3,this.navigated=!1,this.lastSuccessfulId=-1,this.hooks={beforePreactivation:BA,afterPreactivation:BA},this.urlHandlingStrategy=new X3,this.routeReuseStrategy=new $3,this.onSameUrlNavigation="ignore",this.paramsInheritanceStrategy="emptyOnly",this.urlUpdateStrategy="deferred",this.relativeLinkResolution="corrected",this.canceledNavigationResolution="replace",this.ngModule=d.get(Da),this.console=d.get(pT);const D=d.get(yi);this.isNgZoneEnabled=D instanceof yi&&yi.isInAngularZone(),this.resetConfig(g),this.currentUrlTree=function E2(){return new Gu(new zt([],{}),{},null)}(),this.rawUrlTree=this.currentUrlTree,this.browserUrlTree=this.currentUrlTree,this.configLoader=new kA(d,p,P=>this.triggerEvent(new $D(P)),P=>this.triggerEvent(new qD(P))),this.routerState=dA(this.currentUrlTree,this.rootComponentType),this.transitions=new Sr({id:0,targetPageId:0,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,extractedUrl:this.urlHandlingStrategy.extract(this.currentUrlTree),urlAfterRedirects:this.urlHandlingStrategy.extract(this.currentUrlTree),rawUrl:this.currentUrlTree,extras:{},resolve:null,reject:null,promise:Promise.resolve(!0),source:"imperative",restoredState:null,currentSnapshot:this.routerState.snapshot,targetSnapshot:null,currentRouterState:this.routerState,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.navigations=this.setupNavigations(this.transitions),this.processNavigations()}get browserPageId(){var i;return null===(i=this.location.getState())||void 0===i?void 0:i.\u0275routerPageId}setupNavigations(i){const r=this.events;return i.pipe(Fh(o=>0!==o.id),nn(o=>Object.assign(Object.assign({},o),{extractedUrl:this.urlHandlingStrategy.extract(o.rawUrl)})),zu(o=>{let l=!1,d=!1;return Dt(o).pipe(Yr(p=>{this.currentNavigation={id:p.id,initialUrl:p.currentRawUrl,extractedUrl:p.extractedUrl,trigger:p.source,extras:p.extras,previousNavigation:this.lastSuccessfulNavigation?Object.assign(Object.assign({},this.lastSuccessfulNavigation),{previousNavigation:null}):null}}),zu(p=>{const g=this.browserUrlTree.toString(),x=!this.navigated||p.extractedUrl.toString()!==g||g!==this.currentUrlTree.toString();if(("reload"===this.onSameUrlNavigation||x)&&this.urlHandlingStrategy.shouldProcessUrl(p.rawUrl))return UA(p.source)&&(this.browserUrlTree=p.extractedUrl),Dt(p).pipe(zu(D=>{const P=this.transitions.getValue();return r.next(new OM(D.id,this.serializeUrl(D.extractedUrl),D.source,D.restoredState)),P!==this.transitions.getValue()?zi:Promise.resolve(D)}),function _3(t,e,i,r){return zu(o=>function g3(t,e,i,r,o){return new y3(t,e,i,r,o).apply()}(t,e,i,o.extractedUrl,r).pipe(nn(l=>Object.assign(Object.assign({},o),{urlAfterRedirects:l}))))}(this.ngModule.injector,this.configLoader,this.urlSerializer,this.config),Yr(D=>{this.currentNavigation=Object.assign(Object.assign({},this.currentNavigation),{finalUrl:D.urlAfterRedirects})}),function U3(t,e,i,r,o){return ui(l=>function F3(t,e,i,r,o="emptyOnly",l="legacy"){try{const d=new N3(t,e,i,r,o,l).recognize();return null===d?RA(new L3):Dt(d)}catch(d){return RA(d)}}(t,e,l.urlAfterRedirects,i(l.urlAfterRedirects),r,o).pipe(nn(d=>Object.assign(Object.assign({},l),{targetSnapshot:d}))))}(this.rootComponentType,this.config,D=>this.serializeUrl(D),this.paramsInheritanceStrategy,this.relativeLinkResolution),Yr(D=>{if("eager"===this.urlUpdateStrategy){if(!D.extras.skipLocationChange){const B=this.urlHandlingStrategy.merge(D.urlAfterRedirects,D.rawUrl);this.setBrowserUrl(B,D)}this.browserUrlTree=D.urlAfterRedirects}const P=new d2(D.id,this.serializeUrl(D.extractedUrl),this.serializeUrl(D.urlAfterRedirects),D.targetSnapshot);r.next(P)}));if(x&&this.rawUrlTree&&this.urlHandlingStrategy.shouldProcessUrl(this.rawUrlTree)){const{id:P,extractedUrl:B,source:z,restoredState:Z,extras:re}=p,me=new OM(P,this.serializeUrl(B),z,Z);r.next(me);const K=dA(B,this.rootComponentType).snapshot;return Dt(Object.assign(Object.assign({},p),{targetSnapshot:K,urlAfterRedirects:B,extras:Object.assign(Object.assign({},re),{skipLocationChange:!1,replaceUrl:!1})}))}return this.rawUrlTree=p.rawUrl,p.resolve(null),zi}),YM(p=>{const{targetSnapshot:g,id:x,extractedUrl:T,rawUrl:D,extras:{skipLocationChange:P,replaceUrl:B}}=p;return this.hooks.beforePreactivation(g,{navigationId:x,appliedUrlTree:T,rawUrlTree:D,skipLocationChange:!!P,replaceUrl:!!B})}),Yr(p=>{const g=new h2(p.id,this.serializeUrl(p.extractedUrl),this.serializeUrl(p.urlAfterRedirects),p.targetSnapshot);this.triggerEvent(g)}),nn(p=>Object.assign(Object.assign({},p),{guards:x3(p.targetSnapshot,p.currentSnapshot,this.rootContexts)})),function S3(t,e){return ui(i=>{const{targetSnapshot:r,currentSnapshot:o,guards:{canActivateChecks:l,canDeactivateChecks:d}}=i;return 0===d.length&&0===l.length?Dt(Object.assign(Object.assign({},i),{guardsResult:!0})):function T3(t,e,i,r){return di(t).pipe(ui(o=>function P3(t,e,i,r,o){const l=e&&e.routeConfig?e.routeConfig.canDeactivate:null;return l&&0!==l.length?Dt(l.map(p=>{const g=m_(p,e,o);let x;if(function s3(t){return t&&ec(t.canDeactivate)}(g))x=Go(g.canDeactivate(t,e,i,r));else{if(!ec(g))throw new Error("Invalid CanDeactivate guard");x=Go(g(t,e,i,r))}return x.pipe(Nh())})).pipe(ym()):Dt(!0)}(o.component,o.route,i,e,r)),Nh(o=>!0!==o,!0))}(d,r,o,t).pipe(ui(p=>p&&function t3(t){return"boolean"==typeof t}(p)?function C3(t,e,i,r){return di(e).pipe(dm(o=>FM(function A3(t,e){return null!==t&&e&&e(new g2(t)),Dt(!0)}(o.route.parent,r),function D3(t,e){return null!==t&&e&&e(new v2(t)),Dt(!0)}(o.route,r),function I3(t,e,i){const r=e[e.length-1],l=e.slice(0,e.length-1).reverse().map(d=>function w3(t){const e=t.routeConfig?t.routeConfig.canActivateChild:null;return e&&0!==e.length?{node:t,guards:e}:null}(d)).filter(d=>null!==d).map(d=>VD(()=>Dt(d.guards.map(g=>{const x=m_(g,d.node,i);let T;if(function r3(t){return t&&ec(t.canActivateChild)}(x))T=Go(x.canActivateChild(r,t));else{if(!ec(x))throw new Error("Invalid CanActivateChild guard");T=Go(x(r,t))}return T.pipe(Nh())})).pipe(ym())));return Dt(l).pipe(ym())}(t,o.path,i),function R3(t,e,i){const r=e.routeConfig?e.routeConfig.canActivate:null;if(!r||0===r.length)return Dt(!0);const o=r.map(l=>VD(()=>{const d=m_(l,e,i);let p;if(function i3(t){return t&&ec(t.canActivate)}(d))p=Go(d.canActivate(e,t));else{if(!ec(d))throw new Error("Invalid CanActivate guard");p=Go(d(e,t))}return p.pipe(Nh())}));return Dt(o).pipe(ym())}(t,o.route,i))),Nh(o=>!0!==o,!0))}(r,l,t,e):Dt(p)),nn(p=>Object.assign(Object.assign({},i),{guardsResult:p})))})}(this.ngModule.injector,p=>this.triggerEvent(p)),Yr(p=>{if(ju(p.guardsResult)){const x=kM(`Redirecting to "${this.serializeUrl(p.guardsResult)}"`);throw x.url=p.guardsResult,x}const g=new f2(p.id,this.serializeUrl(p.extractedUrl),this.serializeUrl(p.urlAfterRedirects),p.targetSnapshot,!!p.guardsResult);this.triggerEvent(g)}),Fh(p=>!!p.guardsResult||(this.restoreHistory(p),this.cancelNavigationTransition(p,""),!1)),YM(p=>{if(p.guards.canActivateChecks.length)return Dt(p).pipe(Yr(g=>{const x=new p2(g.id,this.serializeUrl(g.extractedUrl),this.serializeUrl(g.urlAfterRedirects),g.targetSnapshot);this.triggerEvent(x)}),zu(g=>{let x=!1;return Dt(g).pipe(function H3(t,e){return ui(i=>{const{targetSnapshot:r,guards:{canActivateChecks:o}}=i;if(!o.length)return Dt(i);let l=0;return di(o).pipe(dm(d=>function V3(t,e,i,r){return function z3(t,e,i,r){const o=OA(t);if(0===o.length)return Dt({});const l={};return di(o).pipe(ui(d=>function G3(t,e,i,r){const o=m_(t,e,r);return Go(o.resolve?o.resolve(e,i):o(e,i))}(t[d],e,i,r).pipe(Yr(p=>{l[d]=p}))),NM(1),ui(()=>OA(l).length===o.length?Dt(l):zi))}(t._resolve,t,e,r).pipe(nn(l=>(t._resolvedData=l,t.data=Object.assign(Object.assign({},t.data),hA(t,i).resolve),null)))}(d.route,r,t,e)),Yr(()=>l++),NM(1),ui(d=>l===o.length?Dt(i):zi))})}(this.paramsInheritanceStrategy,this.ngModule.injector),Yr({next:()=>x=!0,complete:()=>{x||(this.restoreHistory(g),this.cancelNavigationTransition(g,"At least one route resolver didn't emit any value."))}}))}),Yr(g=>{const x=new m2(g.id,this.serializeUrl(g.extractedUrl),this.serializeUrl(g.urlAfterRedirects),g.targetSnapshot);this.triggerEvent(x)}))}),YM(p=>{const{targetSnapshot:g,id:x,extractedUrl:T,rawUrl:D,extras:{skipLocationChange:P,replaceUrl:B}}=p;return this.hooks.afterPreactivation(g,{navigationId:x,appliedUrlTree:T,rawUrlTree:D,skipLocationChange:!!P,replaceUrl:!!B})}),nn(p=>{const g=function z2(t,e,i){const r=pm(t,e._root,i?i._root:void 0);return new uA(r,e)}(this.routeReuseStrategy,p.targetSnapshot,p.currentRouterState);return Object.assign(Object.assign({},p),{targetRouterState:g})}),Yr(p=>{this.currentUrlTree=p.urlAfterRedirects,this.rawUrlTree=this.urlHandlingStrategy.merge(p.urlAfterRedirects,p.rawUrl),this.routerState=p.targetRouterState,"deferred"===this.urlUpdateStrategy&&(p.extras.skipLocationChange||this.setBrowserUrl(this.rawUrlTree,p),this.browserUrlTree=p.urlAfterRedirects)}),((t,e,i)=>nn(r=>(new J2(e,r.targetRouterState,r.currentRouterState,i).activate(t),r)))(this.rootContexts,this.routeReuseStrategy,p=>this.triggerEvent(p)),Yr({next(){l=!0},complete(){l=!0}}),function c2(t){return On((e,i)=>{try{e.subscribe(i)}finally{i.add(t)}})}(()=>{var p;l||d||this.cancelNavigationTransition(o,`Navigation ID ${o.id} is not equal to the current navigation id ${this.navigationId}`),(null===(p=this.currentNavigation)||void 0===p?void 0:p.id)===o.id&&(this.currentNavigation=null)}),Jl(p=>{if(d=!0,function w2(t){return t&&t[ZD]}(p)){const g=ju(p.url);g||(this.navigated=!0,this.restoreHistory(o,!0));const x=new jD(o.id,this.serializeUrl(o.extractedUrl),p.message);r.next(x),g?setTimeout(()=>{const T=this.urlHandlingStrategy.merge(p.url,this.rawUrlTree),D={skipLocationChange:o.extras.skipLocationChange,replaceUrl:"eager"===this.urlUpdateStrategy||UA(o.source)};this.scheduleNavigation(T,"imperative",null,D,{resolve:o.resolve,reject:o.reject,promise:o.promise})},0):o.resolve(!1)}else{this.restoreHistory(o,!0);const g=new u2(o.id,this.serializeUrl(o.extractedUrl),p);r.next(g);try{o.resolve(this.errorHandler(p))}catch(x){o.reject(x)}}return zi}))}))}resetRootComponentType(i){this.rootComponentType=i,this.routerState.root.component=this.rootComponentType}setTransition(i){this.transitions.next(Object.assign(Object.assign({},this.transitions.value),i))}initialNavigation(){this.setUpLocationChangeListener(),0===this.navigationId&&this.navigateByUrl(this.location.path(!0),{replaceUrl:!0})}setUpLocationChangeListener(){this.locationSubscription||(this.locationSubscription=this.location.subscribe(i=>{const r="popstate"===i.type?"popstate":"hashchange";"popstate"===r&&setTimeout(()=>{var o;const l={replaceUrl:!0},d=(null===(o=i.state)||void 0===o?void 0:o.navigationId)?i.state:null;if(d){const g=Object.assign({},d);delete g.navigationId,delete g.\u0275routerPageId,0!==Object.keys(g).length&&(l.state=g)}const p=this.parseUrl(i.url);this.scheduleNavigation(p,r,d,l)},0)}))}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.currentNavigation}triggerEvent(i){this.events.next(i)}resetConfig(i){bA(i),this.config=i.map(XM),this.navigated=!1,this.lastSuccessfulId=-1}ngOnDestroy(){this.dispose()}dispose(){this.transitions.complete(),this.locationSubscription&&(this.locationSubscription.unsubscribe(),this.locationSubscription=void 0),this.disposed=!0}createUrlTree(i,r={}){const{relativeTo:o,queryParams:l,fragment:d,queryParamsHandling:p,preserveFragment:g}=r,x=o||this.routerState.root,T=g?this.currentUrlTree.fragment:d;let D=null;switch(p){case"merge":D=Object.assign(Object.assign({},this.currentUrlTree.queryParams),l);break;case"preserve":D=this.currentUrlTree.queryParams;break;default:D=l||null}return null!==D&&(D=this.removeEmptyProps(D)),function j2(t,e,i,r,o){if(0===i.length)return WM(e.root,e.root,e.root,r,o);const l=function $2(t){if("string"==typeof t[0]&&1===t.length&&"/"===t[0])return new gA(!0,0,t);let e=0,i=!1;const r=t.reduce((o,l,d)=>{if("object"==typeof l&&null!=l){if(l.outlets){const p={};return Ui(l.outlets,(g,x)=>{p[x]="string"==typeof g?g.split("/"):g}),[...o,{outlets:p}]}if(l.segmentPath)return[...o,l.segmentPath]}return"string"!=typeof l?[...o,l]:0===d?(l.split("/").forEach((p,g)=>{0==g&&"."===p||(0==g&&""===p?i=!0:".."===p?e++:""!=p&&o.push(p))}),o):[...o,l]},[]);return new gA(i,e,r)}(i);if(l.toRoot())return WM(e.root,e.root,new zt([],{}),r,o);const d=function q2(t,e,i){if(t.isAbsolute)return new jM(e.root,!0,0);if(-1===i.snapshot._lastPathIndex){const l=i.snapshot._urlSegment;return new jM(l,l===e.root,0)}const r=l_(t.commands[0])?0:1;return function X2(t,e,i){let r=t,o=e,l=i;for(;l>o;){if(l-=o,r=r.parent,!r)throw new Error("Invalid number of '../'");o=r.segments.length}return new jM(r,!1,o-l)}(i.snapshot._urlSegment,i.snapshot._lastPathIndex+r,t.numberOfDoubleDots)}(l,e,t),p=d.processChildren?c_(d.segmentGroup,d.index,l.commands):yA(d.segmentGroup,d.index,l.commands);return WM(e.root,d.segmentGroup,p,r,o)}(x,this.currentUrlTree,i,D,null!=T?T:null)}navigateByUrl(i,r={skipLocationChange:!1}){const o=ju(i)?i:this.parseUrl(i),l=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(l,"imperative",null,r)}navigate(i,r={skipLocationChange:!1}){return function J3(t){for(let e=0;e<t.length;e++){const i=t[e];if(null==i)throw new Error(`The requested path contains ${i} segment at index ${e}`)}}(i),this.navigateByUrl(this.createUrlTree(i,r),r)}serializeUrl(i){return this.urlSerializer.serialize(i)}parseUrl(i){let r;try{r=this.urlSerializer.parse(i)}catch(o){r=this.malformedUriErrorHandler(o,this.urlSerializer,i)}return r}isActive(i,r){let o;if(o=!0===r?Object.assign({},Q3):!1===r?Object.assign({},K3):r,ju(i))return eA(this.currentUrlTree,i,o);const l=this.parseUrl(i);return eA(this.currentUrlTree,l,o)}removeEmptyProps(i){return Object.keys(i).reduce((r,o)=>{const l=i[o];return null!=l&&(r[o]=l),r},{})}processNavigations(){this.navigations.subscribe(i=>{this.navigated=!0,this.lastSuccessfulId=i.id,this.currentPageId=i.targetPageId,this.events.next(new Oh(i.id,this.serializeUrl(i.extractedUrl),this.serializeUrl(this.currentUrlTree))),this.lastSuccessfulNavigation=this.currentNavigation,i.resolve(!0)},i=>{this.console.warn(`Unhandled Navigation Error: ${i}`)})}scheduleNavigation(i,r,o,l,d){var p,g;if(this.disposed)return Promise.resolve(!1);let x,T,D;d?(x=d.resolve,T=d.reject,D=d.promise):D=new Promise((z,Z)=>{x=z,T=Z});const P=++this.navigationId;let B;return"computed"===this.canceledNavigationResolution?(0===this.currentPageId&&(o=this.location.getState()),B=o&&o.\u0275routerPageId?o.\u0275routerPageId:l.replaceUrl||l.skipLocationChange?null!==(p=this.browserPageId)&&void 0!==p?p:0:(null!==(g=this.browserPageId)&&void 0!==g?g:0)+1):B=0,this.setTransition({id:P,targetPageId:B,source:r,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.rawUrlTree,rawUrl:i,extras:l,resolve:x,reject:T,promise:D,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),D.catch(z=>Promise.reject(z))}setBrowserUrl(i,r){const o=this.urlSerializer.serialize(i),l=Object.assign(Object.assign({},r.extras.state),this.generateNgRouterState(r.id,r.targetPageId));this.location.isCurrentPathEqualTo(o)||r.extras.replaceUrl?this.location.replaceState(o,"",l):this.location.go(o,"",l)}restoreHistory(i,r=!1){var o,l;if("computed"===this.canceledNavigationResolution){const d=this.currentPageId-i.targetPageId;"popstate"!==i.source&&"eager"!==this.urlUpdateStrategy&&this.currentUrlTree!==(null===(o=this.currentNavigation)||void 0===o?void 0:o.finalUrl)||0===d?this.currentUrlTree===(null===(l=this.currentNavigation)||void 0===l?void 0:l.finalUrl)&&0===d&&(this.resetState(i),this.browserUrlTree=i.currentUrlTree,this.resetUrlToCurrentUrlTree()):this.location.historyGo(d)}else"replace"===this.canceledNavigationResolution&&(r&&this.resetState(i),this.resetUrlToCurrentUrlTree())}resetState(i){this.routerState=i.currentRouterState,this.currentUrlTree=i.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,i.rawUrl)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}cancelNavigationTransition(i,r){const o=new jD(i.id,this.serializeUrl(i.extractedUrl),r);this.triggerEvent(o),i.resolve(!1)}generateNgRouterState(i,r){return"computed"===this.canceledNavigationResolution?{navigationId:i,\u0275routerPageId:r}:{navigationId:i}}}return t.\u0275fac=function(i){Wl()},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function UA(t){return"imperative"!==t}class HA{}class VA{preload(e,i){return Dt(null)}}let zA=(()=>{class t{constructor(i,r,o,l){this.router=i,this.injector=o,this.preloadingStrategy=l,this.loader=new kA(o,r,g=>i.triggerEvent(new $D(g)),g=>i.triggerEvent(new qD(g)))}setUpPreloading(){this.subscription=this.router.events.pipe(Fh(i=>i instanceof Oh),dm(()=>this.preload())).subscribe(()=>{})}preload(){const i=this.injector.get(Da);return this.processRoutes(i,this.router.config)}ngOnDestroy(){this.subscription&&this.subscription.unsubscribe()}processRoutes(i,r){const o=[];for(const l of r)if(l.loadChildren&&!l.canLoad&&l._loadedConfig){const d=l._loadedConfig;o.push(this.processRoutes(d.module,d.routes))}else l.loadChildren&&!l.canLoad?o.push(this.preloadConfig(i,l)):l.children&&o.push(this.processRoutes(i,l.children));return di(o).pipe(Ir(),nn(l=>{}))}preloadConfig(i,r){return this.preloadingStrategy.preload(r,()=>(r._loadedConfig?Dt(r._loadedConfig):this.loader.load(i.injector,r)).pipe(ui(l=>(r._loadedConfig=l,this.processRoutes(l.module,l.routes)))))}}return t.\u0275fac=function(i){return new(i||t)(Ee(Tr),Ee(mT),Ee(mi),Ee(HA))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})(),eE=(()=>{class t{constructor(i,r,o={}){this.router=i,this.viewportScroller=r,this.options=o,this.lastId=0,this.lastSource="imperative",this.restoredId=0,this.store={},o.scrollPositionRestoration=o.scrollPositionRestoration||"disabled",o.anchorScrolling=o.anchorScrolling||"disabled"}init(){"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.setHistoryScrollRestoration("manual"),this.routerEventsSubscription=this.createScrollEvents(),this.scrollEventsSubscription=this.consumeScrollEvents()}createScrollEvents(){return this.router.events.subscribe(i=>{i instanceof OM?(this.store[this.lastId]=this.viewportScroller.getScrollPosition(),this.lastSource=i.navigationTrigger,this.restoredId=i.restoredState?i.restoredState.navigationId:0):i instanceof Oh&&(this.lastId=i.id,this.scheduleScrollEvent(i,this.router.parseUrl(i.urlAfterRedirects).fragment))})}consumeScrollEvents(){return this.router.events.subscribe(i=>{i instanceof XD&&(i.position?"top"===this.options.scrollPositionRestoration?this.viewportScroller.scrollToPosition([0,0]):"enabled"===this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition(i.position):i.anchor&&"enabled"===this.options.anchorScrolling?this.viewportScroller.scrollToAnchor(i.anchor):"disabled"!==this.options.scrollPositionRestoration&&this.viewportScroller.scrollToPosition([0,0]))})}scheduleScrollEvent(i,r){this.router.triggerEvent(new XD(i,"popstate"===this.lastSource?this.store[this.restoredId]:null,r))}ngOnDestroy(){this.routerEventsSubscription&&this.routerEventsSubscription.unsubscribe(),this.scrollEventsSubscription&&this.scrollEventsSubscription.unsubscribe()}}return t.\u0275fac=function(i){Wl()},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();const $u=new ze("ROUTER_CONFIGURATION"),GA=new ze("ROUTER_FORROOT_GUARD"),ik=[Tb,{provide:rA,useClass:sA},{provide:Tr,useFactory:function lk(t,e,i,r,o,l,d={},p,g){const x=new Tr(null,t,e,i,r,o,QD(l));return p&&(x.urlHandlingStrategy=p),g&&(x.routeReuseStrategy=g),function ck(t,e){t.errorHandler&&(e.errorHandler=t.errorHandler),t.malformedUriErrorHandler&&(e.malformedUriErrorHandler=t.malformedUriErrorHandler),t.onSameUrlNavigation&&(e.onSameUrlNavigation=t.onSameUrlNavigation),t.paramsInheritanceStrategy&&(e.paramsInheritanceStrategy=t.paramsInheritanceStrategy),t.relativeLinkResolution&&(e.relativeLinkResolution=t.relativeLinkResolution),t.urlUpdateStrategy&&(e.urlUpdateStrategy=t.urlUpdateStrategy),t.canceledNavigationResolution&&(e.canceledNavigationResolution=t.canceledNavigationResolution)}(d,x),d.enableTracing&&x.events.subscribe(T=>{var D,P;null===(D=console.group)||void 0===D||D.call(console,`Router Event: ${T.constructor.name}`),console.log(T.toString()),console.log(T),null===(P=console.groupEnd)||void 0===P||P.call(console)}),x},deps:[rA,vm,Tb,mi,mT,QM,$u,[class q3{},new Eo],[class W3{},new Eo]]},vm,{provide:Uh,useFactory:function uk(t){return t.routerState.root},deps:[Tr]},zA,VA,class nk{preload(e,i){return i().pipe(Jl(()=>Dt(null)))}},{provide:$u,useValue:{enableTracing:!1}}];function rk(){return new xT("Router",Tr)}let WA=(()=>{class t{constructor(i,r){}static forRoot(i,r){return{ngModule:t,providers:[ik,jA(i),{provide:GA,useFactory:ak,deps:[[Tr,new Eo,new Oc]]},{provide:$u,useValue:r||{}},{provide:Rh,useFactory:ok,deps:[ku,[new Nc(Sb),new Eo],$u]},{provide:eE,useFactory:sk,deps:[Tr,fL,$u]},{provide:HA,useExisting:r&&r.preloadingStrategy?r.preloadingStrategy:VA},{provide:xT,multi:!0,useFactory:rk},[tE,{provide:lb,multi:!0,useFactory:dk,deps:[tE]},{provide:$A,useFactory:hk,deps:[tE]},{provide:fT,multi:!0,useExisting:$A}]]}}static forChild(i){return{ngModule:t,providers:[jA(i)]}}}return t.\u0275fac=function(i){return new(i||t)(Ee(GA,8),Ee(Tr,8))},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({}),t})();function sk(t,e,i){return i.scrollOffset&&e.setOffset(i.scrollOffset),new eE(t,e,i)}function ok(t,e,i={}){return i.useHash?new $I(t,e):new HT(t,e)}function ak(t){return"guarded"}function jA(t){return[{provide:s0,multi:!0,useValue:t},{provide:QM,multi:!0,useValue:t}]}let tE=(()=>{class t{constructor(i){this.injector=i,this.initNavigation=!1,this.destroyed=!1,this.resultOfPreactivationDone=new Ri}appInitializer(){return this.injector.get(GI,Promise.resolve(null)).then(()=>{if(this.destroyed)return Promise.resolve(!0);let r=null;const o=new Promise(p=>r=p),l=this.injector.get(Tr),d=this.injector.get($u);return"disabled"===d.initialNavigation?(l.setUpLocationChangeListener(),r(!0)):"enabled"===d.initialNavigation||"enabledBlocking"===d.initialNavigation?(l.hooks.afterPreactivation=()=>this.initNavigation?Dt(null):(this.initNavigation=!0,r(!0),this.resultOfPreactivationDone),l.initialNavigation()):r(!0),o})}bootstrapListener(i){const r=this.injector.get($u),o=this.injector.get(zA),l=this.injector.get(eE),d=this.injector.get(Tr),p=this.injector.get(yb);i===p.components[0]&&(("enabledNonBlocking"===r.initialNavigation||void 0===r.initialNavigation)&&d.initialNavigation(),o.setUpPreloading(),l.init(),d.resetRootComponentType(p.componentTypes[0]),this.resultOfPreactivationDone.next(null),this.resultOfPreactivationDone.complete())}ngOnDestroy(){this.destroyed=!0}}return t.\u0275fac=function(i){return new(i||t)(Ee(mi))},t.\u0275prov=at({token:t,factory:t.\u0275fac}),t})();function dk(t){return t.appInitializer.bind(t)}function hk(t){return t.bootstrapListener.bind(t)}const $A=new ze("Router Initializer");var qA=Mi(239);const pk={motto:{name:"motto",value:"Hi!"},order:{name:"",value:[0,1,2,3,4,5,6,7,8,9]},alphaber:{name:"",value:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","W","V","X","Y","Z"]},location:{name:"location",value:["Kyiv, Ukraine"]},experience:{name:"experience",value:"10+"},started:{name:"started",value:2012},companies:{name:"",value:[{name:"[ , Luxoft (2021, 2022) ]",years:[]}]},technologies:{name:"technologies",value:[{value:"JavaScript",fs:12},{value:"Canvas",fs:16},{value:"TypeScript",fs:12},{value:"Node.js",fs:15},{value:"Docker",fs:16}]},services:{},contacts:{name:"contacts",value:[{name:"telegram",value:"@nnnnndnt"}]}};var mk=Mi(560);const yk=(0,Mi(384).fo)("Geolocation",{web:()=>Mi.e(384).then(Mi.bind(Mi,215)).then(t=>new t.GeolocationWeb)});let vk=(()=>{class t{constructor(){var i=this;this.onGet=function(){var r=(0,qA.Z)(function*(o){try{const l=yield Mi.e(309).then(Mi.bind(Mi,309));i.module=l.createInstance({canvas:o}),i.module.draw()}catch(l){console.warn("._ crashed",l)}});return function(o){return r.apply(this,arguments)}}()}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function _k(t,e){1&t&&bh(0,"div")}function xk(t,e){1&t&&bh(0,"canvas",3)(1,"div",4),2&t&&xn("viewRef",Wp().canvasService.onGet)}function wk(t,e){}let bk=(()=>{class t{constructor(i){this.ref=i,this.onElementGet=()=>{}}ngAfterViewInit(){this.onElementGet(this.ref.nativeElement)}}return t.\u0275fac=function(i){return new(i||t)(We(Ca))},t.\u0275dir=Jn({type:t,selectors:[["","viewRef",""]],inputs:{onElementGet:["viewRef","onElementGet"]}}),t})(),Mk=(()=>{class t{constructor(){this.emitChangeSource=new Xi,this.prop=this.emitChangeSource.asObservable()}emitChange(i){this.emitChangeSource.next(i)}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),nE=(()=>{class t{constructor(){this.data=pk}}return t.\u0275fac=function(i){return new(i||t)},t.\u0275prov=at({token:t,factory:t.\u0275fac,providedIn:"root"}),t})(),Ek=(()=>{class t{constructor(i,r,o,l,d){this.communicationService=i,this.canvasService=r,this.dataService=o,this.routeService=l,this.titleService=d,this.language="en",this.time=Date.now(),this.links=[],this.title="hot3dsoftwaresolutions",this.keys=Object.keys(mk.Ilk.NAMES),this.isOpened=!0,this.communicationService.prop.subscribe(p=>{}),this.routeService.events.subscribe(p=>{if(p instanceof Oh){const{url:g}=p,x=g.slice(1,g.length);this.titleService.setTitle(`${this.title} ${x&&"|"} ${x}`)}}),this.links=XA.map(({path:p})=>({name:p.slice(0,1)||".",path:p}))}ngOnInit(){Object.defineProperty(globalThis,"requestAnimationFrame",{value:window.requestAnimationFrame,writable:!1,configurable:!1})}ngAfterContentChecked(){}getCurrentPosition(){return(0,qA.Z)(function*(){return yield yk.getCurrentPosition()})()}}return t.\u0275fac=function(i){return new(i||t)(We(Mk),We(vk),We(nE),We(Tr),We(pC))},t.\u0275cmp=qa({type:t,selectors:[["app-root"]],decls:5,vars:3,consts:[[4,"ngIf","ngIfThen","ngIfElse"],["thenBlock",""],["elseBlock",""],[1,"webgl",3,"viewRef"],[1,"grid"]],template:function(i,r){if(1&i&&(Gl(0,_k,1,0,"div",0),Gl(1,xk,2,1,"ng-template",null,1,nb),Gl(3,wk,0,0,"ng-template",null,2,nb)),2&i){const o=Cu(2),l=Cu(4);xn("ngIf",r.isOpened)("ngIfThen",o)("ngIfElse",l)}},directives:[QT,bk],styles:["","[_nghost-%COMP%] {\n    font-family: -apple-system, BlinkMacSystemFont, Segoe UI, Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol';\n    font-size: 14px;\n    box-sizing: border-box;\n    -webkit-font-smoothing: antialiased;\n    -moz-osx-font-smoothing: grayscale;\n\n    display: flex;\n    min-height: 100%;\n    color: rgba(255, 255, 255, .5);\n  }\n\n  h1[_ngcontent-%COMP%], h2[_ngcontent-%COMP%], h3[_ngcontent-%COMP%], h4[_ngcontent-%COMP%], h5[_ngcontent-%COMP%], h6[_ngcontent-%COMP%] {\n    margin: 0;\n  }\n\n  p[_ngcontent-%COMP%] {\n    margin: 0;\n  }\n\n  .webgl[_ngcontent-%COMP%] {\n    position: fixed;\n    top: 0;\n    left: 0;\n    z-index: 1;\n  }\n\n  @media screen and (max-width: 1000px) {\n    \n  }"]}),t})(),Sk=(()=>{class t{constructor(i){this.dataSerice=i}ngOnInit(){this.data=this.dataSerice.data}}return t.\u0275fac=function(i){return new(i||t)(We(nE))},t.\u0275cmp=qa({type:t,selectors:[["app-conts"]],decls:3,vars:0,consts:[[1,"value"],["href","https://t.me/nnnnndnt","target","_blank",1,"addrs"]],template:function(i,r){1&i&&(Ks(0,"div",0)(1,"a",1),C(2," https://t.me/nnnnndnt "),Ru()())},styles:[""]}),t})(),Tk=(()=>{class t{constructor(i){this.dataSerice=i}ngOnInit(){this.data=this.dataSerice.data}}return t.\u0275fac=function(i){return new(i||t)(We(nE))},t.\u0275cmp=qa({type:t,selectors:[["app-loct"]],decls:4,vars:2,consts:[[1,"value"],[1,"name"]],template:function(i,r){1&i&&(Ks(0,"div",0),C(1),Ru(),Ks(2,"div",1),C(3),Ru()),2&i&&(Bd(1),S(" ",r.data.location.value," "),Bd(2),S(" ",r.data.location.name," "))},styles:[""]}),t})();const XA=[{path:"",component:Sk}],Ck=[...XA,{path:"**",component:Tk,redirectTo:""}];let Dk=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Lr({type:t}),t.\u0275inj=Pr({imports:[[WA.forRoot(Ck,{})],WA]}),t})(),Ak=(()=>{class t{}return t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=Lr({type:t,bootstrap:[Ek]}),t.\u0275inj=Pr({providers:[],imports:[[fC,Dk,XN,HO.forRoot({},{})]]}),t})();(function bI(){if(CT)throw new Error("Cannot enable prod mode after platform setup.");TT=!1})(),UL().bootstrapModule(Ak).catch(t=>console.error(t))},560:(Zu,Oa,Mi)=>{Mi.d(Oa,{$V:()=>KE,BVQ:()=>fu,CP7:()=>en,FM8:()=>he,Ilk:()=>Re,Kj0:()=>ii,M8C:()=>id,Pa4:()=>k,QmN:()=>Cr,RsA:()=>lo,SUY:()=>ba,WMw:()=>jo,YT8:()=>fp,ZAu:()=>Ur,_fP:()=>un,a$l:()=>Ve,b_z:()=>mu,cPb:()=>zn,dd2:()=>ti,dj0:()=>er,ehD:()=>co,fHI:()=>ga,iKG:()=>Cd,jFi:()=>Qi,jyz:()=>yr,lCJ:()=>gr,lRF:()=>Xc,mSO:()=>D_,nls:()=>si,pBf:()=>ia,rDY:()=>ig,u9r:()=>Ye,vBJ:()=>Vs,x12:()=>Co,xsS:()=>Kc,yGw:()=>$e});var it=Mi(239);const lo={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},Cr={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},co=2,Qi=0,jo=2,Gt=1001,Qt=1003,hn=1006,Jo=1009,za=1012,fo=1015,Ga=1016,ea=1020,Xn=1023,Ir=1026,zi=1027,Fs=2400,hi=2401,po=3e3,Tn=3001,D_=3201,Wt="srgb",ja="srgb-linear",cc=35044,er=35048;class ia{addEventListener(n,s){void 0===this._listeners&&(this._listeners={});const a=this._listeners;void 0===a[n]&&(a[n]=[]),-1===a[n].indexOf(s)&&a[n].push(s)}hasEventListener(n,s){if(void 0===this._listeners)return!1;const a=this._listeners;return void 0!==a[n]&&-1!==a[n].indexOf(s)}removeEventListener(n,s){if(void 0===this._listeners)return;const c=this._listeners[n];if(void 0!==c){const u=c.indexOf(s);-1!==u&&c.splice(u,1)}}dispatchEvent(n){if(void 0===this._listeners)return;const a=this._listeners[n.type];if(void 0!==a){n.target=this;const c=a.slice(0);for(let u=0,f=c.length;u<f;u++)c[u].call(this,n);n.target=null}}}const ft=[];for(let h=0;h<256;h++)ft[h]=(h<16?"0":"")+h.toString(16);let L_=1234567;const $a=Math.PI/180,as=180/Math.PI;function St(){const h=4294967295*Math.random()|0,n=4294967295*Math.random()|0,s=4294967295*Math.random()|0,a=4294967295*Math.random()|0;return(ft[255&h]+ft[h>>8&255]+ft[h>>16&255]+ft[h>>24&255]+"-"+ft[255&n]+ft[n>>8&255]+"-"+ft[n>>16&15|64]+ft[n>>24&255]+"-"+ft[63&s|128]+ft[s>>8&255]+"-"+ft[s>>16&255]+ft[s>>24&255]+ft[255&a]+ft[a>>8&255]+ft[a>>16&255]+ft[a>>24&255]).toLowerCase()}function wn(h,n,s){return Math.max(n,Math.min(s,h))}function uc(h,n){return(h%n+n)%n}function tr(h,n,s){return(1-s)*h+s*n}function Jn(h){return 0==(h&h-1)&&0!==h}function ei(h){return Math.pow(2,Math.floor(Math.log(h)/Math.LN2))}var id=Object.freeze({__proto__:null,DEG2RAD:$a,RAD2DEG:as,generateUUID:St,clamp:wn,euclideanModulo:uc,mapLinear:function sf(h,n,s,a,c){return a+(h-n)*(c-a)/(s-n)},inverseLerp:function Wm(h,n,s){return h!==n?(s-h)/(n-h):0},lerp:tr,damp:function dc(h,n,s,a){return tr(h,n,1-Math.exp(-s*a))},pingpong:function F_(h,n=1){return n-Math.abs(uc(h,2*n)-n)},smoothstep:function qa(h,n,s){return h<=n?0:h>=s?1:(h=(h-n)/(s-n))*h*(3-2*h)},smootherstep:function N_(h,n,s){return h<=n?0:h>=s?1:(h=(h-n)/(s-n))*h*h*(h*(6*h-15)+10)},randInt:function jm(h,n){return h+Math.floor(Math.random()*(n-h+1))},randFloat:function $m(h,n){return h+Math.random()*(n-h)},randFloatSpread:function qm(h){return h*(.5-Math.random())},seededRandom:function Lr(h){void 0!==h&&(L_=h);let n=L_+=1831565813;return n=Math.imul(n^n>>>15,1|n),n^=n+Math.imul(n^n>>>7,61|n),((n^n>>>14)>>>0)/4294967296},degToRad:function O_(h){return h*$a},radToDeg:function Xm(h){return h*as},isPowerOfTwo:Jn,ceilPowerOfTwo:function Pi(h){return Math.pow(2,Math.ceil(Math.log(h)/Math.LN2))},floorPowerOfTwo:ei,setQuaternionFromProperEuler:function mo(h,n,s,a,c){const u=Math.cos,f=Math.sin,m=u(s/2),y=f(s/2),v=u((n+a)/2),_=f((n+a)/2),w=u((n-a)/2),b=f((n-a)/2),M=u((a-n)/2),C=f((a-n)/2);switch(c){case"XYX":h.set(m*_,y*w,y*b,m*v);break;case"YZY":h.set(y*b,m*_,y*w,m*v);break;case"ZXZ":h.set(y*w,y*b,m*_,m*v);break;case"XZX":h.set(m*_,y*C,y*M,m*v);break;case"YXY":h.set(y*M,m*_,y*C,m*v);break;case"ZYZ":h.set(y*C,y*M,m*_,m*v);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+c)}},normalize:function pr(h,n){switch(n.constructor){case Float32Array:return h;case Uint16Array:return Math.round(65535*h);case Uint8Array:return Math.round(255*h);case Int16Array:return Math.round(32767*h);case Int8Array:return Math.round(127*h);default:throw new Error("Invalid component type.")}},denormalize:function ra(h,n){switch(n.constructor){case Float32Array:return h;case Uint16Array:return h/65535;case Uint8Array:return h/255;case Int16Array:return Math.max(h/32767,-1);case Int8Array:return Math.max(h/127,-1);default:throw new Error("Invalid component type.")}}});class he{constructor(n=0,s=0){this.x=n,this.y=s}get width(){return this.x}set width(n){this.x=n}get height(){return this.y}set height(n){this.y=n}set(n,s){return this.x=n,this.y=s,this}setScalar(n){return this.x=n,this.y=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setComponent(n,s){switch(n){case 0:this.x=s;break;case 1:this.y=s;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y)}copy(n){return this.x=n.x,this.y=n.y,this}add(n,s){return void 0!==s?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(n,s)):(this.x+=n.x,this.y+=n.y,this)}addScalar(n){return this.x+=n,this.y+=n,this}addVectors(n,s){return this.x=n.x+s.x,this.y=n.y+s.y,this}addScaledVector(n,s){return this.x+=n.x*s,this.y+=n.y*s,this}sub(n,s){return void 0!==s?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(n,s)):(this.x-=n.x,this.y-=n.y,this)}subScalar(n){return this.x-=n,this.y-=n,this}subVectors(n,s){return this.x=n.x-s.x,this.y=n.y-s.y,this}multiply(n){return this.x*=n.x,this.y*=n.y,this}multiplyScalar(n){return this.x*=n,this.y*=n,this}divide(n){return this.x/=n.x,this.y/=n.y,this}divideScalar(n){return this.multiplyScalar(1/n)}applyMatrix3(n){const s=this.x,a=this.y,c=n.elements;return this.x=c[0]*s+c[3]*a+c[6],this.y=c[1]*s+c[4]*a+c[7],this}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this}clamp(n,s){return this.x=Math.max(n.x,Math.min(s.x,this.x)),this.y=Math.max(n.y,Math.min(s.y,this.y)),this}clampScalar(n,s){return this.x=Math.max(n,Math.min(s,this.x)),this.y=Math.max(n,Math.min(s,this.y)),this}clampLength(n,s){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(n,Math.min(s,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(n){return this.x*n.x+this.y*n.y}cross(n){return this.x*n.y-this.y*n.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(n){return Math.sqrt(this.distanceToSquared(n))}distanceToSquared(n){const s=this.x-n.x,a=this.y-n.y;return s*s+a*a}manhattanDistanceTo(n){return Math.abs(this.x-n.x)+Math.abs(this.y-n.y)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,s){return this.x+=(n.x-this.x)*s,this.y+=(n.y-this.y)*s,this}lerpVectors(n,s,a){return this.x=n.x+(s.x-n.x)*a,this.y=n.y+(s.y-n.y)*a,this}equals(n){return n.x===this.x&&n.y===this.y}fromArray(n,s=0){return this.x=n[s],this.y=n[s+1],this}toArray(n=[],s=0){return n[s]=this.x,n[s+1]=this.y,n}fromBufferAttribute(n,s,a){return void 0!==a&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=n.getX(s),this.y=n.getY(s),this}rotateAround(n,s){const a=Math.cos(s),c=Math.sin(s),u=this.x-n.x,f=this.y-n.y;return this.x=u*a-f*c+n.x,this.y=u*c+f*a+n.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}he.prototype.isVector2=!0;class Pn{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(n,s,a,c,u,f,m,y,v){const _=this.elements;return _[0]=n,_[1]=c,_[2]=m,_[3]=s,_[4]=u,_[5]=y,_[6]=a,_[7]=f,_[8]=v,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(n){const s=this.elements,a=n.elements;return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],this}extractBasis(n,s,a){return n.setFromMatrix3Column(this,0),s.setFromMatrix3Column(this,1),a.setFromMatrix3Column(this,2),this}setFromMatrix4(n){const s=n.elements;return this.set(s[0],s[4],s[8],s[1],s[5],s[9],s[2],s[6],s[10]),this}multiply(n){return this.multiplyMatrices(this,n)}premultiply(n){return this.multiplyMatrices(n,this)}multiplyMatrices(n,s){const a=n.elements,c=s.elements,u=this.elements,f=a[0],m=a[3],y=a[6],v=a[1],_=a[4],w=a[7],b=a[2],M=a[5],C=a[8],E=c[0],S=c[3],A=c[6],R=c[1],F=c[4],I=c[7],O=c[2],V=c[5],W=c[8];return u[0]=f*E+m*R+y*O,u[3]=f*S+m*F+y*V,u[6]=f*A+m*I+y*W,u[1]=v*E+_*R+w*O,u[4]=v*S+_*F+w*V,u[7]=v*A+_*I+w*W,u[2]=b*E+M*R+C*O,u[5]=b*S+M*F+C*V,u[8]=b*A+M*I+C*W,this}multiplyScalar(n){const s=this.elements;return s[0]*=n,s[3]*=n,s[6]*=n,s[1]*=n,s[4]*=n,s[7]*=n,s[2]*=n,s[5]*=n,s[8]*=n,this}determinant(){const n=this.elements,s=n[0],a=n[1],c=n[2],u=n[3],f=n[4],m=n[5],y=n[6],v=n[7],_=n[8];return s*f*_-s*m*v-a*u*_+a*m*y+c*u*v-c*f*y}invert(){const n=this.elements,s=n[0],a=n[1],c=n[2],u=n[3],f=n[4],m=n[5],y=n[6],v=n[7],_=n[8],w=_*f-m*v,b=m*y-_*u,M=v*u-f*y,C=s*w+a*b+c*M;if(0===C)return this.set(0,0,0,0,0,0,0,0,0);const E=1/C;return n[0]=w*E,n[1]=(c*v-_*a)*E,n[2]=(m*a-c*f)*E,n[3]=b*E,n[4]=(_*s-c*y)*E,n[5]=(c*u-m*s)*E,n[6]=M*E,n[7]=(a*y-v*s)*E,n[8]=(f*s-a*u)*E,this}transpose(){let n;const s=this.elements;return n=s[1],s[1]=s[3],s[3]=n,n=s[2],s[2]=s[6],s[6]=n,n=s[5],s[5]=s[7],s[7]=n,this}getNormalMatrix(n){return this.setFromMatrix4(n).invert().transpose()}transposeIntoArray(n){const s=this.elements;return n[0]=s[0],n[1]=s[3],n[2]=s[6],n[3]=s[1],n[4]=s[4],n[5]=s[7],n[6]=s[2],n[7]=s[5],n[8]=s[8],this}setUvTransform(n,s,a,c,u,f,m){const y=Math.cos(u),v=Math.sin(u);return this.set(a*y,a*v,-a*(y*f+v*m)+f+n,-c*v,c*y,-c*(-v*f+y*m)+m+s,0,0,1),this}scale(n,s){const a=this.elements;return a[0]*=n,a[3]*=n,a[6]*=n,a[1]*=s,a[4]*=s,a[7]*=s,this}rotate(n){const s=Math.cos(n),a=Math.sin(n),c=this.elements,u=c[0],f=c[3],m=c[6],y=c[1],v=c[4],_=c[7];return c[0]=s*u+a*y,c[3]=s*f+a*v,c[6]=s*m+a*_,c[1]=-a*u+s*y,c[4]=-a*f+s*v,c[7]=-a*m+s*_,this}translate(n,s){const a=this.elements;return a[0]+=n*a[2],a[3]+=n*a[5],a[6]+=n*a[8],a[1]+=s*a[2],a[4]+=s*a[5],a[7]+=s*a[8],this}equals(n){const s=this.elements,a=n.elements;for(let c=0;c<9;c++)if(s[c]!==a[c])return!1;return!0}fromArray(n,s=0){for(let a=0;a<9;a++)this.elements[a]=n[a+s];return this}toArray(n=[],s=0){const a=this.elements;return n[s]=a[0],n[s+1]=a[1],n[s+2]=a[2],n[s+3]=a[3],n[s+4]=a[4],n[s+5]=a[5],n[s+6]=a[6],n[s+7]=a[7],n[s+8]=a[8],n}clone(){return(new this.constructor).fromArray(this.elements)}}function hc(h){for(let n=h.length-1;n>=0;--n)if(h[n]>65535)return!0;return!1}function fc(h){return document.createElementNS("http://www.w3.org/1999/xhtml",h)}function fi(h){return h<.04045?.0773993808*h:Math.pow(.9478672986*h+.0521327014,2.4)}function Ae(h){return h<.0031308?12.92*h:1.055*Math.pow(h,.41666)-.055}Pn.prototype.isMatrix3=!0,Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;const Mt={[Wt]:{[ja]:fi},[ja]:{[Wt]:Ae}},Ut={legacyMode:!0,get workingColorSpace(){return ja},set workingColorSpace(h){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(h,n,s){if(this.legacyMode||n===s||!n||!s)return h;if(Mt[n]&&void 0!==Mt[n][s]){const a=Mt[n][s];return h.r=a(h.r),h.g=a(h.g),h.b=a(h.b),h}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(h,n){return this.convert(h,this.workingColorSpace,n)},toWorkingColorSpace:function(h,n){return this.convert(h,n,this.workingColorSpace)}},Gi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},vn={r:0,g:0,b:0},an={h:0,s:0,l:0},ls={h:0,s:0,l:0};function Cn(h,n,s){return s<0&&(s+=1),s>1&&(s-=1),s<1/6?h+6*(n-h)*s:s<.5?n:s<2/3?h+6*(n-h)*(2/3-s):h}function go(h,n){return n.r=h.r,n.g=h.g,n.b=h.b,n}let lt,Re=(()=>{class h{constructor(s,a,c){return void 0===a&&void 0===c?this.set(s):this.setRGB(s,a,c)}set(s){return s&&s.isColor?this.copy(s):"number"==typeof s?this.setHex(s):"string"==typeof s&&this.setStyle(s),this}setScalar(s){return this.r=s,this.g=s,this.b=s,this}setHex(s,a=Wt){return s=Math.floor(s),this.r=(s>>16&255)/255,this.g=(s>>8&255)/255,this.b=(255&s)/255,Ut.toWorkingColorSpace(this,a),this}setRGB(s,a,c,u=ja){return this.r=s,this.g=a,this.b=c,Ut.toWorkingColorSpace(this,u),this}setHSL(s,a,c,u=ja){if(s=uc(s,1),a=wn(a,0,1),c=wn(c,0,1),0===a)this.r=this.g=this.b=c;else{const f=c<=.5?c*(1+a):c+a-c*a,m=2*c-f;this.r=Cn(m,f,s+1/3),this.g=Cn(m,f,s),this.b=Cn(m,f,s-1/3)}return Ut.toWorkingColorSpace(this,u),this}setStyle(s,a=Wt){function c(f){void 0!==f&&parseFloat(f)<1&&console.warn("THREE.Color: Alpha component of "+s+" will be ignored.")}let u;if(u=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(s)){let f;const y=u[2];switch(u[1]){case"rgb":case"rgba":if(f=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(y))return this.r=Math.min(255,parseInt(f[1],10))/255,this.g=Math.min(255,parseInt(f[2],10))/255,this.b=Math.min(255,parseInt(f[3],10))/255,Ut.toWorkingColorSpace(this,a),c(f[4]),this;if(f=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(y))return this.r=Math.min(100,parseInt(f[1],10))/100,this.g=Math.min(100,parseInt(f[2],10))/100,this.b=Math.min(100,parseInt(f[3],10))/100,Ut.toWorkingColorSpace(this,a),c(f[4]),this;break;case"hsl":case"hsla":if(f=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(y)){const v=parseFloat(f[1])/360,_=parseInt(f[2],10)/100,w=parseInt(f[3],10)/100;return c(f[4]),this.setHSL(v,_,w,a)}}}else if(u=/^\#([A-Fa-f\d]+)$/.exec(s)){const f=u[1],m=f.length;if(3===m)return this.r=parseInt(f.charAt(0)+f.charAt(0),16)/255,this.g=parseInt(f.charAt(1)+f.charAt(1),16)/255,this.b=parseInt(f.charAt(2)+f.charAt(2),16)/255,Ut.toWorkingColorSpace(this,a),this;if(6===m)return this.r=parseInt(f.charAt(0)+f.charAt(1),16)/255,this.g=parseInt(f.charAt(2)+f.charAt(3),16)/255,this.b=parseInt(f.charAt(4)+f.charAt(5),16)/255,Ut.toWorkingColorSpace(this,a),this}return s&&s.length>0?this.setColorName(s,a):this}setColorName(s,a=Wt){const c=Gi[s.toLowerCase()];return void 0!==c?this.setHex(c,a):console.warn("THREE.Color: Unknown color "+s),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(s){return this.r=s.r,this.g=s.g,this.b=s.b,this}copySRGBToLinear(s){return this.r=fi(s.r),this.g=fi(s.g),this.b=fi(s.b),this}copyLinearToSRGB(s){return this.r=Ae(s.r),this.g=Ae(s.g),this.b=Ae(s.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(s=Wt){return Ut.fromWorkingColorSpace(go(this,vn),s),wn(255*vn.r,0,255)<<16^wn(255*vn.g,0,255)<<8^wn(255*vn.b,0,255)<<0}getHexString(s=Wt){return("000000"+this.getHex(s).toString(16)).slice(-6)}getHSL(s,a=ja){Ut.fromWorkingColorSpace(go(this,vn),a);const c=vn.r,u=vn.g,f=vn.b,m=Math.max(c,u,f),y=Math.min(c,u,f);let v,_;const w=(y+m)/2;if(y===m)v=0,_=0;else{const b=m-y;switch(_=w<=.5?b/(m+y):b/(2-m-y),m){case c:v=(u-f)/b+(u<f?6:0);break;case u:v=(f-c)/b+2;break;case f:v=(c-u)/b+4}v/=6}return s.h=v,s.s=_,s.l=w,s}getRGB(s,a=ja){return Ut.fromWorkingColorSpace(go(this,vn),a),s.r=vn.r,s.g=vn.g,s.b=vn.b,s}getStyle(s=Wt){return Ut.fromWorkingColorSpace(go(this,vn),s),s!==Wt?`color(${s} ${vn.r} ${vn.g} ${vn.b})`:`rgb(${255*vn.r|0},${255*vn.g|0},${255*vn.b|0})`}offsetHSL(s,a,c){return this.getHSL(an),an.h+=s,an.s+=a,an.l+=c,this.setHSL(an.h,an.s,an.l),this}add(s){return this.r+=s.r,this.g+=s.g,this.b+=s.b,this}addColors(s,a){return this.r=s.r+a.r,this.g=s.g+a.g,this.b=s.b+a.b,this}addScalar(s){return this.r+=s,this.g+=s,this.b+=s,this}sub(s){return this.r=Math.max(0,this.r-s.r),this.g=Math.max(0,this.g-s.g),this.b=Math.max(0,this.b-s.b),this}multiply(s){return this.r*=s.r,this.g*=s.g,this.b*=s.b,this}multiplyScalar(s){return this.r*=s,this.g*=s,this.b*=s,this}lerp(s,a){return this.r+=(s.r-this.r)*a,this.g+=(s.g-this.g)*a,this.b+=(s.b-this.b)*a,this}lerpColors(s,a,c){return this.r=s.r+(a.r-s.r)*c,this.g=s.g+(a.g-s.g)*c,this.b=s.b+(a.b-s.b)*c,this}lerpHSL(s,a){this.getHSL(an),s.getHSL(ls);const c=tr(an.h,ls.h,a),u=tr(an.s,ls.s,a),f=tr(an.l,ls.l,a);return this.setHSL(c,u,f),this}equals(s){return s.r===this.r&&s.g===this.g&&s.b===this.b}fromArray(s,a=0){return this.r=s[a],this.g=s[a+1],this.b=s[a+2],this}toArray(s=[],a=0){return s[a]=this.r,s[a+1]=this.g,s[a+2]=this.b,s}fromBufferAttribute(s,a){return this.r=s.getX(a),this.g=s.getY(a),this.b=s.getZ(a),!0===s.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}return h.NAMES=Gi,h})();Re.prototype.isColor=!0,Re.prototype.r=1,Re.prototype.g=1,Re.prototype.b=1;class cs{static getDataURL(n){if(/^data:/i.test(n.src)||"undefined"==typeof HTMLCanvasElement)return n.src;let s;if(n instanceof HTMLCanvasElement)s=n;else{void 0===lt&&(lt=fc("canvas")),lt.width=n.width,lt.height=n.height;const a=lt.getContext("2d");n instanceof ImageData?a.putImageData(n,0,0):a.drawImage(n,0,0,n.width,n.height),s=lt}return s.width>2048||s.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",n),s.toDataURL("image/jpeg",.6)):s.toDataURL("image/png")}static sRGBToLinear(n){if("undefined"!=typeof HTMLImageElement&&n instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&n instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&n instanceof ImageBitmap){const s=fc("canvas");s.width=n.width,s.height=n.height;const a=s.getContext("2d");a.drawImage(n,0,0,n.width,n.height);const c=a.getImageData(0,0,n.width,n.height),u=c.data;for(let f=0;f<u.length;f++)u[f]=255*fi(u[f]/255);return a.putImageData(c,0,0),s}if(n.data){const s=n.data.slice(0);for(let a=0;a<s.length;a++)s[a]=s instanceof Uint8Array||s instanceof Uint8ClampedArray?Math.floor(255*fi(s[a]/255)):fi(s[a]);return{data:s,width:n.width,height:n.height}}return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),n}}class Fr{constructor(n=null){this.uuid=St(),this.data=n,this.version=0}set needsUpdate(n){!0===n&&this.version++}toJSON(n){const s=void 0===n||"string"==typeof n;if(!s&&void 0!==n.images[this.uuid])return n.images[this.uuid];const a={uuid:this.uuid,url:""},c=this.data;if(null!==c){let u;if(Array.isArray(c)){u=[];for(let f=0,m=c.length;f<m;f++)u.push(pc(c[f].isDataTexture?c[f].image:c[f]))}else u=pc(c);a.url=u}return s||(n.images[this.uuid]=a),a}}function pc(h){return"undefined"!=typeof HTMLImageElement&&h instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&h instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&h instanceof ImageBitmap?cs.getDataURL(h):h.data?{data:Array.prototype.slice.call(h.data),width:h.width,height:h.height,type:h.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Fr.prototype.isSource=!0;let Xa=0,cn=(()=>{class h extends ia{constructor(s=h.DEFAULT_IMAGE,a=h.DEFAULT_MAPPING,c=Gt,u=Gt,f=hn,m=1008,y=Xn,v=Jo,_=1,w=po){super(),Object.defineProperty(this,"id",{value:Xa++}),this.uuid=St(),this.name="",this.source=new Fr(s),this.mipmaps=[],this.mapping=a,this.wrapS=c,this.wrapT=u,this.magFilter=f,this.minFilter=m,this.anisotropy=_,this.format=y,this.internalFormat=null,this.type=v,this.offset=new he(0,0),this.repeat=new he(1,1),this.center=new he(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pn,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=w,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(s){this.source.data=s}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return(new this.constructor).copy(this)}copy(s){return this.name=s.name,this.source=s.source,this.mipmaps=s.mipmaps.slice(0),this.mapping=s.mapping,this.wrapS=s.wrapS,this.wrapT=s.wrapT,this.magFilter=s.magFilter,this.minFilter=s.minFilter,this.anisotropy=s.anisotropy,this.format=s.format,this.internalFormat=s.internalFormat,this.type=s.type,this.offset.copy(s.offset),this.repeat.copy(s.repeat),this.center.copy(s.center),this.rotation=s.rotation,this.matrixAutoUpdate=s.matrixAutoUpdate,this.matrix.copy(s.matrix),this.generateMipmaps=s.generateMipmaps,this.premultiplyAlpha=s.premultiplyAlpha,this.flipY=s.flipY,this.unpackAlignment=s.unpackAlignment,this.encoding=s.encoding,this.userData=JSON.parse(JSON.stringify(s.userData)),this.needsUpdate=!0,this}toJSON(s){const a=void 0===s||"string"==typeof s;if(!a&&void 0!==s.textures[this.uuid])return s.textures[this.uuid];const c={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(s).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return"{}"!==JSON.stringify(this.userData)&&(c.userData=this.userData),a||(s.textures[this.uuid]=c),c}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(s){if(300!==this.mapping)return s;if(s.applyMatrix3(this.matrix),s.x<0||s.x>1)switch(this.wrapS){case 1e3:s.x=s.x-Math.floor(s.x);break;case Gt:s.x=s.x<0?0:1;break;case 1002:s.x=1===Math.abs(Math.floor(s.x)%2)?Math.ceil(s.x)-s.x:s.x-Math.floor(s.x)}if(s.y<0||s.y>1)switch(this.wrapT){case 1e3:s.y=s.y-Math.floor(s.y);break;case Gt:s.y=s.y<0?0:1;break;case 1002:s.y=1===Math.abs(Math.floor(s.y)%2)?Math.ceil(s.y)-s.y:s.y-Math.floor(s.y)}return this.flipY&&(s.y=1-s.y),s}set needsUpdate(s){!0===s&&(this.version++,this.source.needsUpdate=!0)}}return h.DEFAULT_IMAGE=null,h.DEFAULT_MAPPING=300,h})();cn.prototype.isTexture=!0;class jt{constructor(n=0,s=0,a=0,c=1){this.x=n,this.y=s,this.z=a,this.w=c}get width(){return this.z}set width(n){this.z=n}get height(){return this.w}set height(n){this.w=n}set(n,s,a,c){return this.x=n,this.y=s,this.z=a,this.w=c,this}setScalar(n){return this.x=n,this.y=n,this.z=n,this.w=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setZ(n){return this.z=n,this}setW(n){return this.w=n,this}setComponent(n,s){switch(n){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;case 3:this.w=s;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(n){return this.x=n.x,this.y=n.y,this.z=n.z,this.w=void 0!==n.w?n.w:1,this}add(n,s){return void 0!==s?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(n,s)):(this.x+=n.x,this.y+=n.y,this.z+=n.z,this.w+=n.w,this)}addScalar(n){return this.x+=n,this.y+=n,this.z+=n,this.w+=n,this}addVectors(n,s){return this.x=n.x+s.x,this.y=n.y+s.y,this.z=n.z+s.z,this.w=n.w+s.w,this}addScaledVector(n,s){return this.x+=n.x*s,this.y+=n.y*s,this.z+=n.z*s,this.w+=n.w*s,this}sub(n,s){return void 0!==s?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(n,s)):(this.x-=n.x,this.y-=n.y,this.z-=n.z,this.w-=n.w,this)}subScalar(n){return this.x-=n,this.y-=n,this.z-=n,this.w-=n,this}subVectors(n,s){return this.x=n.x-s.x,this.y=n.y-s.y,this.z=n.z-s.z,this.w=n.w-s.w,this}multiply(n){return this.x*=n.x,this.y*=n.y,this.z*=n.z,this.w*=n.w,this}multiplyScalar(n){return this.x*=n,this.y*=n,this.z*=n,this.w*=n,this}applyMatrix4(n){const s=this.x,a=this.y,c=this.z,u=this.w,f=n.elements;return this.x=f[0]*s+f[4]*a+f[8]*c+f[12]*u,this.y=f[1]*s+f[5]*a+f[9]*c+f[13]*u,this.z=f[2]*s+f[6]*a+f[10]*c+f[14]*u,this.w=f[3]*s+f[7]*a+f[11]*c+f[15]*u,this}divideScalar(n){return this.multiplyScalar(1/n)}setAxisAngleFromQuaternion(n){this.w=2*Math.acos(n.w);const s=Math.sqrt(1-n.w*n.w);return s<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=n.x/s,this.y=n.y/s,this.z=n.z/s),this}setAxisAngleFromRotationMatrix(n){let s,a,c,u;const y=n.elements,v=y[0],_=y[4],w=y[8],b=y[1],M=y[5],C=y[9],E=y[2],S=y[6],A=y[10];if(Math.abs(_-b)<.01&&Math.abs(w-E)<.01&&Math.abs(C-S)<.01){if(Math.abs(_+b)<.1&&Math.abs(w+E)<.1&&Math.abs(C+S)<.1&&Math.abs(v+M+A-3)<.1)return this.set(1,0,0,0),this;s=Math.PI;const F=(v+1)/2,I=(M+1)/2,O=(A+1)/2,V=(_+b)/4,W=(w+E)/4,$=(C+S)/4;return F>I&&F>O?F<.01?(a=0,c=.707106781,u=.707106781):(a=Math.sqrt(F),c=V/a,u=W/a):I>O?I<.01?(a=.707106781,c=0,u=.707106781):(c=Math.sqrt(I),a=V/c,u=$/c):O<.01?(a=.707106781,c=.707106781,u=0):(u=Math.sqrt(O),a=W/u,c=$/u),this.set(a,c,u,s),this}let R=Math.sqrt((S-C)*(S-C)+(w-E)*(w-E)+(b-_)*(b-_));return Math.abs(R)<.001&&(R=1),this.x=(S-C)/R,this.y=(w-E)/R,this.z=(b-_)/R,this.w=Math.acos((v+M+A-1)/2),this}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this.w=Math.min(this.w,n.w),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this.w=Math.max(this.w,n.w),this}clamp(n,s){return this.x=Math.max(n.x,Math.min(s.x,this.x)),this.y=Math.max(n.y,Math.min(s.y,this.y)),this.z=Math.max(n.z,Math.min(s.z,this.z)),this.w=Math.max(n.w,Math.min(s.w,this.w)),this}clampScalar(n,s){return this.x=Math.max(n,Math.min(s,this.x)),this.y=Math.max(n,Math.min(s,this.y)),this.z=Math.max(n,Math.min(s,this.z)),this.w=Math.max(n,Math.min(s,this.w)),this}clampLength(n,s){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(n,Math.min(s,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z+this.w*n.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,s){return this.x+=(n.x-this.x)*s,this.y+=(n.y-this.y)*s,this.z+=(n.z-this.z)*s,this.w+=(n.w-this.w)*s,this}lerpVectors(n,s,a){return this.x=n.x+(s.x-n.x)*a,this.y=n.y+(s.y-n.y)*a,this.z=n.z+(s.z-n.z)*a,this.w=n.w+(s.w-n.w)*a,this}equals(n){return n.x===this.x&&n.y===this.y&&n.z===this.z&&n.w===this.w}fromArray(n,s=0){return this.x=n[s],this.y=n[s+1],this.z=n[s+2],this.w=n[s+3],this}toArray(n=[],s=0){return n[s]=this.x,n[s+1]=this.y,n[s+2]=this.z,n[s+3]=this.w,n}fromBufferAttribute(n,s,a){return void 0!==a&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=n.getX(s),this.y=n.getY(s),this.z=n.getZ(s),this.w=n.getW(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}jt.prototype.isVector4=!0;class ti extends ia{constructor(n,s,a={}){super(),this.width=n,this.height=s,this.depth=1,this.scissor=new jt(0,0,n,s),this.scissorTest=!1,this.viewport=new jt(0,0,n,s),this.texture=new cn({width:n,height:s,depth:1},a.mapping,a.wrapS,a.wrapT,a.magFilter,a.minFilter,a.format,a.type,a.anisotropy,a.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=void 0!==a.generateMipmaps&&a.generateMipmaps,this.texture.internalFormat=void 0!==a.internalFormat?a.internalFormat:null,this.texture.minFilter=void 0!==a.minFilter?a.minFilter:hn,this.depthBuffer=void 0===a.depthBuffer||a.depthBuffer,this.stencilBuffer=void 0!==a.stencilBuffer&&a.stencilBuffer,this.depthTexture=void 0!==a.depthTexture?a.depthTexture:null,this.samples=void 0!==a.samples?a.samples:0}setSize(n,s,a=1){(this.width!==n||this.height!==s||this.depth!==a)&&(this.width=n,this.height=s,this.depth=a,this.texture.image.width=n,this.texture.image.height=s,this.texture.image.depth=a,this.dispose()),this.viewport.set(0,0,n,s),this.scissor.set(0,0,n,s)}clone(){return(new this.constructor).copy(this)}copy(n){return this.width=n.width,this.height=n.height,this.depth=n.depth,this.viewport.copy(n.viewport),this.texture=n.texture.clone(),this.texture.isRenderTargetTexture=!0,this.texture.image=Object.assign({},n.texture.image),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,null!==n.depthTexture&&(this.depthTexture=n.depthTexture.clone()),this.samples=n.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}ti.prototype.isWebGLRenderTarget=!0;class Wi extends cn{constructor(n=null,s=1,a=1,c=1){super(null),this.image={data:n,width:s,height:a,depth:c},this.magFilter=Qt,this.minFilter=Qt,this.wrapR=Gt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}Wi.prototype.isDataArrayTexture=!0,class fn extends ti{constructor(n,s,a){super(n,s),this.depth=a,this.texture=new Wi(null,n,s,a),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGLArrayRenderTarget=!0;class of extends cn{constructor(n=null,s=1,a=1,c=1){super(null),this.image={data:n,width:s,height:a,depth:c},this.magFilter=Qt,this.minFilter=Qt,this.wrapR=Gt,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}of.prototype.isData3DTexture=!0,class k_ extends ti{constructor(n,s,a){super(n,s),this.depth=a,this.texture=new of(null,n,s,a),this.texture.isRenderTargetTexture=!0}}.prototype.isWebGL3DRenderTarget=!0,class us extends ti{constructor(n,s,a,c={}){super(n,s,c);const u=this.texture;this.texture=[];for(let f=0;f<a;f++)this.texture[f]=u.clone(),this.texture[f].isRenderTargetTexture=!0}setSize(n,s,a=1){if(this.width!==n||this.height!==s||this.depth!==a){this.width=n,this.height=s,this.depth=a;for(let c=0,u=this.texture.length;c<u;c++)this.texture[c].image.width=n,this.texture[c].image.height=s,this.texture[c].image.depth=a;this.dispose()}return this.viewport.set(0,0,n,s),this.scissor.set(0,0,n,s),this}copy(n){this.dispose(),this.width=n.width,this.height=n.height,this.depth=n.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.depthTexture=n.depthTexture,this.texture.length=0;for(let s=0,a=n.texture.length;s<a;s++)this.texture[s]=n.texture[s].clone();return this}}.prototype.isWebGLMultipleRenderTargets=!0;class un{constructor(n=0,s=0,a=0,c=1){this._x=n,this._y=s,this._z=a,this._w=c}static slerp(n,s,a,c){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),a.slerpQuaternions(n,s,c)}static slerpFlat(n,s,a,c,u,f,m){let y=a[c+0],v=a[c+1],_=a[c+2],w=a[c+3];const b=u[f+0],M=u[f+1],C=u[f+2],E=u[f+3];if(0===m)return n[s+0]=y,n[s+1]=v,n[s+2]=_,void(n[s+3]=w);if(1===m)return n[s+0]=b,n[s+1]=M,n[s+2]=C,void(n[s+3]=E);if(w!==E||y!==b||v!==M||_!==C){let S=1-m;const A=y*b+v*M+_*C+w*E,R=A>=0?1:-1,F=1-A*A;if(F>Number.EPSILON){const O=Math.sqrt(F),V=Math.atan2(O,A*R);S=Math.sin(S*V)/O,m=Math.sin(m*V)/O}const I=m*R;if(y=y*S+b*I,v=v*S+M*I,_=_*S+C*I,w=w*S+E*I,S===1-m){const O=1/Math.sqrt(y*y+v*v+_*_+w*w);y*=O,v*=O,_*=O,w*=O}}n[s]=y,n[s+1]=v,n[s+2]=_,n[s+3]=w}static multiplyQuaternionsFlat(n,s,a,c,u,f){const m=a[c],y=a[c+1],v=a[c+2],_=a[c+3],w=u[f],b=u[f+1],M=u[f+2],C=u[f+3];return n[s]=m*C+_*w+y*M-v*b,n[s+1]=y*C+_*b+v*w-m*M,n[s+2]=v*C+_*M+m*b-y*w,n[s+3]=_*C-m*w-y*b-v*M,n}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get w(){return this._w}set w(n){this._w=n,this._onChangeCallback()}set(n,s,a,c){return this._x=n,this._y=s,this._z=a,this._w=c,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(n){return this._x=n.x,this._y=n.y,this._z=n.z,this._w=n.w,this._onChangeCallback(),this}setFromEuler(n,s){if(!n||!n.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const a=n._x,c=n._y,u=n._z,f=n._order,m=Math.cos,y=Math.sin,v=m(a/2),_=m(c/2),w=m(u/2),b=y(a/2),M=y(c/2),C=y(u/2);switch(f){case"XYZ":this._x=b*_*w+v*M*C,this._y=v*M*w-b*_*C,this._z=v*_*C+b*M*w,this._w=v*_*w-b*M*C;break;case"YXZ":this._x=b*_*w+v*M*C,this._y=v*M*w-b*_*C,this._z=v*_*C-b*M*w,this._w=v*_*w+b*M*C;break;case"ZXY":this._x=b*_*w-v*M*C,this._y=v*M*w+b*_*C,this._z=v*_*C+b*M*w,this._w=v*_*w-b*M*C;break;case"ZYX":this._x=b*_*w-v*M*C,this._y=v*M*w+b*_*C,this._z=v*_*C-b*M*w,this._w=v*_*w+b*M*C;break;case"YZX":this._x=b*_*w+v*M*C,this._y=v*M*w+b*_*C,this._z=v*_*C-b*M*w,this._w=v*_*w-b*M*C;break;case"XZY":this._x=b*_*w-v*M*C,this._y=v*M*w-b*_*C,this._z=v*_*C+b*M*w,this._w=v*_*w+b*M*C;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+f)}return!1!==s&&this._onChangeCallback(),this}setFromAxisAngle(n,s){const a=s/2,c=Math.sin(a);return this._x=n.x*c,this._y=n.y*c,this._z=n.z*c,this._w=Math.cos(a),this._onChangeCallback(),this}setFromRotationMatrix(n){const s=n.elements,a=s[0],c=s[4],u=s[8],f=s[1],m=s[5],y=s[9],v=s[2],_=s[6],w=s[10],b=a+m+w;if(b>0){const M=.5/Math.sqrt(b+1);this._w=.25/M,this._x=(_-y)*M,this._y=(u-v)*M,this._z=(f-c)*M}else if(a>m&&a>w){const M=2*Math.sqrt(1+a-m-w);this._w=(_-y)/M,this._x=.25*M,this._y=(c+f)/M,this._z=(u+v)/M}else if(m>w){const M=2*Math.sqrt(1+m-a-w);this._w=(u-v)/M,this._x=(c+f)/M,this._y=.25*M,this._z=(y+_)/M}else{const M=2*Math.sqrt(1+w-a-m);this._w=(f-c)/M,this._x=(u+v)/M,this._y=(y+_)/M,this._z=.25*M}return this._onChangeCallback(),this}setFromUnitVectors(n,s){let a=n.dot(s)+1;return a<Number.EPSILON?(a=0,Math.abs(n.x)>Math.abs(n.z)?(this._x=-n.y,this._y=n.x,this._z=0,this._w=a):(this._x=0,this._y=-n.z,this._z=n.y,this._w=a)):(this._x=n.y*s.z-n.z*s.y,this._y=n.z*s.x-n.x*s.z,this._z=n.x*s.y-n.y*s.x,this._w=a),this.normalize()}angleTo(n){return 2*Math.acos(Math.abs(wn(this.dot(n),-1,1)))}rotateTowards(n,s){const a=this.angleTo(n);if(0===a)return this;const c=Math.min(1,s/a);return this.slerp(n,c),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(n){return this._x*n._x+this._y*n._y+this._z*n._z+this._w*n._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let n=this.length();return 0===n?(this._x=0,this._y=0,this._z=0,this._w=1):(n=1/n,this._x=this._x*n,this._y=this._y*n,this._z=this._z*n,this._w=this._w*n),this._onChangeCallback(),this}multiply(n,s){return void 0!==s?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(n,s)):this.multiplyQuaternions(this,n)}premultiply(n){return this.multiplyQuaternions(n,this)}multiplyQuaternions(n,s){const a=n._x,c=n._y,u=n._z,f=n._w,m=s._x,y=s._y,v=s._z,_=s._w;return this._x=a*_+f*m+c*v-u*y,this._y=c*_+f*y+u*m-a*v,this._z=u*_+f*v+a*y-c*m,this._w=f*_-a*m-c*y-u*v,this._onChangeCallback(),this}slerp(n,s){if(0===s)return this;if(1===s)return this.copy(n);const a=this._x,c=this._y,u=this._z,f=this._w;let m=f*n._w+a*n._x+c*n._y+u*n._z;if(m<0?(this._w=-n._w,this._x=-n._x,this._y=-n._y,this._z=-n._z,m=-m):this.copy(n),m>=1)return this._w=f,this._x=a,this._y=c,this._z=u,this;const y=1-m*m;if(y<=Number.EPSILON){const M=1-s;return this._w=M*f+s*this._w,this._x=M*a+s*this._x,this._y=M*c+s*this._y,this._z=M*u+s*this._z,this.normalize(),this._onChangeCallback(),this}const v=Math.sqrt(y),_=Math.atan2(v,m),w=Math.sin((1-s)*_)/v,b=Math.sin(s*_)/v;return this._w=f*w+this._w*b,this._x=a*w+this._x*b,this._y=c*w+this._y*b,this._z=u*w+this._z*b,this._onChangeCallback(),this}slerpQuaternions(n,s,a){return this.copy(n).slerp(s,a)}random(){const n=Math.random(),s=Math.sqrt(1-n),a=Math.sqrt(n),c=2*Math.PI*Math.random(),u=2*Math.PI*Math.random();return this.set(s*Math.cos(c),a*Math.sin(u),a*Math.cos(u),s*Math.sin(c))}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._w===this._w}fromArray(n,s=0){return this._x=n[s],this._y=n[s+1],this._z=n[s+2],this._w=n[s+3],this._onChangeCallback(),this}toArray(n=[],s=0){return n[s]=this._x,n[s+1]=this._y,n[s+2]=this._z,n[s+3]=this._w,n}fromBufferAttribute(n,s){return this._x=n.getX(s),this._y=n.getY(s),this._z=n.getZ(s),this._w=n.getW(s),this}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}}un.prototype.isQuaternion=!0;class k{constructor(n=0,s=0,a=0){this.x=n,this.y=s,this.z=a}set(n,s,a){return void 0===a&&(a=this.z),this.x=n,this.y=s,this.z=a,this}setScalar(n){return this.x=n,this.y=n,this.z=n,this}setX(n){return this.x=n,this}setY(n){return this.y=n,this}setZ(n){return this.z=n,this}setComponent(n,s){switch(n){case 0:this.x=s;break;case 1:this.y=s;break;case 2:this.z=s;break;default:throw new Error("index is out of range: "+n)}return this}getComponent(n){switch(n){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+n)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(n){return this.x=n.x,this.y=n.y,this.z=n.z,this}add(n,s){return void 0!==s?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(n,s)):(this.x+=n.x,this.y+=n.y,this.z+=n.z,this)}addScalar(n){return this.x+=n,this.y+=n,this.z+=n,this}addVectors(n,s){return this.x=n.x+s.x,this.y=n.y+s.y,this.z=n.z+s.z,this}addScaledVector(n,s){return this.x+=n.x*s,this.y+=n.y*s,this.z+=n.z*s,this}sub(n,s){return void 0!==s?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(n,s)):(this.x-=n.x,this.y-=n.y,this.z-=n.z,this)}subScalar(n){return this.x-=n,this.y-=n,this.z-=n,this}subVectors(n,s){return this.x=n.x-s.x,this.y=n.y-s.y,this.z=n.z-s.z,this}multiply(n,s){return void 0!==s?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(n,s)):(this.x*=n.x,this.y*=n.y,this.z*=n.z,this)}multiplyScalar(n){return this.x*=n,this.y*=n,this.z*=n,this}multiplyVectors(n,s){return this.x=n.x*s.x,this.y=n.y*s.y,this.z=n.z*s.z,this}applyEuler(n){return n&&n.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(mc.setFromEuler(n))}applyAxisAngle(n,s){return this.applyQuaternion(mc.setFromAxisAngle(n,s))}applyMatrix3(n){const s=this.x,a=this.y,c=this.z,u=n.elements;return this.x=u[0]*s+u[3]*a+u[6]*c,this.y=u[1]*s+u[4]*a+u[7]*c,this.z=u[2]*s+u[5]*a+u[8]*c,this}applyNormalMatrix(n){return this.applyMatrix3(n).normalize()}applyMatrix4(n){const s=this.x,a=this.y,c=this.z,u=n.elements,f=1/(u[3]*s+u[7]*a+u[11]*c+u[15]);return this.x=(u[0]*s+u[4]*a+u[8]*c+u[12])*f,this.y=(u[1]*s+u[5]*a+u[9]*c+u[13])*f,this.z=(u[2]*s+u[6]*a+u[10]*c+u[14])*f,this}applyQuaternion(n){const s=this.x,a=this.y,c=this.z,u=n.x,f=n.y,m=n.z,y=n.w,v=y*s+f*c-m*a,_=y*a+m*s-u*c,w=y*c+u*a-f*s,b=-u*s-f*a-m*c;return this.x=v*y+b*-u+_*-m-w*-f,this.y=_*y+b*-f+w*-u-v*-m,this.z=w*y+b*-m+v*-f-_*-u,this}project(n){return this.applyMatrix4(n.matrixWorldInverse).applyMatrix4(n.projectionMatrix)}unproject(n){return this.applyMatrix4(n.projectionMatrixInverse).applyMatrix4(n.matrixWorld)}transformDirection(n){const s=this.x,a=this.y,c=this.z,u=n.elements;return this.x=u[0]*s+u[4]*a+u[8]*c,this.y=u[1]*s+u[5]*a+u[9]*c,this.z=u[2]*s+u[6]*a+u[10]*c,this.normalize()}divide(n){return this.x/=n.x,this.y/=n.y,this.z/=n.z,this}divideScalar(n){return this.multiplyScalar(1/n)}min(n){return this.x=Math.min(this.x,n.x),this.y=Math.min(this.y,n.y),this.z=Math.min(this.z,n.z),this}max(n){return this.x=Math.max(this.x,n.x),this.y=Math.max(this.y,n.y),this.z=Math.max(this.z,n.z),this}clamp(n,s){return this.x=Math.max(n.x,Math.min(s.x,this.x)),this.y=Math.max(n.y,Math.min(s.y,this.y)),this.z=Math.max(n.z,Math.min(s.z,this.z)),this}clampScalar(n,s){return this.x=Math.max(n,Math.min(s,this.x)),this.y=Math.max(n,Math.min(s,this.y)),this.z=Math.max(n,Math.min(s,this.z)),this}clampLength(n,s){const a=this.length();return this.divideScalar(a||1).multiplyScalar(Math.max(n,Math.min(s,a)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(n){return this.x*n.x+this.y*n.y+this.z*n.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(n){return this.normalize().multiplyScalar(n)}lerp(n,s){return this.x+=(n.x-this.x)*s,this.y+=(n.y-this.y)*s,this.z+=(n.z-this.z)*s,this}lerpVectors(n,s,a){return this.x=n.x+(s.x-n.x)*a,this.y=n.y+(s.y-n.y)*a,this.z=n.z+(s.z-n.z)*a,this}cross(n,s){return void 0!==s?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(n,s)):this.crossVectors(this,n)}crossVectors(n,s){const a=n.x,c=n.y,u=n.z,f=s.x,m=s.y,y=s.z;return this.x=c*y-u*m,this.y=u*f-a*y,this.z=a*m-c*f,this}projectOnVector(n){const s=n.lengthSq();if(0===s)return this.set(0,0,0);const a=n.dot(this)/s;return this.copy(n).multiplyScalar(a)}projectOnPlane(n){return Za.copy(this).projectOnVector(n),this.sub(Za)}reflect(n){return this.sub(Za.copy(n).multiplyScalar(2*this.dot(n)))}angleTo(n){const s=Math.sqrt(this.lengthSq()*n.lengthSq());if(0===s)return Math.PI/2;const a=this.dot(n)/s;return Math.acos(wn(a,-1,1))}distanceTo(n){return Math.sqrt(this.distanceToSquared(n))}distanceToSquared(n){const s=this.x-n.x,a=this.y-n.y,c=this.z-n.z;return s*s+a*a+c*c}manhattanDistanceTo(n){return Math.abs(this.x-n.x)+Math.abs(this.y-n.y)+Math.abs(this.z-n.z)}setFromSpherical(n){return this.setFromSphericalCoords(n.radius,n.phi,n.theta)}setFromSphericalCoords(n,s,a){const c=Math.sin(s)*n;return this.x=c*Math.sin(a),this.y=Math.cos(s)*n,this.z=c*Math.cos(a),this}setFromCylindrical(n){return this.setFromCylindricalCoords(n.radius,n.theta,n.y)}setFromCylindricalCoords(n,s,a){return this.x=n*Math.sin(s),this.y=a,this.z=n*Math.cos(s),this}setFromMatrixPosition(n){const s=n.elements;return this.x=s[12],this.y=s[13],this.z=s[14],this}setFromMatrixScale(n){const s=this.setFromMatrixColumn(n,0).length(),a=this.setFromMatrixColumn(n,1).length(),c=this.setFromMatrixColumn(n,2).length();return this.x=s,this.y=a,this.z=c,this}setFromMatrixColumn(n,s){return this.fromArray(n.elements,4*s)}setFromMatrix3Column(n,s){return this.fromArray(n.elements,3*s)}setFromEuler(n){return this.x=n._x,this.y=n._y,this.z=n._z,this}equals(n){return n.x===this.x&&n.y===this.y&&n.z===this.z}fromArray(n,s=0){return this.x=n[s],this.y=n[s+1],this.z=n[s+2],this}toArray(n=[],s=0){return n[s]=this.x,n[s+1]=this.y,n[s+2]=this.z,n}fromBufferAttribute(n,s,a){return void 0!==a&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=n.getX(s),this.y=n.getY(s),this.z=n.getZ(s),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const n=2*(Math.random()-.5),s=Math.random()*Math.PI*2,a=Math.sqrt(1-n**2);return this.x=a*Math.cos(s),this.y=a*Math.sin(s),this.z=n,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}k.prototype.isVector3=!0;const Za=new k,mc=new un;class Ln{constructor(n=new k(1/0,1/0,1/0),s=new k(-1/0,-1/0,-1/0)){this.min=n,this.max=s}set(n,s){return this.min.copy(n),this.max.copy(s),this}setFromArray(n){let s=1/0,a=1/0,c=1/0,u=-1/0,f=-1/0,m=-1/0;for(let y=0,v=n.length;y<v;y+=3){const _=n[y],w=n[y+1],b=n[y+2];_<s&&(s=_),w<a&&(a=w),b<c&&(c=b),_>u&&(u=_),w>f&&(f=w),b>m&&(m=b)}return this.min.set(s,a,c),this.max.set(u,f,m),this}setFromBufferAttribute(n){let s=1/0,a=1/0,c=1/0,u=-1/0,f=-1/0,m=-1/0;for(let y=0,v=n.count;y<v;y++){const _=n.getX(y),w=n.getY(y),b=n.getZ(y);_<s&&(s=_),w<a&&(a=w),b<c&&(c=b),_>u&&(u=_),w>f&&(f=w),b>m&&(m=b)}return this.min.set(s,a,c),this.max.set(u,f,m),this}setFromPoints(n){this.makeEmpty();for(let s=0,a=n.length;s<a;s++)this.expandByPoint(n[s]);return this}setFromCenterAndSize(n,s){const a=Ya.copy(s).multiplyScalar(.5);return this.min.copy(n).sub(a),this.max.copy(n).add(a),this}setFromObject(n,s=!1){return this.makeEmpty(),this.expandByObject(n,s)}clone(){return(new this.constructor).copy(this)}copy(n){return this.min.copy(n.min),this.max.copy(n.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(n){return this.isEmpty()?n.set(0,0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(n){return this.isEmpty()?n.set(0,0,0):n.subVectors(this.max,this.min)}expandByPoint(n){return this.min.min(n),this.max.max(n),this}expandByVector(n){return this.min.sub(n),this.max.add(n),this}expandByScalar(n){return this.min.addScalar(-n),this.max.addScalar(n),this}expandByObject(n,s=!1){n.updateWorldMatrix(!1,!1);const a=n.geometry;if(void 0!==a)if(s&&null!=a.attributes&&void 0!==a.attributes.position){const u=a.attributes.position;for(let f=0,m=u.count;f<m;f++)Ya.fromBufferAttribute(u,f).applyMatrix4(n.matrixWorld),this.expandByPoint(Ya)}else null===a.boundingBox&&a.computeBoundingBox(),af.copy(a.boundingBox),af.applyMatrix4(n.matrixWorld),this.union(af);const c=n.children;for(let u=0,f=c.length;u<f;u++)this.expandByObject(c[u],s);return this}containsPoint(n){return!(n.x<this.min.x||n.x>this.max.x||n.y<this.min.y||n.y>this.max.y||n.z<this.min.z||n.z>this.max.z)}containsBox(n){return this.min.x<=n.min.x&&n.max.x<=this.max.x&&this.min.y<=n.min.y&&n.max.y<=this.max.y&&this.min.z<=n.min.z&&n.max.z<=this.max.z}getParameter(n,s){return s.set((n.x-this.min.x)/(this.max.x-this.min.x),(n.y-this.min.y)/(this.max.y-this.min.y),(n.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(n){return!(n.max.x<this.min.x||n.min.x>this.max.x||n.max.y<this.min.y||n.min.y>this.max.y||n.max.z<this.min.z||n.min.z>this.max.z)}intersectsSphere(n){return this.clampPoint(n.center,Ya),Ya.distanceToSquared(n.center)<=n.radius*n.radius}intersectsPlane(n){let s,a;return n.normal.x>0?(s=n.normal.x*this.min.x,a=n.normal.x*this.max.x):(s=n.normal.x*this.max.x,a=n.normal.x*this.min.x),n.normal.y>0?(s+=n.normal.y*this.min.y,a+=n.normal.y*this.max.y):(s+=n.normal.y*this.max.y,a+=n.normal.y*this.min.y),n.normal.z>0?(s+=n.normal.z*this.min.z,a+=n.normal.z*this.max.z):(s+=n.normal.z*this.max.z,a+=n.normal.z*this.min.z),s<=-n.constant&&a>=-n.constant}intersectsTriangle(n){if(this.isEmpty())return!1;this.getCenter(rd),lf.subVectors(this.max,rd),Qa.subVectors(n.a,rd),gc.subVectors(n.b,rd),yc.subVectors(n.c,rd),oa.subVectors(gc,Qa),aa.subVectors(yc,gc),Ka.subVectors(Qa,yc);let s=[0,-oa.z,oa.y,0,-aa.z,aa.y,0,-Ka.z,Ka.y,oa.z,0,-oa.x,aa.z,0,-aa.x,Ka.z,0,-Ka.x,-oa.y,oa.x,0,-aa.y,aa.x,0,-Ka.y,Ka.x,0];return!(!Zm(s,Qa,gc,yc,lf)||(s=[1,0,0,0,1,0,0,0,1],!Zm(s,Qa,gc,yc,lf)))&&(cf.crossVectors(oa,aa),s=[cf.x,cf.y,cf.z],Zm(s,Qa,gc,yc,lf))}clampPoint(n,s){return s.copy(n).clamp(this.min,this.max)}distanceToPoint(n){return Ya.copy(n).clamp(this.min,this.max).sub(n).length()}getBoundingSphere(n){return this.getCenter(n.center),n.radius=.5*this.getSize(Ya).length(),n}intersect(n){return this.min.max(n.min),this.max.min(n.max),this.isEmpty()&&this.makeEmpty(),this}union(n){return this.min.min(n.min),this.max.max(n.max),this}applyMatrix4(n){return this.isEmpty()||(Os[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(n),Os[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(n),Os[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(n),Os[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(n),Os[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(n),Os[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(n),Os[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(n),Os[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(n),this.setFromPoints(Os)),this}translate(n){return this.min.add(n),this.max.add(n),this}equals(n){return n.min.equals(this.min)&&n.max.equals(this.max)}}Ln.prototype.isBox3=!0;const Os=[new k,new k,new k,new k,new k,new k,new k,new k],Ya=new k,af=new Ln,Qa=new k,gc=new k,yc=new k,oa=new k,aa=new k,Ka=new k,rd=new k,lf=new k,cf=new k,Ja=new k;function Zm(h,n,s,a,c){for(let u=0,f=h.length-3;u<=f;u+=3){Ja.fromArray(h,u);const m=c.x*Math.abs(Ja.x)+c.y*Math.abs(Ja.y)+c.z*Math.abs(Ja.z),y=n.dot(Ja),v=s.dot(Ja),_=a.dot(Ja);if(Math.max(-Math.max(y,v,_),Math.min(y,v,_))>m)return!1}return!0}const uE=new Ln,B_=new k,uf=new k,Ym=new k;class yo{constructor(n=new k,s=-1){this.center=n,this.radius=s}set(n,s){return this.center.copy(n),this.radius=s,this}setFromPoints(n,s){const a=this.center;void 0!==s?a.copy(s):uE.setFromPoints(n).getCenter(a);let c=0;for(let u=0,f=n.length;u<f;u++)c=Math.max(c,a.distanceToSquared(n[u]));return this.radius=Math.sqrt(c),this}copy(n){return this.center.copy(n.center),this.radius=n.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(n){return n.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(n){return n.distanceTo(this.center)-this.radius}intersectsSphere(n){const s=this.radius+n.radius;return n.center.distanceToSquared(this.center)<=s*s}intersectsBox(n){return n.intersectsSphere(this)}intersectsPlane(n){return Math.abs(n.distanceToPoint(this.center))<=this.radius}clampPoint(n,s){const a=this.center.distanceToSquared(n);return s.copy(n),a>this.radius*this.radius&&(s.sub(this.center).normalize(),s.multiplyScalar(this.radius).add(this.center)),s}getBoundingBox(n){return this.isEmpty()?(n.makeEmpty(),n):(n.set(this.center,this.center),n.expandByScalar(this.radius),n)}applyMatrix4(n){return this.center.applyMatrix4(n),this.radius=this.radius*n.getMaxScaleOnAxis(),this}translate(n){return this.center.add(n),this}expandByPoint(n){Ym.subVectors(n,this.center);const s=Ym.lengthSq();if(s>this.radius*this.radius){const a=Math.sqrt(s),c=.5*(a-this.radius);this.center.add(Ym.multiplyScalar(c/a)),this.radius+=c}return this}union(n){return!0===this.center.equals(n.center)?uf.set(0,0,1).multiplyScalar(n.radius):uf.subVectors(n.center,this.center).normalize().multiplyScalar(n.radius),this.expandByPoint(B_.copy(n.center).add(uf)),this.expandByPoint(B_.copy(n.center).sub(uf)),this}equals(n){return n.center.equals(this.center)&&n.radius===this.radius}clone(){return(new this.constructor).copy(this)}}const Nr=new k,Qm=new k,df=new k,la=new k,ks=new k,sd=new k,Bs=new k;class vo{constructor(n=new k,s=new k(0,0,-1)){this.origin=n,this.direction=s}set(n,s){return this.origin.copy(n),this.direction.copy(s),this}copy(n){return this.origin.copy(n.origin),this.direction.copy(n.direction),this}at(n,s){return s.copy(this.direction).multiplyScalar(n).add(this.origin)}lookAt(n){return this.direction.copy(n).sub(this.origin).normalize(),this}recast(n){return this.origin.copy(this.at(n,Nr)),this}closestPointToPoint(n,s){s.subVectors(n,this.origin);const a=s.dot(this.direction);return a<0?s.copy(this.origin):s.copy(this.direction).multiplyScalar(a).add(this.origin)}distanceToPoint(n){return Math.sqrt(this.distanceSqToPoint(n))}distanceSqToPoint(n){const s=Nr.subVectors(n,this.origin).dot(this.direction);return s<0?this.origin.distanceToSquared(n):(Nr.copy(this.direction).multiplyScalar(s).add(this.origin),Nr.distanceToSquared(n))}distanceSqToSegment(n,s,a,c){Qm.copy(n).add(s).multiplyScalar(.5),df.copy(s).sub(n).normalize(),la.copy(this.origin).sub(Qm);const u=.5*n.distanceTo(s),f=-this.direction.dot(df),m=la.dot(this.direction),y=-la.dot(df),v=la.lengthSq(),_=Math.abs(1-f*f);let w,b,M,C;if(_>0)if(w=f*y-m,b=f*m-y,C=u*_,w>=0)if(b>=-C)if(b<=C){const E=1/_;w*=E,b*=E,M=w*(w+f*b+2*m)+b*(f*w+b+2*y)+v}else b=u,w=Math.max(0,-(f*b+m)),M=-w*w+b*(b+2*y)+v;else b=-u,w=Math.max(0,-(f*b+m)),M=-w*w+b*(b+2*y)+v;else b<=-C?(w=Math.max(0,-(-f*u+m)),b=w>0?-u:Math.min(Math.max(-u,-y),u),M=-w*w+b*(b+2*y)+v):b<=C?(w=0,b=Math.min(Math.max(-u,-y),u),M=b*(b+2*y)+v):(w=Math.max(0,-(f*u+m)),b=w>0?u:Math.min(Math.max(-u,-y),u),M=-w*w+b*(b+2*y)+v);else b=f>0?-u:u,w=Math.max(0,-(f*b+m)),M=-w*w+b*(b+2*y)+v;return a&&a.copy(this.direction).multiplyScalar(w).add(this.origin),c&&c.copy(df).multiplyScalar(b).add(Qm),M}intersectSphere(n,s){Nr.subVectors(n.center,this.origin);const a=Nr.dot(this.direction),c=Nr.dot(Nr)-a*a,u=n.radius*n.radius;if(c>u)return null;const f=Math.sqrt(u-c),m=a-f,y=a+f;return m<0&&y<0?null:this.at(m<0?y:m,s)}intersectsSphere(n){return this.distanceSqToPoint(n.center)<=n.radius*n.radius}distanceToPlane(n){const s=n.normal.dot(this.direction);if(0===s)return 0===n.distanceToPoint(this.origin)?0:null;const a=-(this.origin.dot(n.normal)+n.constant)/s;return a>=0?a:null}intersectPlane(n,s){const a=this.distanceToPlane(n);return null===a?null:this.at(a,s)}intersectsPlane(n){const s=n.distanceToPoint(this.origin);return 0===s||n.normal.dot(this.direction)*s<0}intersectBox(n,s){let a,c,u,f,m,y;const v=1/this.direction.x,_=1/this.direction.y,w=1/this.direction.z,b=this.origin;return v>=0?(a=(n.min.x-b.x)*v,c=(n.max.x-b.x)*v):(a=(n.max.x-b.x)*v,c=(n.min.x-b.x)*v),_>=0?(u=(n.min.y-b.y)*_,f=(n.max.y-b.y)*_):(u=(n.max.y-b.y)*_,f=(n.min.y-b.y)*_),a>f||u>c||((u>a||a!=a)&&(a=u),(f<c||c!=c)&&(c=f),w>=0?(m=(n.min.z-b.z)*w,y=(n.max.z-b.z)*w):(m=(n.max.z-b.z)*w,y=(n.min.z-b.z)*w),a>y||m>c)||((m>a||a!=a)&&(a=m),(y<c||c!=c)&&(c=y),c<0)?null:this.at(a>=0?a:c,s)}intersectsBox(n){return null!==this.intersectBox(n,Nr)}intersectTriangle(n,s,a,c,u){ks.subVectors(s,n),sd.subVectors(a,n),Bs.crossVectors(ks,sd);let m,f=this.direction.dot(Bs);if(f>0){if(c)return null;m=1}else{if(!(f<0))return null;m=-1,f=-f}la.subVectors(this.origin,n);const y=m*this.direction.dot(sd.crossVectors(la,sd));if(y<0)return null;const v=m*this.direction.dot(ks.cross(la));if(v<0||y+v>f)return null;const _=-m*la.dot(Bs);return _<0?null:this.at(_/f,u)}applyMatrix4(n){return this.origin.applyMatrix4(n),this.direction.transformDirection(n),this}equals(n){return n.origin.equals(this.origin)&&n.direction.equals(this.direction)}clone(){return(new this.constructor).copy(this)}}class $e{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(n,s,a,c,u,f,m,y,v,_,w,b,M,C,E,S){const A=this.elements;return A[0]=n,A[4]=s,A[8]=a,A[12]=c,A[1]=u,A[5]=f,A[9]=m,A[13]=y,A[2]=v,A[6]=_,A[10]=w,A[14]=b,A[3]=M,A[7]=C,A[11]=E,A[15]=S,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return(new $e).fromArray(this.elements)}copy(n){const s=this.elements,a=n.elements;return s[0]=a[0],s[1]=a[1],s[2]=a[2],s[3]=a[3],s[4]=a[4],s[5]=a[5],s[6]=a[6],s[7]=a[7],s[8]=a[8],s[9]=a[9],s[10]=a[10],s[11]=a[11],s[12]=a[12],s[13]=a[13],s[14]=a[14],s[15]=a[15],this}copyPosition(n){const s=this.elements,a=n.elements;return s[12]=a[12],s[13]=a[13],s[14]=a[14],this}setFromMatrix3(n){const s=n.elements;return this.set(s[0],s[3],s[6],0,s[1],s[4],s[7],0,s[2],s[5],s[8],0,0,0,0,1),this}extractBasis(n,s,a){return n.setFromMatrixColumn(this,0),s.setFromMatrixColumn(this,1),a.setFromMatrixColumn(this,2),this}makeBasis(n,s,a){return this.set(n.x,s.x,a.x,0,n.y,s.y,a.y,0,n.z,s.z,a.z,0,0,0,0,1),this}extractRotation(n){const s=this.elements,a=n.elements,c=1/el.setFromMatrixColumn(n,0).length(),u=1/el.setFromMatrixColumn(n,1).length(),f=1/el.setFromMatrixColumn(n,2).length();return s[0]=a[0]*c,s[1]=a[1]*c,s[2]=a[2]*c,s[3]=0,s[4]=a[4]*u,s[5]=a[5]*u,s[6]=a[6]*u,s[7]=0,s[8]=a[8]*f,s[9]=a[9]*f,s[10]=a[10]*f,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromEuler(n){n&&n.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const s=this.elements,a=n.x,c=n.y,u=n.z,f=Math.cos(a),m=Math.sin(a),y=Math.cos(c),v=Math.sin(c),_=Math.cos(u),w=Math.sin(u);if("XYZ"===n.order){const b=f*_,M=f*w,C=m*_,E=m*w;s[0]=y*_,s[4]=-y*w,s[8]=v,s[1]=M+C*v,s[5]=b-E*v,s[9]=-m*y,s[2]=E-b*v,s[6]=C+M*v,s[10]=f*y}else if("YXZ"===n.order){const b=y*_,M=y*w,C=v*_,E=v*w;s[0]=b+E*m,s[4]=C*m-M,s[8]=f*v,s[1]=f*w,s[5]=f*_,s[9]=-m,s[2]=M*m-C,s[6]=E+b*m,s[10]=f*y}else if("ZXY"===n.order){const b=y*_,M=y*w,C=v*_,E=v*w;s[0]=b-E*m,s[4]=-f*w,s[8]=C+M*m,s[1]=M+C*m,s[5]=f*_,s[9]=E-b*m,s[2]=-f*v,s[6]=m,s[10]=f*y}else if("ZYX"===n.order){const b=f*_,M=f*w,C=m*_,E=m*w;s[0]=y*_,s[4]=C*v-M,s[8]=b*v+E,s[1]=y*w,s[5]=E*v+b,s[9]=M*v-C,s[2]=-v,s[6]=m*y,s[10]=f*y}else if("YZX"===n.order){const b=f*y,M=f*v,C=m*y,E=m*v;s[0]=y*_,s[4]=E-b*w,s[8]=C*w+M,s[1]=w,s[5]=f*_,s[9]=-m*_,s[2]=-v*_,s[6]=M*w+C,s[10]=b-E*w}else if("XZY"===n.order){const b=f*y,M=f*v,C=m*y,E=m*v;s[0]=y*_,s[4]=-w,s[8]=v*_,s[1]=b*w+E,s[5]=f*_,s[9]=M*w-C,s[2]=C*w-M,s[6]=m*_,s[10]=E*w+b}return s[3]=0,s[7]=0,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,this}makeRotationFromQuaternion(n){return this.compose(Km,n,U_)}lookAt(n,s,a){const c=this.elements;return bn.subVectors(n,s),0===bn.lengthSq()&&(bn.z=1),bn.normalize(),ds.crossVectors(a,bn),0===ds.lengthSq()&&(1===Math.abs(a.z)?bn.x+=1e-4:bn.z+=1e-4,bn.normalize(),ds.crossVectors(a,bn)),ds.normalize(),od.crossVectors(bn,ds),c[0]=ds.x,c[4]=od.x,c[8]=bn.x,c[1]=ds.y,c[5]=od.y,c[9]=bn.y,c[2]=ds.z,c[6]=od.z,c[10]=bn.z,this}multiply(n,s){return void 0!==s?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(n,s)):this.multiplyMatrices(this,n)}premultiply(n){return this.multiplyMatrices(n,this)}multiplyMatrices(n,s){const a=n.elements,c=s.elements,u=this.elements,f=a[0],m=a[4],y=a[8],v=a[12],_=a[1],w=a[5],b=a[9],M=a[13],C=a[2],E=a[6],S=a[10],A=a[14],R=a[3],F=a[7],I=a[11],O=a[15],V=c[0],W=c[4],$=c[8],ie=c[12],q=c[1],L=c[5],G=c[9],_e=c[13],Y=c[2],ne=c[6],J=c[10],oe=c[14],X=c[3],pe=c[7],ve=c[11],Me=c[15];return u[0]=f*V+m*q+y*Y+v*X,u[4]=f*W+m*L+y*ne+v*pe,u[8]=f*$+m*G+y*J+v*ve,u[12]=f*ie+m*_e+y*oe+v*Me,u[1]=_*V+w*q+b*Y+M*X,u[5]=_*W+w*L+b*ne+M*pe,u[9]=_*$+w*G+b*J+M*ve,u[13]=_*ie+w*_e+b*oe+M*Me,u[2]=C*V+E*q+S*Y+A*X,u[6]=C*W+E*L+S*ne+A*pe,u[10]=C*$+E*G+S*J+A*ve,u[14]=C*ie+E*_e+S*oe+A*Me,u[3]=R*V+F*q+I*Y+O*X,u[7]=R*W+F*L+I*ne+O*pe,u[11]=R*$+F*G+I*J+O*ve,u[15]=R*ie+F*_e+I*oe+O*Me,this}multiplyScalar(n){const s=this.elements;return s[0]*=n,s[4]*=n,s[8]*=n,s[12]*=n,s[1]*=n,s[5]*=n,s[9]*=n,s[13]*=n,s[2]*=n,s[6]*=n,s[10]*=n,s[14]*=n,s[3]*=n,s[7]*=n,s[11]*=n,s[15]*=n,this}determinant(){const n=this.elements,s=n[0],a=n[4],c=n[8],u=n[12],f=n[1],m=n[5],y=n[9],v=n[13],_=n[2],w=n[6],b=n[10],M=n[14];return n[3]*(+u*y*w-c*v*w-u*m*b+a*v*b+c*m*M-a*y*M)+n[7]*(+s*y*M-s*v*b+u*f*b-c*f*M+c*v*_-u*y*_)+n[11]*(+s*v*w-s*m*M-u*f*w+a*f*M+u*m*_-a*v*_)+n[15]*(-c*m*_-s*y*w+s*m*b+c*f*w-a*f*b+a*y*_)}transpose(){const n=this.elements;let s;return s=n[1],n[1]=n[4],n[4]=s,s=n[2],n[2]=n[8],n[8]=s,s=n[6],n[6]=n[9],n[9]=s,s=n[3],n[3]=n[12],n[12]=s,s=n[7],n[7]=n[13],n[13]=s,s=n[11],n[11]=n[14],n[14]=s,this}setPosition(n,s,a){const c=this.elements;return n.isVector3?(c[12]=n.x,c[13]=n.y,c[14]=n.z):(c[12]=n,c[13]=s,c[14]=a),this}invert(){const n=this.elements,s=n[0],a=n[1],c=n[2],u=n[3],f=n[4],m=n[5],y=n[6],v=n[7],_=n[8],w=n[9],b=n[10],M=n[11],C=n[12],E=n[13],S=n[14],A=n[15],R=w*S*v-E*b*v+E*y*M-m*S*M-w*y*A+m*b*A,F=C*b*v-_*S*v-C*y*M+f*S*M+_*y*A-f*b*A,I=_*E*v-C*w*v+C*m*M-f*E*M-_*m*A+f*w*A,O=C*w*y-_*E*y-C*m*b+f*E*b+_*m*S-f*w*S,V=s*R+a*F+c*I+u*O;if(0===V)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const W=1/V;return n[0]=R*W,n[1]=(E*b*u-w*S*u-E*c*M+a*S*M+w*c*A-a*b*A)*W,n[2]=(m*S*u-E*y*u+E*c*v-a*S*v-m*c*A+a*y*A)*W,n[3]=(w*y*u-m*b*u-w*c*v+a*b*v+m*c*M-a*y*M)*W,n[4]=F*W,n[5]=(_*S*u-C*b*u+C*c*M-s*S*M-_*c*A+s*b*A)*W,n[6]=(C*y*u-f*S*u-C*c*v+s*S*v+f*c*A-s*y*A)*W,n[7]=(f*b*u-_*y*u+_*c*v-s*b*v-f*c*M+s*y*M)*W,n[8]=I*W,n[9]=(C*w*u-_*E*u-C*a*M+s*E*M+_*a*A-s*w*A)*W,n[10]=(f*E*u-C*m*u+C*a*v-s*E*v-f*a*A+s*m*A)*W,n[11]=(_*m*u-f*w*u-_*a*v+s*w*v+f*a*M-s*m*M)*W,n[12]=O*W,n[13]=(_*E*c-C*w*c+C*a*b-s*E*b-_*a*S+s*w*S)*W,n[14]=(C*m*c-f*E*c-C*a*y+s*E*y+f*a*S-s*m*S)*W,n[15]=(f*w*c-_*m*c+_*a*y-s*w*y-f*a*b+s*m*b)*W,this}scale(n){const s=this.elements,a=n.x,c=n.y,u=n.z;return s[0]*=a,s[4]*=c,s[8]*=u,s[1]*=a,s[5]*=c,s[9]*=u,s[2]*=a,s[6]*=c,s[10]*=u,s[3]*=a,s[7]*=c,s[11]*=u,this}getMaxScaleOnAxis(){const n=this.elements;return Math.sqrt(Math.max(n[0]*n[0]+n[1]*n[1]+n[2]*n[2],n[4]*n[4]+n[5]*n[5]+n[6]*n[6],n[8]*n[8]+n[9]*n[9]+n[10]*n[10]))}makeTranslation(n,s,a){return this.set(1,0,0,n,0,1,0,s,0,0,1,a,0,0,0,1),this}makeRotationX(n){const s=Math.cos(n),a=Math.sin(n);return this.set(1,0,0,0,0,s,-a,0,0,a,s,0,0,0,0,1),this}makeRotationY(n){const s=Math.cos(n),a=Math.sin(n);return this.set(s,0,a,0,0,1,0,0,-a,0,s,0,0,0,0,1),this}makeRotationZ(n){const s=Math.cos(n),a=Math.sin(n);return this.set(s,-a,0,0,a,s,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(n,s){const a=Math.cos(s),c=Math.sin(s),u=1-a,f=n.x,m=n.y,y=n.z,v=u*f,_=u*m;return this.set(v*f+a,v*m-c*y,v*y+c*m,0,v*m+c*y,_*m+a,_*y-c*f,0,v*y-c*m,_*y+c*f,u*y*y+a,0,0,0,0,1),this}makeScale(n,s,a){return this.set(n,0,0,0,0,s,0,0,0,0,a,0,0,0,0,1),this}makeShear(n,s,a,c,u,f){return this.set(1,a,u,0,n,1,f,0,s,c,1,0,0,0,0,1),this}compose(n,s,a){const c=this.elements,u=s._x,f=s._y,m=s._z,y=s._w,v=u+u,_=f+f,w=m+m,b=u*v,M=u*_,C=u*w,E=f*_,S=f*w,A=m*w,R=y*v,F=y*_,I=y*w,O=a.x,V=a.y,W=a.z;return c[0]=(1-(E+A))*O,c[1]=(M+I)*O,c[2]=(C-F)*O,c[3]=0,c[4]=(M-I)*V,c[5]=(1-(b+A))*V,c[6]=(S+R)*V,c[7]=0,c[8]=(C+F)*W,c[9]=(S-R)*W,c[10]=(1-(b+E))*W,c[11]=0,c[12]=n.x,c[13]=n.y,c[14]=n.z,c[15]=1,this}decompose(n,s,a){const c=this.elements;let u=el.set(c[0],c[1],c[2]).length();const f=el.set(c[4],c[5],c[6]).length(),m=el.set(c[8],c[9],c[10]).length();this.determinant()<0&&(u=-u),n.x=c[12],n.y=c[13],n.z=c[14],mr.copy(this);const v=1/u,_=1/f,w=1/m;return mr.elements[0]*=v,mr.elements[1]*=v,mr.elements[2]*=v,mr.elements[4]*=_,mr.elements[5]*=_,mr.elements[6]*=_,mr.elements[8]*=w,mr.elements[9]*=w,mr.elements[10]*=w,s.setFromRotationMatrix(mr),a.x=u,a.y=f,a.z=m,this}makePerspective(n,s,a,c,u,f){void 0===f&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const m=this.elements,v=2*u/(a-c),_=(s+n)/(s-n),w=(a+c)/(a-c),b=-(f+u)/(f-u),M=-2*f*u/(f-u);return m[0]=2*u/(s-n),m[4]=0,m[8]=_,m[12]=0,m[1]=0,m[5]=v,m[9]=w,m[13]=0,m[2]=0,m[6]=0,m[10]=b,m[14]=M,m[3]=0,m[7]=0,m[11]=-1,m[15]=0,this}makeOrthographic(n,s,a,c,u,f){const m=this.elements,y=1/(s-n),v=1/(a-c),_=1/(f-u),w=(s+n)*y,b=(a+c)*v,M=(f+u)*_;return m[0]=2*y,m[4]=0,m[8]=0,m[12]=-w,m[1]=0,m[5]=2*v,m[9]=0,m[13]=-b,m[2]=0,m[6]=0,m[10]=-2*_,m[14]=-M,m[3]=0,m[7]=0,m[11]=0,m[15]=1,this}equals(n){const s=this.elements,a=n.elements;for(let c=0;c<16;c++)if(s[c]!==a[c])return!1;return!0}fromArray(n,s=0){for(let a=0;a<16;a++)this.elements[a]=n[a+s];return this}toArray(n=[],s=0){const a=this.elements;return n[s]=a[0],n[s+1]=a[1],n[s+2]=a[2],n[s+3]=a[3],n[s+4]=a[4],n[s+5]=a[5],n[s+6]=a[6],n[s+7]=a[7],n[s+8]=a[8],n[s+9]=a[9],n[s+10]=a[10],n[s+11]=a[11],n[s+12]=a[12],n[s+13]=a[13],n[s+14]=a[14],n[s+15]=a[15],n}}$e.prototype.isMatrix4=!0;const el=new k,mr=new $e,Km=new k(0,0,0),U_=new k(1,1,1),ds=new k,od=new k,bn=new k,ad=new $e,Jm=new un;class Us{constructor(n=0,s=0,a=0,c=Us.DefaultOrder){this._x=n,this._y=s,this._z=a,this._order=c}get x(){return this._x}set x(n){this._x=n,this._onChangeCallback()}get y(){return this._y}set y(n){this._y=n,this._onChangeCallback()}get z(){return this._z}set z(n){this._z=n,this._onChangeCallback()}get order(){return this._order}set order(n){this._order=n,this._onChangeCallback()}set(n,s,a,c=this._order){return this._x=n,this._y=s,this._z=a,this._order=c,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(n){return this._x=n._x,this._y=n._y,this._z=n._z,this._order=n._order,this._onChangeCallback(),this}setFromRotationMatrix(n,s=this._order,a=!0){const c=n.elements,u=c[0],f=c[4],m=c[8],y=c[1],v=c[5],_=c[9],w=c[2],b=c[6],M=c[10];switch(s){case"XYZ":this._y=Math.asin(wn(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(-_,M),this._z=Math.atan2(-f,u)):(this._x=Math.atan2(b,v),this._z=0);break;case"YXZ":this._x=Math.asin(-wn(_,-1,1)),Math.abs(_)<.9999999?(this._y=Math.atan2(m,M),this._z=Math.atan2(y,v)):(this._y=Math.atan2(-w,u),this._z=0);break;case"ZXY":this._x=Math.asin(wn(b,-1,1)),Math.abs(b)<.9999999?(this._y=Math.atan2(-w,M),this._z=Math.atan2(-f,v)):(this._y=0,this._z=Math.atan2(y,u));break;case"ZYX":this._y=Math.asin(-wn(w,-1,1)),Math.abs(w)<.9999999?(this._x=Math.atan2(b,M),this._z=Math.atan2(y,u)):(this._x=0,this._z=Math.atan2(-f,v));break;case"YZX":this._z=Math.asin(wn(y,-1,1)),Math.abs(y)<.9999999?(this._x=Math.atan2(-_,v),this._y=Math.atan2(-w,u)):(this._x=0,this._y=Math.atan2(m,M));break;case"XZY":this._z=Math.asin(-wn(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(b,v),this._y=Math.atan2(m,u)):(this._x=Math.atan2(-_,M),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+s)}return this._order=s,!0===a&&this._onChangeCallback(),this}setFromQuaternion(n,s,a){return ad.makeRotationFromQuaternion(n),this.setFromRotationMatrix(ad,s,a)}setFromVector3(n,s=this._order){return this.set(n.x,n.y,n.z,s)}reorder(n){return Jm.setFromEuler(this),this.setFromQuaternion(Jm,n)}equals(n){return n._x===this._x&&n._y===this._y&&n._z===this._z&&n._order===this._order}fromArray(n){return this._x=n[0],this._y=n[1],this._z=n[2],void 0!==n[3]&&(this._order=n[3]),this._onChangeCallback(),this}toArray(n=[],s=0){return n[s]=this._x,n[s+1]=this._y,n[s+2]=this._z,n[s+3]=this._order,n}_onChange(n){return this._onChangeCallback=n,this}_onChangeCallback(){}}Us.prototype.isEuler=!0,Us.DefaultOrder="XYZ",Us.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class hf{constructor(){this.mask=1}set(n){this.mask=(1<<n|0)>>>0}enable(n){this.mask|=1<<n|0}enableAll(){this.mask=-1}toggle(n){this.mask^=1<<n|0}disable(n){this.mask&=~(1<<n|0)}disableAll(){this.mask=0}test(n){return 0!=(this.mask&n.mask)}isEnabled(n){return 0!=(this.mask&(1<<n|0))}}let H_=0;const ld=new k,tl=new un,Or=new $e,ff=new k,pn=new k,eg=new k,V_=new un,Un=new k(1,0,0),tg=new k(0,1,0),z_=new k(0,0,1),cd={type:"added"},nr={type:"removed"};class Jt extends ia{constructor(){super(),Object.defineProperty(this,"id",{value:H_++}),this.uuid=St(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=Jt.DefaultUp.clone();const n=new k,s=new Us,a=new un,c=new k(1,1,1);s._onChange(function u(){a.setFromEuler(s,!1)}),a._onChange(function f(){s.setFromQuaternion(a,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:n},rotation:{configurable:!0,enumerable:!0,value:s},quaternion:{configurable:!0,enumerable:!0,value:a},scale:{configurable:!0,enumerable:!0,value:c},modelViewMatrix:{value:new $e},normalMatrix:{value:new Pn}}),this.matrix=new $e,this.matrixWorld=new $e,this.matrixAutoUpdate=Jt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new hf,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(n){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(n),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(n){return this.quaternion.premultiply(n),this}setRotationFromAxisAngle(n,s){this.quaternion.setFromAxisAngle(n,s)}setRotationFromEuler(n){this.quaternion.setFromEuler(n,!0)}setRotationFromMatrix(n){this.quaternion.setFromRotationMatrix(n)}setRotationFromQuaternion(n){this.quaternion.copy(n)}rotateOnAxis(n,s){return tl.setFromAxisAngle(n,s),this.quaternion.multiply(tl),this}rotateOnWorldAxis(n,s){return tl.setFromAxisAngle(n,s),this.quaternion.premultiply(tl),this}rotateX(n){return this.rotateOnAxis(Un,n)}rotateY(n){return this.rotateOnAxis(tg,n)}rotateZ(n){return this.rotateOnAxis(z_,n)}translateOnAxis(n,s){return ld.copy(n).applyQuaternion(this.quaternion),this.position.add(ld.multiplyScalar(s)),this}translateX(n){return this.translateOnAxis(Un,n)}translateY(n){return this.translateOnAxis(tg,n)}translateZ(n){return this.translateOnAxis(z_,n)}localToWorld(n){return n.applyMatrix4(this.matrixWorld)}worldToLocal(n){return n.applyMatrix4(Or.copy(this.matrixWorld).invert())}lookAt(n,s,a){n.isVector3?ff.copy(n):ff.set(n,s,a);const c=this.parent;this.updateWorldMatrix(!0,!1),pn.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Or.lookAt(pn,ff,this.up):Or.lookAt(ff,pn,this.up),this.quaternion.setFromRotationMatrix(Or),c&&(Or.extractRotation(c.matrixWorld),tl.setFromRotationMatrix(Or),this.quaternion.premultiply(tl.invert()))}add(n){if(arguments.length>1){for(let s=0;s<arguments.length;s++)this.add(arguments[s]);return this}return n===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",n),this):(n&&n.isObject3D?(null!==n.parent&&n.parent.remove(n),n.parent=this,this.children.push(n),n.dispatchEvent(cd)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",n),this)}remove(n){if(arguments.length>1){for(let a=0;a<arguments.length;a++)this.remove(arguments[a]);return this}const s=this.children.indexOf(n);return-1!==s&&(n.parent=null,this.children.splice(s,1),n.dispatchEvent(nr)),this}removeFromParent(){const n=this.parent;return null!==n&&n.remove(this),this}clear(){for(let n=0;n<this.children.length;n++){const s=this.children[n];s.parent=null,s.dispatchEvent(nr)}return this.children.length=0,this}attach(n){return this.updateWorldMatrix(!0,!1),Or.copy(this.matrixWorld).invert(),null!==n.parent&&(n.parent.updateWorldMatrix(!0,!1),Or.multiply(n.parent.matrixWorld)),n.applyMatrix4(Or),this.add(n),n.updateWorldMatrix(!1,!0),this}getObjectById(n){return this.getObjectByProperty("id",n)}getObjectByName(n){return this.getObjectByProperty("name",n)}getObjectByProperty(n,s){if(this[n]===s)return this;for(let a=0,c=this.children.length;a<c;a++){const f=this.children[a].getObjectByProperty(n,s);if(void 0!==f)return f}}getWorldPosition(n){return this.updateWorldMatrix(!0,!1),n.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(pn,n,eg),n}getWorldScale(n){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(pn,V_,n),n}getWorldDirection(n){this.updateWorldMatrix(!0,!1);const s=this.matrixWorld.elements;return n.set(s[8],s[9],s[10]).normalize()}raycast(){}traverse(n){n(this);const s=this.children;for(let a=0,c=s.length;a<c;a++)s[a].traverse(n)}traverseVisible(n){if(!1===this.visible)return;n(this);const s=this.children;for(let a=0,c=s.length;a<c;a++)s[a].traverseVisible(n)}traverseAncestors(n){const s=this.parent;null!==s&&(n(s),s.traverseAncestors(n))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(n){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||n)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,n=!0);const s=this.children;for(let a=0,c=s.length;a<c;a++)s[a].updateMatrixWorld(n)}updateWorldMatrix(n,s){const a=this.parent;if(!0===n&&null!==a&&a.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===s){const c=this.children;for(let u=0,f=c.length;u<f;u++)c[u].updateWorldMatrix(!1,!0)}}toJSON(n){const s=void 0===n||"string"==typeof n,a={};s&&(n={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},a.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const c={};function u(m,y){return void 0===m[y.uuid]&&(m[y.uuid]=y.toJSON(n)),y.uuid}if(c.uuid=this.uuid,c.type=this.type,""!==this.name&&(c.name=this.name),!0===this.castShadow&&(c.castShadow=!0),!0===this.receiveShadow&&(c.receiveShadow=!0),!1===this.visible&&(c.visible=!1),!1===this.frustumCulled&&(c.frustumCulled=!1),0!==this.renderOrder&&(c.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(c.userData=this.userData),c.layers=this.layers.mask,c.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(c.matrixAutoUpdate=!1),this.isInstancedMesh&&(c.type="InstancedMesh",c.count=this.count,c.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(c.instanceColor=this.instanceColor.toJSON())),this.isScene)this.background&&(this.background.isColor?c.background=this.background.toJSON():this.background.isTexture&&(c.background=this.background.toJSON(n).uuid)),this.environment&&this.environment.isTexture&&(c.environment=this.environment.toJSON(n).uuid);else if(this.isMesh||this.isLine||this.isPoints){c.geometry=u(n.geometries,this.geometry);const m=this.geometry.parameters;if(void 0!==m&&void 0!==m.shapes){const y=m.shapes;if(Array.isArray(y))for(let v=0,_=y.length;v<_;v++)u(n.shapes,y[v]);else u(n.shapes,y)}}if(this.isSkinnedMesh&&(c.bindMode=this.bindMode,c.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(u(n.skeletons,this.skeleton),c.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){const m=[];for(let y=0,v=this.material.length;y<v;y++)m.push(u(n.materials,this.material[y]));c.material=m}else c.material=u(n.materials,this.material);if(this.children.length>0){c.children=[];for(let m=0;m<this.children.length;m++)c.children.push(this.children[m].toJSON(n).object)}if(this.animations.length>0){c.animations=[];for(let m=0;m<this.animations.length;m++)c.animations.push(u(n.animations,this.animations[m]))}if(s){const m=f(n.geometries),y=f(n.materials),v=f(n.textures),_=f(n.images),w=f(n.shapes),b=f(n.skeletons),M=f(n.animations),C=f(n.nodes);m.length>0&&(a.geometries=m),y.length>0&&(a.materials=y),v.length>0&&(a.textures=v),_.length>0&&(a.images=_),w.length>0&&(a.shapes=w),b.length>0&&(a.skeletons=b),M.length>0&&(a.animations=M),C.length>0&&(a.nodes=C)}return a.object=c,a;function f(m){const y=[];for(const v in m){const _=m[v];delete _.metadata,y.push(_)}return y}}clone(n){return(new this.constructor).copy(this,n)}copy(n,s=!0){if(this.name=n.name,this.up.copy(n.up),this.position.copy(n.position),this.rotation.order=n.rotation.order,this.quaternion.copy(n.quaternion),this.scale.copy(n.scale),this.matrix.copy(n.matrix),this.matrixWorld.copy(n.matrixWorld),this.matrixAutoUpdate=n.matrixAutoUpdate,this.matrixWorldNeedsUpdate=n.matrixWorldNeedsUpdate,this.layers.mask=n.layers.mask,this.visible=n.visible,this.castShadow=n.castShadow,this.receiveShadow=n.receiveShadow,this.frustumCulled=n.frustumCulled,this.renderOrder=n.renderOrder,this.userData=JSON.parse(JSON.stringify(n.userData)),!0===s)for(let a=0;a<n.children.length;a++)this.add(n.children[a].clone());return this}}Jt.DefaultUp=new k(0,1,0),Jt.DefaultMatrixAutoUpdate=!0,Jt.prototype.isObject3D=!0;const ir=new k,ji=new k,Li=new k,hs=new k,_o=new k,nl=new k,Hs=new k,ud=new k,vc=new k,rt=new k;class ni{constructor(n=new k,s=new k,a=new k){this.a=n,this.b=s,this.c=a}static getNormal(n,s,a,c){c.subVectors(a,s),ir.subVectors(n,s),c.cross(ir);const u=c.lengthSq();return u>0?c.multiplyScalar(1/Math.sqrt(u)):c.set(0,0,0)}static getBarycoord(n,s,a,c,u){ir.subVectors(c,s),ji.subVectors(a,s),Li.subVectors(n,s);const f=ir.dot(ir),m=ir.dot(ji),y=ir.dot(Li),v=ji.dot(ji),_=ji.dot(Li),w=f*v-m*m;if(0===w)return u.set(-2,-1,-1);const b=1/w,M=(v*y-m*_)*b,C=(f*_-m*y)*b;return u.set(1-M-C,C,M)}static containsPoint(n,s,a,c){return this.getBarycoord(n,s,a,c,hs),hs.x>=0&&hs.y>=0&&hs.x+hs.y<=1}static getUV(n,s,a,c,u,f,m,y){return this.getBarycoord(n,s,a,c,hs),y.set(0,0),y.addScaledVector(u,hs.x),y.addScaledVector(f,hs.y),y.addScaledVector(m,hs.z),y}static isFrontFacing(n,s,a,c){return ir.subVectors(a,s),ji.subVectors(n,s),ir.cross(ji).dot(c)<0}set(n,s,a){return this.a.copy(n),this.b.copy(s),this.c.copy(a),this}setFromPointsAndIndices(n,s,a,c){return this.a.copy(n[s]),this.b.copy(n[a]),this.c.copy(n[c]),this}setFromAttributeAndIndices(n,s,a,c){return this.a.fromBufferAttribute(n,s),this.b.fromBufferAttribute(n,a),this.c.fromBufferAttribute(n,c),this}clone(){return(new this.constructor).copy(this)}copy(n){return this.a.copy(n.a),this.b.copy(n.b),this.c.copy(n.c),this}getArea(){return ir.subVectors(this.c,this.b),ji.subVectors(this.a,this.b),.5*ir.cross(ji).length()}getMidpoint(n){return n.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(n){return ni.getNormal(this.a,this.b,this.c,n)}getPlane(n){return n.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(n,s){return ni.getBarycoord(n,this.a,this.b,this.c,s)}getUV(n,s,a,c,u){return ni.getUV(n,this.a,this.b,this.c,s,a,c,u)}containsPoint(n){return ni.containsPoint(n,this.a,this.b,this.c)}isFrontFacing(n){return ni.isFrontFacing(this.a,this.b,this.c,n)}intersectsBox(n){return n.intersectsTriangle(this)}closestPointToPoint(n,s){const a=this.a,c=this.b,u=this.c;let f,m;_o.subVectors(c,a),nl.subVectors(u,a),ud.subVectors(n,a);const y=_o.dot(ud),v=nl.dot(ud);if(y<=0&&v<=0)return s.copy(a);vc.subVectors(n,c);const _=_o.dot(vc),w=nl.dot(vc);if(_>=0&&w<=_)return s.copy(c);const b=y*w-_*v;if(b<=0&&y>=0&&_<=0)return f=y/(y-_),s.copy(a).addScaledVector(_o,f);rt.subVectors(n,u);const M=_o.dot(rt),C=nl.dot(rt);if(C>=0&&M<=C)return s.copy(u);const E=M*v-y*C;if(E<=0&&v>=0&&C<=0)return m=v/(v-C),s.copy(a).addScaledVector(nl,m);const S=_*C-M*w;if(S<=0&&w-_>=0&&M-C>=0)return Hs.subVectors(u,c),m=(w-_)/(w-_+(M-C)),s.copy(c).addScaledVector(Hs,m);const A=1/(S+E+b);return f=E*A,m=b*A,s.copy(a).addScaledVector(_o,f).addScaledVector(nl,m)}equals(n){return n.a.equals(this.a)&&n.b.equals(this.b)&&n.c.equals(this.c)}}let G_=0;class Zn extends ia{constructor(){super(),Object.defineProperty(this,"id",{value:G_++}),this.uuid=St(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(n){this._alphaTest>0!=n>0&&this.version++,this._alphaTest=n}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(n){if(void 0!==n)for(const s in n){const a=n[s];if(void 0===a){console.warn("THREE.Material: '"+s+"' parameter is undefined.");continue}if("shading"===s){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===a;continue}const c=this[s];void 0!==c?c&&c.isColor?c.set(a):c&&c.isVector3&&a&&a.isVector3?c.copy(a):this[s]=a:console.warn("THREE."+this.type+": '"+s+"' is not a property of this material.")}}toJSON(n){const s=void 0===n||"string"==typeof n;s&&(n={textures:{},images:{}});const a={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function c(u){const f=[];for(const m in u){const y=u[m];delete y.metadata,f.push(y)}return f}if(a.uuid=this.uuid,a.type=this.type,""!==this.name&&(a.name=this.name),this.color&&this.color.isColor&&(a.color=this.color.getHex()),void 0!==this.roughness&&(a.roughness=this.roughness),void 0!==this.metalness&&(a.metalness=this.metalness),void 0!==this.sheen&&(a.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(a.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(a.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(a.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(a.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(a.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(a.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(a.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(a.shininess=this.shininess),void 0!==this.clearcoat&&(a.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(a.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(a.clearcoatMap=this.clearcoatMap.toJSON(n).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(a.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(n).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(a.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(n).uuid,a.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(a.map=this.map.toJSON(n).uuid),this.matcap&&this.matcap.isTexture&&(a.matcap=this.matcap.toJSON(n).uuid),this.alphaMap&&this.alphaMap.isTexture&&(a.alphaMap=this.alphaMap.toJSON(n).uuid),this.lightMap&&this.lightMap.isTexture&&(a.lightMap=this.lightMap.toJSON(n).uuid,a.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(a.aoMap=this.aoMap.toJSON(n).uuid,a.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(a.bumpMap=this.bumpMap.toJSON(n).uuid,a.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(a.normalMap=this.normalMap.toJSON(n).uuid,a.normalMapType=this.normalMapType,a.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(a.displacementMap=this.displacementMap.toJSON(n).uuid,a.displacementScale=this.displacementScale,a.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(a.roughnessMap=this.roughnessMap.toJSON(n).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(a.metalnessMap=this.metalnessMap.toJSON(n).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(a.emissiveMap=this.emissiveMap.toJSON(n).uuid),this.specularMap&&this.specularMap.isTexture&&(a.specularMap=this.specularMap.toJSON(n).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(a.specularIntensityMap=this.specularIntensityMap.toJSON(n).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(a.specularColorMap=this.specularColorMap.toJSON(n).uuid),this.envMap&&this.envMap.isTexture&&(a.envMap=this.envMap.toJSON(n).uuid,void 0!==this.combine&&(a.combine=this.combine)),void 0!==this.envMapIntensity&&(a.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(a.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(a.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(a.gradientMap=this.gradientMap.toJSON(n).uuid),void 0!==this.transmission&&(a.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(a.transmissionMap=this.transmissionMap.toJSON(n).uuid),void 0!==this.thickness&&(a.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(a.thicknessMap=this.thicknessMap.toJSON(n).uuid),void 0!==this.attenuationDistance&&(a.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(a.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(a.size=this.size),null!==this.shadowSide&&(a.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(a.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(a.blending=this.blending),0!==this.side&&(a.side=this.side),this.vertexColors&&(a.vertexColors=!0),this.opacity<1&&(a.opacity=this.opacity),!0===this.transparent&&(a.transparent=this.transparent),a.depthFunc=this.depthFunc,a.depthTest=this.depthTest,a.depthWrite=this.depthWrite,a.colorWrite=this.colorWrite,a.stencilWrite=this.stencilWrite,a.stencilWriteMask=this.stencilWriteMask,a.stencilFunc=this.stencilFunc,a.stencilRef=this.stencilRef,a.stencilFuncMask=this.stencilFuncMask,a.stencilFail=this.stencilFail,a.stencilZFail=this.stencilZFail,a.stencilZPass=this.stencilZPass,void 0!==this.rotation&&0!==this.rotation&&(a.rotation=this.rotation),!0===this.polygonOffset&&(a.polygonOffset=!0),0!==this.polygonOffsetFactor&&(a.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(a.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(a.linewidth=this.linewidth),void 0!==this.dashSize&&(a.dashSize=this.dashSize),void 0!==this.gapSize&&(a.gapSize=this.gapSize),void 0!==this.scale&&(a.scale=this.scale),!0===this.dithering&&(a.dithering=!0),this.alphaTest>0&&(a.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(a.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(a.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(a.wireframe=this.wireframe),this.wireframeLinewidth>1&&(a.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(a.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(a.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(a.flatShading=this.flatShading),!1===this.visible&&(a.visible=!1),!1===this.toneMapped&&(a.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(a.userData=this.userData),s){const u=c(n.textures),f=c(n.images);u.length>0&&(a.textures=u),f.length>0&&(a.images=f)}return a}clone(){return(new this.constructor).copy(this)}copy(n){this.name=n.name,this.fog=n.fog,this.blending=n.blending,this.side=n.side,this.vertexColors=n.vertexColors,this.opacity=n.opacity,this.transparent=n.transparent,this.blendSrc=n.blendSrc,this.blendDst=n.blendDst,this.blendEquation=n.blendEquation,this.blendSrcAlpha=n.blendSrcAlpha,this.blendDstAlpha=n.blendDstAlpha,this.blendEquationAlpha=n.blendEquationAlpha,this.depthFunc=n.depthFunc,this.depthTest=n.depthTest,this.depthWrite=n.depthWrite,this.stencilWriteMask=n.stencilWriteMask,this.stencilFunc=n.stencilFunc,this.stencilRef=n.stencilRef,this.stencilFuncMask=n.stencilFuncMask,this.stencilFail=n.stencilFail,this.stencilZFail=n.stencilZFail,this.stencilZPass=n.stencilZPass,this.stencilWrite=n.stencilWrite;const s=n.clippingPlanes;let a=null;if(null!==s){const c=s.length;a=new Array(c);for(let u=0;u!==c;++u)a[u]=s[u].clone()}return this.clippingPlanes=a,this.clipIntersection=n.clipIntersection,this.clipShadows=n.clipShadows,this.shadowSide=n.shadowSide,this.colorWrite=n.colorWrite,this.precision=n.precision,this.polygonOffset=n.polygonOffset,this.polygonOffsetFactor=n.polygonOffsetFactor,this.polygonOffsetUnits=n.polygonOffsetUnits,this.dithering=n.dithering,this.alphaTest=n.alphaTest,this.alphaToCoverage=n.alphaToCoverage,this.premultipliedAlpha=n.premultipliedAlpha,this.visible=n.visible,this.toneMapped=n.toneMapped,this.userData=JSON.parse(JSON.stringify(n.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(n){!0===n&&this.version++}}Zn.prototype.isMaterial=!0,Zn.fromType=function(){return null};class Vs extends Zn{constructor(n){super(),this.type="MeshBasicMaterial",this.color=new Re(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this}}Vs.prototype.isMeshBasicMaterial=!0;const Hn=new k,dd=new he;class mn{constructor(n,s,a){if(Array.isArray(n))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=n,this.itemSize=s,this.count=void 0!==n?n.length/s:0,this.normalized=!0===a,this.usage=cc,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(n){!0===n&&this.version++}setUsage(n){return this.usage=n,this}copy(n){return this.name=n.name,this.array=new n.array.constructor(n.array),this.itemSize=n.itemSize,this.count=n.count,this.normalized=n.normalized,this.usage=n.usage,this}copyAt(n,s,a){n*=this.itemSize,a*=s.itemSize;for(let c=0,u=this.itemSize;c<u;c++)this.array[n+c]=s.array[a+c];return this}copyArray(n){return this.array.set(n),this}copyColorsArray(n){const s=this.array;let a=0;for(let c=0,u=n.length;c<u;c++){let f=n[c];void 0===f&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",c),f=new Re),s[a++]=f.r,s[a++]=f.g,s[a++]=f.b}return this}copyVector2sArray(n){const s=this.array;let a=0;for(let c=0,u=n.length;c<u;c++){let f=n[c];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",c),f=new he),s[a++]=f.x,s[a++]=f.y}return this}copyVector3sArray(n){const s=this.array;let a=0;for(let c=0,u=n.length;c<u;c++){let f=n[c];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",c),f=new k),s[a++]=f.x,s[a++]=f.y,s[a++]=f.z}return this}copyVector4sArray(n){const s=this.array;let a=0;for(let c=0,u=n.length;c<u;c++){let f=n[c];void 0===f&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",c),f=new jt),s[a++]=f.x,s[a++]=f.y,s[a++]=f.z,s[a++]=f.w}return this}applyMatrix3(n){if(2===this.itemSize)for(let s=0,a=this.count;s<a;s++)dd.fromBufferAttribute(this,s),dd.applyMatrix3(n),this.setXY(s,dd.x,dd.y);else if(3===this.itemSize)for(let s=0,a=this.count;s<a;s++)Hn.fromBufferAttribute(this,s),Hn.applyMatrix3(n),this.setXYZ(s,Hn.x,Hn.y,Hn.z);return this}applyMatrix4(n){for(let s=0,a=this.count;s<a;s++)Hn.fromBufferAttribute(this,s),Hn.applyMatrix4(n),this.setXYZ(s,Hn.x,Hn.y,Hn.z);return this}applyNormalMatrix(n){for(let s=0,a=this.count;s<a;s++)Hn.fromBufferAttribute(this,s),Hn.applyNormalMatrix(n),this.setXYZ(s,Hn.x,Hn.y,Hn.z);return this}transformDirection(n){for(let s=0,a=this.count;s<a;s++)Hn.fromBufferAttribute(this,s),Hn.transformDirection(n),this.setXYZ(s,Hn.x,Hn.y,Hn.z);return this}set(n,s=0){return this.array.set(n,s),this}getX(n){return this.array[n*this.itemSize]}setX(n,s){return this.array[n*this.itemSize]=s,this}getY(n){return this.array[n*this.itemSize+1]}setY(n,s){return this.array[n*this.itemSize+1]=s,this}getZ(n){return this.array[n*this.itemSize+2]}setZ(n,s){return this.array[n*this.itemSize+2]=s,this}getW(n){return this.array[n*this.itemSize+3]}setW(n,s){return this.array[n*this.itemSize+3]=s,this}setXY(n,s,a){return this.array[0+(n*=this.itemSize)]=s,this.array[n+1]=a,this}setXYZ(n,s,a,c){return this.array[0+(n*=this.itemSize)]=s,this.array[n+1]=a,this.array[n+2]=c,this}setXYZW(n,s,a,c,u){return this.array[0+(n*=this.itemSize)]=s,this.array[n+1]=a,this.array[n+2]=c,this.array[n+3]=u,this}onUpload(n){return this.onUploadCallback=n,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const n={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(n.name=this.name),this.usage!==cc&&(n.usage=this.usage),(0!==this.updateRange.offset||-1!==this.updateRange.count)&&(n.updateRange=this.updateRange),n}}mn.prototype.isBufferAttribute=!0;class pf extends mn{constructor(n,s,a){super(new Uint16Array(n),s,a)}}class gr extends mn{constructor(n,s,a){super(new Uint32Array(n),s,a)}}(class mf extends mn{constructor(n,s,a){super(new Uint16Array(n),s,a)}}).prototype.isFloat16BufferAttribute=!0;class Ve extends mn{constructor(n,s,a){super(new Float32Array(n),s,a)}}let W_=0;const Fi=new $e,il=new Jt,Yn=new k,Vn=new Ln,rl=new Ln,Dn=new k;class Ye extends ia{constructor(){super(),Object.defineProperty(this,"id",{value:W_++}),this.uuid=St(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(n){return this.index=Array.isArray(n)?new(hc(n)?gr:pf)(n,1):n,this}getAttribute(n){return this.attributes[n]}setAttribute(n,s){return this.attributes[n]=s,this}deleteAttribute(n){return delete this.attributes[n],this}hasAttribute(n){return void 0!==this.attributes[n]}addGroup(n,s,a=0){this.groups.push({start:n,count:s,materialIndex:a})}clearGroups(){this.groups=[]}setDrawRange(n,s){this.drawRange.start=n,this.drawRange.count=s}applyMatrix4(n){const s=this.attributes.position;void 0!==s&&(s.applyMatrix4(n),s.needsUpdate=!0);const a=this.attributes.normal;if(void 0!==a){const u=(new Pn).getNormalMatrix(n);a.applyNormalMatrix(u),a.needsUpdate=!0}const c=this.attributes.tangent;return void 0!==c&&(c.transformDirection(n),c.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(n){return Fi.makeRotationFromQuaternion(n),this.applyMatrix4(Fi),this}rotateX(n){return Fi.makeRotationX(n),this.applyMatrix4(Fi),this}rotateY(n){return Fi.makeRotationY(n),this.applyMatrix4(Fi),this}rotateZ(n){return Fi.makeRotationZ(n),this.applyMatrix4(Fi),this}translate(n,s,a){return Fi.makeTranslation(n,s,a),this.applyMatrix4(Fi),this}scale(n,s,a){return Fi.makeScale(n,s,a),this.applyMatrix4(Fi),this}lookAt(n){return il.lookAt(n),il.updateMatrix(),this.applyMatrix4(il.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Yn).negate(),this.translate(Yn.x,Yn.y,Yn.z),this}setFromPoints(n){const s=[];for(let a=0,c=n.length;a<c;a++){const u=n[a];s.push(u.x,u.y,u.z||0)}return this.setAttribute("position",new Ve(s,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new Ln);const n=this.attributes.position,s=this.morphAttributes.position;if(n&&n.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new k(-1/0,-1/0,-1/0),new k(1/0,1/0,1/0));if(void 0!==n){if(this.boundingBox.setFromBufferAttribute(n),s)for(let a=0,c=s.length;a<c;a++)Vn.setFromBufferAttribute(s[a]),this.morphTargetsRelative?(Dn.addVectors(this.boundingBox.min,Vn.min),this.boundingBox.expandByPoint(Dn),Dn.addVectors(this.boundingBox.max,Vn.max),this.boundingBox.expandByPoint(Dn)):(this.boundingBox.expandByPoint(Vn.min),this.boundingBox.expandByPoint(Vn.max))}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new yo);const n=this.attributes.position,s=this.morphAttributes.position;if(n&&n.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new k,1/0);if(n){const a=this.boundingSphere.center;if(Vn.setFromBufferAttribute(n),s)for(let u=0,f=s.length;u<f;u++)rl.setFromBufferAttribute(s[u]),this.morphTargetsRelative?(Dn.addVectors(Vn.min,rl.min),Vn.expandByPoint(Dn),Dn.addVectors(Vn.max,rl.max),Vn.expandByPoint(Dn)):(Vn.expandByPoint(rl.min),Vn.expandByPoint(rl.max));Vn.getCenter(a);let c=0;for(let u=0,f=n.count;u<f;u++)Dn.fromBufferAttribute(n,u),c=Math.max(c,a.distanceToSquared(Dn));if(s)for(let u=0,f=s.length;u<f;u++){const m=s[u],y=this.morphTargetsRelative;for(let v=0,_=m.count;v<_;v++)Dn.fromBufferAttribute(m,v),y&&(Yn.fromBufferAttribute(n,v),Dn.add(Yn)),c=Math.max(c,a.distanceToSquared(Dn))}this.boundingSphere.radius=Math.sqrt(c),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const n=this.index,s=this.attributes;if(null===n||void 0===s.position||void 0===s.normal||void 0===s.uv)return void console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");const a=n.array,c=s.position.array,u=s.normal.array,f=s.uv.array,m=c.length/3;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new mn(new Float32Array(4*m),4));const y=this.getAttribute("tangent").array,v=[],_=[];for(let q=0;q<m;q++)v[q]=new k,_[q]=new k;const w=new k,b=new k,M=new k,C=new he,E=new he,S=new he,A=new k,R=new k;function F(q,L,G){w.fromArray(c,3*q),b.fromArray(c,3*L),M.fromArray(c,3*G),C.fromArray(f,2*q),E.fromArray(f,2*L),S.fromArray(f,2*G),b.sub(w),M.sub(w),E.sub(C),S.sub(C);const _e=1/(E.x*S.y-S.x*E.y);!isFinite(_e)||(A.copy(b).multiplyScalar(S.y).addScaledVector(M,-E.y).multiplyScalar(_e),R.copy(M).multiplyScalar(E.x).addScaledVector(b,-S.x).multiplyScalar(_e),v[q].add(A),v[L].add(A),v[G].add(A),_[q].add(R),_[L].add(R),_[G].add(R))}let I=this.groups;0===I.length&&(I=[{start:0,count:a.length}]);for(let q=0,L=I.length;q<L;++q){const G=I[q],_e=G.start;for(let ne=_e,J=_e+G.count;ne<J;ne+=3)F(a[ne+0],a[ne+1],a[ne+2])}const O=new k,V=new k,W=new k,$=new k;function ie(q){W.fromArray(u,3*q),$.copy(W);const L=v[q];O.copy(L),O.sub(W.multiplyScalar(W.dot(L))).normalize(),V.crossVectors($,L);const _e=V.dot(_[q])<0?-1:1;y[4*q]=O.x,y[4*q+1]=O.y,y[4*q+2]=O.z,y[4*q+3]=_e}for(let q=0,L=I.length;q<L;++q){const G=I[q],_e=G.start;for(let ne=_e,J=_e+G.count;ne<J;ne+=3)ie(a[ne+0]),ie(a[ne+1]),ie(a[ne+2])}}computeVertexNormals(){const n=this.index,s=this.getAttribute("position");if(void 0!==s){let a=this.getAttribute("normal");if(void 0===a)a=new mn(new Float32Array(3*s.count),3),this.setAttribute("normal",a);else for(let b=0,M=a.count;b<M;b++)a.setXYZ(b,0,0,0);const c=new k,u=new k,f=new k,m=new k,y=new k,v=new k,_=new k,w=new k;if(n)for(let b=0,M=n.count;b<M;b+=3){const C=n.getX(b+0),E=n.getX(b+1),S=n.getX(b+2);c.fromBufferAttribute(s,C),u.fromBufferAttribute(s,E),f.fromBufferAttribute(s,S),_.subVectors(f,u),w.subVectors(c,u),_.cross(w),m.fromBufferAttribute(a,C),y.fromBufferAttribute(a,E),v.fromBufferAttribute(a,S),m.add(_),y.add(_),v.add(_),a.setXYZ(C,m.x,m.y,m.z),a.setXYZ(E,y.x,y.y,y.z),a.setXYZ(S,v.x,v.y,v.z)}else for(let b=0,M=s.count;b<M;b+=3)c.fromBufferAttribute(s,b+0),u.fromBufferAttribute(s,b+1),f.fromBufferAttribute(s,b+2),_.subVectors(f,u),w.subVectors(c,u),_.cross(w),a.setXYZ(b+0,_.x,_.y,_.z),a.setXYZ(b+1,_.x,_.y,_.z),a.setXYZ(b+2,_.x,_.y,_.z);this.normalizeNormals(),a.needsUpdate=!0}}merge(n,s){if(!n||!n.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",n);void 0===s&&(s=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const a=this.attributes;for(const c in a){if(void 0===n.attributes[c])continue;const f=a[c].array,m=n.attributes[c],y=m.array,v=m.itemSize*s,_=Math.min(y.length,f.length-v);for(let w=0,b=v;w<_;w++,b++)f[b]=y[w]}return this}normalizeNormals(){const n=this.attributes.normal;for(let s=0,a=n.count;s<a;s++)Dn.fromBufferAttribute(n,s),Dn.normalize(),n.setXYZ(s,Dn.x,Dn.y,Dn.z)}toNonIndexed(){function n(m,y){const v=m.array,_=m.itemSize,w=m.normalized,b=new v.constructor(y.length*_);let M=0,C=0;for(let E=0,S=y.length;E<S;E++){M=m.isInterleavedBufferAttribute?y[E]*m.data.stride+m.offset:y[E]*_;for(let A=0;A<_;A++)b[C++]=v[M++]}return new mn(b,_,w)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const s=new Ye,a=this.index.array,c=this.attributes;for(const m in c){const v=n(c[m],a);s.setAttribute(m,v)}const u=this.morphAttributes;for(const m in u){const y=[],v=u[m];for(let _=0,w=v.length;_<w;_++){const M=n(v[_],a);y.push(M)}s.morphAttributes[m]=y}s.morphTargetsRelative=this.morphTargetsRelative;const f=this.groups;for(let m=0,y=f.length;m<y;m++){const v=f[m];s.addGroup(v.start,v.count,v.materialIndex)}return s}toJSON(){const n={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),Object.keys(this.userData).length>0&&(n.userData=this.userData),void 0!==this.parameters){const y=this.parameters;for(const v in y)void 0!==y[v]&&(n[v]=y[v]);return n}n.data={attributes:{}};const s=this.index;null!==s&&(n.data.index={type:s.array.constructor.name,array:Array.prototype.slice.call(s.array)});const a=this.attributes;for(const y in a)n.data.attributes[y]=a[y].toJSON(n.data);const c={};let u=!1;for(const y in this.morphAttributes){const v=this.morphAttributes[y],_=[];for(let w=0,b=v.length;w<b;w++)_.push(v[w].toJSON(n.data));_.length>0&&(c[y]=_,u=!0)}u&&(n.data.morphAttributes=c,n.data.morphTargetsRelative=this.morphTargetsRelative);const f=this.groups;f.length>0&&(n.data.groups=JSON.parse(JSON.stringify(f)));const m=this.boundingSphere;return null!==m&&(n.data.boundingSphere={center:m.center.toArray(),radius:m.radius}),n}clone(){return(new this.constructor).copy(this)}copy(n){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const s={};this.name=n.name;const a=n.index;null!==a&&this.setIndex(a.clone(s));const c=n.attributes;for(const v in c)this.setAttribute(v,c[v].clone(s));const u=n.morphAttributes;for(const v in u){const _=[],w=u[v];for(let b=0,M=w.length;b<M;b++)_.push(w[b].clone(s));this.morphAttributes[v]=_}this.morphTargetsRelative=n.morphTargetsRelative;const f=n.groups;for(let v=0,_=f.length;v<_;v++){const w=f[v];this.addGroup(w.start,w.count,w.materialIndex)}const m=n.boundingBox;null!==m&&(this.boundingBox=m.clone());const y=n.boundingSphere;return null!==y&&(this.boundingSphere=y.clone()),this.drawRange.start=n.drawRange.start,this.drawRange.count=n.drawRange.count,this.userData=n.userData,void 0!==n.parameters&&(this.parameters=Object.assign({},n.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}Ye.prototype.isBufferGeometry=!0;const ng=new $e,ca=new vo,gf=new yo,xo=new k,fs=new k,ps=new k,fd=new k,_c=new k,yf=new k,xc=new k,ua=new k,wc=new k,bc=new he,Mc=new he,Ec=new he,sl=new k,pd=new k;class ii extends Jt{constructor(n=new Ye,s=new Vs){super(),this.type="Mesh",this.geometry=n,this.material=s,this.updateMorphTargets()}copy(n){return super.copy(n),void 0!==n.morphTargetInfluences&&(this.morphTargetInfluences=n.morphTargetInfluences.slice()),void 0!==n.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},n.morphTargetDictionary)),this.material=n.material,this.geometry=n.geometry,this}updateMorphTargets(){const n=this.geometry;if(n.isBufferGeometry){const s=n.morphAttributes,a=Object.keys(s);if(a.length>0){const c=s[a[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,f=c.length;u<f;u++){const m=c[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=u}}}}else{const s=n.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(n,s){const a=this.geometry,c=this.material,u=this.matrixWorld;if(void 0===c||(null===a.boundingSphere&&a.computeBoundingSphere(),gf.copy(a.boundingSphere),gf.applyMatrix4(u),!1===n.ray.intersectsSphere(gf))||(ng.copy(u).invert(),ca.copy(n.ray).applyMatrix4(ng),null!==a.boundingBox&&!1===ca.intersectsBox(a.boundingBox)))return;let f;if(a.isBufferGeometry){const m=a.index,y=a.attributes.position,v=a.morphAttributes.position,_=a.morphTargetsRelative,w=a.attributes.uv,b=a.attributes.uv2,M=a.groups,C=a.drawRange;if(null!==m)if(Array.isArray(c))for(let E=0,S=M.length;E<S;E++){const A=M[E],R=c[A.materialIndex];for(let O=Math.max(A.start,C.start),V=Math.min(m.count,Math.min(A.start+A.count,C.start+C.count));O<V;O+=3){const W=m.getX(O),$=m.getX(O+1),ie=m.getX(O+2);f=kr(this,R,n,ca,y,v,_,w,b,W,$,ie),f&&(f.faceIndex=Math.floor(O/3),f.face.materialIndex=A.materialIndex,s.push(f))}}else for(let A=Math.max(0,C.start),R=Math.min(m.count,C.start+C.count);A<R;A+=3){const F=m.getX(A),I=m.getX(A+1),O=m.getX(A+2);f=kr(this,c,n,ca,y,v,_,w,b,F,I,O),f&&(f.faceIndex=Math.floor(A/3),s.push(f))}else if(void 0!==y)if(Array.isArray(c))for(let E=0,S=M.length;E<S;E++){const A=M[E],R=c[A.materialIndex];for(let O=Math.max(A.start,C.start),V=Math.min(y.count,Math.min(A.start+A.count,C.start+C.count));O<V;O+=3)f=kr(this,R,n,ca,y,v,_,w,b,O,O+1,O+2),f&&(f.faceIndex=Math.floor(O/3),f.face.materialIndex=A.materialIndex,s.push(f))}else for(let A=Math.max(0,C.start),R=Math.min(y.count,C.start+C.count);A<R;A+=3)f=kr(this,c,n,ca,y,v,_,w,b,A,A+1,A+2),f&&(f.faceIndex=Math.floor(A/3),s.push(f))}else a.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}function kr(h,n,s,a,c,u,f,m,y,v,_,w){xo.fromBufferAttribute(c,v),fs.fromBufferAttribute(c,_),ps.fromBufferAttribute(c,w);const b=h.morphTargetInfluences;if(u&&b){xc.set(0,0,0),ua.set(0,0,0),wc.set(0,0,0);for(let C=0,E=u.length;C<E;C++){const S=b[C],A=u[C];0!==S&&(fd.fromBufferAttribute(A,v),_c.fromBufferAttribute(A,_),yf.fromBufferAttribute(A,w),f?(xc.addScaledVector(fd,S),ua.addScaledVector(_c,S),wc.addScaledVector(yf,S)):(xc.addScaledVector(fd.sub(xo),S),ua.addScaledVector(_c.sub(fs),S),wc.addScaledVector(yf.sub(ps),S)))}xo.add(xc),fs.add(ua),ps.add(wc)}h.isSkinnedMesh&&(h.boneTransform(v,xo),h.boneTransform(_,fs),h.boneTransform(w,ps));const M=function Ni(h,n,s,a,c,u,f,m){let y;if(y=1===n.side?a.intersectTriangle(f,u,c,!0,m):a.intersectTriangle(c,u,f,n.side!==co,m),null===y)return null;pd.copy(m),pd.applyMatrix4(h.matrixWorld);const v=s.ray.origin.distanceTo(pd);return v<s.near||v>s.far?null:{distance:v,point:pd.clone(),object:h}}(h,n,s,a,xo,fs,ps,sl);if(M){m&&(bc.fromBufferAttribute(m,v),Mc.fromBufferAttribute(m,_),Ec.fromBufferAttribute(m,w),M.uv=ni.getUV(sl,xo,fs,ps,bc,Mc,Ec,new he)),y&&(bc.fromBufferAttribute(y,v),Mc.fromBufferAttribute(y,_),Ec.fromBufferAttribute(y,w),M.uv2=ni.getUV(sl,xo,fs,ps,bc,Mc,Ec,new he));const C={a:v,b:_,c:w,normal:new k,materialIndex:0};ni.getNormal(xo,fs,ps,C.normal),M.face=C}return M}ii.prototype.isMesh=!0;class ln extends Ye{constructor(n=1,s=1,a=1,c=1,u=1,f=1){super(),this.type="BoxGeometry",this.parameters={width:n,height:s,depth:a,widthSegments:c,heightSegments:u,depthSegments:f};const m=this;c=Math.floor(c),u=Math.floor(u),f=Math.floor(f);const y=[],v=[],_=[],w=[];let b=0,M=0;function C(E,S,A,R,F,I,O,V,W,$,ie){const q=I/W,L=O/$,G=I/2,_e=O/2,Y=V/2,ne=W+1,J=$+1;let oe=0,X=0;const pe=new k;for(let ve=0;ve<J;ve++){const Me=ve*L-_e;for(let xe=0;xe<ne;xe++)pe[E]=(xe*q-G)*R,pe[S]=Me*F,pe[A]=Y,v.push(pe.x,pe.y,pe.z),pe[E]=0,pe[S]=0,pe[A]=V>0?1:-1,_.push(pe.x,pe.y,pe.z),w.push(xe/W),w.push(1-ve/$),oe+=1}for(let ve=0;ve<$;ve++)for(let Me=0;Me<W;Me++){const Qe=b+Me+ne*(ve+1),Rt=b+(Me+1)+ne*(ve+1),pt=b+(Me+1)+ne*ve;y.push(b+Me+ne*ve,Qe,pt),y.push(Qe,Rt,pt),X+=6}m.addGroup(M,X,ie),M+=X,b+=oe}C("z","y","x",-1,-1,a,s,n,f,u,0),C("z","y","x",1,-1,a,s,-n,f,u,1),C("x","z","y",1,1,n,a,s,c,f,2),C("x","z","y",1,-1,n,a,-s,c,f,3),C("x","y","z",1,-1,n,s,a,c,u,4),C("x","y","z",-1,-1,n,s,-a,c,u,5),this.setIndex(y),this.setAttribute("position",new Ve(v,3)),this.setAttribute("normal",new Ve(_,3)),this.setAttribute("uv",new Ve(w,2))}static fromJSON(n){return new ln(n.width,n.height,n.depth,n.widthSegments,n.heightSegments,n.depthSegments)}}function ol(h){const n={};for(const s in h){n[s]={};for(const a in h[s]){const c=h[s][a];n[s][a]=c&&(c.isColor||c.isMatrix3||c.isMatrix4||c.isVector2||c.isVector3||c.isVector4||c.isTexture||c.isQuaternion)?c.clone():Array.isArray(c)?c.slice():c}}return n}function Ti(h){const n={};for(let s=0;s<h.length;s++){const a=ol(h[s]);for(const c in a)n[c]=a[c]}return n}const ig={clone:ol,merge:Ti};class yr extends Zn{constructor(n){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==n&&(void 0!==n.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(n))}copy(n){return super.copy(n),this.fragmentShader=n.fragmentShader,this.vertexShader=n.vertexShader,this.uniforms=ol(n.uniforms),this.defines=Object.assign({},n.defines),this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.lights=n.lights,this.clipping=n.clipping,this.extensions=Object.assign({},n.extensions),this.glslVersion=n.glslVersion,this}toJSON(n){const s=super.toJSON(n);s.glslVersion=this.glslVersion,s.uniforms={};for(const c in this.uniforms){const f=this.uniforms[c].value;s.uniforms[c]=f&&f.isTexture?{type:"t",value:f.toJSON(n).uuid}:f&&f.isColor?{type:"c",value:f.getHex()}:f&&f.isVector2?{type:"v2",value:f.toArray()}:f&&f.isVector3?{type:"v3",value:f.toArray()}:f&&f.isVector4?{type:"v4",value:f.toArray()}:f&&f.isMatrix3?{type:"m3",value:f.toArray()}:f&&f.isMatrix4?{type:"m4",value:f.toArray()}:{value:f}}Object.keys(this.defines).length>0&&(s.defines=this.defines),s.vertexShader=this.vertexShader,s.fragmentShader=this.fragmentShader;const a={};for(const c in this.extensions)!0===this.extensions[c]&&(a[c]=!0);return Object.keys(a).length>0&&(s.extensions=a),s}}yr.prototype.isShaderMaterial=!0;class da extends Jt{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new $e,this.projectionMatrix=new $e,this.projectionMatrixInverse=new $e}copy(n,s){return super.copy(n,s),this.matrixWorldInverse.copy(n.matrixWorldInverse),this.projectionMatrix.copy(n.projectionMatrix),this.projectionMatrixInverse.copy(n.projectionMatrixInverse),this}getWorldDirection(n){this.updateWorldMatrix(!0,!1);const s=this.matrixWorld.elements;return n.set(-s[8],-s[9],-s[10]).normalize()}updateMatrixWorld(n){super.updateMatrixWorld(n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(n,s){super.updateWorldMatrix(n,s),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return(new this.constructor).copy(this)}}da.prototype.isCamera=!0;class zn extends da{constructor(n=50,s=1,a=.1,c=2e3){super(),this.type="PerspectiveCamera",this.fov=n,this.zoom=1,this.near=a,this.far=c,this.focus=10,this.aspect=s,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(n,s){return super.copy(n,s),this.fov=n.fov,this.zoom=n.zoom,this.near=n.near,this.far=n.far,this.focus=n.focus,this.aspect=n.aspect,this.view=null===n.view?null:Object.assign({},n.view),this.filmGauge=n.filmGauge,this.filmOffset=n.filmOffset,this}setFocalLength(n){const s=.5*this.getFilmHeight()/n;this.fov=2*as*Math.atan(s),this.updateProjectionMatrix()}getFocalLength(){const n=Math.tan(.5*$a*this.fov);return.5*this.getFilmHeight()/n}getEffectiveFOV(){return 2*as*Math.atan(Math.tan(.5*$a*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(n,s,a,c,u,f){this.aspect=n/s,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=s,this.view.offsetX=a,this.view.offsetY=c,this.view.width=u,this.view.height=f,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=this.near;let s=n*Math.tan(.5*$a*this.fov)/this.zoom,a=2*s,c=this.aspect*a,u=-.5*c;const f=this.view;if(null!==this.view&&this.view.enabled){const y=f.fullWidth,v=f.fullHeight;u+=f.offsetX*c/y,s-=f.offsetY*a/v,c*=f.width/y,a*=f.height/v}const m=this.filmOffset;0!==m&&(u+=n*m/this.getFilmWidth()),this.projectionMatrix.makePerspective(u,u+c,s,s-a,n,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const s=super.toJSON(n);return s.object.fov=this.fov,s.object.zoom=this.zoom,s.object.near=this.near,s.object.far=this.far,s.object.focus=this.focus,s.object.aspect=this.aspect,null!==this.view&&(s.object.view=Object.assign({},this.view)),s.object.filmGauge=this.filmGauge,s.object.filmOffset=this.filmOffset,s}}zn.prototype.isPerspectiveCamera=!0;class md extends Jt{constructor(n,s,a){if(super(),this.type="CubeCamera",!0!==a.isWebGLCubeRenderTarget)return void console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");this.renderTarget=a;const c=new zn(90,1,n,s);c.layers=this.layers,c.up.set(0,-1,0),c.lookAt(new k(1,0,0)),this.add(c);const u=new zn(90,1,n,s);u.layers=this.layers,u.up.set(0,-1,0),u.lookAt(new k(-1,0,0)),this.add(u);const f=new zn(90,1,n,s);f.layers=this.layers,f.up.set(0,0,1),f.lookAt(new k(0,1,0)),this.add(f);const m=new zn(90,1,n,s);m.layers=this.layers,m.up.set(0,0,-1),m.lookAt(new k(0,-1,0)),this.add(m);const y=new zn(90,1,n,s);y.layers=this.layers,y.up.set(0,-1,0),y.lookAt(new k(0,0,1)),this.add(y);const v=new zn(90,1,n,s);v.layers=this.layers,v.up.set(0,-1,0),v.lookAt(new k(0,0,-1)),this.add(v)}update(n,s){null===this.parent&&this.updateMatrixWorld();const a=this.renderTarget,[c,u,f,m,y,v]=this.children,_=n.getRenderTarget(),w=n.outputEncoding,b=n.toneMapping,M=n.xr.enabled;n.outputEncoding=po,n.toneMapping=0,n.xr.enabled=!1;const C=a.texture.generateMipmaps;a.texture.generateMipmaps=!1,n.setRenderTarget(a,0),n.render(s,c),n.setRenderTarget(a,1),n.render(s,u),n.setRenderTarget(a,2),n.render(s,f),n.setRenderTarget(a,3),n.render(s,m),n.setRenderTarget(a,4),n.render(s,y),a.texture.generateMipmaps=C,n.setRenderTarget(a,5),n.render(s,v),n.setRenderTarget(_),n.outputEncoding=w,n.toneMapping=b,n.xr.enabled=M,a.texture.needsPMREMUpdate=!0}}class Sc extends cn{constructor(n,s,a,c,u,f,m,y,v,_){super(n=void 0!==n?n:[],s=void 0!==s?s:301,a,c,u,f,m,y,v,_),this.flipY=!1}get images(){return this.image}set images(n){this.image=n}}Sc.prototype.isCubeTexture=!0;class Gs extends ti{constructor(n,s={}){super(n,n,s);const a={width:n,height:n,depth:1};this.texture=new Sc([a,a,a,a,a,a],s.mapping,s.wrapS,s.wrapT,s.magFilter,s.minFilter,s.format,s.type,s.anisotropy,s.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=void 0!==s.generateMipmaps&&s.generateMipmaps,this.texture.minFilter=void 0!==s.minFilter?s.minFilter:hn}fromEquirectangularTexture(n,s){this.texture.type=s.type,this.texture.encoding=s.encoding,this.texture.generateMipmaps=s.generateMipmaps,this.texture.minFilter=s.minFilter,this.texture.magFilter=s.magFilter;const a_uniforms={tEquirect:{value:null}},a_vertexShader="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",a_fragmentShader="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",c=new ln(5,5,5),u=new yr({name:"CubemapFromEquirect",uniforms:ol(a_uniforms),vertexShader:a_vertexShader,fragmentShader:a_fragmentShader,side:1,blending:Qi});u.uniforms.tEquirect.value=s;const f=new ii(c,u),m=s.minFilter;return 1008===s.minFilter&&(s.minFilter=hn),new md(1,10,this).update(n,f),s.minFilter=m,f.geometry.dispose(),f.material.dispose(),this}clear(n,s,a,c){const u=n.getRenderTarget();for(let f=0;f<6;f++)n.setRenderTarget(this,f),n.clear(s,a,c);n.setRenderTarget(u)}}Gs.prototype.isWebGLCubeRenderTarget=!0;const ha=new k,q_=new k,X_=new Pn;class rr{constructor(n=new k(1,0,0),s=0){this.normal=n,this.constant=s}set(n,s){return this.normal.copy(n),this.constant=s,this}setComponents(n,s,a,c){return this.normal.set(n,s,a),this.constant=c,this}setFromNormalAndCoplanarPoint(n,s){return this.normal.copy(n),this.constant=-s.dot(this.normal),this}setFromCoplanarPoints(n,s,a){const c=ha.subVectors(a,s).cross(q_.subVectors(n,s)).normalize();return this.setFromNormalAndCoplanarPoint(c,n),this}copy(n){return this.normal.copy(n.normal),this.constant=n.constant,this}normalize(){const n=1/this.normal.length();return this.normal.multiplyScalar(n),this.constant*=n,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(n){return this.normal.dot(n)+this.constant}distanceToSphere(n){return this.distanceToPoint(n.center)-n.radius}projectPoint(n,s){return s.copy(this.normal).multiplyScalar(-this.distanceToPoint(n)).add(n)}intersectLine(n,s){const a=n.delta(ha),c=this.normal.dot(a);if(0===c)return 0===this.distanceToPoint(n.start)?s.copy(n.start):null;const u=-(n.start.dot(this.normal)+this.constant)/c;return u<0||u>1?null:s.copy(a).multiplyScalar(u).add(n.start)}intersectsLine(n){const s=this.distanceToPoint(n.start),a=this.distanceToPoint(n.end);return s<0&&a>0||a<0&&s>0}intersectsBox(n){return n.intersectsPlane(this)}intersectsSphere(n){return n.intersectsPlane(this)}coplanarPoint(n){return n.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(n,s){const a=s||X_.getNormalMatrix(n),c=this.coplanarPoint(ha).applyMatrix4(n),u=this.normal.applyMatrix3(a).normalize();return this.constant=-c.dot(u),this}translate(n){return this.constant-=n.dot(this.normal),this}equals(n){return n.normal.equals(this.normal)&&n.constant===this.constant}clone(){return(new this.constructor).copy(this)}}rr.prototype.isPlane=!0;const bo=new yo,gd=new k;class yd{constructor(n=new rr,s=new rr,a=new rr,c=new rr,u=new rr,f=new rr){this.planes=[n,s,a,c,u,f]}set(n,s,a,c,u,f){const m=this.planes;return m[0].copy(n),m[1].copy(s),m[2].copy(a),m[3].copy(c),m[4].copy(u),m[5].copy(f),this}copy(n){const s=this.planes;for(let a=0;a<6;a++)s[a].copy(n.planes[a]);return this}setFromProjectionMatrix(n){const s=this.planes,a=n.elements,c=a[0],u=a[1],f=a[2],m=a[3],y=a[4],v=a[5],_=a[6],w=a[7],b=a[8],M=a[9],C=a[10],E=a[11],S=a[12],A=a[13],R=a[14],F=a[15];return s[0].setComponents(m-c,w-y,E-b,F-S).normalize(),s[1].setComponents(m+c,w+y,E+b,F+S).normalize(),s[2].setComponents(m+u,w+v,E+M,F+A).normalize(),s[3].setComponents(m-u,w-v,E-M,F-A).normalize(),s[4].setComponents(m-f,w-_,E-C,F-R).normalize(),s[5].setComponents(m+f,w+_,E+C,F+R).normalize(),this}intersectsObject(n){const s=n.geometry;return null===s.boundingSphere&&s.computeBoundingSphere(),bo.copy(s.boundingSphere).applyMatrix4(n.matrixWorld),this.intersectsSphere(bo)}intersectsSprite(n){return bo.center.set(0,0,0),bo.radius=.7071067811865476,bo.applyMatrix4(n.matrixWorld),this.intersectsSphere(bo)}intersectsSphere(n){const s=this.planes,a=n.center,c=-n.radius;for(let u=0;u<6;u++)if(s[u].distanceToPoint(a)<c)return!1;return!0}intersectsBox(n){const s=this.planes;for(let a=0;a<6;a++){const c=s[a];if(gd.x=c.normal.x>0?n.max.x:n.min.x,gd.y=c.normal.y>0?n.max.y:n.min.y,gd.z=c.normal.z>0?n.max.z:n.min.z,c.distanceToPoint(gd)<0)return!1}return!0}containsPoint(n){const s=this.planes;for(let a=0;a<6;a++)if(s[a].distanceToPoint(n)<0)return!1;return!0}clone(){return(new this.constructor).copy(this)}}function Z_(){let h=null,n=!1,s=null,a=null;function c(u,f){s(u,f),a=h.requestAnimationFrame(c)}return{start:function(){!0!==n&&null!==s&&(a=h.requestAnimationFrame(c),n=!0)},stop:function(){h.cancelAnimationFrame(a),n=!1},setAnimationLoop:function(u){s=u},setContext:function(u){h=u}}}function hE(h,n){const s=n.isWebGL2,a=new WeakMap;return{get:function f(v){return v.isInterleavedBufferAttribute&&(v=v.data),a.get(v)},remove:function m(v){v.isInterleavedBufferAttribute&&(v=v.data);const _=a.get(v);_&&(h.deleteBuffer(_.buffer),a.delete(v))},update:function y(v,_){if(v.isGLBufferAttribute){const b=a.get(v);return void((!b||b.version<v.version)&&a.set(v,{buffer:v.buffer,type:v.type,bytesPerElement:v.elementSize,version:v.version}))}v.isInterleavedBufferAttribute&&(v=v.data);const w=a.get(v);void 0===w?a.set(v,function c(v,_){const w=v.array,b=v.usage,M=h.createBuffer();let C;if(h.bindBuffer(_,M),h.bufferData(_,w,b),v.onUploadCallback(),w instanceof Float32Array)C=5126;else if(w instanceof Uint16Array)if(v.isFloat16BufferAttribute){if(!s)throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");C=5131}else C=5123;else if(w instanceof Int16Array)C=5122;else if(w instanceof Uint32Array)C=5125;else if(w instanceof Int32Array)C=5124;else if(w instanceof Int8Array)C=5120;else if(w instanceof Uint8Array)C=5121;else{if(!(w instanceof Uint8ClampedArray))throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+w);C=5121}return{buffer:M,type:C,bytesPerElement:w.BYTES_PER_ELEMENT,version:v.version}}(v,_)):w.version<v.version&&(function u(v,_,w){const b=_.array,M=_.updateRange;h.bindBuffer(w,v),-1===M.count?h.bufferSubData(w,0,b):(s?h.bufferSubData(w,M.offset*b.BYTES_PER_ELEMENT,b,M.offset,M.count):h.bufferSubData(w,M.offset*b.BYTES_PER_ELEMENT,b.subarray(M.offset,M.offset+M.count)),M.count=-1)}(w.buffer,v,_),w.version=v.version)}}}class Mo extends Ye{constructor(n=1,s=1,a=1,c=1){super(),this.type="PlaneGeometry",this.parameters={width:n,height:s,widthSegments:a,heightSegments:c};const u=n/2,f=s/2,m=Math.floor(a),y=Math.floor(c),v=m+1,_=y+1,w=n/m,b=s/y,M=[],C=[],E=[],S=[];for(let A=0;A<_;A++){const R=A*b-f;for(let F=0;F<v;F++)C.push(F*w-u,-R,0),E.push(0,0,1),S.push(F/m),S.push(1-A/y)}for(let A=0;A<y;A++)for(let R=0;R<m;R++){const I=R+v*(A+1),O=R+1+v*(A+1),V=R+1+v*A;M.push(R+v*A,I,V),M.push(I,O,V)}this.setIndex(M),this.setAttribute("position",new Ve(C,3)),this.setAttribute("normal",new Ve(E,3)),this.setAttribute("uv",new Ve(S,2))}static fromJSON(n){return new Mo(n.width,n.height,n.widthSegments,n.heightSegments)}}const At={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef USE_ALPHATEST\n\tif ( diffuseColor.a < alphaTest ) discard;\n#endif",alphatest_pars_fragment:"#ifdef USE_ALPHATEST\n\tuniform float alphaTest;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec3 BRDF_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {\n\tfloat fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );\n\treturn f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );\n}\nfloat V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( f0, f90, dotVH );\n\tfloat V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( V * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotVH = saturate( dot( viewDir, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, 1.0, dotVH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie( float roughness, float dotNH ) {\n\tfloat alpha = pow2( roughness );\n\tfloat invAlpha = 1.0 / alpha;\n\tfloat cos2h = dotNH * dotNH;\n\tfloat sin2h = max( 1.0 - cos2h, 0.0078125 );\n\treturn ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );\n}\nfloat V_Neubelt( float dotNV, float dotNL ) {\n\treturn saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );\n}\nvec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {\n\tvec3 halfDir = normalize( lightDir + viewDir );\n\tfloat dotNL = saturate( dot( normal, lightDir ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat D = D_Charlie( sheenRoughness, dotNH );\n\tfloat V = V_Neubelt( dotNV, dotNL );\n\treturn sheenColor * ( D * V );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement( a ) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract( sin( sn ) * c );\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tuv.x += filterInt * 3.0 * cubeUV_minTileSize;\n\t\tuv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );\n\t\tuv.x *= CUBEUV_TEXEL_WIDTH;\n\t\tuv.y *= CUBEUV_TEXEL_HEIGHT;\n\t\t#ifdef texture2DGradEXT\n\t\t\treturn texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;\n\t\t#else\n\t\t\treturn texture2D( envMap, uv ).rgb;\n\t\t#endif\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"vec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\tvec3 getIBLIrradiance( const in vec3 normal ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n\tvec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {\n\t\t#if defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 reflectVec = reflect( - viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t\treturn envMapColor.rgb * envMapIntensity;\n\t\t#else\n\t\t\treturn vec3( 0.0 );\n\t\t#endif\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tvFogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float vFogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, vFogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float vFogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn vec3( texture2D( gradientMap, coord ).r );\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\treflectedLight.indirectDiffuse += lightMapIrradiance;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointLightInfo( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotLightInfo( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalLightInfo( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( - dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {\n\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\treturn irradiance;\n}\nfloat getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\t#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tif ( cutoffDistance > 0.0 ) {\n\t\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\t}\n\t\treturn distanceFalloff;\n\t#else\n\t\tif ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\t\treturn pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t\t}\n\t\treturn 1.0;\n\t#endif\n}\nfloat getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {\n\treturn smoothstep( coneCosine, penumbraCosine, angleCosine );\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tlight.color = directionalLight.color;\n\t\tlight.direction = directionalLight.direction;\n\t\tlight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tlight.color = pointLight.color;\n\t\tlight.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );\n\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tlight.direction = normalize( lVector );\n\t\tfloat angleCos = dot( light.direction, spotLight.direction );\n\t\tfloat spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\tif ( spotAttenuation > 0.0 ) {\n\t\t\tfloat lightDistance = length( lVector );\n\t\t\tlight.color = spotLight.color * spotAttenuation;\n\t\t\tlight.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tlight.visible = ( light.color != vec3( 0.0 ) );\n\t\t} else {\n\t\t\tlight.color = vec3( 0.0 );\n\t\t\tlight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {\n\t\tfloat dotNL = dot( normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;\nmaterial.roughness = min( material.roughness, 1.0 );\n#ifdef IOR\n\t#ifdef SPECULAR\n\t\tfloat specularIntensityFactor = specularIntensity;\n\t\tvec3 specularColorFactor = specularColor;\n\t\t#ifdef USE_SPECULARINTENSITYMAP\n\t\t\tspecularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;\n\t\t#endif\n\t\t#ifdef USE_SPECULARCOLORMAP\n\t\t\tspecularColorFactor *= texture2D( specularColorMap, vUv ).rgb;\n\t\t#endif\n\t\tmaterial.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );\n\t#else\n\t\tfloat specularIntensityFactor = 1.0;\n\t\tvec3 specularColorFactor = vec3( 1.0 );\n\t\tmaterial.specularF90 = 1.0;\n\t#endif\n\tmaterial.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.specularF90 = 1.0;\n#endif\n#ifdef USE_CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\tmaterial.clearcoatF0 = vec3( 0.04 );\n\tmaterial.clearcoatF90 = 1.0;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheenColor;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tmaterial.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;\n\t#endif\n\tmaterial.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tmaterial.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;\n\t#endif\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat roughness;\n\tvec3 specularColor;\n\tfloat specularF90;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat clearcoat;\n\t\tfloat clearcoatRoughness;\n\t\tvec3 clearcoatF0;\n\t\tfloat clearcoatF90;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tvec3 sheenColor;\n\t\tfloat sheenRoughness;\n\t#endif\n};\nvec3 clearcoatSpecular = vec3( 0.0 );\nvec3 sheenSpecular = vec3( 0.0 );\nfloat IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat r2 = roughness * roughness;\n\tfloat a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;\n\tfloat b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;\n\tfloat DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );\n\treturn saturate( DG * RECIPROCAL_PI );\n}\nvec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;\n\treturn fab;\n}\nvec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\treturn specularColor * fab.x + specularF90 * fab.y;\n}\nvoid computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tvec2 fab = DFGApprox( normal, viewDir, roughness );\n\tvec3 FssEss = specularColor * fab.x + specularF90 * fab.y;\n\tfloat Ess = fab.x + fab.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.roughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = dotNLcc * directLight.color;\n\t\tclearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );\n\t#endif\n\treflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );\n\treflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );\n\t#endif\n\t#ifdef USE_SHEEN\n\t\tsheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );\n\t#endif\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tcomputeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef USE_CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointLightInfo( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotLightInfo( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalLightInfo( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry.normal );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getIBLIrradiance( geometry.normal );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );\n\t#ifdef USE_CLEARCOAT\n\t\tclearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 sampledDiffuseColor = texture2D( map, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tsampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );\n\t#endif\n\tdiffuseColor *= sampledDiffuseColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tdiffuseColor *= texture2D( map, uv );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphcolor_vertex:"#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )\n\tvColor *= morphTargetBaseInfluence;\n\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t#if defined( USE_COLOR_ALPHA )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];\n\t\t#elif defined( USE_COLOR )\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];\n\t\t#endif\n\t}\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\t\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\t\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\t\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n\t#endif\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tuniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];\n\t\tuniform sampler2DArray morphTargetsTexture;\n\t\tuniform ivec2 morphTargetsTextureSize;\n\t\tvec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {\n\t\t\tint texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;\n\t\t\tint y = texelIndex / morphTargetsTextureSize.x;\n\t\t\tint x = texelIndex - y * morphTargetsTextureSize.x;\n\t\t\tivec3 morphUV = ivec3( x, y, morphTargetIndex );\n\t\t\treturn texelFetch( morphTargetsTexture, morphUV, 0 );\n\t\t}\n\t#else\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\tuniform float morphTargetInfluences[ 8 ];\n\t\t#else\n\t\t\tuniform float morphTargetInfluences[ 4 ];\n\t\t#endif\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\t#ifdef MORPHTARGETS_TEXTURE\n\t\tfor ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {\n\t\t\tif ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];\n\t\t}\n\t#else\n\t\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\t\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\t\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\t\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t\t#ifndef USE_MORPHNORMALS\n\t\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t\t#endif\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normal_pars_fragment:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_pars_vertex:"#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif",normal_vertex:"#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef USE_CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",output_fragment:"#ifdef OPAQUE\ndiffuseColor.a = 1.0;\n#endif\n#ifdef USE_TRANSMISSION\ndiffuseColor.a *= transmissionAlpha + 0.1;\n#endif\ngl_FragColor = vec4( outgoingLight, diffuseColor.a );",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate( a ) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmission_fragment:"#ifdef USE_TRANSMISSION\n\tfloat transmissionAlpha = 1.0;\n\tfloat transmissionFactor = transmission;\n\tfloat thicknessFactor = thickness;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\ttransmissionFactor *= texture2D( transmissionMap, vUv ).r;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tthicknessFactor *= texture2D( thicknessMap, vUv ).g;\n\t#endif\n\tvec3 pos = vWorldPosition;\n\tvec3 v = normalize( cameraPosition - pos );\n\tvec3 n = inverseTransformDirection( normal, viewMatrix );\n\tvec4 transmission = getIBLVolumeRefraction(\n\t\tn, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,\n\t\tpos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,\n\t\tattenuationColor, attenuationDistance );\n\ttotalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );\n\ttransmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );\n#endif",transmission_pars_fragment:"#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform float attenuationDistance;\n\tuniform vec3 attenuationColor;\n\t#ifdef USE_TRANSMISSIONMAP\n\t\tuniform sampler2D transmissionMap;\n\t#endif\n\t#ifdef USE_THICKNESSMAP\n\t\tuniform sampler2D thicknessMap;\n\t#endif\n\tuniform vec2 transmissionSamplerSize;\n\tuniform sampler2D transmissionSamplerMap;\n\tuniform mat4 modelMatrix;\n\tuniform mat4 projectionMatrix;\n\tvarying vec3 vWorldPosition;\n\tvec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {\n\t\tvec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );\n\t\tvec3 modelScale;\n\t\tmodelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );\n\t\tmodelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );\n\t\tmodelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );\n\t\treturn normalize( refractionVector ) * thickness * modelScale;\n\t}\n\tfloat applyIorToRoughness( const in float roughness, const in float ior ) {\n\t\treturn roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );\n\t}\n\tvec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {\n\t\tfloat framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );\n\t\t#ifdef texture2DLodEXT\n\t\t\treturn texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#else\n\t\t\treturn texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );\n\t\t#endif\n\t}\n\tvec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tif ( attenuationDistance == 0.0 ) {\n\t\t\treturn radiance;\n\t\t} else {\n\t\t\tvec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;\n\t\t\tvec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );\t\t\treturn transmittance * radiance;\n\t\t}\n\t}\n\tvec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,\n\t\tconst in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,\n\t\tconst in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,\n\t\tconst in vec3 attenuationColor, const in float attenuationDistance ) {\n\t\tvec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );\n\t\tvec3 refractedRayExit = position + transmissionRay;\n\t\tvec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );\n\t\tvec2 refractionCoords = ndcPos.xy / ndcPos.w;\n\t\trefractionCoords += 1.0;\n\t\trefractionCoords /= 2.0;\n\t\tvec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );\n\t\tvec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );\n\t\tvec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );\n\t\treturn vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );\n\t}\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tgl_FragColor = texture2D( t2D, vUv );\n\t#ifdef DECODE_VIDEO_TEXTURE\n\t\tgl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );\n\t#endif\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinbase_vertex>\n\t\t#include <skinnormal_vertex>\n\t\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel = texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t#else\n\t\tvec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshnormal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",meshnormal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <normal_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n\t#ifdef OPAQUE\n\t\tgl_FragColor.a = 1.0;\n\t#endif\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifdef USE_TRANSMISSION\n\tvarying vec3 vWorldPosition;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n#ifdef USE_TRANSMISSION\n\tvWorldPosition = worldPosition.xyz;\n#endif\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define IOR\n\t#define SPECULAR\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef IOR\n\tuniform float ior;\n#endif\n#ifdef SPECULAR\n\tuniform float specularIntensity;\n\tuniform vec3 specularColor;\n\t#ifdef USE_SPECULARINTENSITYMAP\n\t\tuniform sampler2D specularIntensityMap;\n\t#endif\n\t#ifdef USE_SPECULARCOLORMAP\n\t\tuniform sampler2D specularColorMap;\n\t#endif\n#endif\n#ifdef USE_CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheenColor;\n\tuniform float sheenRoughness;\n\t#ifdef USE_SHEENCOLORMAP\n\t\tuniform sampler2D sheenColorMap;\n\t#endif\n\t#ifdef USE_SHEENROUGHNESSMAP\n\t\tuniform sampler2D sheenRoughnessMap;\n\t#endif\n#endif\nvarying vec3 vViewPosition;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_physical_pars_fragment>\n#include <transmission_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\tvec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t#include <transmission_fragment>\n\tvec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\t#ifdef USE_SHEEN\n\t\tfloat sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );\n\t\toutgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;\n\t#endif\n\t#ifdef USE_CLEARCOAT\n\t\tfloat dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\tvec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );\n\t\toutgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;\n\t#endif\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <normal_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <normal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <normal_pars_fragment>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <morphcolor_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <alphatest_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\t#include <output_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}"},Pe={common:{diffuse:{value:new Re(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Pn},uv2Transform:{value:new Pn},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new he(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Re(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Re(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Pn}},sprite:{diffuse:{value:new Re(16777215)},opacity:{value:1},center:{value:new he(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Pn}}},gs={basic:{uniforms:Ti([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.fog]),vertexShader:At.meshbasic_vert,fragmentShader:At.meshbasic_frag},lambert:{uniforms:Ti([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.fog,Pe.lights,{emissive:{value:new Re(0)}}]),vertexShader:At.meshlambert_vert,fragmentShader:At.meshlambert_frag},phong:{uniforms:Ti([Pe.common,Pe.specularmap,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,Pe.lights,{emissive:{value:new Re(0)},specular:{value:new Re(1118481)},shininess:{value:30}}]),vertexShader:At.meshphong_vert,fragmentShader:At.meshphong_frag},standard:{uniforms:Ti([Pe.common,Pe.envmap,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.roughnessmap,Pe.metalnessmap,Pe.fog,Pe.lights,{emissive:{value:new Re(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:At.meshphysical_vert,fragmentShader:At.meshphysical_frag},toon:{uniforms:Ti([Pe.common,Pe.aomap,Pe.lightmap,Pe.emissivemap,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.gradientmap,Pe.fog,Pe.lights,{emissive:{value:new Re(0)}}]),vertexShader:At.meshtoon_vert,fragmentShader:At.meshtoon_frag},matcap:{uniforms:Ti([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,Pe.fog,{matcap:{value:null}}]),vertexShader:At.meshmatcap_vert,fragmentShader:At.meshmatcap_frag},points:{uniforms:Ti([Pe.points,Pe.fog]),vertexShader:At.points_vert,fragmentShader:At.points_frag},dashed:{uniforms:Ti([Pe.common,Pe.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:At.linedashed_vert,fragmentShader:At.linedashed_frag},depth:{uniforms:Ti([Pe.common,Pe.displacementmap]),vertexShader:At.depth_vert,fragmentShader:At.depth_frag},normal:{uniforms:Ti([Pe.common,Pe.bumpmap,Pe.normalmap,Pe.displacementmap,{opacity:{value:1}}]),vertexShader:At.meshnormal_vert,fragmentShader:At.meshnormal_frag},sprite:{uniforms:Ti([Pe.sprite,Pe.fog]),vertexShader:At.sprite_vert,fragmentShader:At.sprite_frag},background:{uniforms:{uvTransform:{value:new Pn},t2D:{value:null}},vertexShader:At.background_vert,fragmentShader:At.background_frag},cube:{uniforms:Ti([Pe.envmap,{opacity:{value:1}}]),vertexShader:At.cube_vert,fragmentShader:At.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:At.equirect_vert,fragmentShader:At.equirect_frag},distanceRGBA:{uniforms:Ti([Pe.common,Pe.displacementmap,{referencePosition:{value:new k},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:At.distanceRGBA_vert,fragmentShader:At.distanceRGBA_frag},shadow:{uniforms:Ti([Pe.lights,Pe.fog,{color:{value:new Re(0)},opacity:{value:1}}]),vertexShader:At.shadow_vert,fragmentShader:At.shadow_frag}};function R0(h,n,s,a,c,u){const f=new Re(0);let y,v,m=!0===c?0:1,_=null,w=0,b=null;function C(E,S){s.buffers.color.setClear(E.r,E.g,E.b,S,u)}return{getClearColor:function(){return f},setClearColor:function(E,S=1){f.set(E),m=S,C(f,m)},getClearAlpha:function(){return m},setClearAlpha:function(E){m=E,C(f,m)},render:function M(E,S){let A=!1,R=!0===S.isScene?S.background:null;R&&R.isTexture&&(R=n.get(R));const F=h.xr,I=F.getSession&&F.getSession();I&&"additive"===I.environmentBlendMode&&(R=null),null===R?C(f,m):R&&R.isColor&&(C(R,1),A=!0),(h.autoClear||A)&&h.clear(h.autoClearColor,h.autoClearDepth,h.autoClearStencil),R&&(R.isCubeTexture||306===R.mapping)?(void 0===v&&(v=new ii(new ln(1,1,1),new yr({name:"BackgroundCubeMaterial",uniforms:ol(gs.cube.uniforms),vertexShader:gs.cube.vertexShader,fragmentShader:gs.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1})),v.geometry.deleteAttribute("normal"),v.geometry.deleteAttribute("uv"),v.onBeforeRender=function(O,V,W){this.matrixWorld.copyPosition(W.matrixWorld)},Object.defineProperty(v.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),a.update(v)),v.material.uniforms.envMap.value=R,v.material.uniforms.flipEnvMap.value=R.isCubeTexture&&!1===R.isRenderTargetTexture?-1:1,(_!==R||w!==R.version||b!==h.toneMapping)&&(v.material.needsUpdate=!0,_=R,w=R.version,b=h.toneMapping),E.unshift(v,v.geometry,v.material,0,0,null)):R&&R.isTexture&&(void 0===y&&(y=new ii(new Mo(2,2),new yr({name:"BackgroundMaterial",uniforms:ol(gs.background.uniforms),vertexShader:gs.background.vertexShader,fragmentShader:gs.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1})),y.geometry.deleteAttribute("normal"),Object.defineProperty(y.material,"map",{get:function(){return this.uniforms.t2D.value}}),a.update(y)),y.material.uniforms.t2D.value=R,!0===R.matrixAutoUpdate&&R.updateMatrix(),y.material.uniforms.uvTransform.value.copy(R.matrix),(_!==R||w!==R.version||b!==h.toneMapping)&&(y.material.needsUpdate=!0,_=R,w=R.version,b=h.toneMapping),E.unshift(y,y.geometry,y.material,0,0,null))}}}function I0(h,n,s,a){const c=h.getParameter(34921),u=a.isWebGL2?null:n.get("OES_vertex_array_object"),f=a.isWebGL2||null!==u,m={},y=S(null);let v=y,_=!1;function M(Y){return a.isWebGL2?h.bindVertexArray(Y):u.bindVertexArrayOES(Y)}function C(Y){return a.isWebGL2?h.deleteVertexArray(Y):u.deleteVertexArrayOES(Y)}function S(Y){const ne=[],J=[],oe=[];for(let X=0;X<c;X++)ne[X]=0,J[X]=0,oe[X]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:ne,enabledAttributes:J,attributeDivisors:oe,object:Y,attributes:{},index:null}}function F(){const Y=v.newAttributes;for(let ne=0,J=Y.length;ne<J;ne++)Y[ne]=0}function I(Y){O(Y,0)}function O(Y,ne){const oe=v.enabledAttributes,X=v.attributeDivisors;v.newAttributes[Y]=1,0===oe[Y]&&(h.enableVertexAttribArray(Y),oe[Y]=1),X[Y]!==ne&&((a.isWebGL2?h:n.get("ANGLE_instanced_arrays"))[a.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](Y,ne),X[Y]=ne)}function V(){const Y=v.newAttributes,ne=v.enabledAttributes;for(let J=0,oe=ne.length;J<oe;J++)ne[J]!==Y[J]&&(h.disableVertexAttribArray(J),ne[J]=0)}function W(Y,ne,J,oe,X,pe){!0!==a.isWebGL2||5124!==J&&5125!==J?h.vertexAttribPointer(Y,ne,J,oe,X,pe):h.vertexAttribIPointer(Y,ne,J,X,pe)}function G(){_e(),_=!0,v!==y&&(v=y,M(v.object))}function _e(){y.geometry=null,y.program=null,y.wireframe=!1}return{setup:function w(Y,ne,J,oe,X){let pe=!1;if(f){const ve=function E(Y,ne,J){const oe=!0===J.wireframe;let X=m[Y.id];void 0===X&&(X={},m[Y.id]=X);let pe=X[ne.id];void 0===pe&&(pe={},X[ne.id]=pe);let ve=pe[oe];return void 0===ve&&(ve=S(function b(){return a.isWebGL2?h.createVertexArray():u.createVertexArrayOES()}()),pe[oe]=ve),ve}(oe,J,ne);v!==ve&&(v=ve,M(v.object)),pe=function A(Y,ne){const J=v.attributes,oe=Y.attributes;let X=0;for(const pe in oe){const ve=J[pe],Me=oe[pe];if(void 0===ve||ve.attribute!==Me||ve.data!==Me.data)return!0;X++}return v.attributesNum!==X||v.index!==ne}(oe,X),pe&&function R(Y,ne){const J={},oe=Y.attributes;let X=0;for(const pe in oe){const ve=oe[pe],Me={};Me.attribute=ve,ve.data&&(Me.data=ve.data),J[pe]=Me,X++}v.attributes=J,v.attributesNum=X,v.index=ne}(oe,X)}else{const ve=!0===ne.wireframe;(v.geometry!==oe.id||v.program!==J.id||v.wireframe!==ve)&&(v.geometry=oe.id,v.program=J.id,v.wireframe=ve,pe=!0)}!0===Y.isInstancedMesh&&(pe=!0),null!==X&&s.update(X,34963),(pe||_)&&(_=!1,function $(Y,ne,J,oe){if(!1===a.isWebGL2&&(Y.isInstancedMesh||oe.isInstancedBufferGeometry)&&null===n.get("ANGLE_instanced_arrays"))return;F();const X=oe.attributes,pe=J.getAttributes(),ve=ne.defaultAttributeValues;for(const Me in pe){const xe=pe[Me];if(xe.location>=0){let Qe=X[Me];if(void 0===Qe&&("instanceMatrix"===Me&&Y.instanceMatrix&&(Qe=Y.instanceMatrix),"instanceColor"===Me&&Y.instanceColor&&(Qe=Y.instanceColor)),void 0!==Qe){const Rt=Qe.normalized,pt=Qe.itemSize,de=s.get(Qe);if(void 0===de)continue;const Zt=de.buffer,xt=de.type,wt=de.bytesPerElement;if(Qe.isInterleavedBufferAttribute){const Ce=Qe.data,It=Ce.stride,ce=Qe.offset;if(Ce.isInstancedInterleavedBuffer){for(let fe=0;fe<xe.locationSize;fe++)O(xe.location+fe,Ce.meshPerAttribute);!0!==Y.isInstancedMesh&&void 0===oe._maxInstanceCount&&(oe._maxInstanceCount=Ce.meshPerAttribute*Ce.count)}else for(let fe=0;fe<xe.locationSize;fe++)I(xe.location+fe);h.bindBuffer(34962,Zt);for(let fe=0;fe<xe.locationSize;fe++)W(xe.location+fe,pt/xe.locationSize,xt,Rt,It*wt,(ce+pt/xe.locationSize*fe)*wt)}else{if(Qe.isInstancedBufferAttribute){for(let Ce=0;Ce<xe.locationSize;Ce++)O(xe.location+Ce,Qe.meshPerAttribute);!0!==Y.isInstancedMesh&&void 0===oe._maxInstanceCount&&(oe._maxInstanceCount=Qe.meshPerAttribute*Qe.count)}else for(let Ce=0;Ce<xe.locationSize;Ce++)I(xe.location+Ce);h.bindBuffer(34962,Zt);for(let Ce=0;Ce<xe.locationSize;Ce++)W(xe.location+Ce,pt/xe.locationSize,xt,Rt,pt*wt,pt/xe.locationSize*Ce*wt)}}else if(void 0!==ve){const Rt=ve[Me];if(void 0!==Rt)switch(Rt.length){case 2:h.vertexAttrib2fv(xe.location,Rt);break;case 3:h.vertexAttrib3fv(xe.location,Rt);break;case 4:h.vertexAttrib4fv(xe.location,Rt);break;default:h.vertexAttrib1fv(xe.location,Rt)}}}}V()}(Y,ne,J,oe),null!==X&&h.bindBuffer(34963,s.get(X).buffer))},reset:G,resetDefaultState:_e,dispose:function ie(){G();for(const Y in m){const ne=m[Y];for(const J in ne){const oe=ne[J];for(const X in oe)C(oe[X].object),delete oe[X];delete ne[J]}delete m[Y]}},releaseStatesOfGeometry:function q(Y){if(void 0===m[Y.id])return;const ne=m[Y.id];for(const J in ne){const oe=ne[J];for(const X in oe)C(oe[X].object),delete oe[X];delete ne[J]}delete m[Y.id]},releaseStatesOfProgram:function L(Y){for(const ne in m){const J=m[ne];if(void 0===J[Y.id])continue;const oe=J[Y.id];for(const X in oe)C(oe[X].object),delete oe[X];delete J[Y.id]}},initAttributes:F,enableAttribute:I,disableUnusedAttributes:V}}function P0(h,n,s,a){const c=a.isWebGL2;let u;this.setMode=function f(v){u=v},this.render=function m(v,_){h.drawArrays(u,v,_),s.update(_,u,1)},this.renderInstances=function y(v,_,w){if(0===w)return;let b,M;if(c)b=h,M="drawArraysInstanced";else if(b=n.get("ANGLE_instanced_arrays"),M="drawArraysInstancedANGLE",null===b)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");b[M](u,v,_,w),s.update(_,u,w)}}function So(h,n,s){let a;function u(W){if("highp"===W){if(h.getShaderPrecisionFormat(35633,36338).precision>0&&h.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";W="mediump"}return"mediump"===W&&h.getShaderPrecisionFormat(35633,36337).precision>0&&h.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const f="undefined"!=typeof WebGL2RenderingContext&&h instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&h instanceof WebGL2ComputeRenderingContext;let m=void 0!==s.precision?s.precision:"highp";const y=u(m);y!==m&&(console.warn("THREE.WebGLRenderer:",m,"not supported, using",y,"instead."),m=y);const v=f||n.has("WEBGL_draw_buffers"),_=!0===s.logarithmicDepthBuffer,w=h.getParameter(34930),b=h.getParameter(35660),M=h.getParameter(3379),C=h.getParameter(34076),E=h.getParameter(34921),S=h.getParameter(36347),A=h.getParameter(36348),R=h.getParameter(36349),F=b>0,I=f||n.has("OES_texture_float");return{isWebGL2:f,drawBuffers:v,getMaxAnisotropy:function c(){if(void 0!==a)return a;if(!0===n.has("EXT_texture_filter_anisotropic")){const W=n.get("EXT_texture_filter_anisotropic");a=h.getParameter(W.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else a=0;return a},getMaxPrecision:u,precision:m,logarithmicDepthBuffer:_,maxTextures:w,maxVertexTextures:b,maxTextureSize:M,maxCubemapSize:C,maxAttributes:E,maxVertexUniforms:S,maxVaryings:A,maxFragmentUniforms:R,vertexTextures:F,floatFragmentTextures:I,floatVertexTextures:F&&I,maxSamples:f?h.getParameter(36183):0}}function Uc(h){const n=this;let s=null,a=0,c=!1,u=!1;const f=new rr,m=new Pn,y={value:null,needsUpdate:!1};function v(){y.value!==s&&(y.value=s,y.needsUpdate=a>0),n.numPlanes=a,n.numIntersection=0}function _(w,b,M,C){const E=null!==w?w.length:0;let S=null;if(0!==E){if(S=y.value,!0!==C||null===S){const A=M+4*E,R=b.matrixWorldInverse;m.getNormalMatrix(R),(null===S||S.length<A)&&(S=new Float32Array(A));for(let F=0,I=M;F!==E;++F,I+=4)f.copy(w[F]).applyMatrix4(R,m),f.normal.toArray(S,I),S[I+3]=f.constant}y.value=S,y.needsUpdate=!0}return n.numPlanes=E,n.numIntersection=0,S}this.uniform=y,this.numPlanes=0,this.numIntersection=0,this.init=function(w,b,M){const C=0!==w.length||b||0!==a||c;return c=b,s=_(w,M,0),a=w.length,C},this.beginShadows=function(){u=!0,_(null)},this.endShadows=function(){u=!1,v()},this.setState=function(w,b,M){const C=w.clippingPlanes,E=w.clipIntersection,S=w.clipShadows,A=h.get(w);if(!c||null===C||0===C.length||u&&!S)u?_(null):v();else{const R=u?0:a,F=4*R;let I=A.clippingState||null;y.value=I,I=_(C,b,F,M);for(let O=0;O!==F;++O)I[O]=s[O];A.clippingState=I,this.numIntersection=E?this.numPlanes:0,this.numPlanes+=R}}}function L0(h){let n=new WeakMap;function s(f,m){return 303===m?f.mapping=301:304===m&&(f.mapping=302),f}function c(f){const m=f.target;m.removeEventListener("dispose",c);const y=n.get(m);void 0!==y&&(n.delete(m),y.dispose())}return{get:function a(f){if(f&&f.isTexture&&!1===f.isRenderTargetTexture){const m=f.mapping;if(303===m||304===m){if(n.has(f))return s(n.get(f).texture,f.mapping);{const y=f.image;if(y&&y.height>0){const v=new Gs(y.height/2);return v.fromEquirectangularTexture(h,f),n.set(f,v),f.addEventListener("dispose",c),s(v.texture,f.mapping)}return null}}}return f},dispose:function u(){n=new WeakMap}}}gs.physical={uniforms:Ti([gs.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new he(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Re(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new he},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Re(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Re(1,1,1)},specularColorMap:{value:null}}]),vertexShader:At.meshphysical_vert,fragmentShader:At.meshphysical_frag};class Cd extends da{constructor(n=-1,s=1,a=1,c=-1,u=.1,f=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=n,this.right=s,this.top=a,this.bottom=c,this.near=u,this.far=f,this.updateProjectionMatrix()}copy(n,s){return super.copy(n,s),this.left=n.left,this.right=n.right,this.top=n.top,this.bottom=n.bottom,this.near=n.near,this.far=n.far,this.zoom=n.zoom,this.view=null===n.view?null:Object.assign({},n.view),this}setViewOffset(n,s,a,c,u,f){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=n,this.view.fullHeight=s,this.view.offsetX=a,this.view.offsetY=c,this.view.width=u,this.view.height=f,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const n=(this.right-this.left)/(2*this.zoom),s=(this.top-this.bottom)/(2*this.zoom),a=(this.right+this.left)/2,c=(this.top+this.bottom)/2;let u=a-n,f=a+n,m=c+s,y=c-s;if(null!==this.view&&this.view.enabled){const v=(this.right-this.left)/this.view.fullWidth/this.zoom,_=(this.top-this.bottom)/this.view.fullHeight/this.zoom;u+=v*this.view.offsetX,f=u+v*this.view.width,m-=_*this.view.offsetY,y=m-_*this.view.height}this.projectionMatrix.makeOrthographic(u,f,m,y,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(n){const s=super.toJSON(n);return s.object.zoom=this.zoom,s.object.left=this.left,s.object.right=this.right,s.object.top=this.top,s.object.bottom=this.bottom,s.object.near=this.near,s.object.far=this.far,null!==this.view&&(s.object.view=Object.assign({},this.view)),s}}Cd.prototype.isOrthographicCamera=!0;const F0=[.125,.215,.35,.446,.526,.582],Dg=new Cd,Pf=new Re;let Lf=null;const fa=(1+Math.sqrt(5))/2,gl=1/fa,Ag=[new k(1,1,1),new k(-1,1,1),new k(1,1,-1),new k(-1,1,-1),new k(0,fa,gl),new k(0,fa,-gl),new k(gl,0,fa),new k(-gl,0,fa),new k(fa,gl,0),new k(-fa,gl,0)];class N0{constructor(n){this._renderer=n,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(n,s=0,a=.1,c=100){Lf=this._renderer.getRenderTarget(),this._setSize(256);const u=this._allocateTargets();return u.depthBuffer=!0,this._sceneToCubeUV(n,a,c,u),s>0&&this._blur(u,0,0,s),this._applyPMREM(u),this._cleanup(u),u}fromEquirectangular(n,s=null){return this._fromTexture(n,s)}fromCubemap(n,s=null){return this._fromTexture(n,s)}compileCubemapShader(){null===this._cubemapMaterial&&(this._cubemapMaterial=Ff(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){null===this._equirectMaterial&&(this._equirectMaterial=yl(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),null!==this._cubemapMaterial&&this._cubemapMaterial.dispose(),null!==this._equirectMaterial&&this._equirectMaterial.dispose()}_setSize(n){this._lodMax=Math.floor(Math.log2(n)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){null!==this._blurMaterial&&this._blurMaterial.dispose(),null!==this._pingPongRenderTarget&&this._pingPongRenderTarget.dispose();for(let n=0;n<this._lodPlanes.length;n++)this._lodPlanes[n].dispose()}_cleanup(n){this._renderer.setRenderTarget(Lf),n.scissorTest=!1,zc(n,0,0,n.width,n.height)}_fromTexture(n,s){this._setSize(301===n.mapping||302===n.mapping?0===n.image.length?16:n.image[0].width||n.image[0].image.width:n.image.width/4),Lf=this._renderer.getRenderTarget();const a=s||this._allocateTargets();return this._textureToCubeUV(n,a),this._applyPMREM(a),this._cleanup(a),a}_allocateTargets(){const n=3*Math.max(this._cubeSize,112),s=4*this._cubeSize-32,a={magFilter:hn,minFilter:hn,generateMipmaps:!1,type:Ga,format:Xn,encoding:po,depthBuffer:!1},c=Vc(n,s,a);if(null===this._pingPongRenderTarget||this._pingPongRenderTarget.width!==n){null!==this._pingPongRenderTarget&&this._dispose(),this._pingPongRenderTarget=Vc(n,s,a);const{_lodMax:u}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=function O0(h){const n=[],s=[],a=[];let c=h;const u=h-4+1+F0.length;for(let f=0;f<u;f++){const m=Math.pow(2,c);s.push(m);let y=1/m;f>h-4?y=F0[f-h+4-1]:0===f&&(y=0),a.push(y);const v=1/(m-1),_=-v/2,w=1+v/2,b=[_,_,w,_,w,w,_,_,w,w,_,w],M=6,C=6,E=3,S=2,A=1,R=new Float32Array(E*C*M),F=new Float32Array(S*C*M),I=new Float32Array(A*C*M);for(let V=0;V<M;V++){const W=V%3*2/3-1,$=V>2?0:-1;R.set([W,$,0,W+2/3,$,0,W+2/3,$+1,0,W,$,0,W+2/3,$+1,0,W,$+1,0],E*C*V),F.set(b,S*C*V),I.set([V,V,V,V,V,V],A*C*V)}const O=new Ye;O.setAttribute("position",new mn(R,E)),O.setAttribute("uv",new mn(F,S)),O.setAttribute("faceIndex",new mn(I,A)),n.push(O),c>4&&c--}return{lodPlanes:n,sizeLods:s,sigmas:a}}(u)),this._blurMaterial=function ys(h,n,s){const a=new Float32Array(20),c=new k(0,1,0);return new yr({name:"SphericalGaussianBlur",defines:{n:20,CUBEUV_TEXEL_WIDTH:1/n,CUBEUV_TEXEL_HEIGHT:1/s,CUBEUV_MAX_MIP:`${h}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:a},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:c}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\t\t\tuniform int samples;\n\t\t\tuniform float weights[ n ];\n\t\t\tuniform bool latitudinal;\n\t\t\tuniform float dTheta;\n\t\t\tuniform float mipInt;\n\t\t\tuniform vec3 poleAxis;\n\n\t\t\t#define ENVMAP_TYPE_CUBE_UV\n\t\t\t#include <cube_uv_reflection_fragment>\n\n\t\t\tvec3 getSample( float theta, vec3 axis ) {\n\n\t\t\t\tfloat cosTheta = cos( theta );\n\t\t\t\t// Rodrigues' axis-angle rotation\n\t\t\t\tvec3 sampleDirection = vOutputDirection * cosTheta\n\t\t\t\t\t+ cross( axis, vOutputDirection ) * sin( theta )\n\t\t\t\t\t+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );\n\n\t\t\t\treturn bilinearCubeUV( envMap, sampleDirection, mipInt );\n\n\t\t\t}\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );\n\n\t\t\t\tif ( all( equal( axis, vec3( 0.0 ) ) ) ) {\n\n\t\t\t\t\taxis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );\n\n\t\t\t\t}\n\n\t\t\t\taxis = normalize( axis );\n\n\t\t\t\tgl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );\n\t\t\t\tgl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );\n\n\t\t\t\tfor ( int i = 1; i < n; i++ ) {\n\n\t\t\t\t\tif ( i >= samples ) {\n\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t}\n\n\t\t\t\t\tfloat theta = dTheta * float( i );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );\n\t\t\t\t\tgl_FragColor.rgb += weights[ i ] * getSample( theta, axis );\n\n\t\t\t\t}\n\n\t\t\t}\n\t\t",blending:Qi,depthTest:!1,depthWrite:!1})}(u,n,s)}return c}_compileMaterial(n){const s=new ii(this._lodPlanes[0],n);this._renderer.compile(s,Dg)}_sceneToCubeUV(n,s,a,c){const m=new zn(90,1,s,a),y=[1,-1,1,1,1,1],v=[1,1,1,-1,-1,-1],_=this._renderer,w=_.autoClear,b=_.toneMapping;_.getClearColor(Pf),_.toneMapping=0,_.autoClear=!1;const M=new Vs({name:"PMREM.Background",side:1,depthWrite:!1,depthTest:!1}),C=new ii(new ln,M);let E=!1;const S=n.background;S?S.isColor&&(M.color.copy(S),n.background=null,E=!0):(M.color.copy(Pf),E=!0);for(let A=0;A<6;A++){const R=A%3;0===R?(m.up.set(0,y[A],0),m.lookAt(v[A],0,0)):1===R?(m.up.set(0,0,y[A]),m.lookAt(0,v[A],0)):(m.up.set(0,y[A],0),m.lookAt(0,0,v[A]));const F=this._cubeSize;zc(c,R*F,A>2?F:0,F,F),_.setRenderTarget(c),E&&_.render(C,m),_.render(n,m)}C.geometry.dispose(),C.material.dispose(),_.toneMapping=b,_.autoClear=w,n.background=S}_textureToCubeUV(n,s){const a=this._renderer,c=301===n.mapping||302===n.mapping;c?(null===this._cubemapMaterial&&(this._cubemapMaterial=Ff()),this._cubemapMaterial.uniforms.flipEnvMap.value=!1===n.isRenderTargetTexture?-1:1):null===this._equirectMaterial&&(this._equirectMaterial=yl());const u=c?this._cubemapMaterial:this._equirectMaterial,f=new ii(this._lodPlanes[0],u);u.uniforms.envMap.value=n;const y=this._cubeSize;zc(s,0,0,3*y,2*y),a.setRenderTarget(s),a.render(f,Dg)}_applyPMREM(n){const s=this._renderer,a=s.autoClear;s.autoClear=!1;for(let c=1;c<this._lodPlanes.length;c++){const u=Math.sqrt(this._sigmas[c]*this._sigmas[c]-this._sigmas[c-1]*this._sigmas[c-1]);this._blur(n,c-1,c,u,Ag[(c-1)%Ag.length])}s.autoClear=a}_blur(n,s,a,c,u){const f=this._pingPongRenderTarget;this._halfBlur(n,f,s,a,c,"latitudinal",u),this._halfBlur(f,n,a,a,c,"longitudinal",u)}_halfBlur(n,s,a,c,u,f,m){const y=this._renderer,v=this._blurMaterial;"latitudinal"!==f&&"longitudinal"!==f&&console.error("blur direction must be either latitudinal or longitudinal!");const w=new ii(this._lodPlanes[c],v),b=v.uniforms,M=this._sizeLods[a]-1,C=isFinite(u)?Math.PI/(2*M):2*Math.PI/39,E=u/C,S=isFinite(u)?1+Math.floor(3*E):20;S>20&&console.warn(`sigmaRadians, ${u}, is too large and will clip, as it requested ${S} samples when the maximum is set to 20`);const A=[];let R=0;for(let W=0;W<20;++W){const $=W/E,ie=Math.exp(-$*$/2);A.push(ie),0===W?R+=ie:W<S&&(R+=2*ie)}for(let W=0;W<A.length;W++)A[W]=A[W]/R;b.envMap.value=n.texture,b.samples.value=S,b.weights.value=A,b.latitudinal.value="latitudinal"===f,m&&(b.poleAxis.value=m);const{_lodMax:F}=this;b.dTheta.value=C,b.mipInt.value=F-a;const I=this._sizeLods[c];zc(s,3*I*(c>F-4?c-F+4:0),4*(this._cubeSize-I),3*I,2*I),y.setRenderTarget(s),y.render(w,Dg)}}function Vc(h,n,s){const a=new ti(h,n,s);return a.texture.mapping=306,a.texture.name="PMREM.cubeUv",a.scissorTest=!0,a}function zc(h,n,s,a,c){h.viewport.set(n,s,a,c),h.scissor.set(n,s,a,c)}function yl(){return new yr({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform sampler2D envMap;\n\n\t\t\t#include <common>\n\n\t\t\tvoid main() {\n\n\t\t\t\tvec3 outputDirection = normalize( vOutputDirection );\n\t\t\t\tvec2 uv = equirectUv( outputDirection );\n\n\t\t\t\tgl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );\n\n\t\t\t}\n\t\t",blending:Qi,depthTest:!1,depthWrite:!1})}function Ff(){return new yr({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:"\n\n\t\tprecision mediump float;\n\t\tprecision mediump int;\n\n\t\tattribute float faceIndex;\n\n\t\tvarying vec3 vOutputDirection;\n\n\t\t// RH coordinate system; PMREM face-indexing convention\n\t\tvec3 getDirection( vec2 uv, float face ) {\n\n\t\t\tuv = 2.0 * uv - 1.0;\n\n\t\t\tvec3 direction = vec3( uv, 1.0 );\n\n\t\t\tif ( face == 0.0 ) {\n\n\t\t\t\tdirection = direction.zyx; // ( 1, v, u ) pos x\n\n\t\t\t} else if ( face == 1.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xz *= -1.0; // ( -u, 1, -v ) pos y\n\n\t\t\t} else if ( face == 2.0 ) {\n\n\t\t\t\tdirection.x *= -1.0; // ( -u, v, 1 ) pos z\n\n\t\t\t} else if ( face == 3.0 ) {\n\n\t\t\t\tdirection = direction.zyx;\n\t\t\t\tdirection.xz *= -1.0; // ( -1, v, -u ) neg x\n\n\t\t\t} else if ( face == 4.0 ) {\n\n\t\t\t\tdirection = direction.xzy;\n\t\t\t\tdirection.xy *= -1.0; // ( -u, -1, v ) neg y\n\n\t\t\t} else if ( face == 5.0 ) {\n\n\t\t\t\tdirection.z *= -1.0; // ( u, v, -1 ) neg z\n\n\t\t\t}\n\n\t\t\treturn direction;\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\tvOutputDirection = getDirection( uv, faceIndex );\n\t\t\tgl_Position = vec4( position, 1.0 );\n\n\t\t}\n\t",fragmentShader:"\n\n\t\t\tprecision mediump float;\n\t\t\tprecision mediump int;\n\n\t\t\tuniform float flipEnvMap;\n\n\t\t\tvarying vec3 vOutputDirection;\n\n\t\t\tuniform samplerCube envMap;\n\n\t\t\tvoid main() {\n\n\t\t\t\tgl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );\n\n\t\t\t}\n\t\t",blending:Qi,depthTest:!1,depthWrite:!1})}function Rg(h){let n=new WeakMap,s=null;function u(m){const y=m.target;y.removeEventListener("dispose",u);const v=n.get(y);void 0!==v&&(n.delete(y),v.dispose())}return{get:function a(m){if(m&&m.isTexture){const y=m.mapping,v=303===y||304===y,_=301===y||302===y;if(v||_){if(m.isRenderTargetTexture&&!0===m.needsPMREMUpdate){m.needsPMREMUpdate=!1;let w=n.get(m);return null===s&&(s=new N0(h)),w=v?s.fromEquirectangular(m,w):s.fromCubemap(m,w),n.set(m,w),w.texture}if(n.has(m))return n.get(m).texture;{const w=m.image;if(v&&w&&w.height>0||_&&w&&function c(m){let y=0;for(let _=0;_<6;_++)void 0!==m[_]&&y++;return 6===y}(w)){null===s&&(s=new N0(h));const b=v?s.fromEquirectangular(m):s.fromCubemap(m);return n.set(m,b),m.addEventListener("dispose",u),b.texture}return null}}}return m},dispose:function f(){n=new WeakMap,null!==s&&(s.dispose(),s=null)}}}function kE(h){const n={};function s(a){if(void 0!==n[a])return n[a];let c;switch(a){case"WEBGL_depth_texture":c=h.getExtension("WEBGL_depth_texture")||h.getExtension("MOZ_WEBGL_depth_texture")||h.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":c=h.getExtension("EXT_texture_filter_anisotropic")||h.getExtension("MOZ_EXT_texture_filter_anisotropic")||h.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":c=h.getExtension("WEBGL_compressed_texture_s3tc")||h.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||h.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":c=h.getExtension("WEBGL_compressed_texture_pvrtc")||h.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:c=h.getExtension(a)}return n[a]=c,c}return{has:function(a){return null!==s(a)},init:function(a){a.isWebGL2?s("EXT_color_buffer_float"):(s("WEBGL_depth_texture"),s("OES_texture_float"),s("OES_texture_half_float"),s("OES_texture_half_float_linear"),s("OES_standard_derivatives"),s("OES_element_index_uint"),s("OES_vertex_array_object"),s("ANGLE_instanced_arrays")),s("OES_texture_float_linear"),s("EXT_color_buffer_half_float"),s("WEBGL_multisampled_render_to_texture")},get:function(a){const c=s(a);return null===c&&console.warn("THREE.WebGLRenderer: "+a+" extension not supported."),c}}}function BE(h,n,s,a){const c={},u=new WeakMap;function f(w){const b=w.target;null!==b.index&&n.remove(b.index);for(const C in b.attributes)n.remove(b.attributes[C]);b.removeEventListener("dispose",f),delete c[b.id];const M=u.get(b);M&&(n.remove(M),u.delete(b)),a.releaseStatesOfGeometry(b),!0===b.isInstancedBufferGeometry&&delete b._maxInstanceCount,s.memory.geometries--}function v(w){const b=[],M=w.index,C=w.attributes.position;let E=0;if(null!==M){const R=M.array;E=M.version;for(let F=0,I=R.length;F<I;F+=3){const O=R[F+0],V=R[F+1],W=R[F+2];b.push(O,V,V,W,W,O)}}else{E=C.version;for(let F=0,I=C.array.length/3-1;F<I;F+=3){const O=F+0,V=F+1,W=F+2;b.push(O,V,V,W,W,O)}}const S=new(hc(b)?gr:pf)(b,1);S.version=E;const A=u.get(w);A&&n.remove(A),u.set(w,S)}return{get:function m(w,b){return!0===c[b.id]||(b.addEventListener("dispose",f),c[b.id]=!0,s.memory.geometries++),b},update:function y(w){const b=w.attributes;for(const C in b)n.update(b[C],34962);const M=w.morphAttributes;for(const C in M){const E=M[C];for(let S=0,A=E.length;S<A;S++)n.update(E[S],34962)}},getWireframeAttribute:function _(w){const b=u.get(w);if(b){const M=w.index;null!==M&&b.version<M.version&&v(w)}else v(w);return u.get(w)}}}function UE(h,n,s,a){const c=a.isWebGL2;let u,m,y;this.setMode=function f(b){u=b},this.setIndex=function v(b){m=b.type,y=b.bytesPerElement},this.render=function _(b,M){h.drawElements(u,M,m,b*y),s.update(M,u,1)},this.renderInstances=function w(b,M,C){if(0===C)return;let E,S;if(c)E=h,S="drawElementsInstanced";else if(E=n.get("ANGLE_instanced_arrays"),S="drawElementsInstancedANGLE",null===E)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");E[S](u,M,m,b*y,C),s.update(M,u,C)}}function Nf(h){const s={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:s,programs:null,autoReset:!0,reset:function c(){s.frame++,s.calls=0,s.triangles=0,s.points=0,s.lines=0},update:function a(u,f,m){switch(s.calls++,f){case 4:s.triangles+=m*(u/3);break;case 1:s.lines+=m*(u/2);break;case 3:s.lines+=m*(u-1);break;case 2:s.lines+=m*u;break;case 0:s.points+=m*u;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",f)}}}}function Of(h,n){return h[0]-n[0]}function kf(h,n){return Math.abs(n[1])-Math.abs(h[1])}function Ig(h,n){let s=1;const a=n.isInterleavedBufferAttribute?n.data.array:n.array;a instanceof Int8Array?s=127:a instanceof Int16Array?s=32767:a instanceof Int32Array?s=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",a),h.divideScalar(s)}function HE(h,n,s){const a={},c=new Float32Array(8),u=new WeakMap,f=new jt,m=[];for(let v=0;v<8;v++)m[v]=[v,0];return{update:function y(v,_,w,b){const M=v.morphTargetInfluences;if(!0===n.isWebGL2){const C=_.morphAttributes.position||_.morphAttributes.normal||_.morphAttributes.color,E=void 0!==C?C.length:0;let S=u.get(_);if(void 0===S||S.count!==E){let ne=function(){_e.dispose(),u.delete(_),_.removeEventListener("dispose",ne)};void 0!==S&&S.texture.dispose();const F=void 0!==_.morphAttributes.position,I=void 0!==_.morphAttributes.normal,O=void 0!==_.morphAttributes.color,V=_.morphAttributes.position||[],W=_.morphAttributes.normal||[],$=_.morphAttributes.color||[];let ie=0;!0===F&&(ie=1),!0===I&&(ie=2),!0===O&&(ie=3);let q=_.attributes.position.count*ie,L=1;q>n.maxTextureSize&&(L=Math.ceil(q/n.maxTextureSize),q=n.maxTextureSize);const G=new Float32Array(q*L*4*E),_e=new Wi(G,q,L,E);_e.type=fo,_e.needsUpdate=!0;const Y=4*ie;for(let J=0;J<E;J++){const oe=V[J],X=W[J],pe=$[J],ve=q*L*4*J;for(let Me=0;Me<oe.count;Me++){const xe=Me*Y;!0===F&&(f.fromBufferAttribute(oe,Me),!0===oe.normalized&&Ig(f,oe),G[ve+xe+0]=f.x,G[ve+xe+1]=f.y,G[ve+xe+2]=f.z,G[ve+xe+3]=0),!0===I&&(f.fromBufferAttribute(X,Me),!0===X.normalized&&Ig(f,X),G[ve+xe+4]=f.x,G[ve+xe+5]=f.y,G[ve+xe+6]=f.z,G[ve+xe+7]=0),!0===O&&(f.fromBufferAttribute(pe,Me),!0===pe.normalized&&Ig(f,pe),G[ve+xe+8]=f.x,G[ve+xe+9]=f.y,G[ve+xe+10]=f.z,G[ve+xe+11]=4===pe.itemSize?f.w:1)}}S={count:E,texture:_e,size:new he(q,L)},u.set(_,S),_.addEventListener("dispose",ne)}let A=0;for(let F=0;F<M.length;F++)A+=M[F];const R=_.morphTargetsRelative?1:1-A;b.getUniforms().setValue(h,"morphTargetBaseInfluence",R),b.getUniforms().setValue(h,"morphTargetInfluences",M),b.getUniforms().setValue(h,"morphTargetsTexture",S.texture,s),b.getUniforms().setValue(h,"morphTargetsTextureSize",S.size)}else{const C=void 0===M?0:M.length;let E=a[_.id];if(void 0===E||E.length!==C){E=[];for(let I=0;I<C;I++)E[I]=[I,0];a[_.id]=E}for(let I=0;I<C;I++){const O=E[I];O[0]=I,O[1]=M[I]}E.sort(kf);for(let I=0;I<8;I++)I<C&&E[I][1]?(m[I][0]=E[I][0],m[I][1]=E[I][1]):(m[I][0]=Number.MAX_SAFE_INTEGER,m[I][1]=0);m.sort(Of);const S=_.morphAttributes.position,A=_.morphAttributes.normal;let R=0;for(let I=0;I<8;I++){const O=m[I],V=O[0],W=O[1];V!==Number.MAX_SAFE_INTEGER&&W?(S&&_.getAttribute("morphTarget"+I)!==S[V]&&_.setAttribute("morphTarget"+I,S[V]),A&&_.getAttribute("morphNormal"+I)!==A[V]&&_.setAttribute("morphNormal"+I,A[V]),c[I]=W,R+=W):(S&&!0===_.hasAttribute("morphTarget"+I)&&_.deleteAttribute("morphTarget"+I),A&&!0===_.hasAttribute("morphNormal"+I)&&_.deleteAttribute("morphNormal"+I),c[I]=0)}const F=_.morphTargetsRelative?1:1-R;b.getUniforms().setValue(h,"morphTargetBaseInfluence",F),b.getUniforms().setValue(h,"morphTargetInfluences",c)}}}}function Pg(h,n,s,a){let c=new WeakMap;function m(y){const v=y.target;v.removeEventListener("dispose",m),s.remove(v.instanceMatrix),null!==v.instanceColor&&s.remove(v.instanceColor)}return{update:function u(y){const v=a.render.frame,w=n.get(y,y.geometry);return c.get(w)!==v&&(n.update(w),c.set(w,v)),y.isInstancedMesh&&(!1===y.hasEventListener("dispose",m)&&y.addEventListener("dispose",m),s.update(y.instanceMatrix,34962),null!==y.instanceColor&&s.update(y.instanceColor,34962)),w},dispose:function f(){c=new WeakMap}}}const Lg=new cn,Fg=new Wi,Ng=new of,Og=new Sc,Bf=[],Gc=[],kg=new Float32Array(16),Ad=new Float32Array(9),Bg=new Float32Array(4);function _n(h,n,s){const a=h[0];if(a<=0||a>0)return h;const c=n*s;let u=Bf[c];if(void 0===u&&(u=new Float32Array(c),Bf[c]=u),0!==n){a.toArray(u,0);for(let f=1,m=0;f!==n;++f)m+=s,h[f].toArray(u,m)}return u}function Oi(h,n){if(h.length!==n.length)return!1;for(let s=0,a=h.length;s<a;s++)if(h[s]!==n[s])return!1;return!0}function Ci(h,n){for(let s=0,a=n.length;s<a;s++)h[s]=n[s]}function vl(h,n){let s=Gc[n];void 0===s&&(s=new Int32Array(n),Gc[n]=s);for(let a=0;a!==n;++a)s[a]=h.allocateTextureUnit();return s}function Ug(h,n){const s=this.cache;s[0]!==n&&(h.uniform1f(this.addr,n),s[0]=n)}function k0(h,n){const s=this.cache;if(void 0!==n.x)(s[0]!==n.x||s[1]!==n.y)&&(h.uniform2f(this.addr,n.x,n.y),s[0]=n.x,s[1]=n.y);else{if(Oi(s,n))return;h.uniform2fv(this.addr,n),Ci(s,n)}}function B0(h,n){const s=this.cache;if(void 0!==n.x)(s[0]!==n.x||s[1]!==n.y||s[2]!==n.z)&&(h.uniform3f(this.addr,n.x,n.y,n.z),s[0]=n.x,s[1]=n.y,s[2]=n.z);else if(void 0!==n.r)(s[0]!==n.r||s[1]!==n.g||s[2]!==n.b)&&(h.uniform3f(this.addr,n.r,n.g,n.b),s[0]=n.r,s[1]=n.g,s[2]=n.b);else{if(Oi(s,n))return;h.uniform3fv(this.addr,n),Ci(s,n)}}function U0(h,n){const s=this.cache;if(void 0!==n.x)(s[0]!==n.x||s[1]!==n.y||s[2]!==n.z||s[3]!==n.w)&&(h.uniform4f(this.addr,n.x,n.y,n.z,n.w),s[0]=n.x,s[1]=n.y,s[2]=n.z,s[3]=n.w);else{if(Oi(s,n))return;h.uniform4fv(this.addr,n),Ci(s,n)}}function H0(h,n){const s=this.cache,a=n.elements;if(void 0===a){if(Oi(s,n))return;h.uniformMatrix2fv(this.addr,!1,n),Ci(s,n)}else{if(Oi(s,a))return;Bg.set(a),h.uniformMatrix2fv(this.addr,!1,Bg),Ci(s,a)}}function V0(h,n){const s=this.cache,a=n.elements;if(void 0===a){if(Oi(s,n))return;h.uniformMatrix3fv(this.addr,!1,n),Ci(s,n)}else{if(Oi(s,a))return;Ad.set(a),h.uniformMatrix3fv(this.addr,!1,Ad),Ci(s,a)}}function VE(h,n){const s=this.cache,a=n.elements;if(void 0===a){if(Oi(s,n))return;h.uniformMatrix4fv(this.addr,!1,n),Ci(s,n)}else{if(Oi(s,a))return;kg.set(a),h.uniformMatrix4fv(this.addr,!1,kg),Ci(s,a)}}function zE(h,n){const s=this.cache;s[0]!==n&&(h.uniform1i(this.addr,n),s[0]=n)}function Wc(h,n){const s=this.cache;Oi(s,n)||(h.uniform2iv(this.addr,n),Ci(s,n))}function ki(h,n){const s=this.cache;Oi(s,n)||(h.uniform3iv(this.addr,n),Ci(s,n))}function Uf(h,n){const s=this.cache;Oi(s,n)||(h.uniform4iv(this.addr,n),Ci(s,n))}function Hg(h,n){const s=this.cache;s[0]!==n&&(h.uniform1ui(this.addr,n),s[0]=n)}function Vg(h,n){const s=this.cache;Oi(s,n)||(h.uniform2uiv(this.addr,n),Ci(s,n))}function Di(h,n){const s=this.cache;Oi(s,n)||(h.uniform3uiv(this.addr,n),Ci(s,n))}function jc(h,n){const s=this.cache;Oi(s,n)||(h.uniform4uiv(this.addr,n),Ci(s,n))}function Hf(h,n,s){const a=this.cache,c=s.allocateTextureUnit();a[0]!==c&&(h.uniform1i(this.addr,c),a[0]=c),s.setTexture2D(n||Lg,c)}function z0(h,n,s){const a=this.cache,c=s.allocateTextureUnit();a[0]!==c&&(h.uniform1i(this.addr,c),a[0]=c),s.setTexture3D(n||Ng,c)}function G0(h,n,s){const a=this.cache,c=s.allocateTextureUnit();a[0]!==c&&(h.uniform1i(this.addr,c),a[0]=c),s.setTextureCube(n||Og,c)}function zg(h,n,s){const a=this.cache,c=s.allocateTextureUnit();a[0]!==c&&(h.uniform1i(this.addr,c),a[0]=c),s.setTexture2DArray(n||Fg,c)}function Gg(h,n){h.uniform1fv(this.addr,n)}function j0(h,n){const s=_n(n,this.size,2);h.uniform2fv(this.addr,s)}function Wg(h,n){const s=_n(n,this.size,3);h.uniform3fv(this.addr,s)}function $0(h,n){const s=_n(n,this.size,4);h.uniform4fv(this.addr,s)}function q0(h,n){const s=_n(n,this.size,4);h.uniformMatrix2fv(this.addr,!1,s)}function Vf(h,n){const s=_n(n,this.size,9);h.uniformMatrix3fv(this.addr,!1,s)}function X0(h,n){const s=_n(n,this.size,16);h.uniformMatrix4fv(this.addr,!1,s)}function Z0(h,n){h.uniform1iv(this.addr,n)}function zf(h,n){h.uniform2iv(this.addr,n)}function Y0(h,n){h.uniform3iv(this.addr,n)}function Q0(h,n){h.uniform4iv(this.addr,n)}function $c(h,n){h.uniform1uiv(this.addr,n)}function K0(h,n){h.uniform2uiv(this.addr,n)}function J0(h,n){h.uniform3uiv(this.addr,n)}function ex(h,n){h.uniform4uiv(this.addr,n)}function tx(h,n,s){const a=n.length,c=vl(s,a);h.uniform1iv(this.addr,c);for(let u=0;u!==a;++u)s.setTexture2D(n[u]||Lg,c[u])}function nx(h,n,s){const a=n.length,c=vl(s,a);h.uniform1iv(this.addr,c);for(let u=0;u!==a;++u)s.setTexture3D(n[u]||Ng,c[u])}function jg(h,n,s){const a=n.length,c=vl(s,a);h.uniform1iv(this.addr,c);for(let u=0;u!==a;++u)s.setTextureCube(n[u]||Og,c[u])}function ix(h,n,s){const a=n.length,c=vl(s,a);h.uniform1iv(this.addr,c);for(let u=0;u!==a;++u)s.setTexture2DArray(n[u]||Fg,c[u])}function sx(h,n,s){this.id=h,this.addr=s,this.cache=[],this.setValue=function W0(h){switch(h){case 5126:return Ug;case 35664:return k0;case 35665:return B0;case 35666:return U0;case 35674:return H0;case 35675:return V0;case 35676:return VE;case 5124:case 35670:return zE;case 35667:case 35671:return Wc;case 35668:case 35672:return ki;case 35669:case 35673:return Uf;case 5125:return Hg;case 36294:return Vg;case 36295:return Di;case 36296:return jc;case 35678:case 36198:case 36298:case 36306:case 35682:return Hf;case 35679:case 36299:case 36307:return z0;case 35680:case 36300:case 36308:case 36293:return G0;case 36289:case 36303:case 36311:case 36292:return zg}}(n.type)}function $g(h,n,s){this.id=h,this.addr=s,this.cache=[],this.size=n.size,this.setValue=function rx(h){switch(h){case 5126:return Gg;case 35664:return j0;case 35665:return Wg;case 35666:return $0;case 35674:return q0;case 35675:return Vf;case 35676:return X0;case 5124:case 35670:return Z0;case 35667:case 35671:return zf;case 35668:case 35672:return Y0;case 35669:case 35673:return Q0;case 5125:return $c;case 36294:return K0;case 36295:return J0;case 36296:return ex;case 35678:case 36198:case 36298:case 36306:case 35682:return tx;case 35679:case 36299:case 36307:return nx;case 35680:case 36300:case 36308:case 36293:return jg;case 36289:case 36303:case 36311:case 36292:return ix}}(n.type)}function qg(h){this.id=h,this.seq=[],this.map={}}$g.prototype.updateCache=function(h){const n=this.cache;h instanceof Float32Array&&n.length!==h.length&&(this.cache=new Float32Array(h.length)),Ci(n,h)},qg.prototype.setValue=function(h,n,s){const a=this.seq;for(let c=0,u=a.length;c!==u;++c){const f=a[c];f.setValue(h,n[f.id],s)}};const Gf=/(\w+)(\])?(\[|\.)?/g;function Xg(h,n){h.seq.push(n),h.map[n.id]=n}function ox(h,n,s){const a=h.name,c=a.length;for(Gf.lastIndex=0;;){const u=Gf.exec(a),f=Gf.lastIndex;let m=u[1];const v=u[3];if("]"===u[2]&&(m|=0),void 0===v||"["===v&&f+2===c){Xg(s,void 0===v?new sx(m,h,n):new $g(m,h,n));break}{let w=s.map[m];void 0===w&&(w=new qg(m),Xg(s,w)),s=w}}}function or(h,n){this.seq=[],this.map={};const s=h.getProgramParameter(n,35718);for(let a=0;a<s;++a){const c=h.getActiveUniform(n,a);ox(c,h.getUniformLocation(n,c.name),this)}}function Br(h,n,s){const a=h.createShader(n);return h.shaderSource(a,s),h.compileShader(a),a}or.prototype.setValue=function(h,n,s,a){const c=this.map[n];void 0!==c&&c.setValue(h,s,a)},or.prototype.setOptional=function(h,n,s){const a=n[s];void 0!==a&&this.setValue(h,s,a)},or.upload=function(h,n,s,a){for(let c=0,u=n.length;c!==u;++c){const f=n[c],m=s[f.id];!1!==m.needsUpdate&&f.setValue(h,m.value,a)}},or.seqWithValue=function(h,n){const s=[];for(let a=0,c=h.length;a!==c;++a){const u=h[a];u.id in n&&s.push(u)}return s};let GE=0;function ax(h,n,s){const a=h.getShaderParameter(n,35713),c=h.getShaderInfoLog(n).trim();if(a&&""===c)return"";const u=parseInt(/ERROR: 0:(\d+)/.exec(c)[1]);return s.toUpperCase()+"\n\n"+c+"\n\n"+function WE(h,n){const s=h.split("\n"),a=[],c=Math.max(n-6,0),u=Math.min(n+6,s.length);for(let f=c;f<u;f++)a.push(f+1+": "+s[f]);return a.join("\n")}(h.getShaderSource(n),u)}function ar(h,n){const s=function Zg(h){switch(h){case po:return["Linear","( value )"];case Tn:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",h),["Linear","( value )"]}}(n);return"vec4 "+h+"( vec4 value ) { return LinearTo"+s[0]+s[1]+"; }"}function Wf(h,n){let s;switch(n){case 1:s="Linear";break;case 2:s="Reinhard";break;case 3:s="OptimizedCineon";break;case 4:s="ACESFilmic";break;case 5:s="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",n),s="Linear"}return"vec3 "+h+"( vec3 color ) { return "+s+"ToneMapping( color ); }"}function Ws(h){return""!==h}function $f(h,n){return h.replace(/NUM_DIR_LIGHTS/g,n.numDirLights).replace(/NUM_SPOT_LIGHTS/g,n.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,n.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,n.numPointLights).replace(/NUM_HEMI_LIGHTS/g,n.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,n.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,n.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,n.numPointLightShadows)}function qf(h,n){return h.replace(/NUM_CLIPPING_PLANES/g,n.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,n.numClippingPlanes-n.numClipIntersection)}const Xf=/^[ \t]*#include +<([\w\d./]+)>/gm;function qc(h){return h.replace(Xf,Qg)}function Qg(h,n){const s=At[n];if(void 0===s)throw new Error("Can not resolve #include <"+n+">");return qc(s)}const jE=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,_l=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function Rd(h){return h.replace(_l,Jg).replace(jE,Kg)}function Kg(h,n,s,a){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),Jg(0,n,s,a)}function Jg(h,n,s,a){let c="";for(let u=parseInt(n);u<parseInt(s);u++)c+=a.replace(/\[\s*i\s*\]/g,"[ "+u+" ]").replace(/UNROLLED_LOOP_INDEX/g,u);return c}function Id(h){let n="precision "+h.precision+" float;\nprecision "+h.precision+" int;";return"highp"===h.precision?n+="\n#define HIGH_PRECISION":"mediump"===h.precision?n+="\n#define MEDIUM_PRECISION":"lowp"===h.precision&&(n+="\n#define LOW_PRECISION"),n}function px(h,n,s,a){const c=h.getContext(),u=s.defines;let f=s.vertexShader,m=s.fragmentShader;const y=function cx(h){let n="SHADOWMAP_TYPE_BASIC";return 1===h.shadowMapType?n="SHADOWMAP_TYPE_PCF":2===h.shadowMapType?n="SHADOWMAP_TYPE_PCF_SOFT":3===h.shadowMapType&&(n="SHADOWMAP_TYPE_VSM"),n}(s),v=function ux(h){let n="ENVMAP_TYPE_CUBE";if(h.envMap)switch(h.envMapMode){case 301:case 302:n="ENVMAP_TYPE_CUBE";break;case 306:n="ENVMAP_TYPE_CUBE_UV"}return n}(s),_=function dx(h){let n="ENVMAP_MODE_REFLECTION";return h.envMap&&302===h.envMapMode&&(n="ENVMAP_MODE_REFRACTION"),n}(s),w=function hx(h){let n="ENVMAP_BLENDING_NONE";if(h.envMap)switch(h.combine){case 0:n="ENVMAP_BLENDING_MULTIPLY";break;case 1:n="ENVMAP_BLENDING_MIX";break;case 2:n="ENVMAP_BLENDING_ADD"}return n}(s),b=function fx(h){const n=h.envMapCubeUVHeight;if(null===n)return null;const s=Math.log2(n/32+1)+3,a=1/n;return{texelWidth:1/(3*Math.max(Math.pow(2,s),112)),texelHeight:a,maxMip:s}}(s),M=s.isWebGL2?"":function jf(h){return[h.extensionDerivatives||h.envMapCubeUVHeight||h.bumpMap||h.tangentSpaceNormalMap||h.clearcoatNormalMap||h.flatShading||"physical"===h.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(h.extensionFragDepth||h.logarithmicDepthBuffer)&&h.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",h.extensionDrawBuffers&&h.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(h.extensionShaderTextureLOD||h.envMap||h.transmission)&&h.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Ws).join("\n")}(s),C=function lx(h){const n=[];for(const s in h){const a=h[s];!1!==a&&n.push("#define "+s+" "+a)}return n.join("\n")}(u),E=c.createProgram();let S,A,R=s.glslVersion?"#version "+s.glslVersion+"\n":"";s.isRawShaderMaterial?(S=[C].filter(Ws).join("\n"),S.length>0&&(S+="\n"),A=[M,C].filter(Ws).join("\n"),A.length>0&&(A+="\n")):(S=[Id(s),"#define SHADER_NAME "+s.shaderName,C,s.instancing?"#define USE_INSTANCING":"",s.instancingColor?"#define USE_INSTANCING_COLOR":"",s.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+s.maxBones,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp2?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+_:"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.normalMap&&s.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",s.normalMap&&s.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",s.clearcoatMap?"#define USE_CLEARCOATMAP":"",s.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",s.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",s.displacementMap&&s.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",s.specularColorMap?"#define USE_SPECULARCOLORMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.transmission?"#define USE_TRANSMISSION":"",s.transmissionMap?"#define USE_TRANSMISSIONMAP":"",s.thicknessMap?"#define USE_THICKNESSMAP":"",s.sheenColorMap?"#define USE_SHEENCOLORMAP":"",s.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",s.vertexTangents?"#define USE_TANGENT":"",s.vertexColors?"#define USE_COLOR":"",s.vertexAlphas?"#define USE_COLOR_ALPHA":"",s.vertexUvs?"#define USE_UV":"",s.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",s.flatShading?"#define FLAT_SHADED":"",s.skinning?"#define USE_SKINNING":"",s.useVertexTexture?"#define BONE_TEXTURE":"",s.morphTargets?"#define USE_MORPHTARGETS":"",s.morphNormals&&!1===s.flatShading?"#define USE_MORPHNORMALS":"",s.morphColors&&s.isWebGL2?"#define USE_MORPHCOLORS":"",s.morphTargetsCount>0&&s.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",s.morphTargetsCount>0&&s.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+s.morphTextureStride:"",s.morphTargetsCount>0&&s.isWebGL2?"#define MORPHTARGETS_COUNT "+s.morphTargetsCount:"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"",s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+y:"",s.sizeAttenuation?"#define USE_SIZEATTENUATION":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.logarithmicDepthBuffer&&s.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Ws).join("\n"),A=[M,Id(s),"#define SHADER_NAME "+s.shaderName,C,s.useFog&&s.fog?"#define USE_FOG":"",s.useFog&&s.fogExp2?"#define FOG_EXP2":"",s.map?"#define USE_MAP":"",s.matcap?"#define USE_MATCAP":"",s.envMap?"#define USE_ENVMAP":"",s.envMap?"#define "+v:"",s.envMap?"#define "+_:"",s.envMap?"#define "+w:"",b?"#define CUBEUV_TEXEL_WIDTH "+b.texelWidth:"",b?"#define CUBEUV_TEXEL_HEIGHT "+b.texelHeight:"",b?"#define CUBEUV_MAX_MIP "+b.maxMip+".0":"",s.lightMap?"#define USE_LIGHTMAP":"",s.aoMap?"#define USE_AOMAP":"",s.emissiveMap?"#define USE_EMISSIVEMAP":"",s.bumpMap?"#define USE_BUMPMAP":"",s.normalMap?"#define USE_NORMALMAP":"",s.normalMap&&s.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",s.normalMap&&s.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",s.clearcoat?"#define USE_CLEARCOAT":"",s.clearcoatMap?"#define USE_CLEARCOATMAP":"",s.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",s.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",s.specularMap?"#define USE_SPECULARMAP":"",s.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",s.specularColorMap?"#define USE_SPECULARCOLORMAP":"",s.roughnessMap?"#define USE_ROUGHNESSMAP":"",s.metalnessMap?"#define USE_METALNESSMAP":"",s.alphaMap?"#define USE_ALPHAMAP":"",s.alphaTest?"#define USE_ALPHATEST":"",s.sheen?"#define USE_SHEEN":"",s.sheenColorMap?"#define USE_SHEENCOLORMAP":"",s.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",s.transmission?"#define USE_TRANSMISSION":"",s.transmissionMap?"#define USE_TRANSMISSIONMAP":"",s.thicknessMap?"#define USE_THICKNESSMAP":"",s.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",s.vertexTangents?"#define USE_TANGENT":"",s.vertexColors||s.instancingColor?"#define USE_COLOR":"",s.vertexAlphas?"#define USE_COLOR_ALPHA":"",s.vertexUvs?"#define USE_UV":"",s.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",s.gradientMap?"#define USE_GRADIENTMAP":"",s.flatShading?"#define FLAT_SHADED":"",s.doubleSided?"#define DOUBLE_SIDED":"",s.flipSided?"#define FLIP_SIDED":"",s.shadowMapEnabled?"#define USE_SHADOWMAP":"",s.shadowMapEnabled?"#define "+y:"",s.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",s.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",s.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",s.logarithmicDepthBuffer&&s.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==s.toneMapping?"#define TONE_MAPPING":"",0!==s.toneMapping?At.tonemapping_pars_fragment:"",0!==s.toneMapping?Wf("toneMapping",s.toneMapping):"",s.dithering?"#define DITHERING":"",s.opaque?"#define OPAQUE":"",At.encodings_pars_fragment,ar("linearToOutputTexel",s.outputEncoding),s.depthPacking?"#define DEPTH_PACKING "+s.depthPacking:"","\n"].filter(Ws).join("\n")),f=qc(f),f=$f(f,s),f=qf(f,s),m=qc(m),m=$f(m,s),m=qf(m,s),f=Rd(f),m=Rd(m),s.isWebGL2&&!0!==s.isRawShaderMaterial&&(R="#version 300 es\n",S=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+S,A=["#define varying in","300 es"===s.glslVersion?"":"layout(location = 0) out highp vec4 pc_fragColor;","300 es"===s.glslVersion?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+A);const I=R+A+m,O=Br(c,35633,R+S+f),V=Br(c,35632,I);if(c.attachShader(E,O),c.attachShader(E,V),void 0!==s.index0AttributeName?c.bindAttribLocation(E,0,s.index0AttributeName):!0===s.morphTargets&&c.bindAttribLocation(E,0,"position"),c.linkProgram(E),h.debug.checkShaderErrors){const ie=c.getProgramInfoLog(E).trim(),q=c.getShaderInfoLog(O).trim(),L=c.getShaderInfoLog(V).trim();let G=!0,_e=!0;if(!1===c.getProgramParameter(E,35714)){G=!1;const Y=ax(c,O,"vertex"),ne=ax(c,V,"fragment");console.error("THREE.WebGLProgram: Shader Error "+c.getError()+" - VALIDATE_STATUS "+c.getProgramParameter(E,35715)+"\n\nProgram Info Log: "+ie+"\n"+Y+"\n"+ne)}else""!==ie?console.warn("THREE.WebGLProgram: Program Info Log:",ie):(""===q||""===L)&&(_e=!1);_e&&(this.diagnostics={runnable:G,programLog:ie,vertexShader:{log:q,prefix:S},fragmentShader:{log:L,prefix:A}})}let W,$;return c.deleteShader(O),c.deleteShader(V),this.getUniforms=function(){return void 0===W&&(W=new or(c,E)),W},this.getAttributes=function(){return void 0===$&&($=function Yg(h,n){const s={},a=h.getProgramParameter(n,35721);for(let c=0;c<a;c++){const u=h.getActiveAttrib(n,c),f=u.name;let m=1;35674===u.type&&(m=2),35675===u.type&&(m=3),35676===u.type&&(m=4),s[f]={type:u.type,location:h.getAttribLocation(n,f),locationSize:m}}return s}(c,E)),$},this.destroy=function(){a.releaseStatesOfProgram(this),c.deleteProgram(E),this.program=void 0},this.name=s.shaderName,this.id=GE++,this.cacheKey=n,this.usedTimes=1,this.program=E,this.vertexShader=O,this.fragmentShader=V,this}let ey=0;class Zf{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(n){const a=n.fragmentShader,c=this._getShaderStage(n.vertexShader),u=this._getShaderStage(a),f=this._getShaderCacheForMaterial(n);return!1===f.has(c)&&(f.add(c),c.usedTimes++),!1===f.has(u)&&(f.add(u),u.usedTimes++),this}remove(n){const s=this.materialCache.get(n);for(const a of s)a.usedTimes--,0===a.usedTimes&&this.shaderCache.delete(a.code);return this.materialCache.delete(n),this}getVertexShaderID(n){return this._getShaderStage(n.vertexShader).id}getFragmentShaderID(n){return this._getShaderStage(n.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(n){const s=this.materialCache;return!1===s.has(n)&&s.set(n,new Set),s.get(n)}_getShaderStage(n){const s=this.shaderCache;if(!1===s.has(n)){const a=new ty(n);s.set(n,a)}return s.get(n)}}class ty{constructor(n){this.id=ey++,this.code=n,this.usedTimes=0}}function Yf(h,n,s,a,c,u,f){const m=new hf,y=new Zf,v=[],_=c.isWebGL2,w=c.logarithmicDepthBuffer,b=c.floatVertexTextures,M=c.maxVertexUniforms,C=c.vertexTextures;let E=c.precision;const S={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};return{getParameters:function R(L,G,_e,Y,ne){const J=Y.fog,oe=ne.geometry,pe=(L.isMeshStandardMaterial?s:n).get(L.envMap||(L.isMeshStandardMaterial?Y.environment:null)),ve=pe&&306===pe.mapping?pe.image.height:null,Me=S[L.type],xe=ne.isSkinnedMesh?function A(L){const _e=L.skeleton.bones;if(b)return 1024;{const ne=Math.floor((M-20)/4),J=Math.min(ne,_e.length);return J<_e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+_e.length+" bones. This GPU supports "+J+"."),0):J}}(ne):0;null!==L.precision&&(E=c.getMaxPrecision(L.precision),E!==L.precision&&console.warn("THREE.WebGLProgram.getParameters:",L.precision,"not supported, using",E,"instead."));const Qe=oe.morphAttributes.position||oe.morphAttributes.normal||oe.morphAttributes.color,Rt=void 0!==Qe?Qe.length:0;let de,Zt,xt,wt,pt=0;if(void 0!==oe.morphAttributes.position&&(pt=1),void 0!==oe.morphAttributes.normal&&(pt=2),void 0!==oe.morphAttributes.color&&(pt=3),Me){const be=gs[Me];de=be.vertexShader,Zt=be.fragmentShader}else de=L.vertexShader,Zt=L.fragmentShader,y.update(L),xt=y.getVertexShaderID(L),wt=y.getFragmentShaderID(L);const Ce=h.getRenderTarget(),ce=L.clearcoat>0;return{isWebGL2:_,shaderID:Me,shaderName:L.type,vertexShader:de,fragmentShader:Zt,defines:L.defines,customVertexShaderID:xt,customFragmentShaderID:wt,isRawShaderMaterial:!0===L.isRawShaderMaterial,glslVersion:L.glslVersion,precision:E,instancing:!0===ne.isInstancedMesh,instancingColor:!0===ne.isInstancedMesh&&null!==ne.instanceColor,supportsVertexTextures:C,outputEncoding:null===Ce?h.outputEncoding:!0===Ce.isXRRenderTarget?Ce.texture.encoding:po,map:!!L.map,matcap:!!L.matcap,envMap:!!pe,envMapMode:pe&&pe.mapping,envMapCubeUVHeight:ve,lightMap:!!L.lightMap,aoMap:!!L.aoMap,emissiveMap:!!L.emissiveMap,bumpMap:!!L.bumpMap,normalMap:!!L.normalMap,objectSpaceNormalMap:1===L.normalMapType,tangentSpaceNormalMap:0===L.normalMapType,decodeVideoTexture:!!L.map&&!0===L.map.isVideoTexture&&L.map.encoding===Tn,clearcoat:ce,clearcoatMap:ce&&!!L.clearcoatMap,clearcoatRoughnessMap:ce&&!!L.clearcoatRoughnessMap,clearcoatNormalMap:ce&&!!L.clearcoatNormalMap,displacementMap:!!L.displacementMap,roughnessMap:!!L.roughnessMap,metalnessMap:!!L.metalnessMap,specularMap:!!L.specularMap,specularIntensityMap:!!L.specularIntensityMap,specularColorMap:!!L.specularColorMap,opaque:!1===L.transparent&&1===L.blending,alphaMap:!!L.alphaMap,alphaTest:L.alphaTest>0,gradientMap:!!L.gradientMap,sheen:L.sheen>0,sheenColorMap:!!L.sheenColorMap,sheenRoughnessMap:!!L.sheenRoughnessMap,transmission:L.transmission>0,transmissionMap:!!L.transmissionMap,thicknessMap:!!L.thicknessMap,combine:L.combine,vertexTangents:!!L.normalMap&&!!oe.attributes.tangent,vertexColors:L.vertexColors,vertexAlphas:!0===L.vertexColors&&!!oe.attributes.color&&4===oe.attributes.color.itemSize,vertexUvs:!!(L.map||L.bumpMap||L.normalMap||L.specularMap||L.alphaMap||L.emissiveMap||L.roughnessMap||L.metalnessMap||L.clearcoatMap||L.clearcoatRoughnessMap||L.clearcoatNormalMap||L.displacementMap||L.transmissionMap||L.thicknessMap||L.specularIntensityMap||L.specularColorMap||L.sheenColorMap||L.sheenRoughnessMap),uvsVertexOnly:!(L.map||L.bumpMap||L.normalMap||L.specularMap||L.alphaMap||L.emissiveMap||L.roughnessMap||L.metalnessMap||L.clearcoatNormalMap||L.transmission>0||L.transmissionMap||L.thicknessMap||L.specularIntensityMap||L.specularColorMap||L.sheen>0||L.sheenColorMap||L.sheenRoughnessMap||!L.displacementMap),fog:!!J,useFog:L.fog,fogExp2:J&&J.isFogExp2,flatShading:!!L.flatShading,sizeAttenuation:L.sizeAttenuation,logarithmicDepthBuffer:w,skinning:!0===ne.isSkinnedMesh&&xe>0,maxBones:xe,useVertexTexture:b,morphTargets:void 0!==oe.morphAttributes.position,morphNormals:void 0!==oe.morphAttributes.normal,morphColors:void 0!==oe.morphAttributes.color,morphTargetsCount:Rt,morphTextureStride:pt,numDirLights:G.directional.length,numPointLights:G.point.length,numSpotLights:G.spot.length,numRectAreaLights:G.rectArea.length,numHemiLights:G.hemi.length,numDirLightShadows:G.directionalShadowMap.length,numPointLightShadows:G.pointShadowMap.length,numSpotLightShadows:G.spotShadowMap.length,numClippingPlanes:f.numPlanes,numClipIntersection:f.numIntersection,dithering:L.dithering,shadowMapEnabled:h.shadowMap.enabled&&_e.length>0,shadowMapType:h.shadowMap.type,toneMapping:L.toneMapped?h.toneMapping:0,physicallyCorrectLights:h.physicallyCorrectLights,premultipliedAlpha:L.premultipliedAlpha,doubleSided:L.side===co,flipSided:1===L.side,depthPacking:void 0!==L.depthPacking&&L.depthPacking,index0AttributeName:L.index0AttributeName,extensionDerivatives:L.extensions&&L.extensions.derivatives,extensionFragDepth:L.extensions&&L.extensions.fragDepth,extensionDrawBuffers:L.extensions&&L.extensions.drawBuffers,extensionShaderTextureLOD:L.extensions&&L.extensions.shaderTextureLOD,rendererExtensionFragDepth:_||a.has("EXT_frag_depth"),rendererExtensionDrawBuffers:_||a.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:_||a.has("EXT_shader_texture_lod"),customProgramCacheKey:L.customProgramCacheKey()}},getProgramCacheKey:function F(L){const G=[];if(L.shaderID?G.push(L.shaderID):(G.push(L.customVertexShaderID),G.push(L.customFragmentShaderID)),void 0!==L.defines)for(const _e in L.defines)G.push(_e),G.push(L.defines[_e]);return!1===L.isRawShaderMaterial&&(function I(L,G){L.push(G.precision),L.push(G.outputEncoding),L.push(G.envMapMode),L.push(G.envMapCubeUVHeight),L.push(G.combine),L.push(G.vertexUvs),L.push(G.fogExp2),L.push(G.sizeAttenuation),L.push(G.maxBones),L.push(G.morphTargetsCount),L.push(G.morphAttributeCount),L.push(G.numDirLights),L.push(G.numPointLights),L.push(G.numSpotLights),L.push(G.numHemiLights),L.push(G.numRectAreaLights),L.push(G.numDirLightShadows),L.push(G.numPointLightShadows),L.push(G.numSpotLightShadows),L.push(G.shadowMapType),L.push(G.toneMapping),L.push(G.numClippingPlanes),L.push(G.numClipIntersection)}(G,L),function O(L,G){m.disableAll(),G.isWebGL2&&m.enable(0),G.supportsVertexTextures&&m.enable(1),G.instancing&&m.enable(2),G.instancingColor&&m.enable(3),G.map&&m.enable(4),G.matcap&&m.enable(5),G.envMap&&m.enable(6),G.lightMap&&m.enable(7),G.aoMap&&m.enable(8),G.emissiveMap&&m.enable(9),G.bumpMap&&m.enable(10),G.normalMap&&m.enable(11),G.objectSpaceNormalMap&&m.enable(12),G.tangentSpaceNormalMap&&m.enable(13),G.clearcoat&&m.enable(14),G.clearcoatMap&&m.enable(15),G.clearcoatRoughnessMap&&m.enable(16),G.clearcoatNormalMap&&m.enable(17),G.displacementMap&&m.enable(18),G.specularMap&&m.enable(19),G.roughnessMap&&m.enable(20),G.metalnessMap&&m.enable(21),G.gradientMap&&m.enable(22),G.alphaMap&&m.enable(23),G.alphaTest&&m.enable(24),G.vertexColors&&m.enable(25),G.vertexAlphas&&m.enable(26),G.vertexUvs&&m.enable(27),G.vertexTangents&&m.enable(28),G.uvsVertexOnly&&m.enable(29),G.fog&&m.enable(30),L.push(m.mask),m.disableAll(),G.useFog&&m.enable(0),G.flatShading&&m.enable(1),G.logarithmicDepthBuffer&&m.enable(2),G.skinning&&m.enable(3),G.useVertexTexture&&m.enable(4),G.morphTargets&&m.enable(5),G.morphNormals&&m.enable(6),G.morphColors&&m.enable(7),G.premultipliedAlpha&&m.enable(8),G.shadowMapEnabled&&m.enable(9),G.physicallyCorrectLights&&m.enable(10),G.doubleSided&&m.enable(11),G.flipSided&&m.enable(12),G.depthPacking&&m.enable(13),G.dithering&&m.enable(14),G.specularIntensityMap&&m.enable(15),G.specularColorMap&&m.enable(16),G.transmission&&m.enable(17),G.transmissionMap&&m.enable(18),G.thicknessMap&&m.enable(19),G.sheen&&m.enable(20),G.sheenColorMap&&m.enable(21),G.sheenRoughnessMap&&m.enable(22),G.decodeVideoTexture&&m.enable(23),G.opaque&&m.enable(24),L.push(m.mask)}(G,L),G.push(h.outputEncoding)),G.push(L.customProgramCacheKey),G.join()},getUniforms:function V(L){const G=S[L.type];let _e;return _e=G?ig.clone(gs[G].uniforms):L.uniforms,_e},acquireProgram:function W(L,G){let _e;for(let Y=0,ne=v.length;Y<ne;Y++){const J=v[Y];if(J.cacheKey===G){_e=J,++_e.usedTimes;break}}return void 0===_e&&(_e=new px(h,G,L,u),v.push(_e)),_e},releaseProgram:function $(L){if(0==--L.usedTimes){const G=v.indexOf(L);v[G]=v[v.length-1],v.pop(),L.destroy()}},releaseShaderCache:function ie(L){y.remove(L)},programs:v,dispose:function q(){y.dispose()}}}function mx(){let h=new WeakMap;return{get:function n(u){let f=h.get(u);return void 0===f&&(f={},h.set(u,f)),f},remove:function s(u){h.delete(u)},update:function a(u,f,m){h.get(u)[f]=m},dispose:function c(){h=new WeakMap}}}function gx(h,n){return h.groupOrder!==n.groupOrder?h.groupOrder-n.groupOrder:h.renderOrder!==n.renderOrder?h.renderOrder-n.renderOrder:h.material.id!==n.material.id?h.material.id-n.material.id:h.z!==n.z?h.z-n.z:h.id-n.id}function Qf(h,n){return h.groupOrder!==n.groupOrder?h.groupOrder-n.groupOrder:h.renderOrder!==n.renderOrder?h.renderOrder-n.renderOrder:h.z!==n.z?n.z-h.z:h.id-n.id}function Kf(){const h=[];let n=0;const s=[],a=[],c=[];function f(w,b,M,C,E,S){let A=h[n];return void 0===A?(A={id:w.id,object:w,geometry:b,material:M,groupOrder:C,renderOrder:w.renderOrder,z:E,group:S},h[n]=A):(A.id=w.id,A.object=w,A.geometry=b,A.material=M,A.groupOrder=C,A.renderOrder=w.renderOrder,A.z=E,A.group=S),n++,A}return{opaque:s,transmissive:a,transparent:c,init:function u(){n=0,s.length=0,a.length=0,c.length=0},push:function m(w,b,M,C,E,S){const A=f(w,b,M,C,E,S);M.transmission>0?a.push(A):!0===M.transparent?c.push(A):s.push(A)},unshift:function y(w,b,M,C,E,S){const A=f(w,b,M,C,E,S);M.transmission>0?a.unshift(A):!0===M.transparent?c.unshift(A):s.unshift(A)},finish:function _(){for(let w=n,b=h.length;w<b;w++){const M=h[w];if(null===M.id)break;M.id=null,M.object=null,M.geometry=null,M.material=null,M.group=null}},sort:function v(w,b){s.length>1&&s.sort(w||gx),a.length>1&&a.sort(b||Qf),c.length>1&&c.sort(b||Qf)}}}function pa(){let h=new WeakMap;return{get:function n(a,c){let u;return!1===h.has(a)?(u=new Kf,h.set(a,[u])):c>=h.get(a).length?(u=new Kf,h.get(a).push(u)):u=h.get(a)[c],u},dispose:function s(){h=new WeakMap}}}function ny(){const h={};return{get:function(n){if(void 0!==h[n.id])return h[n.id];let s;switch(n.type){case"DirectionalLight":s={direction:new k,color:new Re};break;case"SpotLight":s={position:new k,direction:new k,color:new Re,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":s={position:new k,color:new Re,distance:0,decay:0};break;case"HemisphereLight":s={direction:new k,skyColor:new Re,groundColor:new Re};break;case"RectAreaLight":s={color:new Re,position:new k,halfWidth:new k,halfHeight:new k}}return h[n.id]=s,s}}}let yx=0;function Pd(h,n){return(n.castShadow?1:0)-(h.castShadow?1:0)}function vx(h,n){const s=new ny,a=function iy(){const h={};return{get:function(n){if(void 0!==h[n.id])return h[n.id];let s;switch(n.type){case"DirectionalLight":case"SpotLight":s={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new he};break;case"PointLight":s={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new he,shadowCameraNear:1,shadowCameraFar:1e3}}return h[n.id]=s,s}}}(),c={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let _=0;_<9;_++)c.probe.push(new k);const u=new k,f=new $e,m=new $e;return{setup:function y(_,w){let b=0,M=0,C=0;for(let ie=0;ie<9;ie++)c.probe[ie].set(0,0,0);let E=0,S=0,A=0,R=0,F=0,I=0,O=0,V=0;_.sort(Pd);const W=!0!==w?Math.PI:1;for(let ie=0,q=_.length;ie<q;ie++){const L=_[ie],G=L.color,_e=L.intensity,Y=L.distance,ne=L.shadow&&L.shadow.map?L.shadow.map.texture:null;if(L.isAmbientLight)b+=G.r*_e*W,M+=G.g*_e*W,C+=G.b*_e*W;else if(L.isLightProbe)for(let J=0;J<9;J++)c.probe[J].addScaledVector(L.sh.coefficients[J],_e);else if(L.isDirectionalLight){const J=s.get(L);if(J.color.copy(L.color).multiplyScalar(L.intensity*W),L.castShadow){const oe=L.shadow,X=a.get(L);X.shadowBias=oe.bias,X.shadowNormalBias=oe.normalBias,X.shadowRadius=oe.radius,X.shadowMapSize=oe.mapSize,c.directionalShadow[E]=X,c.directionalShadowMap[E]=ne,c.directionalShadowMatrix[E]=L.shadow.matrix,I++}c.directional[E]=J,E++}else if(L.isSpotLight){const J=s.get(L);if(J.position.setFromMatrixPosition(L.matrixWorld),J.color.copy(G).multiplyScalar(_e*W),J.distance=Y,J.coneCos=Math.cos(L.angle),J.penumbraCos=Math.cos(L.angle*(1-L.penumbra)),J.decay=L.decay,L.castShadow){const oe=L.shadow,X=a.get(L);X.shadowBias=oe.bias,X.shadowNormalBias=oe.normalBias,X.shadowRadius=oe.radius,X.shadowMapSize=oe.mapSize,c.spotShadow[A]=X,c.spotShadowMap[A]=ne,c.spotShadowMatrix[A]=L.shadow.matrix,V++}c.spot[A]=J,A++}else if(L.isRectAreaLight){const J=s.get(L);J.color.copy(G).multiplyScalar(_e),J.halfWidth.set(.5*L.width,0,0),J.halfHeight.set(0,.5*L.height,0),c.rectArea[R]=J,R++}else if(L.isPointLight){const J=s.get(L);if(J.color.copy(L.color).multiplyScalar(L.intensity*W),J.distance=L.distance,J.decay=L.decay,L.castShadow){const oe=L.shadow,X=a.get(L);X.shadowBias=oe.bias,X.shadowNormalBias=oe.normalBias,X.shadowRadius=oe.radius,X.shadowMapSize=oe.mapSize,X.shadowCameraNear=oe.camera.near,X.shadowCameraFar=oe.camera.far,c.pointShadow[S]=X,c.pointShadowMap[S]=ne,c.pointShadowMatrix[S]=L.shadow.matrix,O++}c.point[S]=J,S++}else if(L.isHemisphereLight){const J=s.get(L);J.skyColor.copy(L.color).multiplyScalar(_e*W),J.groundColor.copy(L.groundColor).multiplyScalar(_e*W),c.hemi[F]=J,F++}}R>0&&(n.isWebGL2||!0===h.has("OES_texture_float_linear")?(c.rectAreaLTC1=Pe.LTC_FLOAT_1,c.rectAreaLTC2=Pe.LTC_FLOAT_2):!0===h.has("OES_texture_half_float_linear")?(c.rectAreaLTC1=Pe.LTC_HALF_1,c.rectAreaLTC2=Pe.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),c.ambient[0]=b,c.ambient[1]=M,c.ambient[2]=C;const $=c.hash;($.directionalLength!==E||$.pointLength!==S||$.spotLength!==A||$.rectAreaLength!==R||$.hemiLength!==F||$.numDirectionalShadows!==I||$.numPointShadows!==O||$.numSpotShadows!==V)&&(c.directional.length=E,c.spot.length=A,c.rectArea.length=R,c.point.length=S,c.hemi.length=F,c.directionalShadow.length=I,c.directionalShadowMap.length=I,c.pointShadow.length=O,c.pointShadowMap.length=O,c.spotShadow.length=V,c.spotShadowMap.length=V,c.directionalShadowMatrix.length=I,c.pointShadowMatrix.length=O,c.spotShadowMatrix.length=V,$.directionalLength=E,$.pointLength=S,$.spotLength=A,$.rectAreaLength=R,$.hemiLength=F,$.numDirectionalShadows=I,$.numPointShadows=O,$.numSpotShadows=V,c.version=yx++)},setupView:function v(_,w){let b=0,M=0,C=0,E=0,S=0;const A=w.matrixWorldInverse;for(let R=0,F=_.length;R<F;R++){const I=_[R];if(I.isDirectionalLight){const O=c.directional[b];O.direction.setFromMatrixPosition(I.matrixWorld),u.setFromMatrixPosition(I.target.matrixWorld),O.direction.sub(u),O.direction.transformDirection(A),b++}else if(I.isSpotLight){const O=c.spot[C];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(A),O.direction.setFromMatrixPosition(I.matrixWorld),u.setFromMatrixPosition(I.target.matrixWorld),O.direction.sub(u),O.direction.transformDirection(A),C++}else if(I.isRectAreaLight){const O=c.rectArea[E];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(A),m.identity(),f.copy(I.matrixWorld),f.premultiply(A),m.extractRotation(f),O.halfWidth.set(.5*I.width,0,0),O.halfHeight.set(0,.5*I.height,0),O.halfWidth.applyMatrix4(m),O.halfHeight.applyMatrix4(m),E++}else if(I.isPointLight){const O=c.point[M];O.position.setFromMatrixPosition(I.matrixWorld),O.position.applyMatrix4(A),M++}else if(I.isHemisphereLight){const O=c.hemi[S];O.direction.setFromMatrixPosition(I.matrixWorld),O.direction.transformDirection(A),O.direction.normalize(),S++}}},state:c}}function Jf(h,n){const s=new vx(h,n),a=[],c=[];return{init:function u(){a.length=0,c.length=0},state:{lightsArray:a,shadowsArray:c,lights:s},setupLights:function y(w){s.setup(a,w)},setupLightsView:function v(w){s.setupView(a,w)},pushLight:function f(w){a.push(w)},pushShadow:function m(w){c.push(w)}}}function ry(h,n){let s=new WeakMap;return{get:function a(u,f=0){let m;return!1===s.has(u)?(m=new Jf(h,n),s.set(u,[m])):f>=s.get(u).length?(m=new Jf(h,n),s.get(u).push(m)):m=s.get(u)[f],m},dispose:function c(){s=new WeakMap}}}class Xc extends Zn{constructor(n){super(),this.type="MeshDepthMaterial",this.depthPacking=3200,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(n)}copy(n){return super.copy(n),this.depthPacking=n.depthPacking,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this}}Xc.prototype.isMeshDepthMaterial=!0;class Zc extends Zn{constructor(n){super(),this.type="MeshDistanceMaterial",this.referencePosition=new k,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(n)}copy(n){return super.copy(n),this.referencePosition.copy(n.referencePosition),this.nearDistance=n.nearDistance,this.farDistance=n.farDistance,this.map=n.map,this.alphaMap=n.alphaMap,this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this}}function Yc(h,n,s){let a=new yd;const c=new he,u=new he,f=new jt,m=new Xc({depthPacking:D_}),y=new Zc,v={},_=s.maxTextureSize,w={0:1,1:0,2:co},b=new yr({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new he},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tconst float samples = float( VSM_SAMPLES );\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );\n\tfloat uvStart = samples <= 1.0 ? 0.0 : - 1.0;\n\tfor ( float i = 0.0; i < samples; i ++ ) {\n\t\tfloat uvOffset = uvStart + i * uvStride;\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean / samples;\n\tsquared_mean = squared_mean / samples;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),M=b.clone();M.defines.HORIZONTAL_PASS=1;const C=new Ye;C.setAttribute("position",new mn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const E=new ii(C,b),S=this;function A(I,O){const V=n.update(E);b.defines.VSM_SAMPLES!==I.blurSamples&&(b.defines.VSM_SAMPLES=I.blurSamples,M.defines.VSM_SAMPLES=I.blurSamples,b.needsUpdate=!0,M.needsUpdate=!0),b.uniforms.shadow_pass.value=I.map.texture,b.uniforms.resolution.value=I.mapSize,b.uniforms.radius.value=I.radius,h.setRenderTarget(I.mapPass),h.clear(),h.renderBufferDirect(O,null,V,b,E,null),M.uniforms.shadow_pass.value=I.mapPass.texture,M.uniforms.resolution.value=I.mapSize,M.uniforms.radius.value=I.radius,h.setRenderTarget(I.map),h.clear(),h.renderBufferDirect(O,null,V,M,E,null)}function R(I,O,V,W,$,ie){let q=null;const L=!0===V.isPointLight?I.customDistanceMaterial:I.customDepthMaterial;if(q=void 0!==L?L:!0===V.isPointLight?y:m,h.localClippingEnabled&&!0===O.clipShadows&&0!==O.clippingPlanes.length||O.displacementMap&&0!==O.displacementScale||O.alphaMap&&O.alphaTest>0){const G=q.uuid,_e=O.uuid;let Y=v[G];void 0===Y&&(Y={},v[G]=Y);let ne=Y[_e];void 0===ne&&(ne=q.clone(),Y[_e]=ne),q=ne}return q.visible=O.visible,q.wireframe=O.wireframe,q.side=3===ie?null!==O.shadowSide?O.shadowSide:O.side:null!==O.shadowSide?O.shadowSide:w[O.side],q.alphaMap=O.alphaMap,q.alphaTest=O.alphaTest,q.clipShadows=O.clipShadows,q.clippingPlanes=O.clippingPlanes,q.clipIntersection=O.clipIntersection,q.displacementMap=O.displacementMap,q.displacementScale=O.displacementScale,q.displacementBias=O.displacementBias,q.wireframeLinewidth=O.wireframeLinewidth,q.linewidth=O.linewidth,!0===V.isPointLight&&!0===q.isMeshDistanceMaterial&&(q.referencePosition.setFromMatrixPosition(V.matrixWorld),q.nearDistance=W,q.farDistance=$),q}function F(I,O,V,W,$){if(!1===I.visible)return;if(I.layers.test(O.layers)&&(I.isMesh||I.isLine||I.isPoints)&&(I.castShadow||I.receiveShadow&&3===$)&&(!I.frustumCulled||a.intersectsObject(I))){I.modelViewMatrix.multiplyMatrices(V.matrixWorldInverse,I.matrixWorld);const L=n.update(I),G=I.material;if(Array.isArray(G)){const _e=L.groups;for(let Y=0,ne=_e.length;Y<ne;Y++){const J=_e[Y],oe=G[J.materialIndex];if(oe&&oe.visible){const X=R(I,oe,W,V.near,V.far,$);h.renderBufferDirect(V,null,L,X,I,J)}}}else if(G.visible){const _e=R(I,G,W,V.near,V.far,$);h.renderBufferDirect(V,null,L,_e,I,null)}}const q=I.children;for(let L=0,G=q.length;L<G;L++)F(q[L],O,V,W,$)}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(I,O,V){if(!1===S.enabled||!1===S.autoUpdate&&!1===S.needsUpdate||0===I.length)return;const W=h.getRenderTarget(),$=h.getActiveCubeFace(),ie=h.getActiveMipmapLevel(),q=h.state;q.setBlending(Qi),q.buffers.color.setClear(1,1,1,1),q.buffers.depth.setTest(!0),q.setScissorTest(!1);for(let L=0,G=I.length;L<G;L++){const _e=I[L],Y=_e.shadow;if(void 0===Y){console.warn("THREE.WebGLShadowMap:",_e,"has no shadow.");continue}if(!1===Y.autoUpdate&&!1===Y.needsUpdate)continue;c.copy(Y.mapSize);const ne=Y.getFrameExtents();c.multiply(ne),u.copy(Y.mapSize),(c.x>_||c.y>_)&&(c.x>_&&(u.x=Math.floor(_/ne.x),c.x=u.x*ne.x,Y.mapSize.x=u.x),c.y>_&&(u.y=Math.floor(_/ne.y),c.y=u.y*ne.y,Y.mapSize.y=u.y)),null===Y.map&&!Y.isPointLightShadow&&3===this.type&&(Y.map=new ti(c.x,c.y),Y.map.texture.name=_e.name+".shadowMap",Y.mapPass=new ti(c.x,c.y),Y.camera.updateProjectionMatrix()),null===Y.map&&(Y.map=new ti(c.x,c.y,{minFilter:Qt,magFilter:Qt,format:Xn}),Y.map.texture.name=_e.name+".shadowMap",Y.camera.updateProjectionMatrix()),h.setRenderTarget(Y.map),h.clear();const J=Y.getViewportCount();for(let oe=0;oe<J;oe++){const X=Y.getViewport(oe);f.set(u.x*X.x,u.y*X.y,u.x*X.z,u.y*X.w),q.viewport(f),Y.updateMatrices(_e,oe),a=Y.getFrustum(),F(O,V,Y.camera,_e,this.type)}!Y.isPointLightShadow&&3===this.type&&A(Y,V),Y.needsUpdate=!1}S.needsUpdate=!1,h.setRenderTarget(W,$,ie)}}function oy(h,n,s){const a=s.isWebGL2,m=new function c(){let j=!1;const Ie=new jt;let Te=null;const ke=new jt(0,0,0,0);return{setMask:function(je){Te!==je&&!j&&(h.colorMask(je,je,je,je),Te=je)},setLocked:function(je){j=je},setClear:function(je,ct,De,vt,gn){!0===gn&&(je*=vt,ct*=vt,De*=vt),Ie.set(je,ct,De,vt),!1===ke.equals(Ie)&&(h.clearColor(je,ct,De,vt),ke.copy(Ie))},reset:function(){j=!1,Te=null,ke.set(-1,0,0,0)}}},y=new function u(){let j=!1,Ie=null,Te=null,ke=null;return{setTest:function(je){je?pt(2929):de(2929)},setMask:function(je){Ie!==je&&!j&&(h.depthMask(je),Ie=je)},setFunc:function(je){if(Te!==je){if(je)switch(je){case 0:h.depthFunc(512);break;case 1:h.depthFunc(519);break;case 2:h.depthFunc(513);break;case 3:default:h.depthFunc(515);break;case 4:h.depthFunc(514);break;case 5:h.depthFunc(518);break;case 6:h.depthFunc(516);break;case 7:h.depthFunc(517)}else h.depthFunc(515);Te=je}},setLocked:function(je){j=je},setClear:function(je){ke!==je&&(h.clearDepth(je),ke=je)},reset:function(){j=!1,Ie=null,Te=null,ke=null}}},v=new function f(){let j=!1,Ie=null,Te=null,ke=null,je=null,ct=null,De=null,vt=null,gn=null;return{setTest:function(kt){j||(kt?pt(2960):de(2960))},setMask:function(kt){Ie!==kt&&!j&&(h.stencilMask(kt),Ie=kt)},setFunc:function(kt,Gr,Wr){(Te!==kt||ke!==Gr||je!==Wr)&&(h.stencilFunc(kt,Gr,Wr),Te=kt,ke=Gr,je=Wr)},setOp:function(kt,Gr,Wr){(ct!==kt||De!==Gr||vt!==Wr)&&(h.stencilOp(kt,Gr,Wr),ct=kt,De=Gr,vt=Wr)},setLocked:function(kt){j=kt},setClear:function(kt){gn!==kt&&(h.clearStencil(kt),gn=kt)},reset:function(){j=!1,Ie=null,Te=null,ke=null,je=null,ct=null,De=null,vt=null,gn=null}}};let _={},w={},b=new WeakMap,M=[],C=null,E=!1,S=null,A=null,R=null,F=null,I=null,O=null,V=null,W=!1,$=null,ie=null,q=null,L=null,G=null;const _e=h.getParameter(35661);let Y=!1,ne=0;const J=h.getParameter(7938);-1!==J.indexOf("WebGL")?(ne=parseFloat(/^WebGL (\d)/.exec(J)[1]),Y=ne>=1):-1!==J.indexOf("OpenGL ES")&&(ne=parseFloat(/^OpenGL ES (\d)/.exec(J)[1]),Y=ne>=2);let oe=null,X={};const pe=h.getParameter(3088),ve=h.getParameter(2978),Me=(new jt).fromArray(pe),xe=(new jt).fromArray(ve);function Qe(j,Ie,Te){const ke=new Uint8Array(4),je=h.createTexture();h.bindTexture(j,je),h.texParameteri(j,10241,9728),h.texParameteri(j,10240,9728);for(let ct=0;ct<Te;ct++)h.texImage2D(Ie+ct,0,6408,1,1,0,6408,5121,ke);return je}const Rt={};function pt(j){!0!==_[j]&&(h.enable(j),_[j]=!0)}function de(j){!1!==_[j]&&(h.disable(j),_[j]=!1)}Rt[3553]=Qe(3553,3553,1),Rt[34067]=Qe(34067,34069,6),m.setClear(0,0,0,1),y.setClear(1),v.setClear(0),pt(2929),y.setFunc(3),be(!1),qe(1),pt(2884),ce(Qi);const Ce={100:32774,101:32778,102:32779};if(a)Ce[103]=32775,Ce[104]=32776;else{const j=n.get("EXT_blend_minmax");null!==j&&(Ce[103]=j.MIN_EXT,Ce[104]=j.MAX_EXT)}const It={200:0,201:1,202:768,204:770,210:776,208:774,206:772,203:769,205:771,209:775,207:773};function ce(j,Ie,Te,ke,je,ct,De,vt){if(j!==Qi){if(!1===E&&(pt(3042),E=!0),5===j)je=je||Ie,ct=ct||Te,De=De||ke,(Ie!==A||je!==I)&&(h.blendEquationSeparate(Ce[Ie],Ce[je]),A=Ie,I=je),(Te!==R||ke!==F||ct!==O||De!==V)&&(h.blendFuncSeparate(It[Te],It[ke],It[ct],It[De]),R=Te,F=ke,O=ct,V=De),S=j,W=null;else if(j!==S||vt!==W){if((100!==A||100!==I)&&(h.blendEquation(32774),A=100,I=100),vt)switch(j){case 1:h.blendFuncSeparate(1,771,1,771);break;case jo:h.blendFunc(1,1);break;case 3:h.blendFuncSeparate(0,769,0,1);break;case 4:h.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",j)}else switch(j){case 1:h.blendFuncSeparate(770,771,1,771);break;case jo:h.blendFunc(770,1);break;case 3:h.blendFuncSeparate(0,769,0,1);break;case 4:h.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",j)}R=null,F=null,O=null,V=null,S=j,W=vt}}else!0===E&&(de(3042),E=!1)}function be(j){$!==j&&(h.frontFace(j?2304:2305),$=j)}function qe(j){0!==j?(pt(2884),j!==ie&&h.cullFace(1===j?1029:2===j?1028:1032)):de(2884),ie=j}function yt(j,Ie,Te){j?(pt(32823),(L!==Ie||G!==Te)&&(h.polygonOffset(Ie,Te),L=Ie,G=Te)):de(32823)}function et(j){void 0===j&&(j=33984+_e-1),oe!==j&&(h.activeTexture(j),oe=j)}return{buffers:{color:m,depth:y,stencil:v},enable:pt,disable:de,bindFramebuffer:function Zt(j,Ie){return w[j]!==Ie&&(h.bindFramebuffer(j,Ie),w[j]=Ie,a&&(36009===j&&(w[36160]=Ie),36160===j&&(w[36009]=Ie)),!0)},drawBuffers:function xt(j,Ie){let Te=M,ke=!1;if(j)if(Te=b.get(Ie),void 0===Te&&(Te=[],b.set(Ie,Te)),j.isWebGLMultipleRenderTargets){const je=j.texture;if(Te.length!==je.length||36064!==Te[0]){for(let ct=0,De=je.length;ct<De;ct++)Te[ct]=36064+ct;Te.length=je.length,ke=!0}}else 36064!==Te[0]&&(Te[0]=36064,ke=!0);else 1029!==Te[0]&&(Te[0]=1029,ke=!0);ke&&(s.isWebGL2?h.drawBuffers(Te):n.get("WEBGL_draw_buffers").drawBuffersWEBGL(Te))},useProgram:function wt(j){return C!==j&&(h.useProgram(j),C=j,!0)},setBlending:ce,setMaterial:function fe(j,Ie){j.side===co?de(2884):pt(2884);let Te=1===j.side;Ie&&(Te=!Te),be(Te),1===j.blending&&!1===j.transparent?ce(Qi):ce(j.blending,j.blendEquation,j.blendSrc,j.blendDst,j.blendEquationAlpha,j.blendSrcAlpha,j.blendDstAlpha,j.premultipliedAlpha),y.setFunc(j.depthFunc),y.setTest(j.depthTest),y.setMask(j.depthWrite),m.setMask(j.colorWrite);const ke=j.stencilWrite;v.setTest(ke),ke&&(v.setMask(j.stencilWriteMask),v.setFunc(j.stencilFunc,j.stencilRef,j.stencilFuncMask),v.setOp(j.stencilFail,j.stencilZFail,j.stencilZPass)),yt(j.polygonOffset,j.polygonOffsetFactor,j.polygonOffsetUnits),!0===j.alphaToCoverage?pt(32926):de(32926)},setFlipSided:be,setCullFace:qe,setLineWidth:function Ne(j){j!==q&&(Y&&h.lineWidth(j),q=j)},setPolygonOffset:yt,setScissorTest:function Ke(j){j?pt(3089):de(3089)},activeTexture:et,bindTexture:function Rn(j,Ie){null===oe&&et();let Te=X[oe];void 0===Te&&(Te={type:void 0,texture:void 0},X[oe]=Te),(Te.type!==j||Te.texture!==Ie)&&(h.bindTexture(j,Ie||Rt[j]),Te.type=j,Te.texture=Ie)},unbindTexture:function Xt(){const j=X[oe];void 0!==j&&void 0!==j.type&&(h.bindTexture(j.type,null),j.type=void 0,j.texture=void 0)},compressedTexImage2D:function H(){try{h.compressedTexImage2D.apply(h,arguments)}catch(j){console.error("THREE.WebGLState:",j)}},texImage2D:function ae(){try{h.texImage2D.apply(h,arguments)}catch(j){console.error("THREE.WebGLState:",j)}},texImage3D:function le(){try{h.texImage3D.apply(h,arguments)}catch(j){console.error("THREE.WebGLState:",j)}},texStorage2D:function Fe(){try{h.texStorage2D.apply(h,arguments)}catch(j){console.error("THREE.WebGLState:",j)}},texStorage3D:function Ue(){try{h.texStorage3D.apply(h,arguments)}catch(j){console.error("THREE.WebGLState:",j)}},texSubImage2D:function N(){try{h.texSubImage2D.apply(h,arguments)}catch(j){console.error("THREE.WebGLState:",j)}},texSubImage3D:function se(){try{h.texSubImage3D.apply(h,arguments)}catch(j){console.error("THREE.WebGLState:",j)}},compressedTexSubImage2D:function we(){try{h.compressedTexSubImage2D.apply(h,arguments)}catch(j){console.error("THREE.WebGLState:",j)}},scissor:function Et(j){!1===Me.equals(j)&&(h.scissor(j.x,j.y,j.z,j.w),Me.copy(j))},viewport:function Pt(j){!1===xe.equals(j)&&(h.viewport(j.x,j.y,j.z,j.w),xe.copy(j))},reset:function Ge(){h.disable(3042),h.disable(2884),h.disable(2929),h.disable(32823),h.disable(3089),h.disable(2960),h.disable(32926),h.blendEquation(32774),h.blendFunc(1,0),h.blendFuncSeparate(1,0,1,0),h.colorMask(!0,!0,!0,!0),h.clearColor(0,0,0,0),h.depthMask(!0),h.depthFunc(513),h.clearDepth(1),h.stencilMask(4294967295),h.stencilFunc(519,0,4294967295),h.stencilOp(7680,7680,7680),h.clearStencil(0),h.cullFace(1029),h.frontFace(2305),h.polygonOffset(0,0),h.activeTexture(33984),h.bindFramebuffer(36160,null),!0===a&&(h.bindFramebuffer(36009,null),h.bindFramebuffer(36008,null)),h.useProgram(null),h.lineWidth(1),h.scissor(0,0,h.canvas.width,h.canvas.height),h.viewport(0,0,h.canvas.width,h.canvas.height),_={},oe=null,X={},w={},b=new WeakMap,M=[],C=null,E=!1,S=null,A=null,R=null,F=null,I=null,O=null,V=null,W=!1,$=null,ie=null,q=null,L=null,G=null,Me.set(0,0,h.canvas.width,h.canvas.height),xe.set(0,0,h.canvas.width,h.canvas.height),m.reset(),y.reset(),v.reset()}}}function ep(h,n,s,a,c,u,f){const m=c.isWebGL2,y=c.maxTextures,v=c.maxCubemapSize,_=c.maxTextureSize,w=c.maxSamples,b=n.has("WEBGL_multisampled_render_to_texture")?n.get("WEBGL_multisampled_render_to_texture"):null,M=/OculusBrowser/g.test(navigator.userAgent),C=new WeakMap;let E;const S=new WeakMap;let A=!1;try{A="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(H){}function R(H,N){return A?new OffscreenCanvas(H,N):fc("canvas")}function F(H,N,se,we){let Fe=1;if((H.width>we||H.height>we)&&(Fe=we/Math.max(H.width,H.height)),Fe<1||!0===N){if("undefined"!=typeof HTMLImageElement&&H instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&H instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&H instanceof ImageBitmap){const Ue=N?ei:Math.floor,ae=Ue(Fe*H.width),le=Ue(Fe*H.height);void 0===E&&(E=R(ae,le));const Et=se?R(ae,le):E;return Et.width=ae,Et.height=le,Et.getContext("2d").drawImage(H,0,0,ae,le),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+H.width+"x"+H.height+") to ("+ae+"x"+le+")."),Et}return"data"in H&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+H.width+"x"+H.height+")."),H}return H}function I(H){return Jn(H.width)&&Jn(H.height)}function V(H,N){return H.generateMipmaps&&N&&H.minFilter!==Qt&&H.minFilter!==hn}function W(H){h.generateMipmap(H)}function $(H,N,se,we,Fe=!1){if(!1===m)return N;if(null!==H){if(void 0!==h[H])return h[H];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+H+"'")}let Ue=N;return 6403===N&&(5126===se&&(Ue=33326),5131===se&&(Ue=33325),5121===se&&(Ue=33321)),33319===N&&(5126===se&&(Ue=33328),5131===se&&(Ue=33327),5121===se&&(Ue=33323)),6408===N&&(5126===se&&(Ue=34836),5131===se&&(Ue=34842),5121===se&&(Ue=we===Tn&&!1===Fe?35907:32856),32819===se&&(Ue=32854),32820===se&&(Ue=32855)),(33325===Ue||33326===Ue||33327===Ue||33328===Ue||34842===Ue||34836===Ue)&&n.get("EXT_color_buffer_float"),Ue}function ie(H,N,se){return!0===V(H,se)||H.isFramebufferTexture&&H.minFilter!==Qt&&H.minFilter!==hn?Math.log2(Math.max(N.width,N.height))+1:void 0!==H.mipmaps&&H.mipmaps.length>0?H.mipmaps.length:H.isCompressedTexture&&Array.isArray(H.image)?N.mipmaps.length:1}function q(H){return H===Qt||1004===H||1005===H?9728:9729}function L(H){const N=H.target;N.removeEventListener("dispose",L),function _e(H){const N=a.get(H);if(void 0===N.__webglInit)return;const se=H.source,we=S.get(se);if(we){const Fe=we[N.__cacheKey];Fe.usedTimes--,0===Fe.usedTimes&&Y(H),0===Object.keys(we).length&&S.delete(se)}a.remove(H)}(N),N.isVideoTexture&&C.delete(N)}function G(H){const N=H.target;N.removeEventListener("dispose",G),function ne(H){const N=H.texture,se=a.get(H),we=a.get(N);if(void 0!==we.__webglTexture&&(h.deleteTexture(we.__webglTexture),f.memory.textures--),H.depthTexture&&H.depthTexture.dispose(),H.isWebGLCubeRenderTarget)for(let Fe=0;Fe<6;Fe++)h.deleteFramebuffer(se.__webglFramebuffer[Fe]),se.__webglDepthbuffer&&h.deleteRenderbuffer(se.__webglDepthbuffer[Fe]);else h.deleteFramebuffer(se.__webglFramebuffer),se.__webglDepthbuffer&&h.deleteRenderbuffer(se.__webglDepthbuffer),se.__webglMultisampledFramebuffer&&h.deleteFramebuffer(se.__webglMultisampledFramebuffer),se.__webglColorRenderbuffer&&h.deleteRenderbuffer(se.__webglColorRenderbuffer),se.__webglDepthRenderbuffer&&h.deleteRenderbuffer(se.__webglDepthRenderbuffer);if(H.isWebGLMultipleRenderTargets)for(let Fe=0,Ue=N.length;Fe<Ue;Fe++){const ae=a.get(N[Fe]);ae.__webglTexture&&(h.deleteTexture(ae.__webglTexture),f.memory.textures--),a.remove(N[Fe])}a.remove(N),a.remove(H)}(N)}function Y(H){const N=a.get(H);h.deleteTexture(N.__webglTexture),delete S.get(H.source)[N.__cacheKey],f.memory.textures--}let J=0;function ve(H,N){const se=a.get(H);if(H.isVideoTexture&&function Rn(H){const N=f.render.frame;C.get(H)!==N&&(C.set(H,N),H.update())}(H),!1===H.isRenderTargetTexture&&H.version>0&&se.__version!==H.version){const we=H.image;if(null===we)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else{if(!1!==we.complete)return void xt(se,H,N);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}s.activeTexture(33984+N),s.bindTexture(3553,se.__webglTexture)}const Rt={1e3:10497,[Gt]:33071,1002:33648},pt={[Qt]:9728,1004:9984,1005:9986,[hn]:9729,1007:9985,1008:9987};function de(H,N,se){if(se?(h.texParameteri(H,10242,Rt[N.wrapS]),h.texParameteri(H,10243,Rt[N.wrapT]),(32879===H||35866===H)&&h.texParameteri(H,32882,Rt[N.wrapR]),h.texParameteri(H,10240,pt[N.magFilter]),h.texParameteri(H,10241,pt[N.minFilter])):(h.texParameteri(H,10242,33071),h.texParameteri(H,10243,33071),(32879===H||35866===H)&&h.texParameteri(H,32882,33071),(N.wrapS!==Gt||N.wrapT!==Gt)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),h.texParameteri(H,10240,q(N.magFilter)),h.texParameteri(H,10241,q(N.minFilter)),N.minFilter!==Qt&&N.minFilter!==hn&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===n.has("EXT_texture_filter_anisotropic")){const we=n.get("EXT_texture_filter_anisotropic");if(N.type===fo&&!1===n.has("OES_texture_float_linear")||!1===m&&N.type===Ga&&!1===n.has("OES_texture_half_float_linear"))return;(N.anisotropy>1||a.get(N).__currentAnisotropy)&&(h.texParameterf(H,we.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(N.anisotropy,c.getMaxAnisotropy())),a.get(N).__currentAnisotropy=N.anisotropy)}}function Zt(H,N){let se=!1;void 0===H.__webglInit&&(H.__webglInit=!0,N.addEventListener("dispose",L));const we=N.source;let Fe=S.get(we);void 0===Fe&&(Fe={},S.set(we,Fe));const Ue=function pe(H){const N=[];return N.push(H.wrapS),N.push(H.wrapT),N.push(H.magFilter),N.push(H.minFilter),N.push(H.anisotropy),N.push(H.internalFormat),N.push(H.format),N.push(H.type),N.push(H.generateMipmaps),N.push(H.premultiplyAlpha),N.push(H.flipY),N.push(H.unpackAlignment),N.push(H.encoding),N.join()}(N);if(Ue!==H.__cacheKey){void 0===Fe[Ue]&&(Fe[Ue]={texture:h.createTexture(),usedTimes:0},f.memory.textures++,se=!0),Fe[Ue].usedTimes++;const ae=Fe[H.__cacheKey];void 0!==ae&&(Fe[H.__cacheKey].usedTimes--,0===ae.usedTimes&&Y(N)),H.__cacheKey=Ue,H.__webglTexture=Fe[Ue].texture}return se}function xt(H,N,se){let we=3553;N.isDataArrayTexture&&(we=35866),N.isData3DTexture&&(we=32879);const Fe=Zt(H,N),Ue=N.source;if(s.activeTexture(33984+se),s.bindTexture(we,H.__webglTexture),Ue.version!==Ue.__currentVersion||!0===Fe){h.pixelStorei(37440,N.flipY),h.pixelStorei(37441,N.premultiplyAlpha),h.pixelStorei(3317,N.unpackAlignment),h.pixelStorei(37443,0);const ae=function O(H){return!m&&(H.wrapS!==Gt||H.wrapT!==Gt||H.minFilter!==Qt&&H.minFilter!==hn)}(N)&&!1===I(N.image);let le=F(N.image,ae,!1,_);le=Xt(N,le);const Et=I(le)||m,Pt=u.convert(N.format,N.encoding);let Ie,Ge=u.convert(N.type),j=$(N.internalFormat,Pt,Ge,N.encoding,N.isVideoTexture);de(we,N,Et);const Te=N.mipmaps,ke=m&&!0!==N.isVideoTexture,je=void 0===H.__version,ct=ie(N,le,Et);if(N.isDepthTexture)j=6402,m?j=N.type===fo?36012:1014===N.type?33190:N.type===ea?35056:33189:N.type===fo&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),N.format===Ir&&6402===j&&N.type!==za&&1014!==N.type&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),N.type=za,Ge=u.convert(N.type)),N.format===zi&&6402===j&&(j=34041,N.type!==ea&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),N.type=ea,Ge=u.convert(N.type))),ke&&je?s.texStorage2D(3553,1,j,le.width,le.height):s.texImage2D(3553,0,j,le.width,le.height,0,Pt,Ge,null);else if(N.isDataTexture)if(Te.length>0&&Et){ke&&je&&s.texStorage2D(3553,ct,j,Te[0].width,Te[0].height);for(let De=0,vt=Te.length;De<vt;De++)Ie=Te[De],ke?s.texSubImage2D(3553,De,0,0,Ie.width,Ie.height,Pt,Ge,Ie.data):s.texImage2D(3553,De,j,Ie.width,Ie.height,0,Pt,Ge,Ie.data);N.generateMipmaps=!1}else ke?(je&&s.texStorage2D(3553,ct,j,le.width,le.height),s.texSubImage2D(3553,0,0,0,le.width,le.height,Pt,Ge,le.data)):s.texImage2D(3553,0,j,le.width,le.height,0,Pt,Ge,le.data);else if(N.isCompressedTexture){ke&&je&&s.texStorage2D(3553,ct,j,Te[0].width,Te[0].height);for(let De=0,vt=Te.length;De<vt;De++)Ie=Te[De],N.format!==Xn?null!==Pt?ke?s.compressedTexSubImage2D(3553,De,0,0,Ie.width,Ie.height,Pt,Ie.data):s.compressedTexImage2D(3553,De,j,Ie.width,Ie.height,0,Ie.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ke?s.texSubImage2D(3553,De,0,0,Ie.width,Ie.height,Pt,Ge,Ie.data):s.texImage2D(3553,De,j,Ie.width,Ie.height,0,Pt,Ge,Ie.data)}else if(N.isDataArrayTexture)ke?(je&&s.texStorage3D(35866,ct,j,le.width,le.height,le.depth),s.texSubImage3D(35866,0,0,0,0,le.width,le.height,le.depth,Pt,Ge,le.data)):s.texImage3D(35866,0,j,le.width,le.height,le.depth,0,Pt,Ge,le.data);else if(N.isData3DTexture)ke?(je&&s.texStorage3D(32879,ct,j,le.width,le.height,le.depth),s.texSubImage3D(32879,0,0,0,0,le.width,le.height,le.depth,Pt,Ge,le.data)):s.texImage3D(32879,0,j,le.width,le.height,le.depth,0,Pt,Ge,le.data);else if(N.isFramebufferTexture)ke&&je?s.texStorage2D(3553,ct,j,le.width,le.height):s.texImage2D(3553,0,j,le.width,le.height,0,Pt,Ge,null);else if(Te.length>0&&Et){ke&&je&&s.texStorage2D(3553,ct,j,Te[0].width,Te[0].height);for(let De=0,vt=Te.length;De<vt;De++)Ie=Te[De],ke?s.texSubImage2D(3553,De,0,0,Pt,Ge,Ie):s.texImage2D(3553,De,j,Pt,Ge,Ie);N.generateMipmaps=!1}else ke?(je&&s.texStorage2D(3553,ct,j,le.width,le.height),s.texSubImage2D(3553,0,0,0,Pt,Ge,le)):s.texImage2D(3553,0,j,Pt,Ge,le);V(N,Et)&&W(we),Ue.__currentVersion=Ue.version,N.onUpdate&&N.onUpdate(N)}H.__version=N.version}function Ce(H,N,se,we,Fe){const Ue=u.convert(se.format,se.encoding),ae=u.convert(se.type),le=$(se.internalFormat,Ue,ae,se.encoding);a.get(N).__hasExternalTextures||(32879===Fe||35866===Fe?s.texImage3D(Fe,0,le,N.width,N.height,N.depth,0,Ue,ae,null):s.texImage2D(Fe,0,le,N.width,N.height,0,Ue,ae,null)),s.bindFramebuffer(36160,H),et(N)?b.framebufferTexture2DMultisampleEXT(36160,we,Fe,a.get(se).__webglTexture,0,Ke(N)):h.framebufferTexture2D(36160,we,Fe,a.get(se).__webglTexture,0),s.bindFramebuffer(36160,null)}function It(H,N,se){if(h.bindRenderbuffer(36161,H),N.depthBuffer&&!N.stencilBuffer){let we=33189;if(se||et(N)){const Fe=N.depthTexture;Fe&&Fe.isDepthTexture&&(Fe.type===fo?we=36012:1014===Fe.type&&(we=33190));const Ue=Ke(N);et(N)?b.renderbufferStorageMultisampleEXT(36161,Ue,we,N.width,N.height):h.renderbufferStorageMultisample(36161,Ue,we,N.width,N.height)}else h.renderbufferStorage(36161,we,N.width,N.height);h.framebufferRenderbuffer(36160,36096,36161,H)}else if(N.depthBuffer&&N.stencilBuffer){const we=Ke(N);se&&!1===et(N)?h.renderbufferStorageMultisample(36161,we,35056,N.width,N.height):et(N)?b.renderbufferStorageMultisampleEXT(36161,we,35056,N.width,N.height):h.renderbufferStorage(36161,34041,N.width,N.height),h.framebufferRenderbuffer(36160,33306,36161,H)}else{const we=!0===N.isWebGLMultipleRenderTargets?N.texture[0]:N.texture,Fe=u.convert(we.format,we.encoding),Ue=u.convert(we.type),ae=$(we.internalFormat,Fe,Ue,we.encoding),le=Ke(N);se&&!1===et(N)?h.renderbufferStorageMultisample(36161,le,ae,N.width,N.height):et(N)?b.renderbufferStorageMultisampleEXT(36161,le,ae,N.width,N.height):h.renderbufferStorage(36161,ae,N.width,N.height)}h.bindRenderbuffer(36161,null)}function fe(H){const N=a.get(H),se=!0===H.isWebGLCubeRenderTarget;if(H.depthTexture&&!N.__autoAllocateDepthBuffer){if(se)throw new Error("target.depthTexture not supported in Cube render targets");!function ce(H,N){if(N&&N.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(s.bindFramebuffer(36160,H),!N.depthTexture||!N.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!a.get(N.depthTexture).__webglTexture||N.depthTexture.image.width!==N.width||N.depthTexture.image.height!==N.height)&&(N.depthTexture.image.width=N.width,N.depthTexture.image.height=N.height,N.depthTexture.needsUpdate=!0),ve(N.depthTexture,0);const we=a.get(N.depthTexture).__webglTexture,Fe=Ke(N);if(N.depthTexture.format===Ir)et(N)?b.framebufferTexture2DMultisampleEXT(36160,36096,3553,we,0,Fe):h.framebufferTexture2D(36160,36096,3553,we,0);else{if(N.depthTexture.format!==zi)throw new Error("Unknown depthTexture format");et(N)?b.framebufferTexture2DMultisampleEXT(36160,33306,3553,we,0,Fe):h.framebufferTexture2D(36160,33306,3553,we,0)}}(N.__webglFramebuffer,H)}else if(se){N.__webglDepthbuffer=[];for(let we=0;we<6;we++)s.bindFramebuffer(36160,N.__webglFramebuffer[we]),N.__webglDepthbuffer[we]=h.createRenderbuffer(),It(N.__webglDepthbuffer[we],H,!1)}else s.bindFramebuffer(36160,N.__webglFramebuffer),N.__webglDepthbuffer=h.createRenderbuffer(),It(N.__webglDepthbuffer,H,!1);s.bindFramebuffer(36160,null)}function Ke(H){return Math.min(w,H.samples)}function et(H){const N=a.get(H);return m&&H.samples>0&&!0===n.has("WEBGL_multisampled_render_to_texture")&&!1!==N.__useRenderToTexture}function Xt(H,N){const se=H.encoding,we=H.format,Fe=H.type;return!0===H.isCompressedTexture||!0===H.isVideoTexture||1035===H.format||se!==po&&(se===Tn?!1===m?!0===n.has("EXT_sRGB")&&we===Xn?(H.format=1035,H.minFilter=hn,H.generateMipmaps=!1):N=cs.sRGBToLinear(N):(we!==Xn||Fe!==Jo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",se)),N}this.allocateTextureUnit=function X(){const H=J;return H>=y&&console.warn("THREE.WebGLTextures: Trying to use "+H+" texture units while this GPU supports only "+y),J+=1,H},this.resetTextureUnits=function oe(){J=0},this.setTexture2D=ve,this.setTexture2DArray=function Me(H,N){const se=a.get(H);H.version>0&&se.__version!==H.version?xt(se,H,N):(s.activeTexture(33984+N),s.bindTexture(35866,se.__webglTexture))},this.setTexture3D=function xe(H,N){const se=a.get(H);H.version>0&&se.__version!==H.version?xt(se,H,N):(s.activeTexture(33984+N),s.bindTexture(32879,se.__webglTexture))},this.setTextureCube=function Qe(H,N){const se=a.get(H);H.version>0&&se.__version!==H.version?function wt(H,N,se){if(6!==N.image.length)return;const we=Zt(H,N),Fe=N.source;if(s.activeTexture(33984+se),s.bindTexture(34067,H.__webglTexture),Fe.version!==Fe.__currentVersion||!0===we){h.pixelStorei(37440,N.flipY),h.pixelStorei(37441,N.premultiplyAlpha),h.pixelStorei(3317,N.unpackAlignment),h.pixelStorei(37443,0);const Ue=N.isCompressedTexture||N.image[0].isCompressedTexture,ae=N.image[0]&&N.image[0].isDataTexture,le=[];for(let De=0;De<6;De++)le[De]=Ue||ae?ae?N.image[De].image:N.image[De]:F(N.image[De],!1,!0,v),le[De]=Xt(N,le[De]);const Et=le[0],Pt=I(Et)||m,Ge=u.convert(N.format,N.encoding),j=u.convert(N.type),Ie=$(N.internalFormat,Ge,j,N.encoding),Te=m&&!0!==N.isVideoTexture,ke=void 0===H.__version;let ct,je=ie(N,Et,Pt);if(de(34067,N,Pt),Ue){Te&&ke&&s.texStorage2D(34067,je,Ie,Et.width,Et.height);for(let De=0;De<6;De++){ct=le[De].mipmaps;for(let vt=0;vt<ct.length;vt++){const gn=ct[vt];N.format!==Xn?null!==Ge?Te?s.compressedTexSubImage2D(34069+De,vt,0,0,gn.width,gn.height,Ge,gn.data):s.compressedTexImage2D(34069+De,vt,Ie,gn.width,gn.height,0,gn.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Te?s.texSubImage2D(34069+De,vt,0,0,gn.width,gn.height,Ge,j,gn.data):s.texImage2D(34069+De,vt,Ie,gn.width,gn.height,0,Ge,j,gn.data)}}}else{ct=N.mipmaps,Te&&ke&&(ct.length>0&&je++,s.texStorage2D(34067,je,Ie,le[0].width,le[0].height));for(let De=0;De<6;De++)if(ae){Te?s.texSubImage2D(34069+De,0,0,0,le[De].width,le[De].height,Ge,j,le[De].data):s.texImage2D(34069+De,0,Ie,le[De].width,le[De].height,0,Ge,j,le[De].data);for(let vt=0;vt<ct.length;vt++){const kt=ct[vt].image[De].image;Te?s.texSubImage2D(34069+De,vt+1,0,0,kt.width,kt.height,Ge,j,kt.data):s.texImage2D(34069+De,vt+1,Ie,kt.width,kt.height,0,Ge,j,kt.data)}}else{Te?s.texSubImage2D(34069+De,0,0,0,Ge,j,le[De]):s.texImage2D(34069+De,0,Ie,Ge,j,le[De]);for(let vt=0;vt<ct.length;vt++){const gn=ct[vt];Te?s.texSubImage2D(34069+De,vt+1,0,0,Ge,j,gn.image[De]):s.texImage2D(34069+De,vt+1,Ie,Ge,j,gn.image[De])}}}V(N,Pt)&&W(34067),Fe.__currentVersion=Fe.version,N.onUpdate&&N.onUpdate(N)}H.__version=N.version}(se,H,N):(s.activeTexture(33984+N),s.bindTexture(34067,se.__webglTexture))},this.rebindTextures=function be(H,N,se){const we=a.get(H);void 0!==N&&Ce(we.__webglFramebuffer,H,H.texture,36064,3553),void 0!==se&&fe(H)},this.setupRenderTarget=function qe(H){const N=H.texture,se=a.get(H),we=a.get(N);H.addEventListener("dispose",G),!0!==H.isWebGLMultipleRenderTargets&&(void 0===we.__webglTexture&&(we.__webglTexture=h.createTexture()),we.__version=N.version,f.memory.textures++);const Fe=!0===H.isWebGLCubeRenderTarget,Ue=!0===H.isWebGLMultipleRenderTargets,ae=I(H)||m;if(Fe){se.__webglFramebuffer=[];for(let le=0;le<6;le++)se.__webglFramebuffer[le]=h.createFramebuffer()}else if(se.__webglFramebuffer=h.createFramebuffer(),Ue)if(c.drawBuffers){const le=H.texture;for(let Et=0,Pt=le.length;Et<Pt;Et++){const Ge=a.get(le[Et]);void 0===Ge.__webglTexture&&(Ge.__webglTexture=h.createTexture(),f.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(m&&H.samples>0&&!1===et(H)){se.__webglMultisampledFramebuffer=h.createFramebuffer(),se.__webglColorRenderbuffer=h.createRenderbuffer(),h.bindRenderbuffer(36161,se.__webglColorRenderbuffer);const le=u.convert(N.format,N.encoding),Et=u.convert(N.type),Pt=$(N.internalFormat,le,Et,N.encoding),Ge=Ke(H);h.renderbufferStorageMultisample(36161,Ge,Pt,H.width,H.height),s.bindFramebuffer(36160,se.__webglMultisampledFramebuffer),h.framebufferRenderbuffer(36160,36064,36161,se.__webglColorRenderbuffer),h.bindRenderbuffer(36161,null),H.depthBuffer&&(se.__webglDepthRenderbuffer=h.createRenderbuffer(),It(se.__webglDepthRenderbuffer,H,!0)),s.bindFramebuffer(36160,null)}if(Fe){s.bindTexture(34067,we.__webglTexture),de(34067,N,ae);for(let le=0;le<6;le++)Ce(se.__webglFramebuffer[le],H,N,36064,34069+le);V(N,ae)&&W(34067),s.unbindTexture()}else if(Ue){const le=H.texture;for(let Et=0,Pt=le.length;Et<Pt;Et++){const Ge=le[Et],j=a.get(Ge);s.bindTexture(3553,j.__webglTexture),de(3553,Ge,ae),Ce(se.__webglFramebuffer,H,Ge,36064+Et,3553),V(Ge,ae)&&W(3553)}s.unbindTexture()}else{let le=3553;(H.isWebGL3DRenderTarget||H.isWebGLArrayRenderTarget)&&(m?le=H.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),s.bindTexture(le,we.__webglTexture),de(le,N,ae),Ce(se.__webglFramebuffer,H,N,36064,le),V(N,ae)&&W(le),s.unbindTexture()}H.depthBuffer&&fe(H)},this.updateRenderTargetMipmap=function Ne(H){const N=I(H)||m,se=!0===H.isWebGLMultipleRenderTargets?H.texture:[H.texture];for(let we=0,Fe=se.length;we<Fe;we++){const Ue=se[we];if(V(Ue,N)){const ae=H.isWebGLCubeRenderTarget?34067:3553,le=a.get(Ue).__webglTexture;s.bindTexture(ae,le),W(ae),s.unbindTexture()}}},this.updateMultisampleRenderTarget=function yt(H){if(m&&H.samples>0&&!1===et(H)){const N=H.width,se=H.height;let we=16384;const Fe=[36064],Ue=H.stencilBuffer?33306:36096;H.depthBuffer&&Fe.push(Ue);const ae=a.get(H),le=void 0!==ae.__ignoreDepthValues&&ae.__ignoreDepthValues;!1===le&&(H.depthBuffer&&(we|=256),H.stencilBuffer&&(we|=1024)),s.bindFramebuffer(36008,ae.__webglMultisampledFramebuffer),s.bindFramebuffer(36009,ae.__webglFramebuffer),!0===le&&(h.invalidateFramebuffer(36008,[Ue]),h.invalidateFramebuffer(36009,[Ue])),h.blitFramebuffer(0,0,N,se,0,0,N,se,we,9728),M&&h.invalidateFramebuffer(36008,Fe),s.bindFramebuffer(36008,null),s.bindFramebuffer(36009,ae.__webglMultisampledFramebuffer)}},this.setupDepthRenderbuffer=fe,this.setupFrameBufferTexture=Ce,this.useMultisampledRTT=et}function ay(h,n,s){const a=s.isWebGL2;return{convert:function c(u,f=null){let m;if(u===Jo)return 5121;if(1017===u)return 32819;if(1018===u)return 32820;if(1010===u)return 5120;if(1011===u)return 5122;if(u===za)return 5123;if(1013===u)return 5124;if(1014===u)return 5125;if(u===fo)return 5126;if(u===Ga)return a?5131:(m=n.get("OES_texture_half_float"),null!==m?m.HALF_FLOAT_OES:null);if(1021===u)return 6406;if(u===Xn)return 6408;if(1024===u)return 6409;if(1025===u)return 6410;if(u===Ir)return 6402;if(u===zi)return 34041;if(1028===u)return 6403;if(1022===u)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(1035===u)return m=n.get("EXT_sRGB"),null!==m?m.SRGB_ALPHA_EXT:null;if(1029===u)return 36244;if(1030===u)return 33319;if(1031===u)return 33320;if(1033===u)return 36249;if(33776===u||33777===u||33778===u||33779===u)if(f===Tn){if(m=n.get("WEBGL_compressed_texture_s3tc_srgb"),null===m)return null;if(33776===u)return m.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(33777===u)return m.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(33778===u)return m.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(33779===u)return m.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else{if(m=n.get("WEBGL_compressed_texture_s3tc"),null===m)return null;if(33776===u)return m.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===u)return m.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===u)return m.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===u)return m.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===u||35841===u||35842===u||35843===u){if(m=n.get("WEBGL_compressed_texture_pvrtc"),null===m)return null;if(35840===u)return m.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===u)return m.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===u)return m.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===u)return m.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===u)return m=n.get("WEBGL_compressed_texture_etc1"),null!==m?m.COMPRESSED_RGB_ETC1_WEBGL:null;if(37492===u||37496===u){if(m=n.get("WEBGL_compressed_texture_etc"),null===m)return null;if(37492===u)return f===Tn?m.COMPRESSED_SRGB8_ETC2:m.COMPRESSED_RGB8_ETC2;if(37496===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:m.COMPRESSED_RGBA8_ETC2_EAC}if(37808===u||37809===u||37810===u||37811===u||37812===u||37813===u||37814===u||37815===u||37816===u||37817===u||37818===u||37819===u||37820===u||37821===u){if(m=n.get("WEBGL_compressed_texture_astc"),null===m)return null;if(37808===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:m.COMPRESSED_RGBA_ASTC_4x4_KHR;if(37809===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:m.COMPRESSED_RGBA_ASTC_5x4_KHR;if(37810===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:m.COMPRESSED_RGBA_ASTC_5x5_KHR;if(37811===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:m.COMPRESSED_RGBA_ASTC_6x5_KHR;if(37812===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:m.COMPRESSED_RGBA_ASTC_6x6_KHR;if(37813===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:m.COMPRESSED_RGBA_ASTC_8x5_KHR;if(37814===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:m.COMPRESSED_RGBA_ASTC_8x6_KHR;if(37815===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:m.COMPRESSED_RGBA_ASTC_8x8_KHR;if(37816===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:m.COMPRESSED_RGBA_ASTC_10x5_KHR;if(37817===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:m.COMPRESSED_RGBA_ASTC_10x6_KHR;if(37818===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:m.COMPRESSED_RGBA_ASTC_10x8_KHR;if(37819===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:m.COMPRESSED_RGBA_ASTC_10x10_KHR;if(37820===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:m.COMPRESSED_RGBA_ASTC_12x10_KHR;if(37821===u)return f===Tn?m.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:m.COMPRESSED_RGBA_ASTC_12x12_KHR}if(36492===u){if(m=n.get("EXT_texture_compression_bptc"),null===m)return null;if(36492===u)return f===Tn?m.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:m.COMPRESSED_RGBA_BPTC_UNORM_EXT}return u===ea?a?34042:(m=n.get("WEBGL_depth_texture"),null!==m?m.UNSIGNED_INT_24_8_WEBGL:null):void 0}}}Zc.prototype.isMeshDistanceMaterial=!0;class Fd extends zn{constructor(n=[]){super(),this.cameras=n}}Fd.prototype.isArrayCamera=!0;class Ur extends Jt{constructor(){super(),this.type="Group"}}Ur.prototype.isGroup=!0;const _x={type:"move"};class Nd{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return null===this._hand&&(this._hand=new Ur,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return null===this._targetRay&&(this._targetRay=new Ur,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new k,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new k),this._targetRay}getGripSpace(){return null===this._grip&&(this._grip=new Ur,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new k,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new k),this._grip}dispatchEvent(n){return null!==this._targetRay&&this._targetRay.dispatchEvent(n),null!==this._grip&&this._grip.dispatchEvent(n),null!==this._hand&&this._hand.dispatchEvent(n),this}disconnect(n){return this.dispatchEvent({type:"disconnected",data:n}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this}update(n,s,a){let c=null,u=null,f=null;const m=this._targetRay,y=this._grip,v=this._hand;if(n&&"visible-blurred"!==s.session.visibilityState)if(null!==m&&(c=s.getPose(n.targetRaySpace,a),null!==c&&(m.matrix.fromArray(c.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),c.linearVelocity?(m.hasLinearVelocity=!0,m.linearVelocity.copy(c.linearVelocity)):m.hasLinearVelocity=!1,c.angularVelocity?(m.hasAngularVelocity=!0,m.angularVelocity.copy(c.angularVelocity)):m.hasAngularVelocity=!1,this.dispatchEvent(_x))),v&&n.hand){f=!0;for(const E of n.hand.values()){const S=s.getJointPose(E,a);if(void 0===v.joints[E.jointName]){const R=new Ur;R.matrixAutoUpdate=!1,R.visible=!1,v.joints[E.jointName]=R,v.add(R)}const A=v.joints[E.jointName];null!==S&&(A.matrix.fromArray(S.transform.matrix),A.matrix.decompose(A.position,A.rotation,A.scale),A.jointRadius=S.radius),A.visible=null!==S}const b=v.joints["index-finger-tip"].position.distanceTo(v.joints["thumb-tip"].position),M=.02,C=.005;v.inputState.pinching&&b>M+C?(v.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:n.handedness,target:this})):!v.inputState.pinching&&b<=M-C&&(v.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:n.handedness,target:this}))}else null!==y&&n.gripSpace&&(u=s.getPose(n.gripSpace,a),null!==u&&(y.matrix.fromArray(u.transform.matrix),y.matrix.decompose(y.position,y.rotation,y.scale),u.linearVelocity?(y.hasLinearVelocity=!0,y.linearVelocity.copy(u.linearVelocity)):y.hasLinearVelocity=!1,u.angularVelocity?(y.hasAngularVelocity=!0,y.angularVelocity.copy(u.angularVelocity)):y.hasAngularVelocity=!1));return null!==m&&(m.visible=null!==c),null!==y&&(y.visible=null!==u),null!==v&&(v.visible=null!==f),this}}class ly extends cn{constructor(n,s,a,c,u,f,m,y,v,_){if((_=void 0!==_?_:Ir)!==Ir&&_!==zi)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===a&&_===Ir&&(a=za),void 0===a&&_===zi&&(a=ea),super(null,c,u,f,m,y,_,a,v),this.image={width:n,height:s},this.magFilter=void 0!==m?m:Qt,this.minFilter=void 0!==y?y:Qt,this.flipY=!1,this.generateMipmaps=!1}}ly.prototype.isDepthTexture=!0;class xx extends ia{constructor(n,s){super();const a=this;let c=null,u=1,f=null,m="local-floor",y=null,v=null,_=null,w=null,b=null;const M=s.getContextAttributes();let C=null,E=null;const S=[],A=new Map,R=new zn;R.layers.enable(1),R.viewport=new jt;const F=new zn;F.layers.enable(2),F.viewport=new jt;const I=[R,F],O=new Fd;O.layers.enable(1),O.layers.enable(2);let V=null,W=null;function $(X){const pe=A.get(X.inputSource);pe&&pe.dispatchEvent({type:X.type,data:X.inputSource})}function ie(){A.forEach(function(X,pe){X.disconnect(pe)}),A.clear(),V=null,W=null,n.setRenderTarget(C),w=null,_=null,v=null,c=null,E=null,oe.stop(),a.isPresenting=!1,a.dispatchEvent({type:"sessionend"})}function q(X){const pe=c.inputSources;for(let ve=0;ve<S.length;ve++)A.set(pe[ve],S[ve]);for(let ve=0;ve<X.removed.length;ve++){const Me=X.removed[ve],xe=A.get(Me);xe&&(xe.dispatchEvent({type:"disconnected",data:Me}),A.delete(Me))}for(let ve=0;ve<X.added.length;ve++){const Me=X.added[ve],xe=A.get(Me);xe&&xe.dispatchEvent({type:"connected",data:Me})}}this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(X){let pe=S[X];return void 0===pe&&(pe=new Nd,S[X]=pe),pe.getTargetRaySpace()},this.getControllerGrip=function(X){let pe=S[X];return void 0===pe&&(pe=new Nd,S[X]=pe),pe.getGripSpace()},this.getHand=function(X){let pe=S[X];return void 0===pe&&(pe=new Nd,S[X]=pe),pe.getHandSpace()},this.setFramebufferScaleFactor=function(X){u=X,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(X){m=X,!0===a.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return f},this.getBaseLayer=function(){return null!==_?_:w},this.getBinding=function(){return v},this.getFrame=function(){return b},this.getSession=function(){return c},this.setSession=function(){var X=(0,it.Z)(function*(pe){if(c=pe,null!==c){if(C=n.getRenderTarget(),c.addEventListener("select",$),c.addEventListener("selectstart",$),c.addEventListener("selectend",$),c.addEventListener("squeeze",$),c.addEventListener("squeezestart",$),c.addEventListener("squeezeend",$),c.addEventListener("end",ie),c.addEventListener("inputsourceschange",q),!0!==M.xrCompatible&&(yield s.makeXRCompatible()),void 0===c.renderState.layers||!1===n.capabilities.isWebGL2)w=new XRWebGLLayer(c,s,{antialias:void 0!==c.renderState.layers||M.antialias,alpha:M.alpha,depth:M.depth,stencil:M.stencil,framebufferScaleFactor:u}),c.updateRenderState({baseLayer:w}),E=new ti(w.framebufferWidth,w.framebufferHeight,{format:Xn,type:Jo,encoding:n.outputEncoding});else{let ve=null,Me=null,xe=null;M.depth&&(xe=M.stencil?35056:33190,ve=M.stencil?zi:Ir,Me=M.stencil?ea:za);const Qe={colorFormat:n.outputEncoding===Tn?35907:32856,depthFormat:xe,scaleFactor:u};v=new XRWebGLBinding(c,s),_=v.createProjectionLayer(Qe),c.updateRenderState({layers:[_]}),E=new ti(_.textureWidth,_.textureHeight,{format:Xn,type:Jo,depthTexture:new ly(_.textureWidth,_.textureHeight,Me,void 0,void 0,void 0,void 0,void 0,void 0,ve),stencilBuffer:M.stencil,encoding:n.outputEncoding,samples:M.antialias?4:0}),n.properties.get(E).__ignoreDepthValues=_.ignoreDepthValues}E.isXRRenderTarget=!0,this.setFoveation(1),f=yield c.requestReferenceSpace(m),oe.setContext(c),oe.start(),a.isPresenting=!0,a.dispatchEvent({type:"sessionstart"})}});return function(pe){return X.apply(this,arguments)}}();const L=new k,G=new k;function Y(X,pe){null===pe?X.matrixWorld.copy(X.matrix):X.matrixWorld.multiplyMatrices(pe.matrixWorld,X.matrix),X.matrixWorldInverse.copy(X.matrixWorld).invert()}this.updateCamera=function(X){if(null===c)return;O.near=F.near=R.near=X.near,O.far=F.far=R.far=X.far,(V!==O.near||W!==O.far)&&(c.updateRenderState({depthNear:O.near,depthFar:O.far}),V=O.near,W=O.far);const pe=X.parent,ve=O.cameras;Y(O,pe);for(let xe=0;xe<ve.length;xe++)Y(ve[xe],pe);O.matrixWorld.decompose(O.position,O.quaternion,O.scale),X.position.copy(O.position),X.quaternion.copy(O.quaternion),X.scale.copy(O.scale),X.matrix.copy(O.matrix),X.matrixWorld.copy(O.matrixWorld);const Me=X.children;for(let xe=0,Qe=Me.length;xe<Qe;xe++)Me[xe].updateMatrixWorld(!0);2===ve.length?function _e(X,pe,ve){L.setFromMatrixPosition(pe.matrixWorld),G.setFromMatrixPosition(ve.matrixWorld);const Me=L.distanceTo(G),xe=pe.projectionMatrix.elements,Qe=ve.projectionMatrix.elements,Rt=xe[14]/(xe[10]-1),pt=xe[14]/(xe[10]+1),de=(xe[9]+1)/xe[5],Zt=(xe[9]-1)/xe[5],xt=(xe[8]-1)/xe[0],wt=(Qe[8]+1)/Qe[0],Ce=Rt*xt,It=Rt*wt,ce=Me/(-xt+wt),fe=ce*-xt;pe.matrixWorld.decompose(X.position,X.quaternion,X.scale),X.translateX(fe),X.translateZ(ce),X.matrixWorld.compose(X.position,X.quaternion,X.scale),X.matrixWorldInverse.copy(X.matrixWorld).invert();const be=Rt+ce,qe=pt+ce;X.projectionMatrix.makePerspective(Ce-fe,It+(Me-fe),de*pt/qe*be,Zt*pt/qe*be,be,qe)}(O,R,F):O.projectionMatrix.copy(R.projectionMatrix)},this.getCamera=function(){return O},this.getFoveation=function(){return null!==_?_.fixedFoveation:null!==w?w.fixedFoveation:void 0},this.setFoveation=function(X){null!==_&&(_.fixedFoveation=X),null!==w&&void 0!==w.fixedFoveation&&(w.fixedFoveation=X)};let ne=null;const oe=new Z_;oe.setAnimationLoop(function J(X,pe){if(y=pe.getViewerPose(f),b=pe,null!==y){const Me=y.views;null!==w&&(n.setRenderTargetFramebuffer(E,w.framebuffer),n.setRenderTarget(E));let xe=!1;Me.length!==O.cameras.length&&(O.cameras.length=0,xe=!0);for(let Qe=0;Qe<Me.length;Qe++){const Rt=Me[Qe];let pt=null;if(null!==w)pt=w.getViewport(Rt);else{const Zt=v.getViewSubImage(_,Rt);pt=Zt.viewport,0===Qe&&(n.setRenderTargetTextures(E,Zt.colorTexture,_.ignoreDepthValues?void 0:Zt.depthStencilTexture),n.setRenderTarget(E))}const de=I[Qe];de.matrix.fromArray(Rt.transform.matrix),de.projectionMatrix.fromArray(Rt.projectionMatrix),de.viewport.set(pt.x,pt.y,pt.width,pt.height),0===Qe&&O.matrix.copy(de.matrix),!0===xe&&O.cameras.push(de)}}const ve=c.inputSources;for(let Me=0;Me<S.length;Me++)S[Me].update(ve[Me],pe,f);ne&&ne(X,pe),b=null}),this.setAnimationLoop=function(X){ne=X},this.dispose=function(){}}}function cy(h,n){function c(E,S){E.opacity.value=S.opacity,S.color&&E.diffuse.value.copy(S.color),S.emissive&&E.emissive.value.copy(S.emissive).multiplyScalar(S.emissiveIntensity),S.map&&(E.map.value=S.map),S.alphaMap&&(E.alphaMap.value=S.alphaMap),S.bumpMap&&(E.bumpMap.value=S.bumpMap,E.bumpScale.value=S.bumpScale,1===S.side&&(E.bumpScale.value*=-1)),S.displacementMap&&(E.displacementMap.value=S.displacementMap,E.displacementScale.value=S.displacementScale,E.displacementBias.value=S.displacementBias),S.emissiveMap&&(E.emissiveMap.value=S.emissiveMap),S.normalMap&&(E.normalMap.value=S.normalMap,E.normalScale.value.copy(S.normalScale),1===S.side&&E.normalScale.value.negate()),S.specularMap&&(E.specularMap.value=S.specularMap),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest);const A=n.get(S).envMap;if(A&&(E.envMap.value=A,E.flipEnvMap.value=A.isCubeTexture&&!1===A.isRenderTargetTexture?-1:1,E.reflectivity.value=S.reflectivity,E.ior.value=S.ior,E.refractionRatio.value=S.refractionRatio),S.lightMap){E.lightMap.value=S.lightMap;const I=!0!==h.physicallyCorrectLights?Math.PI:1;E.lightMapIntensity.value=S.lightMapIntensity*I}let R,F;S.aoMap&&(E.aoMap.value=S.aoMap,E.aoMapIntensity.value=S.aoMapIntensity),S.map?R=S.map:S.specularMap?R=S.specularMap:S.displacementMap?R=S.displacementMap:S.normalMap?R=S.normalMap:S.bumpMap?R=S.bumpMap:S.roughnessMap?R=S.roughnessMap:S.metalnessMap?R=S.metalnessMap:S.alphaMap?R=S.alphaMap:S.emissiveMap?R=S.emissiveMap:S.clearcoatMap?R=S.clearcoatMap:S.clearcoatNormalMap?R=S.clearcoatNormalMap:S.clearcoatRoughnessMap?R=S.clearcoatRoughnessMap:S.specularIntensityMap?R=S.specularIntensityMap:S.specularColorMap?R=S.specularColorMap:S.transmissionMap?R=S.transmissionMap:S.thicknessMap?R=S.thicknessMap:S.sheenColorMap?R=S.sheenColorMap:S.sheenRoughnessMap&&(R=S.sheenRoughnessMap),void 0!==R&&(R.isWebGLRenderTarget&&(R=R.texture),!0===R.matrixAutoUpdate&&R.updateMatrix(),E.uvTransform.value.copy(R.matrix)),S.aoMap?F=S.aoMap:S.lightMap&&(F=S.lightMap),void 0!==F&&(F.isWebGLRenderTarget&&(F=F.texture),!0===F.matrixAutoUpdate&&F.updateMatrix(),E.uv2Transform.value.copy(F.matrix))}return{refreshFogUniforms:function s(E,S){E.fogColor.value.copy(S.color),S.isFog?(E.fogNear.value=S.near,E.fogFar.value=S.far):S.isFogExp2&&(E.fogDensity.value=S.density)},refreshMaterialUniforms:function a(E,S,A,R,F){S.isMeshBasicMaterial||S.isMeshLambertMaterial?c(E,S):S.isMeshToonMaterial?(c(E,S),function _(E,S){S.gradientMap&&(E.gradientMap.value=S.gradientMap)}(E,S)):S.isMeshPhongMaterial?(c(E,S),function v(E,S){E.specular.value.copy(S.specular),E.shininess.value=Math.max(S.shininess,1e-4)}(E,S)):S.isMeshStandardMaterial?(c(E,S),function w(E,S){E.roughness.value=S.roughness,E.metalness.value=S.metalness,S.roughnessMap&&(E.roughnessMap.value=S.roughnessMap),S.metalnessMap&&(E.metalnessMap.value=S.metalnessMap),n.get(S).envMap&&(E.envMapIntensity.value=S.envMapIntensity)}(E,S),S.isMeshPhysicalMaterial&&function b(E,S,A){E.ior.value=S.ior,S.sheen>0&&(E.sheenColor.value.copy(S.sheenColor).multiplyScalar(S.sheen),E.sheenRoughness.value=S.sheenRoughness,S.sheenColorMap&&(E.sheenColorMap.value=S.sheenColorMap),S.sheenRoughnessMap&&(E.sheenRoughnessMap.value=S.sheenRoughnessMap)),S.clearcoat>0&&(E.clearcoat.value=S.clearcoat,E.clearcoatRoughness.value=S.clearcoatRoughness,S.clearcoatMap&&(E.clearcoatMap.value=S.clearcoatMap),S.clearcoatRoughnessMap&&(E.clearcoatRoughnessMap.value=S.clearcoatRoughnessMap),S.clearcoatNormalMap&&(E.clearcoatNormalScale.value.copy(S.clearcoatNormalScale),E.clearcoatNormalMap.value=S.clearcoatNormalMap,1===S.side&&E.clearcoatNormalScale.value.negate())),S.transmission>0&&(E.transmission.value=S.transmission,E.transmissionSamplerMap.value=A.texture,E.transmissionSamplerSize.value.set(A.width,A.height),S.transmissionMap&&(E.transmissionMap.value=S.transmissionMap),E.thickness.value=S.thickness,S.thicknessMap&&(E.thicknessMap.value=S.thicknessMap),E.attenuationDistance.value=S.attenuationDistance,E.attenuationColor.value.copy(S.attenuationColor)),E.specularIntensity.value=S.specularIntensity,E.specularColor.value.copy(S.specularColor),S.specularIntensityMap&&(E.specularIntensityMap.value=S.specularIntensityMap),S.specularColorMap&&(E.specularColorMap.value=S.specularColorMap)}(E,S,F)):S.isMeshMatcapMaterial?(c(E,S),function M(E,S){S.matcap&&(E.matcap.value=S.matcap)}(E,S)):S.isMeshDepthMaterial?c(E,S):S.isMeshDistanceMaterial?(c(E,S),function C(E,S){E.referencePosition.value.copy(S.referencePosition),E.nearDistance.value=S.nearDistance,E.farDistance.value=S.farDistance}(E,S)):S.isMeshNormalMaterial?c(E,S):S.isLineBasicMaterial?(function u(E,S){E.diffuse.value.copy(S.color),E.opacity.value=S.opacity}(E,S),S.isLineDashedMaterial&&function f(E,S){E.dashSize.value=S.dashSize,E.totalSize.value=S.dashSize+S.gapSize,E.scale.value=S.scale}(E,S)):S.isPointsMaterial?function m(E,S,A,R){let F;E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.size.value=S.size*A,E.scale.value=.5*R,S.map&&(E.map.value=S.map),S.alphaMap&&(E.alphaMap.value=S.alphaMap),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest),S.map?F=S.map:S.alphaMap&&(F=S.alphaMap),void 0!==F&&(!0===F.matrixAutoUpdate&&F.updateMatrix(),E.uvTransform.value.copy(F.matrix))}(E,S,A,R):S.isSpriteMaterial?function y(E,S){let A;E.diffuse.value.copy(S.color),E.opacity.value=S.opacity,E.rotation.value=S.rotation,S.map&&(E.map.value=S.map),S.alphaMap&&(E.alphaMap.value=S.alphaMap),S.alphaTest>0&&(E.alphaTest.value=S.alphaTest),S.map?A=S.map:S.alphaMap&&(A=S.alphaMap),void 0!==A&&(!0===A.matrixAutoUpdate&&A.updateMatrix(),E.uvTransform.value.copy(A.matrix))}(E,S):S.isShadowMaterial?(E.color.value.copy(S.color),E.opacity.value=S.opacity):S.isShaderMaterial&&(S.uniformsNeedUpdate=!1)}}}function en(h={}){const n=void 0!==h.canvas?h.canvas:function tp(){const h=fc("canvas");return h.style.display="block",h}(),s=void 0!==h.context?h.context:null,a=void 0===h.depth||h.depth,c=void 0===h.stencil||h.stencil,u=void 0!==h.antialias&&h.antialias,f=void 0===h.premultipliedAlpha||h.premultipliedAlpha,m=void 0!==h.preserveDrawingBuffer&&h.preserveDrawingBuffer,y=void 0!==h.powerPreference?h.powerPreference:"default",v=void 0!==h.failIfMajorPerformanceCaveat&&h.failIfMajorPerformanceCaveat;let _;_=void 0!==h.context?s.getContextAttributes().alpha:void 0!==h.alpha&&h.alpha;let w=null,b=null;const M=[],C=[];this.domElement=n,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=po,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;const E=this;let S=!1,A=0,R=0,F=null,I=-1,O=null;const V=new jt,W=new jt;let $=null,ie=n.width,q=n.height,L=1,G=null,_e=null;const Y=new jt(0,0,ie,q),ne=new jt(0,0,ie,q);let J=!1;const oe=new yd;let X=!1,pe=!1,ve=null;const Me=new $e,xe=new he,Qe=new k,Rt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function pt(){return null===F?L:1}let xt,wt,Ce,It,ce,fe,be,qe,Ne,yt,Ke,et,Rn,Xt,H,N,se,we,Fe,Ue,ae,le,Et,de=s;function Zt(U,Q){for(let te=0;te<U.length;te++){const ue=n.getContext(U[te],Q);if(null!==ue)return ue}return null}try{const U={alpha:!0,depth:a,stencil:c,antialias:u,premultipliedAlpha:f,preserveDrawingBuffer:m,powerPreference:y,failIfMajorPerformanceCaveat:v};if("setAttribute"in n&&n.setAttribute("data-engine","three.js r139"),n.addEventListener("webglcontextlost",j,!1),n.addEventListener("webglcontextrestored",Ie,!1),null===de){const Q=["webgl2","webgl","experimental-webgl"];if(!0===E.isWebGL1Renderer&&Q.shift(),de=Zt(Q,U),null===de)throw Zt(Q)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===de.getShaderPrecisionFormat&&(de.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(U){throw console.error("THREE.WebGLRenderer: "+U.message),U}function Pt(){xt=new kE(de),wt=new So(de,xt,h),xt.init(wt),le=new ay(de,xt,wt),Ce=new oy(de,xt,wt),It=new Nf(de),ce=new mx,fe=new ep(de,xt,Ce,ce,wt,le,It),be=new L0(E),qe=new Rg(E),Ne=new hE(de,wt),Et=new I0(de,xt,Ne,wt),yt=new BE(de,Ne,It,Et),Ke=new Pg(de,yt,Ne,It),Fe=new HE(de,wt,fe),N=new Uc(ce),et=new Yf(E,be,qe,xt,wt,Et,N),Rn=new cy(E,ce),Xt=new pa,H=new ry(xt,wt),we=new R0(E,be,Ce,Ke,_,f),se=new Yc(E,Ke,wt),Ue=new P0(de,xt,It,wt),ae=new UE(de,xt,It,wt),It.programs=et.programs,E.capabilities=wt,E.extensions=xt,E.properties=ce,E.renderLists=Xt,E.shadowMap=se,E.state=Ce,E.info=It}Pt();const Ge=new xx(E,de);function j(U){U.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),S=!0}function Ie(){console.log("THREE.WebGLRenderer: Context Restored."),S=!1;const U=It.autoReset,Q=se.enabled,te=se.autoUpdate,ee=se.needsUpdate,ue=se.type;Pt(),It.autoReset=U,se.enabled=Q,se.autoUpdate=te,se.needsUpdate=ee,se.type=ue}function Te(U){const Q=U.target;Q.removeEventListener("dispose",Te),function ke(U){(function je(U){const Q=ce.get(U).programs;void 0!==Q&&(Q.forEach(function(te){et.releaseProgram(te)}),U.isShaderMaterial&&et.releaseShaderCache(U))})(U),ce.remove(U)}(Q)}this.xr=Ge,this.getContext=function(){return de},this.getContextAttributes=function(){return de.getContextAttributes()},this.forceContextLoss=function(){const U=xt.get("WEBGL_lose_context");U&&U.loseContext()},this.forceContextRestore=function(){const U=xt.get("WEBGL_lose_context");U&&U.restoreContext()},this.getPixelRatio=function(){return L},this.setPixelRatio=function(U){void 0!==U&&(L=U,this.setSize(ie,q,!1))},this.getSize=function(U){return U.set(ie,q)},this.setSize=function(U,Q,te){Ge.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(ie=U,q=Q,n.width=Math.floor(U*L),n.height=Math.floor(Q*L),!1!==te&&(n.style.width=U+"px",n.style.height=Q+"px"),this.setViewport(0,0,U,Q))},this.getDrawingBufferSize=function(U){return U.set(ie*L,q*L).floor()},this.setDrawingBufferSize=function(U,Q,te){ie=U,q=Q,L=te,n.width=Math.floor(U*te),n.height=Math.floor(Q*te),this.setViewport(0,0,U,Q)},this.getCurrentViewport=function(U){return U.copy(V)},this.getViewport=function(U){return U.copy(Y)},this.setViewport=function(U,Q,te,ee){U.isVector4?Y.set(U.x,U.y,U.z,U.w):Y.set(U,Q,te,ee),Ce.viewport(V.copy(Y).multiplyScalar(L).floor())},this.getScissor=function(U){return U.copy(ne)},this.setScissor=function(U,Q,te,ee){U.isVector4?ne.set(U.x,U.y,U.z,U.w):ne.set(U,Q,te,ee),Ce.scissor(W.copy(ne).multiplyScalar(L).floor())},this.getScissorTest=function(){return J},this.setScissorTest=function(U){Ce.setScissorTest(J=U)},this.setOpaqueSort=function(U){G=U},this.setTransparentSort=function(U){_e=U},this.getClearColor=function(U){return U.copy(we.getClearColor())},this.setClearColor=function(){we.setClearColor.apply(we,arguments)},this.getClearAlpha=function(){return we.getClearAlpha()},this.setClearAlpha=function(){we.setClearAlpha.apply(we,arguments)},this.clear=function(U=!0,Q=!0,te=!0){let ee=0;U&&(ee|=16384),Q&&(ee|=256),te&&(ee|=1024),de.clear(ee)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){n.removeEventListener("webglcontextlost",j,!1),n.removeEventListener("webglcontextrestored",Ie,!1),Xt.dispose(),H.dispose(),ce.dispose(),be.dispose(),qe.dispose(),Ke.dispose(),Et.dispose(),et.dispose(),Ge.dispose(),Ge.removeEventListener("sessionstart",vt),Ge.removeEventListener("sessionend",gn),ve&&(ve.dispose(),ve=null),kt.stop()},this.renderBufferDirect=function(U,Q,te,ee,ue,tt){null===Q&&(Q=Rt);const bt=ue.isMesh&&ue.matrixWorld.determinant()<0,Lt=function Fw(U,Q,te,ee,ue){!0!==Q.isScene&&(Q=Rt),fe.resetTextureUnits();const tt=Q.fog,Lt=null===F?E.outputEncoding:!0===F.isXRRenderTarget?F.texture.encoding:po,Tt=(ee.isMeshStandardMaterial?qe:be).get(ee.envMap||(ee.isMeshStandardMaterial?Q.environment:null)),tn=!0===ee.vertexColors&&!!te.attributes.color&&4===te.attributes.color.itemSize,Ht=!!ee.normalMap&&!!te.attributes.tangent,qt=!!te.morphAttributes.position,Fn=!!te.morphAttributes.normal,Ho=!!te.morphAttributes.color,$l=ee.toneMapped?E.toneMapping:0,ql=te.morphAttributes.position||te.morphAttributes.normal||te.morphAttributes.color,to=void 0!==ql?ql.length:0,sn=ce.get(ee),Fu=b.state.lights;!0!==X||!0!==pe&&U===O||N.setState(ee,U,U===O&&ee.id===I);let ai=!1;ee.version===sn.__version?(sn.needsLights&&sn.lightsStateVersion!==Fu.state.version||sn.outputEncoding!==Lt||ue.isInstancedMesh&&!1===sn.instancing||!ue.isInstancedMesh&&!0===sn.instancing||ue.isSkinnedMesh&&!1===sn.skinning||!ue.isSkinnedMesh&&!0===sn.skinning||sn.envMap!==Tt||ee.fog&&sn.fog!==tt||void 0!==sn.numClippingPlanes&&(sn.numClippingPlanes!==N.numPlanes||sn.numIntersection!==N.numIntersection)||sn.vertexAlphas!==tn||sn.vertexTangents!==Ht||sn.morphTargets!==qt||sn.morphNormals!==Fn||sn.morphColors!==Ho||sn.toneMapping!==$l||!0===wt.isWebGL2&&sn.morphTargetsCount!==to)&&(ai=!0):(ai=!0,sn.__version=ee.version);let jr=sn.currentProgram;!0===ai&&(jr=Ta(ee,Q,ue));let $r=!1,Nu=!1,jp=!1;const wi=jr.getUniforms(),no=sn.uniforms;if(Ce.useProgram(jr.program)&&($r=!0,Nu=!0,jp=!0),ee.id!==I&&(I=ee.id,Nu=!0),$r||O!==U){if(wi.setValue(de,"projectionMatrix",U.projectionMatrix),wt.logarithmicDepthBuffer&&wi.setValue(de,"logDepthBufFC",2/(Math.log(U.far+1)/Math.LN2)),O!==U&&(O=U,Nu=!0,jp=!0),ee.isShaderMaterial||ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshStandardMaterial||ee.envMap){const qr=wi.map.cameraPosition;void 0!==qr&&qr.setValue(de,Qe.setFromMatrixPosition(U.matrixWorld))}(ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshLambertMaterial||ee.isMeshBasicMaterial||ee.isMeshStandardMaterial||ee.isShaderMaterial)&&wi.setValue(de,"isOrthographic",!0===U.isOrthographicCamera),(ee.isMeshPhongMaterial||ee.isMeshToonMaterial||ee.isMeshLambertMaterial||ee.isMeshBasicMaterial||ee.isMeshStandardMaterial||ee.isShaderMaterial||ee.isShadowMaterial||ue.isSkinnedMesh)&&wi.setValue(de,"viewMatrix",U.matrixWorldInverse)}if(ue.isSkinnedMesh){wi.setOptional(de,ue,"bindMatrix"),wi.setOptional(de,ue,"bindMatrixInverse");const qr=ue.skeleton;qr&&(wt.floatVertexTextures?(null===qr.boneTexture&&qr.computeBoneTexture(),wi.setValue(de,"boneTexture",qr.boneTexture,fe),wi.setValue(de,"boneTextureSize",qr.boneTextureSize)):wi.setOptional(de,qr,"boneMatrices"))}const $p=te.morphAttributes;return(void 0!==$p.position||void 0!==$p.normal||void 0!==$p.color&&!0===wt.isWebGL2)&&Fe.update(ue,te,ee,jr),(Nu||sn.receiveShadow!==ue.receiveShadow)&&(sn.receiveShadow=ue.receiveShadow,wi.setValue(de,"receiveShadow",ue.receiveShadow)),Nu&&(wi.setValue(de,"toneMappingExposure",E.toneMappingExposure),sn.needsLights&&function Nw(U,Q){U.ambientLightColor.needsUpdate=Q,U.lightProbe.needsUpdate=Q,U.directionalLights.needsUpdate=Q,U.directionalLightShadows.needsUpdate=Q,U.pointLights.needsUpdate=Q,U.pointLightShadows.needsUpdate=Q,U.spotLights.needsUpdate=Q,U.spotLightShadows.needsUpdate=Q,U.rectAreaLights.needsUpdate=Q,U.hemisphereLights.needsUpdate=Q}(no,jp),tt&&ee.fog&&Rn.refreshFogUniforms(no,tt),Rn.refreshMaterialUniforms(no,ee,L,q,ve),or.upload(de,sn.uniformsList,no,fe)),ee.isShaderMaterial&&!0===ee.uniformsNeedUpdate&&(or.upload(de,sn.uniformsList,no,fe),ee.uniformsNeedUpdate=!1),ee.isSpriteMaterial&&wi.setValue(de,"center",ue.center),wi.setValue(de,"modelViewMatrix",ue.modelViewMatrix),wi.setValue(de,"normalMatrix",ue.normalMatrix),wi.setValue(de,"modelMatrix",ue.matrixWorld),jr}(U,Q,te,ee,ue);Ce.setMaterial(ee,bt);let Tt=te.index;const tn=te.attributes.position;if(null===Tt){if(void 0===tn||0===tn.count)return}else if(0===Tt.count)return;let Ht=1;!0===ee.wireframe&&(Tt=yt.getWireframeAttribute(te),Ht=2),Et.setup(ue,ee,Lt,te,Tt);let qt,Fn=Ue;null!==Tt&&(qt=Ne.get(Tt),Fn=ae,Fn.setIndex(qt));const Ho=null!==Tt?Tt.count:tn.count,$l=te.drawRange.start*Ht,ql=te.drawRange.count*Ht,to=null!==tt?tt.start*Ht:0,sn=null!==tt?tt.count*Ht:1/0,Fu=Math.max($l,to),ai=Math.min(Ho,$l+ql,to+sn)-1,jr=Math.max(0,ai-Fu+1);if(0!==jr){if(ue.isMesh)!0===ee.wireframe?(Ce.setLineWidth(ee.wireframeLinewidth*pt()),Fn.setMode(1)):Fn.setMode(4);else if(ue.isLine){let $r=ee.linewidth;void 0===$r&&($r=1),Ce.setLineWidth($r*pt()),Fn.setMode(ue.isLineSegments?1:ue.isLineLoop?2:3)}else ue.isPoints?Fn.setMode(0):ue.isSprite&&Fn.setMode(4);if(ue.isInstancedMesh)Fn.renderInstances(Fu,jr,ue.count);else if(te.isInstancedBufferGeometry){const $r=Math.min(te.instanceCount,te._maxInstanceCount);Fn.renderInstances(Fu,jr,$r)}else Fn.render(Fu,jr)}},this.compile=function(U,Q){b=H.get(U),b.init(),C.push(b),U.traverseVisible(function(te){te.isLight&&te.layers.test(Q.layers)&&(b.pushLight(te),te.castShadow&&b.pushShadow(te))}),b.setupLights(E.physicallyCorrectLights),U.traverse(function(te){const ee=te.material;if(ee)if(Array.isArray(ee))for(let ue=0;ue<ee.length;ue++)Ta(ee[ue],U,te);else Ta(ee,U,te)}),C.pop(),b=null};let ct=null;function vt(){kt.stop()}function gn(){kt.start()}const kt=new Z_;function Gr(U,Q,te,ee){if(!1===U.visible)return;if(U.layers.test(Q.layers))if(U.isGroup)te=U.renderOrder;else if(U.isLOD)!0===U.autoUpdate&&U.update(Q);else if(U.isLight)b.pushLight(U),U.castShadow&&b.pushShadow(U);else if(U.isSprite){if(!U.frustumCulled||oe.intersectsSprite(U)){ee&&Qe.setFromMatrixPosition(U.matrixWorld).applyMatrix4(Me);const bt=Ke.update(U),Lt=U.material;Lt.visible&&w.push(U,bt,Lt,te,Qe.z,null)}}else if((U.isMesh||U.isLine||U.isPoints)&&(U.isSkinnedMesh&&U.skeleton.frame!==It.render.frame&&(U.skeleton.update(),U.skeleton.frame=It.render.frame),!U.frustumCulled||oe.intersectsObject(U))){ee&&Qe.setFromMatrixPosition(U.matrixWorld).applyMatrix4(Me);const bt=Ke.update(U),Lt=U.material;if(Array.isArray(Lt)){const Tt=bt.groups;for(let tn=0,Ht=Tt.length;tn<Ht;tn++){const qt=Tt[tn],Fn=Lt[qt.materialIndex];Fn&&Fn.visible&&w.push(U,bt,Fn,te,Qe.z,qt)}}else Lt.visible&&w.push(U,bt,Lt,te,Qe.z,null)}const tt=U.children;for(let bt=0,Lt=tt.length;bt<Lt;bt++)Gr(tt[bt],Q,te,ee)}function Wr(U,Q,te,ee){const ue=U.opaque,tt=U.transmissive,bt=U.transparent;b.setupLightsView(te),tt.length>0&&function Pw(U,Q,te){const ee=wt.isWebGL2;null===ve&&(ve=new ti(1,1,{generateMipmaps:!0,type:null!==le.convert(Ga)?Ga:Jo,minFilter:1008,samples:ee&&!0===u?4:0})),E.getDrawingBufferSize(xe),ee?ve.setSize(xe.x,xe.y):ve.setSize(ei(xe.x),ei(xe.y));const ue=E.getRenderTarget();E.setRenderTarget(ve),E.clear();const tt=E.toneMapping;E.toneMapping=0,Eh(U,Q,te),E.toneMapping=tt,fe.updateMultisampleRenderTarget(ve),fe.updateRenderTargetMipmap(ve),E.setRenderTarget(ue)}(ue,Q,te),ee&&Ce.viewport(V.copy(ee)),ue.length>0&&Eh(ue,Q,te),tt.length>0&&Eh(tt,Q,te),bt.length>0&&Eh(bt,Q,te),Ce.buffers.depth.setTest(!0),Ce.buffers.depth.setMask(!0),Ce.buffers.color.setMask(!0),Ce.setPolygonOffset(!1)}function Eh(U,Q,te){const ee=!0===Q.isScene?Q.overrideMaterial:null;for(let ue=0,tt=U.length;ue<tt;ue++){const bt=U[ue],Lt=bt.object,Tt=bt.geometry,tn=null===ee?bt.material:ee,Ht=bt.group;Lt.layers.test(te.layers)&&Lw(Lt,Q,te,Tt,tn,Ht)}}function Lw(U,Q,te,ee,ue,tt){U.onBeforeRender(E,Q,te,ee,ue,tt),U.modelViewMatrix.multiplyMatrices(te.matrixWorldInverse,U.matrixWorld),U.normalMatrix.getNormalMatrix(U.modelViewMatrix),ue.onBeforeRender(E,Q,te,ee,U,tt),!0===ue.transparent&&ue.side===co?(ue.side=1,ue.needsUpdate=!0,E.renderBufferDirect(te,Q,ee,ue,U,tt),ue.side=0,ue.needsUpdate=!0,E.renderBufferDirect(te,Q,ee,ue,U,tt),ue.side=co):E.renderBufferDirect(te,Q,ee,ue,U,tt),U.onAfterRender(E,Q,te,ee,ue,tt)}function Ta(U,Q,te){!0!==Q.isScene&&(Q=Rt);const ee=ce.get(U),ue=b.state.lights,bt=ue.state.version,Lt=et.getParameters(U,ue.state,b.state.shadowsArray,Q,te),Tt=et.getProgramCacheKey(Lt);let tn=ee.programs;ee.environment=U.isMeshStandardMaterial?Q.environment:null,ee.fog=Q.fog,ee.envMap=(U.isMeshStandardMaterial?qe:be).get(U.envMap||ee.environment),void 0===tn&&(U.addEventListener("dispose",Te),tn=new Map,ee.programs=tn);let Ht=tn.get(Tt);if(void 0!==Ht){if(ee.currentProgram===Ht&&ee.lightsStateVersion===bt)return ov(U,Lt),Ht}else Lt.uniforms=et.getUniforms(U),U.onBuild(te,Lt,E),U.onBeforeCompile(Lt,E),Ht=et.acquireProgram(Lt,Tt),tn.set(Tt,Ht),ee.uniforms=Lt.uniforms;const qt=ee.uniforms;(!U.isShaderMaterial&&!U.isRawShaderMaterial||!0===U.clipping)&&(qt.clippingPlanes=N.uniform),ov(U,Lt),ee.needsLights=function Sh(U){return U.isMeshLambertMaterial||U.isMeshToonMaterial||U.isMeshPhongMaterial||U.isMeshStandardMaterial||U.isShadowMaterial||U.isShaderMaterial&&!0===U.lights}(U),ee.lightsStateVersion=bt,ee.needsLights&&(qt.ambientLightColor.value=ue.state.ambient,qt.lightProbe.value=ue.state.probe,qt.directionalLights.value=ue.state.directional,qt.directionalLightShadows.value=ue.state.directionalShadow,qt.spotLights.value=ue.state.spot,qt.spotLightShadows.value=ue.state.spotShadow,qt.rectAreaLights.value=ue.state.rectArea,qt.ltc_1.value=ue.state.rectAreaLTC1,qt.ltc_2.value=ue.state.rectAreaLTC2,qt.pointLights.value=ue.state.point,qt.pointLightShadows.value=ue.state.pointShadow,qt.hemisphereLights.value=ue.state.hemi,qt.directionalShadowMap.value=ue.state.directionalShadowMap,qt.directionalShadowMatrix.value=ue.state.directionalShadowMatrix,qt.spotShadowMap.value=ue.state.spotShadowMap,qt.spotShadowMatrix.value=ue.state.spotShadowMatrix,qt.pointShadowMap.value=ue.state.pointShadowMap,qt.pointShadowMatrix.value=ue.state.pointShadowMatrix);const Fn=Ht.getUniforms(),Ho=or.seqWithValue(Fn.seq,qt);return ee.currentProgram=Ht,ee.uniformsList=Ho,Ht}function ov(U,Q){const te=ce.get(U);te.outputEncoding=Q.outputEncoding,te.instancing=Q.instancing,te.skinning=Q.skinning,te.morphTargets=Q.morphTargets,te.morphNormals=Q.morphNormals,te.morphColors=Q.morphColors,te.morphTargetsCount=Q.morphTargetsCount,te.numClippingPlanes=Q.numClippingPlanes,te.numIntersection=Q.numClipIntersection,te.vertexAlphas=Q.vertexAlphas,te.vertexTangents=Q.vertexTangents,te.toneMapping=Q.toneMapping}kt.setAnimationLoop(function De(U){ct&&ct(U)}),"undefined"!=typeof self&&kt.setContext(self),this.setAnimationLoop=function(U){ct=U,Ge.setAnimationLoop(U),null===U?kt.stop():kt.start()},Ge.addEventListener("sessionstart",vt),Ge.addEventListener("sessionend",gn),this.render=function(U,Q){if(void 0===Q||!0===Q.isCamera){if(!0!==S){if(!0===U.autoUpdate&&U.updateMatrixWorld(),null===Q.parent&&Q.updateMatrixWorld(),!0===Ge.enabled&&!0===Ge.isPresenting&&(!0===Ge.cameraAutoUpdate&&Ge.updateCamera(Q),Q=Ge.getCamera()),!0===U.isScene&&U.onBeforeRender(E,U,Q,F),b=H.get(U,C.length),b.init(),C.push(b),Me.multiplyMatrices(Q.projectionMatrix,Q.matrixWorldInverse),oe.setFromProjectionMatrix(Me),pe=this.localClippingEnabled,X=N.init(this.clippingPlanes,pe,Q),w=Xt.get(U,M.length),w.init(),M.push(w),Gr(U,Q,0,E.sortObjects),w.finish(),!0===E.sortObjects&&w.sort(G,_e),!0===X&&N.beginShadows(),se.render(b.state.shadowsArray,U,Q),!0===X&&N.endShadows(),!0===this.info.autoReset&&this.info.reset(),we.render(w,U),b.setupLights(E.physicallyCorrectLights),Q.isArrayCamera){const ee=Q.cameras;for(let ue=0,tt=ee.length;ue<tt;ue++){const bt=ee[ue];Wr(w,U,bt,bt.viewport)}}else Wr(w,U,Q);null!==F&&(fe.updateMultisampleRenderTarget(F),fe.updateRenderTargetMipmap(F)),!0===U.isScene&&U.onAfterRender(E,U,Q),Et.resetDefaultState(),I=-1,O=null,C.pop(),b=C.length>0?C[C.length-1]:null,M.pop(),w=M.length>0?M[M.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return A},this.getActiveMipmapLevel=function(){return R},this.getRenderTarget=function(){return F},this.setRenderTargetTextures=function(U,Q,te){ce.get(U.texture).__webglTexture=Q,ce.get(U.depthTexture).__webglTexture=te;const ee=ce.get(U);ee.__hasExternalTextures=!0,ee.__hasExternalTextures&&(ee.__autoAllocateDepthBuffer=void 0===te,ee.__autoAllocateDepthBuffer||!0===xt.has("WEBGL_multisampled_render_to_texture")&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ee.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(U,Q){const te=ce.get(U);te.__webglFramebuffer=Q,te.__useDefaultFramebuffer=void 0===Q},this.setRenderTarget=function(U,Q=0,te=0){F=U,A=Q,R=te;let ee=!0;if(U){const Tt=ce.get(U);void 0!==Tt.__useDefaultFramebuffer?(Ce.bindFramebuffer(36160,null),ee=!1):void 0===Tt.__webglFramebuffer?fe.setupRenderTarget(U):Tt.__hasExternalTextures&&fe.rebindTextures(U,ce.get(U.texture).__webglTexture,ce.get(U.depthTexture).__webglTexture)}let ue=null,tt=!1,bt=!1;if(U){const Tt=U.texture;(Tt.isData3DTexture||Tt.isDataArrayTexture)&&(bt=!0);const tn=ce.get(U).__webglFramebuffer;U.isWebGLCubeRenderTarget?(ue=tn[Q],tt=!0):ue=wt.isWebGL2&&U.samples>0&&!1===fe.useMultisampledRTT(U)?ce.get(U).__webglMultisampledFramebuffer:tn,V.copy(U.viewport),W.copy(U.scissor),$=U.scissorTest}else V.copy(Y).multiplyScalar(L).floor(),W.copy(ne).multiplyScalar(L).floor(),$=J;if(Ce.bindFramebuffer(36160,ue)&&wt.drawBuffers&&ee&&Ce.drawBuffers(U,ue),Ce.viewport(V),Ce.scissor(W),Ce.setScissorTest($),tt){const Tt=ce.get(U.texture);de.framebufferTexture2D(36160,36064,34069+Q,Tt.__webglTexture,te)}else if(bt){const Tt=ce.get(U.texture);de.framebufferTextureLayer(36160,36064,Tt.__webglTexture,te||0,Q||0)}I=-1},this.readRenderTargetPixels=function(U,Q,te,ee,ue,tt,bt){if(!U||!U.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let Lt=ce.get(U).__webglFramebuffer;if(U.isWebGLCubeRenderTarget&&void 0!==bt&&(Lt=Lt[bt]),Lt){Ce.bindFramebuffer(36160,Lt);try{const Tt=U.texture,tn=Tt.format,Ht=Tt.type;if(tn!==Xn&&le.convert(tn)!==de.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");const qt=Ht===Ga&&(xt.has("EXT_color_buffer_half_float")||wt.isWebGL2&&xt.has("EXT_color_buffer_float"));if(!(Ht===Jo||le.convert(Ht)===de.getParameter(35738)||Ht===fo&&(wt.isWebGL2||xt.has("OES_texture_float")||xt.has("WEBGL_color_buffer_float"))||qt))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");Q>=0&&Q<=U.width-ee&&te>=0&&te<=U.height-ue&&de.readPixels(Q,te,ee,ue,le.convert(tn),le.convert(Ht),tt)}finally{const Tt=null!==F?ce.get(F).__webglFramebuffer:null;Ce.bindFramebuffer(36160,Tt)}}},this.copyFramebufferToTexture=function(U,Q,te=0){if(!0!==Q.isFramebufferTexture)return void console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");const ee=Math.pow(2,-te),ue=Math.floor(Q.image.width*ee),tt=Math.floor(Q.image.height*ee);fe.setTexture2D(Q,0),de.copyTexSubImage2D(3553,te,0,0,U.x,U.y,ue,tt),Ce.unbindTexture()},this.copyTextureToTexture=function(U,Q,te,ee=0){const ue=Q.image.width,tt=Q.image.height,bt=le.convert(te.format),Lt=le.convert(te.type);fe.setTexture2D(te,0),de.pixelStorei(37440,te.flipY),de.pixelStorei(37441,te.premultiplyAlpha),de.pixelStorei(3317,te.unpackAlignment),Q.isDataTexture?de.texSubImage2D(3553,ee,U.x,U.y,ue,tt,bt,Lt,Q.image.data):Q.isCompressedTexture?de.compressedTexSubImage2D(3553,ee,U.x,U.y,Q.mipmaps[0].width,Q.mipmaps[0].height,bt,Q.mipmaps[0].data):de.texSubImage2D(3553,ee,U.x,U.y,bt,Lt,Q.image),0===ee&&te.generateMipmaps&&de.generateMipmap(3553),Ce.unbindTexture()},this.copyTextureToTexture3D=function(U,Q,te,ee,ue=0){if(E.isWebGL1Renderer)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");const tt=U.max.x-U.min.x+1,bt=U.max.y-U.min.y+1,Lt=U.max.z-U.min.z+1,Tt=le.convert(ee.format),tn=le.convert(ee.type);let Ht;if(ee.isData3DTexture)fe.setTexture3D(ee,0),Ht=32879;else{if(!ee.isDataArrayTexture)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");fe.setTexture2DArray(ee,0),Ht=35866}de.pixelStorei(37440,ee.flipY),de.pixelStorei(37441,ee.premultiplyAlpha),de.pixelStorei(3317,ee.unpackAlignment);const qt=de.getParameter(3314),Fn=de.getParameter(32878),Ho=de.getParameter(3316),$l=de.getParameter(3315),ql=de.getParameter(32877),to=te.isCompressedTexture?te.mipmaps[0]:te.image;de.pixelStorei(3314,to.width),de.pixelStorei(32878,to.height),de.pixelStorei(3316,U.min.x),de.pixelStorei(3315,U.min.y),de.pixelStorei(32877,U.min.z),te.isDataTexture||te.isData3DTexture?de.texSubImage3D(Ht,ue,Q.x,Q.y,Q.z,tt,bt,Lt,Tt,tn,to.data):te.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),de.compressedTexSubImage3D(Ht,ue,Q.x,Q.y,Q.z,tt,bt,Lt,Tt,to.data)):de.texSubImage3D(Ht,ue,Q.x,Q.y,Q.z,tt,bt,Lt,Tt,tn,to),de.pixelStorei(3314,qt),de.pixelStorei(32878,Fn),de.pixelStorei(3316,Ho),de.pixelStorei(3315,$l),de.pixelStorei(32877,ql),0===ue&&ee.generateMipmaps&&de.generateMipmap(Ht),Ce.unbindTexture()},this.initTexture=function(U){fe.setTexture2D(U,0),Ce.unbindTexture()},this.resetState=function(){A=0,R=0,F=null,Ce.reset(),Et.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}en.prototype.isWebGLRenderer=!0,class $E extends en{}.prototype.isWebGL1Renderer=!0;class Qc{constructor(n,s=25e-5){this.name="",this.color=new Re(n),this.density=s}clone(){return new Qc(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}Qc.prototype.isFogExp2=!0;class Od{constructor(n,s=1,a=1e3){this.name="",this.color=new Re(n),this.near=s,this.far=a}clone(){return new Od(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}Od.prototype.isFog=!0;class Kc extends Jt{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(n,s){return super.copy(n,s),null!==n.background&&(this.background=n.background.clone()),null!==n.environment&&(this.environment=n.environment.clone()),null!==n.fog&&(this.fog=n.fog.clone()),null!==n.overrideMaterial&&(this.overrideMaterial=n.overrideMaterial.clone()),this.autoUpdate=n.autoUpdate,this.matrixAutoUpdate=n.matrixAutoUpdate,this}toJSON(n){const s=super.toJSON(n);return null!==this.fog&&(s.object.fog=this.fog.toJSON()),s}}Kc.prototype.isScene=!0;class xl{constructor(n,s){this.array=n,this.stride=s,this.count=void 0!==n?n.length/s:0,this.usage=cc,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=St()}onUploadCallback(){}set needsUpdate(n){!0===n&&this.version++}setUsage(n){return this.usage=n,this}copy(n){return this.array=new n.array.constructor(n.array),this.count=n.count,this.stride=n.stride,this.usage=n.usage,this}copyAt(n,s,a){n*=this.stride,a*=s.stride;for(let c=0,u=this.stride;c<u;c++)this.array[n+c]=s.array[a+c];return this}set(n,s=0){return this.array.set(n,s),this}clone(n){void 0===n.arrayBuffers&&(n.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=St()),void 0===n.arrayBuffers[this.array.buffer._uuid]&&(n.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const s=new this.array.constructor(n.arrayBuffers[this.array.buffer._uuid]),a=new this.constructor(s,this.stride);return a.setUsage(this.usage),a}onUpload(n){return this.onUploadCallback=n,this}toJSON(n){return void 0===n.arrayBuffers&&(n.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=St()),void 0===n.arrayBuffers[this.array.buffer._uuid]&&(n.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}xl.prototype.isInterleavedBuffer=!0;const Bi=new k;class xi{constructor(n,s,a,c=!1){this.name="",this.data=n,this.itemSize=s,this.offset=a,this.normalized=!0===c}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(n){this.data.needsUpdate=n}applyMatrix4(n){for(let s=0,a=this.data.count;s<a;s++)Bi.fromBufferAttribute(this,s),Bi.applyMatrix4(n),this.setXYZ(s,Bi.x,Bi.y,Bi.z);return this}applyNormalMatrix(n){for(let s=0,a=this.count;s<a;s++)Bi.fromBufferAttribute(this,s),Bi.applyNormalMatrix(n),this.setXYZ(s,Bi.x,Bi.y,Bi.z);return this}transformDirection(n){for(let s=0,a=this.count;s<a;s++)Bi.fromBufferAttribute(this,s),Bi.transformDirection(n),this.setXYZ(s,Bi.x,Bi.y,Bi.z);return this}setX(n,s){return this.data.array[n*this.data.stride+this.offset]=s,this}setY(n,s){return this.data.array[n*this.data.stride+this.offset+1]=s,this}setZ(n,s){return this.data.array[n*this.data.stride+this.offset+2]=s,this}setW(n,s){return this.data.array[n*this.data.stride+this.offset+3]=s,this}getX(n){return this.data.array[n*this.data.stride+this.offset]}getY(n){return this.data.array[n*this.data.stride+this.offset+1]}getZ(n){return this.data.array[n*this.data.stride+this.offset+2]}getW(n){return this.data.array[n*this.data.stride+this.offset+3]}setXY(n,s,a){return this.data.array[(n=n*this.data.stride+this.offset)+0]=s,this.data.array[n+1]=a,this}setXYZ(n,s,a,c){return this.data.array[(n=n*this.data.stride+this.offset)+0]=s,this.data.array[n+1]=a,this.data.array[n+2]=c,this}setXYZW(n,s,a,c,u){return this.data.array[(n=n*this.data.stride+this.offset)+0]=s,this.data.array[n+1]=a,this.data.array[n+2]=c,this.data.array[n+3]=u,this}clone(n){if(void 0===n){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const s=[];for(let a=0;a<this.count;a++){const c=a*this.data.stride+this.offset;for(let u=0;u<this.itemSize;u++)s.push(this.data.array[c+u])}return new mn(new this.array.constructor(s),this.itemSize,this.normalized)}return void 0===n.interleavedBuffers&&(n.interleavedBuffers={}),void 0===n.interleavedBuffers[this.data.uuid]&&(n.interleavedBuffers[this.data.uuid]=this.data.clone(n)),new xi(n.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(n){if(void 0===n){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const s=[];for(let a=0;a<this.count;a++){const c=a*this.data.stride+this.offset;for(let u=0;u<this.itemSize;u++)s.push(this.data.array[c+u])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:s,normalized:this.normalized}}return void 0===n.interleavedBuffers&&(n.interleavedBuffers={}),void 0===n.interleavedBuffers[this.data.uuid]&&(n.interleavedBuffers[this.data.uuid]=this.data.toJSON(n)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}xi.prototype.isInterleavedBufferAttribute=!0;class np extends Zn{constructor(n){super(),this.type="SpriteMaterial",this.color=new Re(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.alphaMap=n.alphaMap,this.rotation=n.rotation,this.sizeAttenuation=n.sizeAttenuation,this}}let ma;np.prototype.isSpriteMaterial=!0;const Jc=new k,wl=new k,bl=new k,Ml=new he,El=new he,uy=new $e,kd=new k,eu=new k,st=new k,Bd=new he,Ud=new he,ip=new he;function $i(h,n,s,a,c,u){Ml.subVectors(h,s).addScalar(.5).multiply(a),void 0!==c?(El.x=u*Ml.x-c*Ml.y,El.y=c*Ml.x+u*Ml.y):El.copy(Ml),h.copy(n),h.x+=El.x,h.y+=El.y,h.applyMatrix4(uy)}(class tu extends Jt{constructor(n){if(super(),this.type="Sprite",void 0===ma){ma=new Ye;const s=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),a=new xl(s,5);ma.setIndex([0,1,2,0,2,3]),ma.setAttribute("position",new xi(a,3,0,!1)),ma.setAttribute("uv",new xi(a,2,3,!1))}this.geometry=ma,this.material=void 0!==n?n:new np,this.center=new he(.5,.5)}raycast(n,s){null===n.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),wl.setFromMatrixScale(this.matrixWorld),uy.copy(n.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(n.camera.matrixWorldInverse,this.matrixWorld),bl.setFromMatrixPosition(this.modelViewMatrix),n.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&wl.multiplyScalar(-bl.z);const a=this.material.rotation;let c,u;0!==a&&(u=Math.cos(a),c=Math.sin(a));const f=this.center;$i(kd.set(-.5,-.5,0),bl,f,wl,c,u),$i(eu.set(.5,-.5,0),bl,f,wl,c,u),$i(st.set(.5,.5,0),bl,f,wl,c,u),Bd.set(0,0),Ud.set(1,0),ip.set(1,1);let m=n.ray.intersectTriangle(kd,eu,st,!1,Jc);if(null===m&&($i(eu.set(-.5,.5,0),bl,f,wl,c,u),Ud.set(0,1),m=n.ray.intersectTriangle(kd,st,eu,!1,Jc),null===m))return;const y=n.ray.origin.distanceTo(Jc);y<n.near||y>n.far||s.push({distance:y,point:Jc.clone(),uv:ni.getUV(Jc,kd,eu,st,Bd,Ud,ip,new he),face:null,object:this})}copy(n){return super.copy(n),void 0!==n.center&&this.center.copy(n.center),this.material=n.material,this}}).prototype.isSprite=!0;const vs=new k,Hd=new jt,sp=new jt,op=new k,wx=new $e;class Vd extends ii{constructor(n,s){super(n,s),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new $e,this.bindMatrixInverse=new $e}copy(n){return super.copy(n),this.bindMode=n.bindMode,this.bindMatrix.copy(n.bindMatrix),this.bindMatrixInverse.copy(n.bindMatrixInverse),this.skeleton=n.skeleton,this}bind(n,s){this.skeleton=n,void 0===s&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),s=this.matrixWorld),this.bindMatrix.copy(s),this.bindMatrixInverse.copy(s).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const n=new jt,s=this.geometry.attributes.skinWeight;for(let a=0,c=s.count;a<c;a++){n.fromBufferAttribute(s,a);const u=1/n.manhattanLength();u!==1/0?n.multiplyScalar(u):n.set(1,0,0,0),s.setXYZW(a,n.x,n.y,n.z,n.w)}}updateMatrixWorld(n){super.updateMatrixWorld(n),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(n,s){const a=this.skeleton,c=this.geometry;Hd.fromBufferAttribute(c.attributes.skinIndex,n),sp.fromBufferAttribute(c.attributes.skinWeight,n),vs.copy(s).applyMatrix4(this.bindMatrix),s.set(0,0,0);for(let u=0;u<4;u++){const f=sp.getComponent(u);if(0!==f){const m=Hd.getComponent(u);wx.multiplyMatrices(a.bones[m].matrixWorld,a.boneInverses[m]),s.addScaledVector(op.copy(vs).applyMatrix4(wx),f)}}return s.applyMatrix4(this.bindMatrixInverse)}}Vd.prototype.isSkinnedMesh=!0;(class hy extends Jt{constructor(){super(),this.type="Bone"}}).prototype.isBone=!0;(class js extends cn{constructor(n=null,s=1,a=1,c,u,f,m,y,v=Qt,_=Qt,w,b){super(null,f,m,y,v,_,c,u,w,b),this.image={data:n,width:s,height:a},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}).prototype.isDataTexture=!0;class To extends mn{constructor(n,s,a,c=1){"number"==typeof a&&(c=a,a=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(n,s,a),this.meshPerAttribute=c}copy(n){return super.copy(n),this.meshPerAttribute=n.meshPerAttribute,this}toJSON(){const n=super.toJSON();return n.meshPerAttribute=this.meshPerAttribute,n.isInstancedBufferAttribute=!0,n}}To.prototype.isInstancedBufferAttribute=!0;const bx=new $e,fy=new $e,zd=[],su=new ii;(class py extends ii{constructor(n,s,a){super(n,s),this.instanceMatrix=new To(new Float32Array(16*a),16),this.instanceColor=null,this.count=a,this.frustumCulled=!1}copy(n){return super.copy(n),this.instanceMatrix.copy(n.instanceMatrix),null!==n.instanceColor&&(this.instanceColor=n.instanceColor.clone()),this.count=n.count,this}getColorAt(n,s){s.fromArray(this.instanceColor.array,3*n)}getMatrixAt(n,s){s.fromArray(this.instanceMatrix.array,16*n)}raycast(n,s){const a=this.matrixWorld,c=this.count;if(su.geometry=this.geometry,su.material=this.material,void 0!==su.material)for(let u=0;u<c;u++){this.getMatrixAt(u,bx),fy.multiplyMatrices(a,bx),su.matrixWorld=fy,su.raycast(n,zd);for(let f=0,m=zd.length;f<m;f++){const y=zd[f];y.instanceId=u,y.object=this,s.push(y)}zd.length=0}}setColorAt(n,s){null===this.instanceColor&&(this.instanceColor=new To(new Float32Array(3*this.instanceMatrix.count),3)),s.toArray(this.instanceColor.array,3*n)}setMatrixAt(n,s){s.toArray(this.instanceMatrix.array,16*n)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}).prototype.isInstancedMesh=!0;class si extends Zn{constructor(n){super(),this.type="LineBasicMaterial",this.color=new Re(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.linewidth=n.linewidth,this.linecap=n.linecap,this.linejoin=n.linejoin,this}}si.prototype.isLineBasicMaterial=!0;const Mx=new k,my=new k,Ex=new $e,Gd=new vo,ou=new yo;class Co extends Jt{constructor(n=new Ye,s=new si){super(),this.type="Line",this.geometry=n,this.material=s,this.updateMorphTargets()}copy(n){return super.copy(n),this.material=n.material,this.geometry=n.geometry,this}computeLineDistances(){const n=this.geometry;if(n.isBufferGeometry)if(null===n.index){const s=n.attributes.position,a=[0];for(let c=1,u=s.count;c<u;c++)Mx.fromBufferAttribute(s,c-1),my.fromBufferAttribute(s,c),a[c]=a[c-1],a[c]+=Mx.distanceTo(my);n.setAttribute("lineDistance",new Ve(a,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else n.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(n,s){const a=this.geometry,c=this.matrixWorld,u=n.params.Line.threshold,f=a.drawRange;if(null===a.boundingSphere&&a.computeBoundingSphere(),ou.copy(a.boundingSphere),ou.applyMatrix4(c),ou.radius+=u,!1===n.ray.intersectsSphere(ou))return;Ex.copy(c).invert(),Gd.copy(n.ray).applyMatrix4(Ex);const m=u/((this.scale.x+this.scale.y+this.scale.z)/3),y=m*m,v=new k,_=new k,w=new k,b=new k,M=this.isLineSegments?2:1;if(a.isBufferGeometry){const C=a.index,S=a.attributes.position;if(null!==C)for(let F=Math.max(0,f.start),I=Math.min(C.count,f.start+f.count)-1;F<I;F+=M){const O=C.getX(F),V=C.getX(F+1);if(v.fromBufferAttribute(S,O),_.fromBufferAttribute(S,V),Gd.distanceSqToSegment(v,_,b,w)>y)continue;b.applyMatrix4(this.matrixWorld);const $=n.ray.origin.distanceTo(b);$<n.near||$>n.far||s.push({distance:$,point:w.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}else for(let F=Math.max(0,f.start),I=Math.min(S.count,f.start+f.count)-1;F<I;F+=M){if(v.fromBufferAttribute(S,F),_.fromBufferAttribute(S,F+1),Gd.distanceSqToSegment(v,_,b,w)>y)continue;b.applyMatrix4(this.matrixWorld);const V=n.ray.origin.distanceTo(b);V<n.near||V>n.far||s.push({distance:V,point:w.clone().applyMatrix4(this.matrixWorld),index:F,face:null,faceIndex:null,object:this})}}else a.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const n=this.geometry;if(n.isBufferGeometry){const s=n.morphAttributes,a=Object.keys(s);if(a.length>0){const c=s[a[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,f=c.length;u<f;u++){const m=c[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=u}}}}else{const s=n.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Co.prototype.isLine=!0;const Wd=new k,Sx=new k;class au extends Co{constructor(n,s){super(n,s),this.type="LineSegments"}computeLineDistances(){const n=this.geometry;if(n.isBufferGeometry)if(null===n.index){const s=n.attributes.position,a=[];for(let c=0,u=s.count;c<u;c+=2)Wd.fromBufferAttribute(s,c),Sx.fromBufferAttribute(s,c+1),a[c]=0===c?0:a[c-1],a[c+1]=a[c]+Wd.distanceTo(Sx);n.setAttribute("lineDistance",new Ve(a,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else n.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}au.prototype.isLineSegments=!0;(class Tx extends Co{constructor(n,s){super(n,s),this.type="LineLoop"}}).prototype.isLineLoop=!0;class gy extends Zn{constructor(n){super(),this.type="PointsMaterial",this.color=new Re(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.alphaMap=n.alphaMap,this.size=n.size,this.sizeAttenuation=n.sizeAttenuation,this}}gy.prototype.isPointsMaterial=!0;const Cx=new $e,yy=new vo,lp=new yo,cp=new k;function Ax(h,n,s,a,c,u,f){const m=yy.distanceSqToPoint(h);if(m<s){const y=new k;yy.closestPointToPoint(h,y),y.applyMatrix4(a);const v=c.ray.origin.distanceTo(y);if(v<c.near||v>c.far)return;u.push({distance:v,distanceToRay:Math.sqrt(m),point:y,index:n,face:null,object:f})}}(class Dx extends Jt{constructor(n=new Ye,s=new gy){super(),this.type="Points",this.geometry=n,this.material=s,this.updateMorphTargets()}copy(n){return super.copy(n),this.material=n.material,this.geometry=n.geometry,this}raycast(n,s){const a=this.geometry,c=this.matrixWorld,u=n.params.Points.threshold,f=a.drawRange;if(null===a.boundingSphere&&a.computeBoundingSphere(),lp.copy(a.boundingSphere),lp.applyMatrix4(c),lp.radius+=u,!1===n.ray.intersectsSphere(lp))return;Cx.copy(c).invert(),yy.copy(n.ray).applyMatrix4(Cx);const m=u/((this.scale.x+this.scale.y+this.scale.z)/3),y=m*m;if(a.isBufferGeometry){const v=a.index,w=a.attributes.position;if(null!==v)for(let C=Math.max(0,f.start),E=Math.min(v.count,f.start+f.count);C<E;C++){const S=v.getX(C);cp.fromBufferAttribute(w,S),Ax(cp,S,y,c,n,s,this)}else for(let C=Math.max(0,f.start),E=Math.min(w.count,f.start+f.count);C<E;C++)cp.fromBufferAttribute(w,C),Ax(cp,C,y,c,n,s,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const n=this.geometry;if(n.isBufferGeometry){const s=n.morphAttributes,a=Object.keys(s);if(a.length>0){const c=s[a[0]];if(void 0!==c){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let u=0,f=c.length;u<f;u++){const m=c[u].name||String(u);this.morphTargetInfluences.push(0),this.morphTargetDictionary[m]=u}}}}else{const s=n.morphTargets;void 0!==s&&s.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}).prototype.isPoints=!0,class Do extends cn{constructor(n,s,a,c,u,f,m,y,v){super(n,s,a,c,u,f,m,y,v),this.minFilter=void 0!==f?f:hn,this.magFilter=void 0!==u?u:hn,this.generateMipmaps=!1;const _=this;"requestVideoFrameCallback"in n&&n.requestVideoFrameCallback(function w(){_.needsUpdate=!0,n.requestVideoFrameCallback(w)})}clone(){return new this.constructor(this.image).copy(this)}update(){const n=this.image;"requestVideoFrameCallback"in n==0&&n.readyState>=n.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}.prototype.isVideoTexture=!0,class up extends cn{constructor(n,s,a){super({width:n,height:s}),this.format=a,this.magFilter=Qt,this.minFilter=Qt,this.generateMipmaps=!1,this.needsUpdate=!0}}.prototype.isFramebufferTexture=!0;(class vy extends cn{constructor(n,s,a,c,u,f,m,y,v,_,w,b){super(null,f,m,y,v,_,c,u,w,b),this.image={width:s,height:a},this.mipmaps=n,this.flipY=!1,this.generateMipmaps=!1}}).prototype.isCompressedTexture=!0,class _y extends cn{constructor(n,s,a,c,u,f,m,y,v){super(n,s,a,c,u,f,m,y,v),this.needsUpdate=!0}}.prototype.isCanvasTexture=!0;class qi{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(n,s){const a=this.getUtoTmapping(n);return this.getPoint(a,s)}getPoints(n=5){const s=[];for(let a=0;a<=n;a++)s.push(this.getPoint(a/n));return s}getSpacedPoints(n=5){const s=[];for(let a=0;a<=n;a++)s.push(this.getPointAt(a/n));return s}getLength(){const n=this.getLengths();return n[n.length-1]}getLengths(n=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===n+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const s=[];let a,c=this.getPoint(0),u=0;s.push(0);for(let f=1;f<=n;f++)a=this.getPoint(f/n),u+=a.distanceTo(c),s.push(u),c=a;return this.cacheArcLengths=s,s}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(n,s){const a=this.getLengths();let c=0;const u=a.length;let f;f=s||n*a[u-1];let v,m=0,y=u-1;for(;m<=y;)if(c=Math.floor(m+(y-m)/2),v=a[c]-f,v<0)m=c+1;else{if(!(v>0)){y=c;break}y=c-1}if(c=y,a[c]===f)return c/(u-1);const _=a[c];return(c+(f-_)/(a[c+1]-_))/(u-1)}getTangent(n,s){let c=n-1e-4,u=n+1e-4;c<0&&(c=0),u>1&&(u=1);const f=this.getPoint(c),m=this.getPoint(u),y=s||(f.isVector2?new he:new k);return y.copy(m).sub(f).normalize(),y}getTangentAt(n,s){const a=this.getUtoTmapping(n);return this.getTangent(a,s)}computeFrenetFrames(n,s){const a=new k,c=[],u=[],f=[],m=new k,y=new $e;for(let M=0;M<=n;M++)c[M]=this.getTangentAt(M/n,new k);u[0]=new k,f[0]=new k;let v=Number.MAX_VALUE;const _=Math.abs(c[0].x),w=Math.abs(c[0].y),b=Math.abs(c[0].z);_<=v&&(v=_,a.set(1,0,0)),w<=v&&(v=w,a.set(0,1,0)),b<=v&&a.set(0,0,1),m.crossVectors(c[0],a).normalize(),u[0].crossVectors(c[0],m),f[0].crossVectors(c[0],u[0]);for(let M=1;M<=n;M++){if(u[M]=u[M-1].clone(),f[M]=f[M-1].clone(),m.crossVectors(c[M-1],c[M]),m.length()>Number.EPSILON){m.normalize();const C=Math.acos(wn(c[M-1].dot(c[M]),-1,1));u[M].applyMatrix4(y.makeRotationAxis(m,C))}f[M].crossVectors(c[M],u[M])}if(!0===s){let M=Math.acos(wn(u[0].dot(u[n]),-1,1));M/=n,c[0].dot(m.crossVectors(u[0],u[n]))>0&&(M=-M);for(let C=1;C<=n;C++)u[C].applyMatrix4(y.makeRotationAxis(c[C],M*C)),f[C].crossVectors(c[C],u[C])}return{tangents:c,normals:u,binormals:f}}clone(){return(new this.constructor).copy(this)}copy(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}toJSON(){const n={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return n.arcLengthDivisions=this.arcLengthDivisions,n.type=this.type,n}fromJSON(n){return this.arcLengthDivisions=n.arcLengthDivisions,this}}class lu extends qi{constructor(n=0,s=0,a=1,c=1,u=0,f=2*Math.PI,m=!1,y=0){super(),this.type="EllipseCurve",this.aX=n,this.aY=s,this.xRadius=a,this.yRadius=c,this.aStartAngle=u,this.aEndAngle=f,this.aClockwise=m,this.aRotation=y}getPoint(n,s){const a=s||new he,c=2*Math.PI;let u=this.aEndAngle-this.aStartAngle;const f=Math.abs(u)<Number.EPSILON;for(;u<0;)u+=c;for(;u>c;)u-=c;u<Number.EPSILON&&(u=f?0:c),!0===this.aClockwise&&!f&&(u===c?u=-c:u-=c);const m=this.aStartAngle+n*u;let y=this.aX+this.xRadius*Math.cos(m),v=this.aY+this.yRadius*Math.sin(m);if(0!==this.aRotation){const _=Math.cos(this.aRotation),w=Math.sin(this.aRotation),b=y-this.aX,M=v-this.aY;y=b*_-M*w+this.aX,v=b*w+M*_+this.aY}return a.set(y,v)}copy(n){return super.copy(n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this}toJSON(){const n=super.toJSON();return n.aX=this.aX,n.aY=this.aY,n.xRadius=this.xRadius,n.yRadius=this.yRadius,n.aStartAngle=this.aStartAngle,n.aEndAngle=this.aEndAngle,n.aClockwise=this.aClockwise,n.aRotation=this.aRotation,n}fromJSON(n){return super.fromJSON(n),this.aX=n.aX,this.aY=n.aY,this.xRadius=n.xRadius,this.yRadius=n.yRadius,this.aStartAngle=n.aStartAngle,this.aEndAngle=n.aEndAngle,this.aClockwise=n.aClockwise,this.aRotation=n.aRotation,this}}lu.prototype.isEllipseCurve=!0;class jd extends lu{constructor(n,s,a,c,u,f){super(n,s,a,a,c,u,f),this.type="ArcCurve"}}function dp(){let h=0,n=0,s=0,a=0;function c(u,f,m,y){h=u,n=m,s=-3*u+3*f-2*m-y,a=2*u-2*f+m+y}return{initCatmullRom:function(u,f,m,y,v){c(f,m,v*(m-u),v*(y-f))},initNonuniformCatmullRom:function(u,f,m,y,v,_,w){let b=(f-u)/v-(m-u)/(v+_)+(m-f)/_,M=(m-f)/_-(y-f)/(_+w)+(y-m)/w;b*=_,M*=_,c(f,m,b,M)},calc:function(u){const f=u*u;return h+n*u+s*f+a*(f*u)}}}jd.prototype.isArcCurve=!0;const Hr=new k,$d=new dp,hp=new dp,cu=new dp;class fp extends qi{constructor(n=[],s=!1,a="centripetal",c=.5){super(),this.type="CatmullRomCurve3",this.points=n,this.closed=s,this.curveType=a,this.tension=c}getPoint(n,s=new k){const a=s,c=this.points,u=c.length,f=(u-(this.closed?0:1))*n;let v,_,m=Math.floor(f),y=f-m;this.closed?m+=m>0?0:(Math.floor(Math.abs(m)/u)+1)*u:0===y&&m===u-1&&(m=u-2,y=1),this.closed||m>0?v=c[(m-1)%u]:(Hr.subVectors(c[0],c[1]).add(c[0]),v=Hr);const w=c[m%u],b=c[(m+1)%u];if(this.closed||m+2<u?_=c[(m+2)%u]:(Hr.subVectors(c[u-1],c[u-2]).add(c[u-1]),_=Hr),"centripetal"===this.curveType||"chordal"===this.curveType){const M="chordal"===this.curveType?.5:.25;let C=Math.pow(v.distanceToSquared(w),M),E=Math.pow(w.distanceToSquared(b),M),S=Math.pow(b.distanceToSquared(_),M);E<1e-4&&(E=1),C<1e-4&&(C=E),S<1e-4&&(S=E),$d.initNonuniformCatmullRom(v.x,w.x,b.x,_.x,C,E,S),hp.initNonuniformCatmullRom(v.y,w.y,b.y,_.y,C,E,S),cu.initNonuniformCatmullRom(v.z,w.z,b.z,_.z,C,E,S)}else"catmullrom"===this.curveType&&($d.initCatmullRom(v.x,w.x,b.x,_.x,this.tension),hp.initCatmullRom(v.y,w.y,b.y,_.y,this.tension),cu.initCatmullRom(v.z,w.z,b.z,_.z,this.tension));return a.set($d.calc(y),hp.calc(y),cu.calc(y)),a}copy(n){super.copy(n),this.points=[];for(let s=0,a=n.points.length;s<a;s++)this.points.push(n.points[s].clone());return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this}toJSON(){const n=super.toJSON();n.points=[];for(let s=0,a=this.points.length;s<a;s++)n.points.push(this.points[s].toArray());return n.closed=this.closed,n.curveType=this.curveType,n.tension=this.tension,n}fromJSON(n){super.fromJSON(n),this.points=[];for(let s=0,a=n.points.length;s<a;s++){const c=n.points[s];this.points.push((new k).fromArray(c))}return this.closed=n.closed,this.curveType=n.curveType,this.tension=n.tension,this}}function pp(h,n,s,a,c){const u=.5*(a-n),f=.5*(c-s),m=h*h;return(2*s-2*a+u+f)*(h*m)+(-3*s+3*a-2*u-f)*m+u*h+s}function _s(h,n,s,a){return function Rx(h,n){const s=1-h;return s*s*n}(h,n)+function Ix(h,n){return 2*(1-h)*h*n}(h,s)+function uu(h,n){return h*h*n}(h,a)}function hu(h,n,s,a,c){return function mp(h,n){const s=1-h;return s*s*s*n}(h,n)+function Sl(h,n){const s=1-h;return 3*s*s*h*n}(h,s)+function du(h,n){return 3*(1-h)*h*h*n}(h,a)+function Tl(h,n){return h*h*h*n}(h,c)}fp.prototype.isCatmullRomCurve3=!0;class qd extends qi{constructor(n=new he,s=new he,a=new he,c=new he){super(),this.type="CubicBezierCurve",this.v0=n,this.v1=s,this.v2=a,this.v3=c}getPoint(n,s=new he){const a=s,c=this.v0,u=this.v1,f=this.v2,m=this.v3;return a.set(hu(n,c.x,u.x,f.x,m.x),hu(n,c.y,u.y,f.y,m.y)),a}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this}}qd.prototype.isCubicBezierCurve=!0;class gp extends qi{constructor(n=new k,s=new k,a=new k,c=new k){super(),this.type="CubicBezierCurve3",this.v0=n,this.v1=s,this.v2=a,this.v3=c}getPoint(n,s=new k){const a=s,c=this.v0,u=this.v1,f=this.v2,m=this.v3;return a.set(hu(n,c.x,u.x,f.x,m.x),hu(n,c.y,u.y,f.y,m.y),hu(n,c.z,u.z,f.z,m.z)),a}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this.v3.copy(n.v3),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n.v3=this.v3.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this.v3.fromArray(n.v3),this}}gp.prototype.isCubicBezierCurve3=!0;class Cl extends qi{constructor(n=new he,s=new he){super(),this.type="LineCurve",this.v1=n,this.v2=s}getPoint(n,s=new he){const a=s;return 1===n?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(n).add(this.v1)),a}getPointAt(n,s){return this.getPoint(n,s)}getTangent(n,s){const a=s||new he;return a.copy(this.v2).sub(this.v1).normalize(),a}copy(n){return super.copy(n),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}Cl.prototype.isLineCurve=!0;class Xd extends qi{constructor(n=new he,s=new he,a=new he){super(),this.type="QuadraticBezierCurve",this.v0=n,this.v1=s,this.v2=a}getPoint(n,s=new he){const a=s,c=this.v0,u=this.v1,f=this.v2;return a.set(_s(n,c.x,u.x,f.x),_s(n,c.y,u.y,f.y)),a}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}Xd.prototype.isQuadraticBezierCurve=!0;class Dl extends qi{constructor(n=new k,s=new k,a=new k){super(),this.type="QuadraticBezierCurve3",this.v0=n,this.v1=s,this.v2=a}getPoint(n,s=new k){const a=s,c=this.v0,u=this.v1,f=this.v2;return a.set(_s(n,c.x,u.x,f.x),_s(n,c.y,u.y,f.y),_s(n,c.z,u.z,f.z)),a}copy(n){return super.copy(n),this.v0.copy(n.v0),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v0=this.v0.toArray(),n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v0.fromArray(n.v0),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}}Dl.prototype.isQuadraticBezierCurve3=!0;class vp extends qi{constructor(n=[]){super(),this.type="SplineCurve",this.points=n}getPoint(n,s=new he){const a=s,c=this.points,u=(c.length-1)*n,f=Math.floor(u),m=u-f,y=c[0===f?f:f-1],v=c[f],_=c[f>c.length-2?c.length-1:f+1],w=c[f>c.length-3?c.length-1:f+2];return a.set(pp(m,y.x,v.x,_.x,w.x),pp(m,y.y,v.y,_.y,w.y)),a}copy(n){super.copy(n),this.points=[];for(let s=0,a=n.points.length;s<a;s++)this.points.push(n.points[s].clone());return this}toJSON(){const n=super.toJSON();n.points=[];for(let s=0,a=this.points.length;s<a;s++)n.points.push(this.points[s].toArray());return n}fromJSON(n){super.fromJSON(n),this.points=[];for(let s=0,a=n.points.length;s<a;s++){const c=n.points[s];this.points.push((new he).fromArray(c))}return this}}vp.prototype.isSplineCurve=!0;var Zd=Object.freeze({__proto__:null,ArcCurve:jd,CatmullRomCurve3:fp,CubicBezierCurve:qd,CubicBezierCurve3:gp,EllipseCurve:lu,LineCurve:Cl,LineCurve3:class yp extends qi{constructor(n=new k,s=new k){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=n,this.v2=s}getPoint(n,s=new k){const a=s;return 1===n?a.copy(this.v2):(a.copy(this.v2).sub(this.v1),a.multiplyScalar(n).add(this.v1)),a}getPointAt(n,s){return this.getPoint(n,s)}copy(n){return super.copy(n),this.v1.copy(n.v1),this.v2.copy(n.v2),this}toJSON(){const n=super.toJSON();return n.v1=this.v1.toArray(),n.v2=this.v2.toArray(),n}fromJSON(n){return super.fromJSON(n),this.v1.fromArray(n.v1),this.v2.fromArray(n.v2),this}},QuadraticBezierCurve:Xd,QuadraticBezierCurve3:Dl,SplineCurve:vp});class qE extends qi{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(n){this.curves.push(n)}closePath(){const n=this.curves[0].getPoint(0),s=this.curves[this.curves.length-1].getPoint(1);n.equals(s)||this.curves.push(new Cl(s,n))}getPoint(n,s){const a=n*this.getLength(),c=this.getCurveLengths();let u=0;for(;u<c.length;){if(c[u]>=a){const f=c[u]-a,m=this.curves[u],y=m.getLength();return m.getPointAt(0===y?0:1-f/y,s)}u++}return null}getLength(){const n=this.getCurveLengths();return n[n.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const n=[];let s=0;for(let a=0,c=this.curves.length;a<c;a++)s+=this.curves[a].getLength(),n.push(s);return this.cacheLengths=n,n}getSpacedPoints(n=40){const s=[];for(let a=0;a<=n;a++)s.push(this.getPoint(a/n));return this.autoClose&&s.push(s[0]),s}getPoints(n=12){const s=[];let a;for(let c=0,u=this.curves;c<u.length;c++){const f=u[c],y=f.getPoints(f.isEllipseCurve?2*n:f.isLineCurve||f.isLineCurve3?1:f.isSplineCurve?n*f.points.length:n);for(let v=0;v<y.length;v++){const _=y[v];a&&a.equals(_)||(s.push(_),a=_)}}return this.autoClose&&s.length>1&&!s[s.length-1].equals(s[0])&&s.push(s[0]),s}copy(n){super.copy(n),this.curves=[];for(let s=0,a=n.curves.length;s<a;s++)this.curves.push(n.curves[s].clone());return this.autoClose=n.autoClose,this}toJSON(){const n=super.toJSON();n.autoClose=this.autoClose,n.curves=[];for(let s=0,a=this.curves.length;s<a;s++)n.curves.push(this.curves[s].toJSON());return n}fromJSON(n){super.fromJSON(n),this.autoClose=n.autoClose,this.curves=[];for(let s=0,a=n.curves.length;s<a;s++){const c=n.curves[s];this.curves.push((new Zd[c.type]).fromJSON(c))}return this}}class Al extends qE{constructor(n){super(),this.type="Path",this.currentPoint=new he,n&&this.setFromPoints(n)}setFromPoints(n){this.moveTo(n[0].x,n[0].y);for(let s=1,a=n.length;s<a;s++)this.lineTo(n[s].x,n[s].y);return this}moveTo(n,s){return this.currentPoint.set(n,s),this}lineTo(n,s){const a=new Cl(this.currentPoint.clone(),new he(n,s));return this.curves.push(a),this.currentPoint.set(n,s),this}quadraticCurveTo(n,s,a,c){const u=new Xd(this.currentPoint.clone(),new he(n,s),new he(a,c));return this.curves.push(u),this.currentPoint.set(a,c),this}bezierCurveTo(n,s,a,c,u,f){const m=new qd(this.currentPoint.clone(),new he(n,s),new he(a,c),new he(u,f));return this.curves.push(m),this.currentPoint.set(u,f),this}splineThru(n){const s=[this.currentPoint.clone()].concat(n),a=new vp(s);return this.curves.push(a),this.currentPoint.copy(n[n.length-1]),this}arc(n,s,a,c,u,f){return this.absarc(n+this.currentPoint.x,s+this.currentPoint.y,a,c,u,f),this}absarc(n,s,a,c,u,f){return this.absellipse(n,s,a,a,c,u,f),this}ellipse(n,s,a,c,u,f,m,y){return this.absellipse(n+this.currentPoint.x,s+this.currentPoint.y,a,c,u,f,m,y),this}absellipse(n,s,a,c,u,f,m,y){const v=new lu(n,s,a,c,u,f,m,y);if(this.curves.length>0){const w=v.getPoint(0);w.equals(this.currentPoint)||this.lineTo(w.x,w.y)}this.curves.push(v);const _=v.getPoint(1);return this.currentPoint.copy(_),this}copy(n){return super.copy(n),this.currentPoint.copy(n.currentPoint),this}toJSON(){const n=super.toJSON();return n.currentPoint=this.currentPoint.toArray(),n}fromJSON(n){return super.fromJSON(n),this.currentPoint.fromArray(n.currentPoint),this}}class Rl extends Ye{constructor(n=[new he(0,.5),new he(.5,0),new he(0,-.5)],s=12,a=0,c=2*Math.PI){super(),this.type="LatheGeometry",this.parameters={points:n,segments:s,phiStart:a,phiLength:c},s=Math.floor(s),c=wn(c,0,2*Math.PI);const u=[],f=[],m=[],y=[],v=[],_=1/s,w=new k,b=new he,M=new k,C=new k,E=new k;let S=0,A=0;for(let R=0;R<=n.length-1;R++)switch(R){case 0:S=n[R+1].x-n[R].x,A=n[R+1].y-n[R].y,M.x=1*A,M.y=-S,M.z=0*A,E.copy(M),M.normalize(),y.push(M.x,M.y,M.z);break;case n.length-1:y.push(E.x,E.y,E.z);break;default:S=n[R+1].x-n[R].x,A=n[R+1].y-n[R].y,M.x=1*A,M.y=-S,M.z=0*A,C.copy(M),M.x+=E.x,M.y+=E.y,M.z+=E.z,M.normalize(),y.push(M.x,M.y,M.z),E.copy(C)}for(let R=0;R<=s;R++){const F=a+R*_*c,I=Math.sin(F),O=Math.cos(F);for(let V=0;V<=n.length-1;V++)w.x=n[V].x*I,w.y=n[V].y,w.z=n[V].x*O,f.push(w.x,w.y,w.z),b.x=R/s,b.y=V/(n.length-1),m.push(b.x,b.y),v.push(y[3*V+0]*I,y[3*V+1],y[3*V+0]*O)}for(let R=0;R<s;R++)for(let F=0;F<n.length-1;F++){const I=F+R*n.length,V=I+n.length,W=I+n.length+1,$=I+1;u.push(I,V,$),u.push(W,$,V)}this.setIndex(u),this.setAttribute("position",new Ve(f,3)),this.setAttribute("uv",new Ve(m,2)),this.setAttribute("normal",new Ve(v,3))}static fromJSON(n){return new Rl(n.points,n.segments,n.phiStart,n.phiLength)}}class fu extends Rl{constructor(n=1,s=1,a=4,c=8){const u=new Al;u.absarc(0,-s/2,n,1.5*Math.PI,0),u.absarc(0,s/2,n,0,.5*Math.PI),super(u.getPoints(a),c),this.type="CapsuleGeometry",this.parameters={radius:n,height:s,capSegments:a,radialSegments:c}}static fromJSON(n){return new fu(n.radius,n.length,n.capSegments,n.radialSegments)}}class ga extends Ye{constructor(n=1,s=1,a=1,c=8,u=1,f=!1,m=0,y=2*Math.PI){super(),this.type="CylinderGeometry",this.parameters={radiusTop:n,radiusBottom:s,height:a,radialSegments:c,heightSegments:u,openEnded:f,thetaStart:m,thetaLength:y};const v=this;c=Math.floor(c),u=Math.floor(u);const _=[],w=[],b=[],M=[];let C=0;const E=[],S=a/2;let A=0;function F(I){const O=C,V=new he,W=new k;let $=0;const ie=!0===I?n:s,q=!0===I?1:-1;for(let G=1;G<=c;G++)w.push(0,S*q,0),b.push(0,q,0),M.push(.5,.5),C++;const L=C;for(let G=0;G<=c;G++){const Y=G/c*y+m,ne=Math.cos(Y),J=Math.sin(Y);W.x=ie*J,W.y=S*q,W.z=ie*ne,w.push(W.x,W.y,W.z),b.push(0,q,0),V.x=.5*ne+.5,V.y=.5*J*q+.5,M.push(V.x,V.y),C++}for(let G=0;G<c;G++){const _e=O+G,Y=L+G;!0===I?_.push(Y,Y+1,_e):_.push(Y+1,Y,_e),$+=3}v.addGroup(A,$,!0===I?1:2),A+=$}(function R(){const I=new k,O=new k;let V=0;const W=(s-n)/a;for(let $=0;$<=u;$++){const ie=[],q=$/u,L=q*(s-n)+n;for(let G=0;G<=c;G++){const _e=G/c,Y=_e*y+m,ne=Math.sin(Y),J=Math.cos(Y);O.x=L*ne,O.y=-q*a+S,O.z=L*J,w.push(O.x,O.y,O.z),I.set(ne,W,J).normalize(),b.push(I.x,I.y,I.z),M.push(_e,1-q),ie.push(C++)}E.push(ie)}for(let $=0;$<c;$++)for(let ie=0;ie<u;ie++){const L=E[ie+1][$],G=E[ie+1][$+1],_e=E[ie][$+1];_.push(E[ie][$],L,_e),_.push(L,G,_e),V+=6}v.addGroup(A,V,0),A+=V})(),!1===f&&(n>0&&F(!0),s>0&&F(!1)),this.setIndex(_),this.setAttribute("position",new Ve(w,3)),this.setAttribute("normal",new Ve(b,3)),this.setAttribute("uv",new Ve(M,2))}static fromJSON(n){return new ga(n.radiusTop,n.radiusBottom,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength)}}class mu extends ga{constructor(n=1,s=1,a=8,c=1,u=!1,f=0,m=2*Math.PI){super(0,n,s,a,c,u,f,m),this.type="ConeGeometry",this.parameters={radius:n,height:s,radialSegments:a,heightSegments:c,openEnded:u,thetaStart:f,thetaLength:m}}static fromJSON(n){return new mu(n.radius,n.height,n.radialSegments,n.heightSegments,n.openEnded,n.thetaStart,n.thetaLength)}}new k,new k,new k,new ni;class $s extends Al{constructor(n){super(n),this.uuid=St(),this.type="Shape",this.holes=[]}getPointsHoles(n){const s=[];for(let a=0,c=this.holes.length;a<c;a++)s[a]=this.holes[a].getPoints(n);return s}extractPoints(n){return{shape:this.getPoints(n),holes:this.getPointsHoles(n)}}copy(n){super.copy(n),this.holes=[];for(let s=0,a=n.holes.length;s<a;s++)this.holes.push(n.holes[s].clone());return this}toJSON(){const n=super.toJSON();n.uuid=this.uuid,n.holes=[];for(let s=0,a=this.holes.length;s<a;s++)n.holes.push(this.holes[s].toJSON());return n}fromJSON(n){super.fromJSON(n),this.uuid=n.uuid,this.holes=[];for(let s=0,a=n.holes.length;s<a;s++){const c=n.holes[s];this.holes.push((new Al).fromJSON(c))}return this}}function wp(h,n,s,a,c){let u,f;if(c===function Hx(h,n,s,a){let c=0;for(let u=n,f=s-a;u<s;u+=a)c+=(h[f]-h[u])*(h[u+1]+h[f+1]),f=u;return c}(h,n,s,a)>0)for(u=n;u<s;u+=a)f=eh(u,h[u],h[u+1],f);else for(u=s-a;u>=n;u-=a)f=eh(u,h[u],h[u+1],f);return f&&Kd(f,f.next)&&(ya(f),f=f.next),f}function Ao(h,n){if(!h)return h;n||(n=h);let a,s=h;do{if(a=!1,s.steiner||!Kd(s,s.next)&&0!==An(s.prev,s,s.next))s=s.next;else{if(ya(s),s=n=s.prev,s===s.next)break;a=!0}}while(a||s!==n);return n}function yu(h,n,s,a,c,u,f){if(!h)return;!f&&u&&function xs(h,n,s,a){let c=h;do{null===c.z&&(c.z=Mp(c.x,c.y,n,s,a)),c.prevZ=c.prev,c.nextZ=c.next,c=c.next}while(c!==h);c.prevZ.nextZ=null,c.prevZ=null,function bp(h){let n,s,a,c,u,f,m,y,v=1;do{for(s=h,h=null,u=null,f=0;s;){for(f++,a=s,m=0,n=0;n<v&&(m++,a=a.nextZ,a);n++);for(y=v;m>0||y>0&&a;)0!==m&&(0===y||!a||s.z<=a.z)?(c=s,s=s.nextZ,m--):(c=a,a=a.nextZ,y--),u?u.nextZ=c:h=c,c.prevZ=u,u=c;s=a}u.nextZ=null,v*=2}while(f>1)}(c)}(h,a,c,u);let y,v,m=h;for(;h.prev!==h.next;)if(y=h.prev,v=h.next,u?wy(h,a,c,u):Lx(h))n.push(y.i/s),n.push(h.i/s),n.push(v.i/s),ya(h),h=v.next,m=v.next;else if((h=v)===m){f?1===f?yu(h=Fx(Ao(h),n,s),n,s,a,c,u,2):2===f&&by(h,n,s,a,c,u):yu(Ao(h),n,s,a,c,u,1);break}}function Lx(h){const n=h.prev,s=h,a=h.next;if(An(n,s,a)>=0)return!1;let c=h.next.next;for(;c!==h.prev;){if(vu(n.x,n.y,s.x,s.y,a.x,a.y,c.x,c.y)&&An(c.prev,c,c.next)>=0)return!1;c=c.next}return!0}function wy(h,n,s,a){const c=h.prev,u=h,f=h.next;if(An(c,u,f)>=0)return!1;const v=c.x>u.x?c.x>f.x?c.x:f.x:u.x>f.x?u.x:f.x,_=c.y>u.y?c.y>f.y?c.y:f.y:u.y>f.y?u.y:f.y,w=Mp(c.x<u.x?c.x<f.x?c.x:f.x:u.x<f.x?u.x:f.x,c.y<u.y?c.y<f.y?c.y:f.y:u.y<f.y?u.y:f.y,n,s,a),b=Mp(v,_,n,s,a);let M=h.prevZ,C=h.nextZ;for(;M&&M.z>=w&&C&&C.z<=b;){if(M!==h.prev&&M!==h.next&&vu(c.x,c.y,u.x,u.y,f.x,f.y,M.x,M.y)&&An(M.prev,M,M.next)>=0||(M=M.prevZ,C!==h.prev&&C!==h.next&&vu(c.x,c.y,u.x,u.y,f.x,f.y,C.x,C.y)&&An(C.prev,C,C.next)>=0))return!1;C=C.nextZ}for(;M&&M.z>=w;){if(M!==h.prev&&M!==h.next&&vu(c.x,c.y,u.x,u.y,f.x,f.y,M.x,M.y)&&An(M.prev,M,M.next)>=0)return!1;M=M.prevZ}for(;C&&C.z<=b;){if(C!==h.prev&&C!==h.next&&vu(c.x,c.y,u.x,u.y,f.x,f.y,C.x,C.y)&&An(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function Fx(h,n,s){let a=h;do{const c=a.prev,u=a.next.next;!Kd(c,u)&&Ty(c,a,a.next,u)&&Ro(c,u)&&Ro(u,c)&&(n.push(c.i/s),n.push(a.i/s),n.push(u.i/s),ya(a),ya(a.next),a=h=u),a=a.next}while(a!==h);return Ao(a)}function by(h,n,s,a,c,u){let f=h;do{let m=f.next.next;for(;m!==f.prev;){if(f.i!==m.i&&Sy(f,m)){let y=Cy(f,m);return f=Ao(f,f.next),y=Ao(y,y.next),yu(f,n,s,a,c,u),void yu(y,n,s,a,c,u)}m=m.next}f=f.next}while(f!==h)}function Ox(h,n){return h.x-n.x}function My(h,n){if(n=function Ey(h,n){let s=n;const a=h.x,c=h.y;let f,u=-1/0;do{if(c<=s.y&&c>=s.next.y&&s.next.y!==s.y){const b=s.x+(c-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(b<=a&&b>u){if(u=b,b===a){if(c===s.y)return s;if(c===s.next.y)return s.next}f=s.x<s.next.x?s:s.next}}s=s.next}while(s!==n);if(!f)return null;if(a===u)return f;const m=f,y=f.x,v=f.y;let w,_=1/0;s=f;do{a>=s.x&&s.x>=y&&a!==s.x&&vu(c<v?a:u,c,y,v,c<v?u:a,c,s.x,s.y)&&(w=Math.abs(c-s.y)/(a-s.x),Ro(s,h)&&(w<_||w===_&&(s.x>f.x||s.x===f.x&&kx(f,s)))&&(f=s,_=w)),s=s.next}while(s!==m);return f}(h,n),n){const s=Cy(n,h);Ao(n,n.next),Ao(s,s.next)}}function kx(h,n){return An(h.prev,h,n.prev)<0&&An(n.next,h,h.next)<0}function Mp(h,n,s,a,c){return(h=1431655765&((h=858993459&((h=252645135&((h=16711935&((h=32767*(h-s)*c)|h<<8))|h<<4))|h<<2))|h<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=32767*(n-a)*c)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Bx(h){let n=h,s=h;do{(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next}while(n!==h);return s}function vu(h,n,s,a,c,u,f,m){return(c-f)*(n-m)-(h-f)*(u-m)>=0&&(h-f)*(a-m)-(s-f)*(n-m)>=0&&(s-f)*(u-m)-(c-f)*(a-m)>=0}function Sy(h,n){return h.next.i!==n.i&&h.prev.i!==n.i&&!function Ux(h,n){let s=h;do{if(s.i!==h.i&&s.next.i!==h.i&&s.i!==n.i&&s.next.i!==n.i&&Ty(s,s.next,h,n))return!0;s=s.next}while(s!==h);return!1}(h,n)&&(Ro(h,n)&&Ro(n,h)&&function Ep(h,n){let s=h,a=!1;const c=(h.x+n.x)/2,u=(h.y+n.y)/2;do{s.y>u!=s.next.y>u&&s.next.y!==s.y&&c<(s.next.x-s.x)*(u-s.y)/(s.next.y-s.y)+s.x&&(a=!a),s=s.next}while(s!==h);return a}(h,n)&&(An(h.prev,h,n.prev)||An(h,n.prev,n))||Kd(h,n)&&An(h.prev,h,h.next)>0&&An(n.prev,n,n.next)>0)}function An(h,n,s){return(n.y-h.y)*(s.x-n.x)-(n.x-h.x)*(s.y-n.y)}function Kd(h,n){return h.x===n.x&&h.y===n.y}function Ty(h,n,s,a){const c=Jd(An(h,n,s)),u=Jd(An(h,n,a)),f=Jd(An(s,a,h)),m=Jd(An(s,a,n));return!!(c!==u&&f!==m||0===c&&Il(h,s,n)||0===u&&Il(h,a,n)||0===f&&Il(s,h,a)||0===m&&Il(s,n,a))}function Il(h,n,s){return n.x<=Math.max(h.x,s.x)&&n.x>=Math.min(h.x,s.x)&&n.y<=Math.max(h.y,s.y)&&n.y>=Math.min(h.y,s.y)}function Jd(h){return h>0?1:h<0?-1:0}function Ro(h,n){return An(h.prev,h,h.next)<0?An(h,n,h.next)>=0&&An(h,h.prev,n)>=0:An(h,n,h.prev)<0||An(h,h.next,n)<0}function Cy(h,n){const s=new th(h.i,h.x,h.y),a=new th(n.i,n.x,n.y),c=h.next,u=n.prev;return h.next=n,n.prev=h,s.next=c,c.prev=s,a.next=s,s.prev=a,u.next=a,a.prev=u,a}function eh(h,n,s,a){const c=new th(h,n,s);return a?(c.next=a.next,c.prev=a,a.next.prev=c,a.next=c):(c.prev=c,c.next=c),c}function ya(h){h.next.prev=h.prev,h.prev.next=h.next,h.prevZ&&(h.prevZ.nextZ=h.nextZ),h.nextZ&&(h.nextZ.prevZ=h.prevZ)}function th(h,n,s){this.i=h,this.x=n,this.y=s,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}class qs{static area(n){const s=n.length;let a=0;for(let c=s-1,u=0;u<s;c=u++)a+=n[c].x*n[u].y-n[u].x*n[c].y;return.5*a}static isClockWise(n){return qs.area(n)<0}static triangulateShape(n,s){const a=[],c=[],u=[];nh(n),Vx(a,n);let f=n.length;s.forEach(nh);for(let y=0;y<s.length;y++)c.push(f),f+=s[y].length,Vx(a,s[y]);const m=function(h,n,s=2){const a=n&&n.length,c=a?n[0]*s:h.length;let u=wp(h,0,c,s,!0);const f=[];if(!u||u.next===u.prev)return f;let m,y,v,_,w,b,M;if(a&&(u=function Nx(h,n,s,a){const c=[];let u,f,m,y,v;for(u=0,f=n.length;u<f;u++)m=n[u]*a,y=u<f-1?n[u+1]*a:h.length,v=wp(h,m,y,a,!1),v===v.next&&(v.steiner=!0),c.push(Bx(v));for(c.sort(Ox),u=0;u<c.length;u++)My(c[u],s),s=Ao(s,s.next);return s}(h,n,u,s)),h.length>80*s){m=v=h[0],y=_=h[1];for(let C=s;C<c;C+=s)w=h[C],b=h[C+1],w<m&&(m=w),b<y&&(y=b),w>v&&(v=w),b>_&&(_=b);M=Math.max(v-m,_-y),M=0!==M?1/M:0}return yu(u,f,s,m,y,M),f}(a,c);for(let y=0;y<m.length;y+=3)u.push(m.slice(y,y+3));return u}}function nh(h){const n=h.length;n>2&&h[n-1].equals(h[0])&&h.pop()}function Vx(h,n){for(let s=0;s<n.length;s++)h.push(n[s].x),h.push(n[s].y)}class Io extends Ye{constructor(n=new $s([new he(.5,.5),new he(-.5,.5),new he(-.5,-.5),new he(.5,-.5)]),s={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:n,options:s},n=Array.isArray(n)?n:[n];const a=this,c=[],u=[];for(let m=0,y=n.length;m<y;m++)f(n[m]);function f(m){const y=[],v=void 0!==s.curveSegments?s.curveSegments:12,_=void 0!==s.steps?s.steps:1;let w=void 0!==s.depth?s.depth:1,b=void 0===s.bevelEnabled||s.bevelEnabled,M=void 0!==s.bevelThickness?s.bevelThickness:.2,C=void 0!==s.bevelSize?s.bevelSize:M-.1,E=void 0!==s.bevelOffset?s.bevelOffset:0,S=void 0!==s.bevelSegments?s.bevelSegments:3;const A=s.extrudePath,R=void 0!==s.UVGenerator?s.UVGenerator:Dy;void 0!==s.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),w=s.amount);let F,O,V,W,$,I=!1;A&&(F=A.getSpacedPoints(_),I=!0,b=!1,O=A.computeFrenetFrames(_,!1),V=new k,W=new k,$=new k),b||(S=0,M=0,C=0,E=0);const ie=m.extractPoints(v);let q=ie.shape;const L=ie.holes;if(!qs.isClockWise(q)){q=q.reverse();for(let ce=0,fe=L.length;ce<fe;ce++){const be=L[ce];qs.isClockWise(be)&&(L[ce]=be.reverse())}}const _e=qs.triangulateShape(q,L),Y=q;for(let ce=0,fe=L.length;ce<fe;ce++)q=q.concat(L[ce]);function ne(ce,fe,be){return fe||console.error("THREE.ExtrudeGeometry: vec does not exist"),fe.clone().multiplyScalar(be).add(ce)}const J=q.length,oe=_e.length;function X(ce,fe,be){let qe,Ne,yt;const Ke=ce.x-fe.x,et=ce.y-fe.y,Rn=be.x-ce.x,Xt=be.y-ce.y,H=Ke*Ke+et*et;if(Math.abs(Ke*Xt-et*Rn)>Number.EPSILON){const se=Math.sqrt(H),we=Math.sqrt(Rn*Rn+Xt*Xt),Fe=fe.x-et/se,Ue=fe.y+Ke/se,Et=((be.x-Xt/we-Fe)*Xt-(be.y+Rn/we-Ue)*Rn)/(Ke*Xt-et*Rn);qe=Fe+Ke*Et-ce.x,Ne=Ue+et*Et-ce.y;const Pt=qe*qe+Ne*Ne;if(Pt<=2)return new he(qe,Ne);yt=Math.sqrt(Pt/2)}else{let se=!1;Ke>Number.EPSILON?Rn>Number.EPSILON&&(se=!0):Ke<-Number.EPSILON?Rn<-Number.EPSILON&&(se=!0):Math.sign(et)===Math.sign(Xt)&&(se=!0),se?(qe=-et,Ne=Ke,yt=Math.sqrt(H)):(qe=Ke,Ne=et,yt=Math.sqrt(H/2))}return new he(qe/yt,Ne/yt)}const pe=[];for(let ce=0,fe=Y.length,be=fe-1,qe=ce+1;ce<fe;ce++,be++,qe++)be===fe&&(be=0),qe===fe&&(qe=0),pe[ce]=X(Y[ce],Y[be],Y[qe]);const ve=[];let Me,xe=pe.concat();for(let ce=0,fe=L.length;ce<fe;ce++){const be=L[ce];Me=[];for(let qe=0,Ne=be.length,yt=Ne-1,Ke=qe+1;qe<Ne;qe++,yt++,Ke++)yt===Ne&&(yt=0),Ke===Ne&&(Ke=0),Me[qe]=X(be[qe],be[yt],be[Ke]);ve.push(Me),xe=xe.concat(Me)}for(let ce=0;ce<S;ce++){const fe=ce/S,be=M*Math.cos(fe*Math.PI/2),qe=C*Math.sin(fe*Math.PI/2)+E;for(let Ne=0,yt=Y.length;Ne<yt;Ne++){const Ke=ne(Y[Ne],pe[Ne],qe);Zt(Ke.x,Ke.y,-be)}for(let Ne=0,yt=L.length;Ne<yt;Ne++){const Ke=L[Ne];Me=ve[Ne];for(let et=0,Rn=Ke.length;et<Rn;et++){const Xt=ne(Ke[et],Me[et],qe);Zt(Xt.x,Xt.y,-be)}}}const Qe=C+E;for(let ce=0;ce<J;ce++){const fe=b?ne(q[ce],xe[ce],Qe):q[ce];I?(W.copy(O.normals[0]).multiplyScalar(fe.x),V.copy(O.binormals[0]).multiplyScalar(fe.y),$.copy(F[0]).add(W).add(V),Zt($.x,$.y,$.z)):Zt(fe.x,fe.y,0)}for(let ce=1;ce<=_;ce++)for(let fe=0;fe<J;fe++){const be=b?ne(q[fe],xe[fe],Qe):q[fe];I?(W.copy(O.normals[ce]).multiplyScalar(be.x),V.copy(O.binormals[ce]).multiplyScalar(be.y),$.copy(F[ce]).add(W).add(V),Zt($.x,$.y,$.z)):Zt(be.x,be.y,w/_*ce)}for(let ce=S-1;ce>=0;ce--){const fe=ce/S,be=M*Math.cos(fe*Math.PI/2),qe=C*Math.sin(fe*Math.PI/2)+E;for(let Ne=0,yt=Y.length;Ne<yt;Ne++){const Ke=ne(Y[Ne],pe[Ne],qe);Zt(Ke.x,Ke.y,w+be)}for(let Ne=0,yt=L.length;Ne<yt;Ne++){const Ke=L[Ne];Me=ve[Ne];for(let et=0,Rn=Ke.length;et<Rn;et++){const Xt=ne(Ke[et],Me[et],qe);I?Zt(Xt.x,Xt.y+F[_-1].y,F[_-1].x+be):Zt(Xt.x,Xt.y,w+be)}}}function de(ce,fe){let be=ce.length;for(;--be>=0;){const qe=be;let Ne=be-1;Ne<0&&(Ne=ce.length-1);for(let yt=0,Ke=_+2*S;yt<Ke;yt++){const et=J*yt,Rn=J*(yt+1);wt(fe+qe+et,fe+Ne+et,fe+Ne+Rn,fe+qe+Rn)}}}function Zt(ce,fe,be){y.push(ce),y.push(fe),y.push(be)}function xt(ce,fe,be){Ce(ce),Ce(fe),Ce(be);const qe=c.length/3,Ne=R.generateTopUV(a,c,qe-3,qe-2,qe-1);It(Ne[0]),It(Ne[1]),It(Ne[2])}function wt(ce,fe,be,qe){Ce(ce),Ce(fe),Ce(qe),Ce(fe),Ce(be),Ce(qe);const Ne=c.length/3,yt=R.generateSideWallUV(a,c,Ne-6,Ne-3,Ne-2,Ne-1);It(yt[0]),It(yt[1]),It(yt[3]),It(yt[1]),It(yt[2]),It(yt[3])}function Ce(ce){c.push(y[3*ce+0]),c.push(y[3*ce+1]),c.push(y[3*ce+2])}function It(ce){u.push(ce.x),u.push(ce.y)}(function Rt(){const ce=c.length/3;if(b){let fe=0,be=J*fe;for(let qe=0;qe<oe;qe++){const Ne=_e[qe];xt(Ne[2]+be,Ne[1]+be,Ne[0]+be)}fe=_+2*S,be=J*fe;for(let qe=0;qe<oe;qe++){const Ne=_e[qe];xt(Ne[0]+be,Ne[1]+be,Ne[2]+be)}}else{for(let fe=0;fe<oe;fe++){const be=_e[fe];xt(be[2],be[1],be[0])}for(let fe=0;fe<oe;fe++){const be=_e[fe];xt(be[0]+J*_,be[1]+J*_,be[2]+J*_)}}a.addGroup(ce,c.length/3-ce,0)})(),function pt(){const ce=c.length/3;let fe=0;de(Y,fe),fe+=Y.length;for(let be=0,qe=L.length;be<qe;be++){const Ne=L[be];de(Ne,fe),fe+=Ne.length}a.addGroup(ce,c.length/3-ce,1)}()}this.setAttribute("position",new Ve(c,3)),this.setAttribute("uv",new Ve(u,2)),this.computeVertexNormals()}toJSON(){const n=super.toJSON();return function Ay(h,n,s){if(s.shapes=[],Array.isArray(h))for(let a=0,c=h.length;a<c;a++)s.shapes.push(h[a].uuid);else s.shapes.push(h.uuid);return void 0!==n.extrudePath&&(s.options.extrudePath=n.extrudePath.toJSON()),s}(this.parameters.shapes,this.parameters.options,n)}static fromJSON(n,s){const a=[];for(let u=0,f=n.shapes.length;u<f;u++)a.push(s[n.shapes[u]]);const c=n.options.extrudePath;return void 0!==c&&(n.options.extrudePath=(new Zd[c.type]).fromJSON(c)),new Io(a,n.options)}}const Dy={generateTopUV:function(h,n,s,a,c){const m=n[3*a],y=n[3*a+1],v=n[3*c],_=n[3*c+1];return[new he(n[3*s],n[3*s+1]),new he(m,y),new he(v,_)]},generateSideWallUV:function(h,n,s,a,c,u){const f=n[3*s],m=n[3*s+1],y=n[3*s+2],v=n[3*a],_=n[3*a+1],w=n[3*a+2],b=n[3*c],M=n[3*c+1],C=n[3*c+2],E=n[3*u],S=n[3*u+1],A=n[3*u+2];return Math.abs(m-_)<Math.abs(f-v)?[new he(f,1-y),new he(v,1-w),new he(b,1-C),new he(E,1-A)]:[new he(m,1-y),new he(_,1-w),new he(M,1-C),new he(S,1-A)]}};class lr extends Ye{constructor(n=new $s([new he(0,.5),new he(-.5,-.5),new he(.5,-.5)]),s=12){super(),this.type="ShapeGeometry",this.parameters={shapes:n,curveSegments:s};const a=[],c=[],u=[],f=[];let m=0,y=0;if(!1===Array.isArray(n))v(n);else for(let _=0;_<n.length;_++)v(n[_]),this.addGroup(m,y,_),m+=y,y=0;function v(_){const w=c.length/3,b=_.extractPoints(s);let M=b.shape;const C=b.holes;!1===qs.isClockWise(M)&&(M=M.reverse());for(let S=0,A=C.length;S<A;S++){const R=C[S];!0===qs.isClockWise(R)&&(C[S]=R.reverse())}const E=qs.triangulateShape(M,C);for(let S=0,A=C.length;S<A;S++)M=M.concat(C[S]);for(let S=0,A=M.length;S<A;S++){const R=M[S];c.push(R.x,R.y,0),u.push(0,0,1),f.push(R.x,R.y)}for(let S=0,A=E.length;S<A;S++){const R=E[S];a.push(R[0]+w,R[1]+w,R[2]+w),y+=3}}this.setIndex(a),this.setAttribute("position",new Ve(c,3)),this.setAttribute("normal",new Ve(u,3)),this.setAttribute("uv",new Ve(f,2))}toJSON(){const n=super.toJSON();return function ih(h,n){if(n.shapes=[],Array.isArray(h))for(let s=0,a=h.length;s<a;s++)n.shapes.push(h[s].uuid);else n.shapes.push(h.uuid);return n}(this.parameters.shapes,n)}static fromJSON(n,s){const a=[];for(let c=0,u=n.shapes.length;c<u;c++)a.push(s[n.shapes[c]]);return new lr(a,n.curveSegments)}}class oh extends Zn{constructor(n){super(),this.type="ShadowMaterial",this.color=new Re(0),this.transparent=!0,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this}}oh.prototype.isShadowMaterial=!0;class Tp extends yr{constructor(n){super(n),this.type="RawShaderMaterial"}}Tp.prototype.isRawShaderMaterial=!0;class ah extends Zn{constructor(n){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Re(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new he(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.defines={STANDARD:""},this.color.copy(n.color),this.roughness=n.roughness,this.metalness=n.metalness,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.roughnessMap=n.roughnessMap,this.metalnessMap=n.metalnessMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.envMapIntensity=n.envMapIntensity,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.flatShading=n.flatShading,this}}ah.prototype.isMeshStandardMaterial=!0;class Cp extends ah{constructor(n){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new he(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return wn(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(s){this.ior=(1+.4*s)/(1-.4*s)}}),this.sheenColor=new Re(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Re(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Re(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(n)}get sheen(){return this._sheen}set sheen(n){this._sheen>0!=n>0&&this.version++,this._sheen=n}get clearcoat(){return this._clearcoat}set clearcoat(n){this._clearcoat>0!=n>0&&this.version++,this._clearcoat=n}get transmission(){return this._transmission}set transmission(n){this._transmission>0!=n>0&&this.version++,this._transmission=n}copy(n){return super.copy(n),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=n.clearcoat,this.clearcoatMap=n.clearcoatMap,this.clearcoatRoughness=n.clearcoatRoughness,this.clearcoatRoughnessMap=n.clearcoatRoughnessMap,this.clearcoatNormalMap=n.clearcoatNormalMap,this.clearcoatNormalScale.copy(n.clearcoatNormalScale),this.ior=n.ior,this.sheen=n.sheen,this.sheenColor.copy(n.sheenColor),this.sheenColorMap=n.sheenColorMap,this.sheenRoughness=n.sheenRoughness,this.sheenRoughnessMap=n.sheenRoughnessMap,this.transmission=n.transmission,this.transmissionMap=n.transmissionMap,this.thickness=n.thickness,this.thicknessMap=n.thicknessMap,this.attenuationDistance=n.attenuationDistance,this.attenuationColor.copy(n.attenuationColor),this.specularIntensity=n.specularIntensity,this.specularIntensityMap=n.specularIntensityMap,this.specularColor.copy(n.specularColor),this.specularColorMap=n.specularColorMap,this}}Cp.prototype.isMeshPhysicalMaterial=!0;class Iy extends Zn{constructor(n){super(),this.type="MeshPhongMaterial",this.color=new Re(16777215),this.specular=new Re(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new he(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.specular.copy(n.specular),this.shininess=n.shininess,this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this.flatShading=n.flatShading,this}}Iy.prototype.isMeshPhongMaterial=!0;class lh extends Zn{constructor(n){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Re(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new he(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.gradientMap=n.gradientMap,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.alphaMap=n.alphaMap,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this}}lh.prototype.isMeshToonMaterial=!0;class Py extends Zn{constructor(n){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new he(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.flatShading=n.flatShading,this}}Py.prototype.isMeshNormalMaterial=!0;class Ly extends Zn{constructor(n){super(),this.type="MeshLambertMaterial",this.color=new Re(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Re(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(n)}copy(n){return super.copy(n),this.color.copy(n.color),this.map=n.map,this.lightMap=n.lightMap,this.lightMapIntensity=n.lightMapIntensity,this.aoMap=n.aoMap,this.aoMapIntensity=n.aoMapIntensity,this.emissive.copy(n.emissive),this.emissiveMap=n.emissiveMap,this.emissiveIntensity=n.emissiveIntensity,this.specularMap=n.specularMap,this.alphaMap=n.alphaMap,this.envMap=n.envMap,this.combine=n.combine,this.reflectivity=n.reflectivity,this.refractionRatio=n.refractionRatio,this.wireframe=n.wireframe,this.wireframeLinewidth=n.wireframeLinewidth,this.wireframeLinecap=n.wireframeLinecap,this.wireframeLinejoin=n.wireframeLinejoin,this}}Ly.prototype.isMeshLambertMaterial=!0;class Dp extends Zn{constructor(n){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Re(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new he(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(n)}copy(n){return super.copy(n),this.defines={MATCAP:""},this.color.copy(n.color),this.matcap=n.matcap,this.map=n.map,this.bumpMap=n.bumpMap,this.bumpScale=n.bumpScale,this.normalMap=n.normalMap,this.normalMapType=n.normalMapType,this.normalScale.copy(n.normalScale),this.displacementMap=n.displacementMap,this.displacementScale=n.displacementScale,this.displacementBias=n.displacementBias,this.alphaMap=n.alphaMap,this.flatShading=n.flatShading,this}}Dp.prototype.isMeshMatcapMaterial=!0;class va extends si{constructor(n){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(n)}copy(n){return super.copy(n),this.scale=n.scale,this.dashSize=n.dashSize,this.gapSize=n.gapSize,this}}va.prototype.isLineDashedMaterial=!0;const Fy={ShadowMaterial:oh,SpriteMaterial:np,RawShaderMaterial:Tp,ShaderMaterial:yr,PointsMaterial:gy,MeshPhysicalMaterial:Cp,MeshStandardMaterial:ah,MeshPhongMaterial:Iy,MeshToonMaterial:lh,MeshNormalMaterial:Py,MeshLambertMaterial:Ly,MeshDepthMaterial:Xc,MeshDistanceMaterial:Zc,MeshBasicMaterial:Vs,MeshMatcapMaterial:Dp,LineDashedMaterial:va,LineBasicMaterial:si,Material:Zn};Zn.fromType=function(h){return new Fy[h]};const Mn={arraySlice:function(h,n,s){return Mn.isTypedArray(h)?new h.constructor(h.subarray(n,void 0!==s?s:h.length)):h.slice(n,s)},convertArray:function(h,n,s){return!h||!s&&h.constructor===n?h:"number"==typeof n.BYTES_PER_ELEMENT?new n(h):Array.prototype.slice.call(h)},isTypedArray:function(h){return ArrayBuffer.isView(h)&&!(h instanceof DataView)},getKeyframeOrder:function(h){const s=h.length,a=new Array(s);for(let c=0;c!==s;++c)a[c]=c;return a.sort(function n(c,u){return h[c]-h[u]}),a},sortedArray:function(h,n,s){const a=h.length,c=new h.constructor(a);for(let u=0,f=0;f!==a;++u){const m=s[u]*n;for(let y=0;y!==n;++y)c[f++]=h[m+y]}return c},flattenJSON:function(h,n,s,a){let c=1,u=h[0];for(;void 0!==u&&void 0===u[a];)u=h[c++];if(void 0===u)return;let f=u[a];if(void 0!==f)if(Array.isArray(f))do{f=u[a],void 0!==f&&(n.push(u.time),s.push.apply(s,f)),u=h[c++]}while(void 0!==u);else if(void 0!==f.toArray)do{f=u[a],void 0!==f&&(n.push(u.time),f.toArray(s,s.length)),u=h[c++]}while(void 0!==u);else do{f=u[a],void 0!==f&&(n.push(u.time),s.push(f)),u=h[c++]}while(void 0!==u)},subclip:function(h,n,s,a,c=30){const u=h.clone();u.name=n;const f=[];for(let y=0;y<u.tracks.length;++y){const v=u.tracks[y],_=v.getValueSize(),w=[],b=[];for(let M=0;M<v.times.length;++M){const C=v.times[M]*c;if(!(C<s||C>=a)){w.push(v.times[M]);for(let E=0;E<_;++E)b.push(v.values[M*_+E])}}0!==w.length&&(v.times=Mn.convertArray(w,v.times.constructor),v.values=Mn.convertArray(b,v.values.constructor),f.push(v))}u.tracks=f;let m=1/0;for(let y=0;y<u.tracks.length;++y)m>u.tracks[y].times[0]&&(m=u.tracks[y].times[0]);for(let y=0;y<u.tracks.length;++y)u.tracks[y].shift(-1*m);return u.resetDuration(),u},makeClipAdditive:function(h,n=0,s=h,a=30){a<=0&&(a=30);const c=s.tracks.length,u=n/a;for(let f=0;f<c;++f){const m=s.tracks[f],y=m.ValueTypeName;if("bool"===y||"string"===y)continue;const v=h.tracks.find(function(A){return A.name===m.name&&A.ValueTypeName===y});if(void 0===v)continue;let _=0;const w=m.getValueSize();m.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(_=w/3);let b=0;const M=v.getValueSize();v.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(b=M/3);const C=m.times.length-1;let E;if(u<=m.times[0])E=Mn.arraySlice(m.values,_,w-_);else if(u>=m.times[C]){const A=C*w+_;E=Mn.arraySlice(m.values,A,A+w-_)}else{const A=m.createInterpolant(),R=_,F=w-_;A.evaluate(u),E=Mn.arraySlice(A.resultBuffer,R,F)}"quaternion"===y&&(new un).fromArray(E).normalize().conjugate().toArray(E);const S=v.times.length;for(let A=0;A<S;++A){const R=A*M+b;if("quaternion"===y)un.multiplyQuaternionsFlat(v.values,R,E,0,v.values,R);else{const F=M-2*b;for(let I=0;I<F;++I)v.values[R+I]-=E[I]}}}return h.blendMode=2501,h}};class Po{constructor(n,s,a,c){this.parameterPositions=n,this._cachedIndex=0,this.resultBuffer=void 0!==c?c:new s.constructor(a),this.sampleValues=s,this.valueSize=a,this.settings=null,this.DefaultSettings_={}}evaluate(n){const s=this.parameterPositions;let a=this._cachedIndex,c=s[a],u=s[a-1];e:{t:{let f;n:{i:if(!(n<c)){for(let m=a+2;;){if(void 0===c){if(n<u)break i;return a=s.length,this._cachedIndex=a,this.afterEnd_(a-1,n,u)}if(a===m)break;if(u=c,c=s[++a],n<c)break t}f=s.length;break n}if(n>=u)break e;{const m=s[1];n<m&&(a=2,u=m);for(let y=a-2;;){if(void 0===u)return this._cachedIndex=0,this.beforeStart_(0,n,c);if(a===y)break;if(c=u,u=s[--a-1],n>=u)break t}f=a,a=0}}for(;a<f;){const m=a+f>>>1;n<s[m]?f=m:a=m+1}if(c=s[a],u=s[a-1],void 0===u)return this._cachedIndex=0,this.beforeStart_(0,n,c);if(void 0===c)return a=s.length,this._cachedIndex=a,this.afterEnd_(a-1,u,n)}this._cachedIndex=a,this.intervalChanged_(a,u,c)}return this.interpolate_(a,u,n,c)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(n){const s=this.resultBuffer,a=this.sampleValues,c=this.valueSize,u=n*c;for(let f=0;f!==c;++f)s[f]=a[u+f];return s}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}Po.prototype.beforeStart_=Po.prototype.copySampleValue_,Po.prototype.afterEnd_=Po.prototype.copySampleValue_;class Nl extends Po{constructor(n,s,a,c){super(n,s,a,c),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Fs,endingEnd:Fs}}intervalChanged_(n,s,a){const c=this.parameterPositions;let u=n-2,f=n+1,m=c[u],y=c[f];if(void 0===m)switch(this.getSettings_().endingStart){case hi:u=n,m=2*s-a;break;case 2402:u=c.length-2,m=s+c[u]-c[u+1];break;default:u=n,m=a}if(void 0===y)switch(this.getSettings_().endingEnd){case hi:f=n,y=2*a-s;break;case 2402:f=1,y=a+c[1]-c[0];break;default:f=n-1,y=s}const v=.5*(a-s),_=this.valueSize;this._weightPrev=v/(s-m),this._weightNext=v/(y-a),this._offsetPrev=u*_,this._offsetNext=f*_}interpolate_(n,s,a,c){const u=this.resultBuffer,f=this.sampleValues,m=this.valueSize,y=n*m,v=y-m,_=this._offsetPrev,w=this._offsetNext,b=this._weightPrev,M=this._weightNext,C=(a-s)/(c-s),E=C*C,S=E*C,A=-b*S+2*b*E-b*C,R=(1+b)*S+(-1.5-2*b)*E+(-.5+b)*C+1,F=(-1-M)*S+(1.5+M)*E+.5*C,I=M*S-M*E;for(let O=0;O!==m;++O)u[O]=A*f[_+O]+R*f[v+O]+F*f[y+O]+I*f[w+O];return u}}class Ny extends Po{constructor(n,s,a,c){super(n,s,a,c)}interpolate_(n,s,a,c){const u=this.resultBuffer,f=this.sampleValues,m=this.valueSize,y=n*m,v=y-m,_=(a-s)/(c-s),w=1-_;for(let b=0;b!==m;++b)u[b]=f[v+b]*w+f[y+b]*_;return u}}class zx extends Po{constructor(n,s,a,c){super(n,s,a,c)}interpolate_(n){return this.copySampleValue_(n-1)}}class ws{constructor(n,s,a,c){if(void 0===n)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===s||0===s.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+n);this.name=n,this.times=Mn.convertArray(s,this.TimeBufferType),this.values=Mn.convertArray(a,this.ValueBufferType),this.setInterpolation(c||this.DefaultInterpolation)}static toJSON(n){const s=n.constructor;let a;if(s.toJSON!==this.toJSON)a=s.toJSON(n);else{a={name:n.name,times:Mn.convertArray(n.times,Array),values:Mn.convertArray(n.values,Array)};const c=n.getInterpolation();c!==n.DefaultInterpolation&&(a.interpolation=c)}return a.type=n.ValueTypeName,a}InterpolantFactoryMethodDiscrete(n){return new zx(this.times,this.values,this.getValueSize(),n)}InterpolantFactoryMethodLinear(n){return new Ny(this.times,this.values,this.getValueSize(),n)}InterpolantFactoryMethodSmooth(n){return new Nl(this.times,this.values,this.getValueSize(),n)}setInterpolation(n){let s;switch(n){case 2300:s=this.InterpolantFactoryMethodDiscrete;break;case 2301:s=this.InterpolantFactoryMethodLinear;break;case 2302:s=this.InterpolantFactoryMethodSmooth}if(void 0===s){const a="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(n===this.DefaultInterpolation)throw new Error(a);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",a),this}return this.createInterpolant=s,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(n){if(0!==n){const s=this.times;for(let a=0,c=s.length;a!==c;++a)s[a]+=n}return this}scale(n){if(1!==n){const s=this.times;for(let a=0,c=s.length;a!==c;++a)s[a]*=n}return this}trim(n,s){const a=this.times,c=a.length;let u=0,f=c-1;for(;u!==c&&a[u]<n;)++u;for(;-1!==f&&a[f]>s;)--f;if(++f,0!==u||f!==c){u>=f&&(f=Math.max(f,1),u=f-1);const m=this.getValueSize();this.times=Mn.arraySlice(a,u,f),this.values=Mn.arraySlice(this.values,u*m,f*m)}return this}validate(){let n=!0;const s=this.getValueSize();s-Math.floor(s)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),n=!1);const a=this.times,c=this.values,u=a.length;0===u&&(console.error("THREE.KeyframeTrack: Track is empty.",this),n=!1);let f=null;for(let m=0;m!==u;m++){const y=a[m];if("number"==typeof y&&isNaN(y)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,m,y),n=!1;break}if(null!==f&&f>y){console.error("THREE.KeyframeTrack: Out of order keys.",this,m,y,f),n=!1;break}f=y}if(void 0!==c&&Mn.isTypedArray(c))for(let m=0,y=c.length;m!==y;++m){const v=c[m];if(isNaN(v)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,m,v),n=!1;break}}return n}optimize(){const n=Mn.arraySlice(this.times),s=Mn.arraySlice(this.values),a=this.getValueSize(),c=2302===this.getInterpolation(),u=n.length-1;let f=1;for(let m=1;m<u;++m){let y=!1;const v=n[m];if(v!==n[m+1]&&(1!==m||v!==n[0]))if(c)y=!0;else{const w=m*a,b=w-a,M=w+a;for(let C=0;C!==a;++C){const E=s[w+C];if(E!==s[b+C]||E!==s[M+C]){y=!0;break}}}if(y){if(m!==f){n[f]=n[m];const w=m*a,b=f*a;for(let M=0;M!==a;++M)s[b+M]=s[w+M]}++f}}if(u>0){n[f]=n[u];for(let m=u*a,y=f*a,v=0;v!==a;++v)s[y+v]=s[m+v];++f}return f!==n.length?(this.times=Mn.arraySlice(n,0,f),this.values=Mn.arraySlice(s,0,f*a)):(this.times=n,this.values=s),this}clone(){const n=Mn.arraySlice(this.times,0),s=Mn.arraySlice(this.values,0),c=new(0,this.constructor)(this.name,n,s);return c.createInterpolant=this.createInterpolant,c}}ws.prototype.TimeBufferType=Float32Array,ws.prototype.ValueBufferType=Float32Array,ws.prototype.DefaultInterpolation=2301;class Ol extends ws{}Ol.prototype.ValueTypeName="bool",Ol.prototype.ValueBufferType=Array,Ol.prototype.DefaultInterpolation=2300,Ol.prototype.InterpolantFactoryMethodLinear=void 0,Ol.prototype.InterpolantFactoryMethodSmooth=void 0;class mi extends ws{}mi.prototype.ValueTypeName="color";class kl extends ws{}kl.prototype.ValueTypeName="number";class Oy extends Po{constructor(n,s,a,c){super(n,s,a,c)}interpolate_(n,s,a,c){const u=this.resultBuffer,f=this.sampleValues,m=this.valueSize,y=(a-s)/(c-s);let v=n*m;for(let _=v+m;v!==_;v+=4)un.slerpFlat(u,0,f,v-m,f,v,y);return u}}class Bl extends ws{InterpolantFactoryMethodLinear(n){return new Oy(this.times,this.values,this.getValueSize(),n)}}Bl.prototype.ValueTypeName="quaternion",Bl.prototype.DefaultInterpolation=2301,Bl.prototype.InterpolantFactoryMethodSmooth=void 0;class _a extends ws{}_a.prototype.ValueTypeName="string",_a.prototype.ValueBufferType=Array,_a.prototype.DefaultInterpolation=2300,_a.prototype.InterpolantFactoryMethodLinear=void 0,_a.prototype.InterpolantFactoryMethodSmooth=void 0;class Mu extends ws{}Mu.prototype.ValueTypeName="vector";class ch{constructor(n,s=-1,a,c=2500){this.name=n,this.tracks=a,this.duration=s,this.blendMode=c,this.uuid=St(),this.duration<0&&this.resetDuration()}static parse(n){const s=[],a=n.tracks,c=1/(n.fps||1);for(let f=0,m=a.length;f!==m;++f)s.push(Wx(a[f]).scale(c));const u=new this(n.name,n.duration,s,n.blendMode);return u.uuid=n.uuid,u}static toJSON(n){const s=[],a=n.tracks,c={name:n.name,duration:n.duration,tracks:s,uuid:n.uuid,blendMode:n.blendMode};for(let u=0,f=a.length;u!==f;++u)s.push(ws.toJSON(a[u]));return c}static CreateFromMorphTargetSequence(n,s,a,c){const u=s.length,f=[];for(let m=0;m<u;m++){let y=[],v=[];y.push((m+u-1)%u,m,(m+1)%u),v.push(0,1,0);const _=Mn.getKeyframeOrder(y);y=Mn.sortedArray(y,1,_),v=Mn.sortedArray(v,1,_),!c&&0===y[0]&&(y.push(u),v.push(v[0])),f.push(new kl(".morphTargetInfluences["+s[m].name+"]",y,v).scale(1/a))}return new this(n,-1,f)}static findByName(n,s){let a=n;if(!Array.isArray(n)){const c=n;a=c.geometry&&c.geometry.animations||c.animations}for(let c=0;c<a.length;c++)if(a[c].name===s)return a[c];return null}static CreateClipsFromMorphTargetSequences(n,s,a){const c={},u=/^([\w-]*?)([\d]+)$/;for(let m=0,y=n.length;m<y;m++){const v=n[m],_=v.name.match(u);if(_&&_.length>1){const w=_[1];let b=c[w];b||(c[w]=b=[]),b.push(v)}}const f=[];for(const m in c)f.push(this.CreateFromMorphTargetSequence(m,c[m],s,a));return f}static parseAnimation(n,s){if(!n)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const a=function(w,b,M,C,E){if(0!==M.length){const S=[],A=[];Mn.flattenJSON(M,S,A,C),0!==S.length&&E.push(new w(b,S,A))}},c=[],u=n.name||"default",f=n.fps||30,m=n.blendMode;let y=n.length||-1;const v=n.hierarchy||[];for(let w=0;w<v.length;w++){const b=v[w].keys;if(b&&0!==b.length)if(b[0].morphTargets){const M={};let C;for(C=0;C<b.length;C++)if(b[C].morphTargets)for(let E=0;E<b[C].morphTargets.length;E++)M[b[C].morphTargets[E]]=-1;for(const E in M){const S=[],A=[];for(let R=0;R!==b[C].morphTargets.length;++R){const F=b[C];S.push(F.time),A.push(F.morphTarget===E?1:0)}c.push(new kl(".morphTargetInfluence["+E+"]",S,A))}y=M.length*f}else{const M=".bones["+s[w].name+"]";a(Mu,M+".position",b,"pos",c),a(Bl,M+".quaternion",b,"rot",c),a(Mu,M+".scale",b,"scl",c)}}return 0===c.length?null:new this(u,y,c,m)}resetDuration(){let s=0;for(let a=0,c=this.tracks.length;a!==c;++a){const u=this.tracks[a];s=Math.max(s,u.times[u.times.length-1])}return this.duration=s,this}trim(){for(let n=0;n<this.tracks.length;n++)this.tracks[n].trim(0,this.duration);return this}validate(){let n=!0;for(let s=0;s<this.tracks.length;s++)n=n&&this.tracks[s].validate();return n}optimize(){for(let n=0;n<this.tracks.length;n++)this.tracks[n].optimize();return this}clone(){const n=[];for(let s=0;s<this.tracks.length;s++)n.push(this.tracks[s].clone());return new this.constructor(this.name,this.duration,n,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function Wx(h){if(void 0===h.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const n=function Gx(h){switch(h.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return kl;case"vector":case"vector2":case"vector3":case"vector4":return Mu;case"color":return mi;case"quaternion":return Bl;case"bool":case"boolean":return Ol;case"string":return _a}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+h)}(h.type);if(void 0===h.times){const s=[],a=[];Mn.flattenJSON(h.keys,s,a,"value"),h.times=s,h.values=a}return void 0!==n.parse?n.parse(h):new n(h.name,h.times,h.values,h.interpolation)}const Ul={enabled:!1,files:{},add:function(h,n){!1!==this.enabled&&(this.files[h]=n)},get:function(h){if(!1!==this.enabled)return this.files[h]},remove:function(h){delete this.files[h]},clear:function(){this.files={}}};const XE=new class Ap{constructor(n,s,a){const c=this;let y,u=!1,f=0,m=0;const v=[];this.onStart=void 0,this.onLoad=n,this.onProgress=s,this.onError=a,this.itemStart=function(_){m++,!1===u&&void 0!==c.onStart&&c.onStart(_,f,m),u=!0},this.itemEnd=function(_){f++,void 0!==c.onProgress&&c.onProgress(_,f,m),f===m&&(u=!1,void 0!==c.onLoad&&c.onLoad())},this.itemError=function(_){void 0!==c.onError&&c.onError(_)},this.resolveURL=function(_){return y?y(_):_},this.setURLModifier=function(_){return y=_,this},this.addHandler=function(_,w){return v.push(_,w),this},this.removeHandler=function(_){const w=v.indexOf(_);return-1!==w&&v.splice(w,2),this},this.getHandler=function(_){for(let w=0,b=v.length;w<b;w+=2){const M=v[w],C=v[w+1];if(M.global&&(M.lastIndex=0),M.test(_))return C}return null}}};class Xs{constructor(n){this.manager=void 0!==n?n:XE,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(n,s){const a=this;return new Promise(function(c,u){a.load(n,c,s,u)})}parse(){}setCrossOrigin(n){return this.crossOrigin=n,this}setWithCredentials(n){return this.withCredentials=n,this}setPath(n){return this.path=n,this}setResourcePath(n){return this.resourcePath=n,this}setRequestHeader(n){return this.requestHeader=n,this}}const Zs={};class Lo extends Xs{constructor(n){super(n)}load(n,s,a,c){void 0===n&&(n=""),void 0!==this.path&&(n=this.path+n),n=this.manager.resolveURL(n);const u=Ul.get(n);if(void 0!==u)return this.manager.itemStart(n),setTimeout(()=>{s&&s(u),this.manager.itemEnd(n)},0),u;if(void 0!==Zs[n])return void Zs[n].push({onLoad:s,onProgress:a,onError:c});Zs[n]=[],Zs[n].push({onLoad:s,onProgress:a,onError:c});const f=new Request(n,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),m=this.mimeType,y=this.responseType;fetch(f).then(v=>{if(200===v.status||0===v.status){if(0===v.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),"undefined"==typeof ReadableStream||void 0===v.body||void 0===v.body.getReader)return v;const _=Zs[n],w=v.body.getReader(),b=v.headers.get("Content-Length"),M=b?parseInt(b):0,C=0!==M;let E=0;const S=new ReadableStream({start(A){!function R(){w.read().then(({done:F,value:I})=>{if(F)A.close();else{E+=I.byteLength;const O=new ProgressEvent("progress",{lengthComputable:C,loaded:E,total:M});for(let V=0,W=_.length;V<W;V++){const $=_[V];$.onProgress&&$.onProgress(O)}A.enqueue(I),R()}})}()}});return new Response(S)}throw Error(`fetch for "${v.url}" responded with ${v.status}: ${v.statusText}`)}).then(v=>{switch(y){case"arraybuffer":return v.arrayBuffer();case"blob":return v.blob();case"document":return v.text().then(_=>(new DOMParser).parseFromString(_,m));case"json":return v.json();default:if(void 0===m)return v.text();{const w=/charset="?([^;"\s]*)"?/i.exec(m),b=w&&w[1]?w[1].toLowerCase():void 0,M=new TextDecoder(b);return v.arrayBuffer().then(C=>M.decode(C))}}}).then(v=>{Ul.add(n,v);const _=Zs[n];delete Zs[n];for(let w=0,b=_.length;w<b;w++){const M=_[w];M.onLoad&&M.onLoad(v)}}).catch(v=>{const _=Zs[n];if(void 0===_)throw this.manager.itemError(n),v;delete Zs[n];for(let w=0,b=_.length;w<b;w++){const M=_[w];M.onError&&M.onError(v)}this.manager.itemError(n)}).finally(()=>{this.manager.itemEnd(n)}),this.manager.itemStart(n)}setResponseType(n){return this.responseType=n,this}setMimeType(n){return this.mimeType=n,this}}class Hl extends Xs{constructor(n){super(n)}load(n,s,a,c){void 0!==this.path&&(n=this.path+n),n=this.manager.resolveURL(n);const u=this,f=Ul.get(n);if(void 0!==f)return u.manager.itemStart(n),setTimeout(function(){s&&s(f),u.manager.itemEnd(n)},0),f;const m=fc("img");function y(){_(),Ul.add(n,this),s&&s(this),u.manager.itemEnd(n)}function v(w){_(),c&&c(w),u.manager.itemError(n),u.manager.itemEnd(n)}function _(){m.removeEventListener("load",y,!1),m.removeEventListener("error",v,!1)}return m.addEventListener("load",y,!1),m.addEventListener("error",v,!1),"data:"!==n.slice(0,5)&&void 0!==this.crossOrigin&&(m.crossOrigin=this.crossOrigin),u.manager.itemStart(n),m.src=n,m}}class jx extends Xs{constructor(n){super(n)}load(n,s,a,c){const u=new Sc,f=new Hl(this.manager);f.setCrossOrigin(this.crossOrigin),f.setPath(this.path);let m=0;function y(v){f.load(n[v],function(_){u.images[v]=_,m++,6===m&&(u.needsUpdate=!0,s&&s(u))},void 0,c)}for(let v=0;v<n.length;++v)y(v);return u}}class ky extends Xs{constructor(n){super(n)}load(n,s,a,c){const u=new cn,f=new Hl(this.manager);return f.setCrossOrigin(this.crossOrigin),f.setPath(this.path),f.load(n,function(m){u.image=m,u.needsUpdate=!0,void 0!==s&&s(u)},a,c),u}}class Ys extends Jt{constructor(n,s=1){super(),this.type="Light",this.color=new Re(n),this.intensity=s}dispose(){}copy(n){return super.copy(n),this.color.copy(n.color),this.intensity=n.intensity,this}toJSON(n){const s=super.toJSON(n);return s.object.color=this.color.getHex(),s.object.intensity=this.intensity,void 0!==this.groundColor&&(s.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(s.object.distance=this.distance),void 0!==this.angle&&(s.object.angle=this.angle),void 0!==this.decay&&(s.object.decay=this.decay),void 0!==this.penumbra&&(s.object.penumbra=this.penumbra),void 0!==this.shadow&&(s.object.shadow=this.shadow.toJSON()),s}}Ys.prototype.isLight=!0;(class _r extends Ys{constructor(n,s,a){super(n,a),this.type="HemisphereLight",this.position.copy(Jt.DefaultUp),this.updateMatrix(),this.groundColor=new Re(s)}copy(n){return Ys.prototype.copy.call(this,n),this.groundColor.copy(n.groundColor),this}}).prototype.isHemisphereLight=!0;const qx=new $e,Xx=new k,Rp=new k;class uh{constructor(n){this.camera=n,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new he(512,512),this.map=null,this.mapPass=null,this.matrix=new $e,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new yd,this._frameExtents=new he(1,1),this._viewportCount=1,this._viewports=[new jt(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(n){const s=this.camera,a=this.matrix;Xx.setFromMatrixPosition(n.matrixWorld),s.position.copy(Xx),Rp.setFromMatrixPosition(n.target.matrixWorld),s.lookAt(Rp),s.updateMatrixWorld(),qx.multiplyMatrices(s.projectionMatrix,s.matrixWorldInverse),this._frustum.setFromProjectionMatrix(qx),a.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),a.multiply(s.projectionMatrix),a.multiply(s.matrixWorldInverse)}getViewport(n){return this._viewports[n]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(n){return this.camera=n.camera.clone(),this.bias=n.bias,this.radius=n.radius,this.mapSize.copy(n.mapSize),this}clone(){return(new this.constructor).copy(this)}toJSON(){const n={};return 0!==this.bias&&(n.bias=this.bias),0!==this.normalBias&&(n.normalBias=this.normalBias),1!==this.radius&&(n.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(n.mapSize=this.mapSize.toArray()),n.camera=this.camera.toJSON(!1).object,delete n.camera.matrix,n}}class Ip extends uh{constructor(){super(new zn(50,1,.5,500)),this.focus=1}updateMatrices(n){const s=this.camera,a=2*as*n.angle*this.focus,c=this.mapSize.width/this.mapSize.height,u=n.distance||s.far;(a!==s.fov||c!==s.aspect||u!==s.far)&&(s.fov=a,s.aspect=c,s.far=u,s.updateProjectionMatrix()),super.updateMatrices(n)}copy(n){return super.copy(n),this.focus=n.focus,this}}Ip.prototype.isSpotLightShadow=!0;(class By extends Ys{constructor(n,s,a=0,c=Math.PI/3,u=0,f=1){super(n,s),this.type="SpotLight",this.position.copy(Jt.DefaultUp),this.updateMatrix(),this.target=new Jt,this.distance=a,this.angle=c,this.penumbra=u,this.decay=f,this.shadow=new Ip}get power(){return this.intensity*Math.PI}set power(n){this.intensity=n/Math.PI}dispose(){this.shadow.dispose()}copy(n){return super.copy(n),this.distance=n.distance,this.angle=n.angle,this.penumbra=n.penumbra,this.decay=n.decay,this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}}).prototype.isSpotLight=!0;const Zx=new $e,Vl=new k,dh=new k;class Uy extends uh{constructor(){super(new zn(90,1,.5,500)),this._frameExtents=new he(4,2),this._viewportCount=6,this._viewports=[new jt(2,1,1,1),new jt(0,1,1,1),new jt(3,1,1,1),new jt(1,1,1,1),new jt(3,0,1,1),new jt(1,0,1,1)],this._cubeDirections=[new k(1,0,0),new k(-1,0,0),new k(0,0,1),new k(0,0,-1),new k(0,1,0),new k(0,-1,0)],this._cubeUps=[new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,1,0),new k(0,0,1),new k(0,0,-1)]}updateMatrices(n,s=0){const a=this.camera,c=this.matrix,u=n.distance||a.far;u!==a.far&&(a.far=u,a.updateProjectionMatrix()),Vl.setFromMatrixPosition(n.matrixWorld),a.position.copy(Vl),dh.copy(a.position),dh.add(this._cubeDirections[s]),a.up.copy(this._cubeUps[s]),a.lookAt(dh),a.updateMatrixWorld(),c.makeTranslation(-Vl.x,-Vl.y,-Vl.z),Zx.multiplyMatrices(a.projectionMatrix,a.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Zx)}}Uy.prototype.isPointLightShadow=!0;(class hh extends Ys{constructor(n,s,a=0,c=1){super(n,s),this.type="PointLight",this.distance=a,this.decay=c,this.shadow=new Uy}get power(){return 4*this.intensity*Math.PI}set power(n){this.intensity=n/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(n){return super.copy(n),this.distance=n.distance,this.decay=n.decay,this.shadow=n.shadow.clone(),this}}).prototype.isPointLight=!0;class Hy extends uh{constructor(){super(new Cd(-5,5,5,-5,.5,500))}}Hy.prototype.isDirectionalLightShadow=!0;(class Vy extends Ys{constructor(n,s){super(n,s),this.type="DirectionalLight",this.position.copy(Jt.DefaultUp),this.updateMatrix(),this.target=new Jt,this.shadow=new Hy}dispose(){this.shadow.dispose()}copy(n){return super.copy(n),this.target=n.target.clone(),this.shadow=n.shadow.clone(),this}}).prototype.isDirectionalLight=!0;(class zy extends Ys{constructor(n,s){super(n,s),this.type="AmbientLight"}}).prototype.isAmbientLight=!0;(class Gy extends Ys{constructor(n,s,a=10,c=10){super(n,s),this.type="RectAreaLight",this.width=a,this.height=c}get power(){return this.intensity*this.width*this.height*Math.PI}set power(n){this.intensity=n/(this.width*this.height*Math.PI)}copy(n){return super.copy(n),this.width=n.width,this.height=n.height,this}toJSON(n){const s=super.toJSON(n);return s.object.width=this.width,s.object.height=this.height,s}}).prototype.isRectAreaLight=!0;class Wy{constructor(){this.coefficients=[];for(let n=0;n<9;n++)this.coefficients.push(new k)}set(n){for(let s=0;s<9;s++)this.coefficients[s].copy(n[s]);return this}zero(){for(let n=0;n<9;n++)this.coefficients[n].set(0,0,0);return this}getAt(n,s){const a=n.x,c=n.y,u=n.z,f=this.coefficients;return s.copy(f[0]).multiplyScalar(.282095),s.addScaledVector(f[1],.488603*c),s.addScaledVector(f[2],.488603*u),s.addScaledVector(f[3],.488603*a),s.addScaledVector(f[4],a*c*1.092548),s.addScaledVector(f[5],c*u*1.092548),s.addScaledVector(f[6],.315392*(3*u*u-1)),s.addScaledVector(f[7],a*u*1.092548),s.addScaledVector(f[8],.546274*(a*a-c*c)),s}getIrradianceAt(n,s){const a=n.x,c=n.y,u=n.z,f=this.coefficients;return s.copy(f[0]).multiplyScalar(.886227),s.addScaledVector(f[1],1.023328*c),s.addScaledVector(f[2],1.023328*u),s.addScaledVector(f[3],1.023328*a),s.addScaledVector(f[4],.858086*a*c),s.addScaledVector(f[5],.858086*c*u),s.addScaledVector(f[6],.743125*u*u-.247708),s.addScaledVector(f[7],.858086*a*u),s.addScaledVector(f[8],.429043*(a*a-c*c)),s}add(n){for(let s=0;s<9;s++)this.coefficients[s].add(n.coefficients[s]);return this}addScaledSH(n,s){for(let a=0;a<9;a++)this.coefficients[a].addScaledVector(n.coefficients[a],s);return this}scale(n){for(let s=0;s<9;s++)this.coefficients[s].multiplyScalar(n);return this}lerp(n,s){for(let a=0;a<9;a++)this.coefficients[a].lerp(n.coefficients[a],s);return this}equals(n){for(let s=0;s<9;s++)if(!this.coefficients[s].equals(n.coefficients[s]))return!1;return!0}copy(n){return this.set(n.coefficients)}clone(){return(new this.constructor).copy(this)}fromArray(n,s=0){const a=this.coefficients;for(let c=0;c<9;c++)a[c].fromArray(n,s+3*c);return this}toArray(n=[],s=0){const a=this.coefficients;for(let c=0;c<9;c++)a[c].toArray(n,s+3*c);return n}static getBasisAt(n,s){const a=n.x,c=n.y,u=n.z;s[0]=.282095,s[1]=.488603*c,s[2]=.488603*u,s[3]=.488603*a,s[4]=1.092548*a*c,s[5]=1.092548*c*u,s[6]=.315392*(3*u*u-1),s[7]=1.092548*a*u,s[8]=.546274*(a*a-c*c)}}Wy.prototype.isSphericalHarmonics3=!0;class fh extends Ys{constructor(n=new Wy,s=1){super(void 0,s),this.sh=n}copy(n){return super.copy(n),this.sh.copy(n.sh),this}fromJSON(n){return this.intensity=n.intensity,this.sh.fromArray(n.sh),this}toJSON(n){const s=super.toJSON(n);return s.object.sh=this.sh.toArray(),s}}fh.prototype.isLightProbe=!0;let oi;(class jy extends Ye{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(n){return super.copy(n),this.instanceCount=n.instanceCount,this}clone(){return(new this.constructor).copy(this)}toJSON(){const n=super.toJSON(this);return n.instanceCount=this.instanceCount,n.isInstancedBufferGeometry=!0,n}}).prototype.isInstancedBufferGeometry=!0,class Su extends Xs{constructor(n){super(n),"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(n){return this.options=n,this}load(n,s,a,c){void 0===n&&(n=""),void 0!==this.path&&(n=this.path+n),n=this.manager.resolveURL(n);const u=this,f=Ul.get(n);if(void 0!==f)return u.manager.itemStart(n),setTimeout(function(){s&&s(f),u.manager.itemEnd(n)},0),f;const m={};m.credentials="anonymous"===this.crossOrigin?"same-origin":"include",m.headers=this.requestHeader,fetch(n,m).then(function(y){return y.blob()}).then(function(y){return createImageBitmap(y,Object.assign(u.options,{colorSpaceConversion:"none"}))}).then(function(y){Ul.add(n,y),s&&s(y),u.manager.itemEnd(n)}).catch(function(y){c&&c(y),u.manager.itemError(n),u.manager.itemEnd(n)}),u.manager.itemStart(n)}}.prototype.isImageBitmapLoader=!0;class gh extends Xs{constructor(n){super(n)}load(n,s,a,c){const u=this,f=new Lo(this.manager);f.setResponseType("arraybuffer"),f.setPath(this.path),f.setRequestHeader(this.requestHeader),f.setWithCredentials(this.withCredentials),f.load(n,function(m){try{const y=m.slice(0);(void 0===oi&&(oi=new(window.AudioContext||window.webkitAudioContext)),oi).decodeAudioData(y,function(_){s(_)})}catch(y){c?c(y):console.error(y),u.manager.itemError(n)}},a,c)}}(class xr extends fh{constructor(n,s,a=1){super(void 0,a);const c=(new Re).set(n),u=(new Re).set(s),f=new k(c.r,c.g,c.b),m=new k(u.r,u.g,u.b),y=Math.sqrt(Math.PI),v=y*Math.sqrt(.75);this.sh.coefficients[0].copy(f).add(m).multiplyScalar(y),this.sh.coefficients[1].copy(f).sub(m).multiplyScalar(v)}}).prototype.isHemisphereLightProbe=!0,class Pp extends fh{constructor(n,s=1){super(void 0,s);const a=(new Re).set(n);this.sh.coefficients[0].set(a.r,a.g,a.b).multiplyScalar(2*Math.sqrt(Math.PI))}}.prototype.isAmbientLightProbe=!0;class ba{constructor(n=!0){this.autoStart=n,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=Ma(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let n=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const s=Ma();n=(s-this.oldTime)/1e3,this.oldTime=s,this.elapsedTime+=n}return n}}function Ma(){return("undefined"==typeof performance?Date:performance).now()}class Jx{constructor(n,s,a){let c,u,f;switch(this.binding=n,this.valueSize=a,s){case"quaternion":c=this._slerp,u=this._slerpAdditive,f=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*a),this._workIndex=5;break;case"string":case"bool":c=this._select,u=this._select,f=this._setAdditiveIdentityOther,this.buffer=new Array(5*a);break;default:c=this._lerp,u=this._lerpAdditive,f=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*a)}this._mixBufferRegion=c,this._mixBufferRegionAdditive=u,this._setIdentity=f,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(n,s){const a=this.buffer,c=this.valueSize,u=n*c+c;let f=this.cumulativeWeight;if(0===f){for(let m=0;m!==c;++m)a[u+m]=a[m];f=s}else f+=s,this._mixBufferRegion(a,u,0,s/f,c);this.cumulativeWeight=f}accumulateAdditive(n){const s=this.buffer,a=this.valueSize,c=a*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(s,c,0,n,a),this.cumulativeWeightAdditive+=n}apply(n){const s=this.valueSize,a=this.buffer,c=n*s+s,u=this.cumulativeWeight,f=this.cumulativeWeightAdditive,m=this.binding;this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,u<1&&this._mixBufferRegion(a,c,s*this._origIndex,1-u,s),f>0&&this._mixBufferRegionAdditive(a,c,this._addIndex*s,1,s);for(let y=s,v=s+s;y!==v;++y)if(a[y]!==a[y+s]){m.setValue(a,c);break}}saveOriginalState(){const s=this.buffer,a=this.valueSize,c=a*this._origIndex;this.binding.getValue(s,c);for(let u=a,f=c;u!==f;++u)s[u]=s[c+u%a];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){this.binding.setValue(this.buffer,3*this.valueSize)}_setAdditiveIdentityNumeric(){const n=this._addIndex*this.valueSize,s=n+this.valueSize;for(let a=n;a<s;a++)this.buffer[a]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const n=this._origIndex*this.valueSize,s=this._addIndex*this.valueSize;for(let a=0;a<this.valueSize;a++)this.buffer[s+a]=this.buffer[n+a]}_select(n,s,a,c,u){if(c>=.5)for(let f=0;f!==u;++f)n[s+f]=n[a+f]}_slerp(n,s,a,c){un.slerpFlat(n,s,n,s,n,a,c)}_slerpAdditive(n,s,a,c,u){const f=this._workIndex*u;un.multiplyQuaternionsFlat(n,f,n,s,n,a),un.slerpFlat(n,s,n,s,n,f,c)}_lerp(n,s,a,c,u){const f=1-c;for(let m=0;m!==u;++m){const y=s+m;n[y]=n[y]*f+n[a+m]*c}}_lerpAdditive(n,s,a,c,u){for(let f=0;f!==u;++f){const m=s+f;n[m]=n[m]+n[a+f]*c}}}const Gl="\\[\\]\\.:\\/",ew=new RegExp("["+Gl+"]","g"),Cu="[^"+Gl+"]",Zy="[^"+Gl.replace("\\.","")+"]",tw=/((?:WC+[\/:])*)/.source.replace("WC",Cu),nw=/(WCOD+)?/.source.replace("WCOD",Zy),Yy=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Cu),iw=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Cu),Qy=new RegExp("^"+tw+nw+Yy+iw+"$"),rw=["material","materials","bones"];class sw{constructor(n,s,a){const c=a||En.parseTrackName(s);this._targetGroup=n,this._bindings=n.subscribe_(s,c)}getValue(n,s){this.bind();const c=this._bindings[this._targetGroup.nCachedObjects_];void 0!==c&&c.getValue(n,s)}setValue(n,s){const a=this._bindings;for(let c=this._targetGroup.nCachedObjects_,u=a.length;c!==u;++c)a[c].setValue(n,s)}bind(){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=n.length;s!==a;++s)n[s].bind()}unbind(){const n=this._bindings;for(let s=this._targetGroup.nCachedObjects_,a=n.length;s!==a;++s)n[s].unbind()}}let En=(()=>{class h{constructor(s,a,c){this.path=a,this.parsedPath=c||h.parseTrackName(a),this.node=h.findNode(s,this.parsedPath.nodeName)||s,this.rootNode=s,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(s,a,c){return s&&s.isAnimationObjectGroup?new h.Composite(s,a,c):new h(s,a,c)}static sanitizeNodeName(s){return s.replace(/\s/g,"_").replace(ew,"")}static parseTrackName(s){const a=Qy.exec(s);if(null===a)throw new Error("PropertyBinding: Cannot parse trackName: "+s);const c={nodeName:a[2],objectName:a[3],objectIndex:a[4],propertyName:a[5],propertyIndex:a[6]},u=c.nodeName&&c.nodeName.lastIndexOf(".");if(void 0!==u&&-1!==u){const f=c.nodeName.substring(u+1);-1!==rw.indexOf(f)&&(c.nodeName=c.nodeName.substring(0,u),c.objectName=f)}if(null===c.propertyName||0===c.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+s);return c}static findNode(s,a){if(void 0===a||""===a||"."===a||-1===a||a===s.name||a===s.uuid)return s;if(s.skeleton){const c=s.skeleton.getBoneByName(a);if(void 0!==c)return c}if(s.children){const c=function(f){for(let m=0;m<f.length;m++){const y=f[m];if(y.name===a||y.uuid===a)return y;const v=c(y.children);if(v)return v}return null},u=c(s.children);if(u)return u}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(s,a){s[a]=this.targetObject[this.propertyName]}_getValue_array(s,a){const c=this.resolvedProperty;for(let u=0,f=c.length;u!==f;++u)s[a++]=c[u]}_getValue_arrayElement(s,a){s[a]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(s,a){this.resolvedProperty.toArray(s,a)}_setValue_direct(s,a){this.targetObject[this.propertyName]=s[a]}_setValue_direct_setNeedsUpdate(s,a){this.targetObject[this.propertyName]=s[a],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(s,a){this.targetObject[this.propertyName]=s[a],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(s,a){const c=this.resolvedProperty;for(let u=0,f=c.length;u!==f;++u)c[u]=s[a++]}_setValue_array_setNeedsUpdate(s,a){const c=this.resolvedProperty;for(let u=0,f=c.length;u!==f;++u)c[u]=s[a++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(s,a){const c=this.resolvedProperty;for(let u=0,f=c.length;u!==f;++u)c[u]=s[a++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(s,a){this.resolvedProperty[this.propertyIndex]=s[a]}_setValue_arrayElement_setNeedsUpdate(s,a){this.resolvedProperty[this.propertyIndex]=s[a],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(s,a){this.resolvedProperty[this.propertyIndex]=s[a],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(s,a){this.resolvedProperty.fromArray(s,a)}_setValue_fromArray_setNeedsUpdate(s,a){this.resolvedProperty.fromArray(s,a),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(s,a){this.resolvedProperty.fromArray(s,a),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(s,a){this.bind(),this.getValue(s,a)}_setValue_unbound(s,a){this.bind(),this.setValue(s,a)}bind(){let s=this.node;const a=this.parsedPath,c=a.objectName,u=a.propertyName;let f=a.propertyIndex;if(s||(s=h.findNode(this.rootNode,a.nodeName)||this.rootNode,this.node=s),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!s)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(c){let _=a.objectIndex;switch(c){case"materials":if(!s.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!s.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);s=s.material.materials;break;case"bones":if(!s.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);s=s.skeleton.bones;for(let w=0;w<s.length;w++)if(s[w].name===_){_=w;break}break;default:if(void 0===s[c])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);s=s[c]}if(void 0!==_){if(void 0===s[_])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,s);s=s[_]}}const m=s[u];if(void 0===m)return void console.error("THREE.PropertyBinding: Trying to update property for track: "+a.nodeName+"."+u+" but it wasn't found.",s);let y=this.Versioning.None;this.targetObject=s,void 0!==s.needsUpdate?y=this.Versioning.NeedsUpdate:void 0!==s.matrixWorldNeedsUpdate&&(y=this.Versioning.MatrixWorldNeedsUpdate);let v=this.BindingType.Direct;if(void 0!==f){if("morphTargetInfluences"===u){if(!s.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!s.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!s.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==s.morphTargetDictionary[f]&&(f=s.morphTargetDictionary[f])}v=this.BindingType.ArrayElement,this.resolvedProperty=m,this.propertyIndex=f}else void 0!==m.fromArray&&void 0!==m.toArray?(v=this.BindingType.HasFromToArray,this.resolvedProperty=m):Array.isArray(m)?(v=this.BindingType.EntireArray,this.resolvedProperty=m):this.propertyName=u;this.getValue=this.GetterByBindingType[v],this.setValue=this.SetterByBindingTypeAndVersioning[v][y]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}return h.Composite=sw,h})();En.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},En.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},En.prototype.GetterByBindingType=[En.prototype._getValue_direct,En.prototype._getValue_array,En.prototype._getValue_arrayElement,En.prototype._getValue_toArray],En.prototype.SetterByBindingTypeAndVersioning=[[En.prototype._setValue_direct,En.prototype._setValue_direct_setNeedsUpdate,En.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[En.prototype._setValue_array,En.prototype._setValue_array_setNeedsUpdate,En.prototype._setValue_array_setMatrixWorldNeedsUpdate],[En.prototype._setValue_arrayElement,En.prototype._setValue_arrayElement_setNeedsUpdate,En.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[En.prototype._setValue_fromArray,En.prototype._setValue_fromArray_setNeedsUpdate,En.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class Fp{constructor(n,s,a=null,c=s.blendMode){this._mixer=n,this._clip=s,this._localRoot=a,this.blendMode=c;const u=s.tracks,f=u.length,m=new Array(f),y={endingStart:Fs,endingEnd:Fs};for(let v=0;v!==f;++v){const _=u[v].createInterpolant(null);m[v]=_,_.settings=y}this._interpolantSettings=y,this._interpolants=m,this._propertyBindings=new Array(f),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(n){return this._startTime=n,this}setLoop(n,s){return this.loop=n,this.repetitions=s,this}setEffectiveWeight(n){return this.weight=n,this._effectiveWeight=this.enabled?n:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(n){return this._scheduleFading(n,0,1)}fadeOut(n){return this._scheduleFading(n,1,0)}crossFadeFrom(n,s,a){if(n.fadeOut(s),this.fadeIn(s),a){const c=this._clip.duration,u=n._clip.duration,m=c/u;n.warp(1,u/c,s),this.warp(m,1,s)}return this}crossFadeTo(n,s,a){return n.crossFadeFrom(this,s,a)}stopFading(){const n=this._weightInterpolant;return null!==n&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(n)),this}setEffectiveTimeScale(n){return this.timeScale=n,this._effectiveTimeScale=this.paused?0:n,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(n){return this.timeScale=this._clip.duration/n,this.stopWarping()}syncWith(n){return this.time=n.time,this.timeScale=n.timeScale,this.stopWarping()}halt(n){return this.warp(this._effectiveTimeScale,0,n)}warp(n,s,a){const c=this._mixer,u=c.time,f=this.timeScale;let m=this._timeScaleInterpolant;null===m&&(m=c._lendControlInterpolant(),this._timeScaleInterpolant=m);const y=m.parameterPositions,v=m.sampleValues;return y[0]=u,y[1]=u+a,v[0]=n/f,v[1]=s/f,this}stopWarping(){const n=this._timeScaleInterpolant;return null!==n&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(n)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(n,s,a,c){if(!this.enabled)return void this._updateWeight(n);const u=this._startTime;if(null!==u){const y=(n-u)*a;if(y<0||0===a)return;this._startTime=null,s=a*y}s*=this._updateTimeScale(n);const f=this._updateTime(s),m=this._updateWeight(n);if(m>0){const y=this._interpolants,v=this._propertyBindings;if(2501===this.blendMode)for(let _=0,w=y.length;_!==w;++_)y[_].evaluate(f),v[_].accumulateAdditive(m);else for(let _=0,w=y.length;_!==w;++_)y[_].evaluate(f),v[_].accumulate(c,m)}}_updateWeight(n){let s=0;if(this.enabled){s=this.weight;const a=this._weightInterpolant;if(null!==a){const c=a.evaluate(n)[0];s*=c,n>a.parameterPositions[1]&&(this.stopFading(),0===c&&(this.enabled=!1))}}return this._effectiveWeight=s,s}_updateTimeScale(n){let s=0;if(!this.paused){s=this.timeScale;const a=this._timeScaleInterpolant;null!==a&&(s*=a.evaluate(n)[0],n>a.parameterPositions[1]&&(this.stopWarping(),0===s?this.paused=!0:this.timeScale=s))}return this._effectiveTimeScale=s,s}_updateTime(n){const s=this._clip.duration,a=this.loop;let c=this.time+n,u=this._loopCount;const f=2202===a;if(0===n)return-1===u?c:f&&1==(1&u)?s-c:c;if(2200===a){-1===u&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(c>=s)c=s;else{if(!(c<0)){this.time=c;break e}c=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=c,this._mixer.dispatchEvent({type:"finished",action:this,direction:n<0?-1:1})}}else{if(-1===u&&(n>=0?(u=0,this._setEndings(!0,0===this.repetitions,f)):this._setEndings(0===this.repetitions,!0,f)),c>=s||c<0){const m=Math.floor(c/s);c-=s*m,u+=Math.abs(m);const y=this.repetitions-u;if(y<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,c=n>0?s:0,this.time=c,this._mixer.dispatchEvent({type:"finished",action:this,direction:n>0?1:-1});else{if(1===y){const v=n<0;this._setEndings(v,!v,f)}else this._setEndings(!1,!1,f);this._loopCount=u,this.time=c,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:m})}}else this.time=c;if(f&&1==(1&u))return s-c}return c}_setEndings(n,s,a){const c=this._interpolantSettings;a?(c.endingStart=hi,c.endingEnd=hi):(c.endingStart=n?this.zeroSlopeAtStart?hi:Fs:2402,c.endingEnd=s?this.zeroSlopeAtEnd?hi:Fs:2402)}_scheduleFading(n,s,a){const c=this._mixer,u=c.time;let f=this._weightInterpolant;null===f&&(f=c._lendControlInterpolant(),this._weightInterpolant=f);const m=f.parameterPositions,y=f.sampleValues;return m[0]=u,y[0]=s,m[1]=u+n,y[1]=a,this}}(class Np extends ia{constructor(n){super(),this._root=n,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(n,s){const a=n._localRoot||this._root,c=n._clip.tracks,u=c.length,f=n._propertyBindings,m=n._interpolants,y=a.uuid,v=this._bindingsByRootAndName;let _=v[y];void 0===_&&(_={},v[y]=_);for(let w=0;w!==u;++w){const b=c[w],M=b.name;let C=_[M];if(void 0!==C)++C.referenceCount,f[w]=C;else{if(C=f[w],void 0!==C){null===C._cacheIndex&&(++C.referenceCount,this._addInactiveBinding(C,y,M));continue}C=new Jx(En.create(a,M,s&&s._propertyBindings[w].binding.parsedPath),b.ValueTypeName,b.getValueSize()),++C.referenceCount,this._addInactiveBinding(C,y,M),f[w]=C}m[w].resultBuffer=C.buffer}}_activateAction(n){if(!this._isActiveAction(n)){if(null===n._cacheIndex){const a=(n._localRoot||this._root).uuid,c=n._clip.uuid,u=this._actionsByClip[c];this._bindAction(n,u&&u.knownActions[0]),this._addInactiveAction(n,c,a)}const s=n._propertyBindings;for(let a=0,c=s.length;a!==c;++a){const u=s[a];0==u.useCount++&&(this._lendBinding(u),u.saveOriginalState())}this._lendAction(n)}}_deactivateAction(n){if(this._isActiveAction(n)){const s=n._propertyBindings;for(let a=0,c=s.length;a!==c;++a){const u=s[a];0==--u.useCount&&(u.restoreOriginalState(),this._takeBackBinding(u))}this._takeBackAction(n)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const n=this;this.stats={actions:{get total(){return n._actions.length},get inUse(){return n._nActiveActions}},bindings:{get total(){return n._bindings.length},get inUse(){return n._nActiveBindings}},controlInterpolants:{get total(){return n._controlInterpolants.length},get inUse(){return n._nActiveControlInterpolants}}}}_isActiveAction(n){const s=n._cacheIndex;return null!==s&&s<this._nActiveActions}_addInactiveAction(n,s,a){const c=this._actions,u=this._actionsByClip;let f=u[s];if(void 0===f)f={knownActions:[n],actionByRoot:{}},n._byClipCacheIndex=0,u[s]=f;else{const m=f.knownActions;n._byClipCacheIndex=m.length,m.push(n)}n._cacheIndex=c.length,c.push(n),f.actionByRoot[a]=n}_removeInactiveAction(n){const s=this._actions,a=s[s.length-1],c=n._cacheIndex;a._cacheIndex=c,s[c]=a,s.pop(),n._cacheIndex=null;const u=n._clip.uuid,f=this._actionsByClip,m=f[u],y=m.knownActions,v=y[y.length-1],_=n._byClipCacheIndex;v._byClipCacheIndex=_,y[_]=v,y.pop(),n._byClipCacheIndex=null,delete m.actionByRoot[(n._localRoot||this._root).uuid],0===y.length&&delete f[u],this._removeInactiveBindingsForAction(n)}_removeInactiveBindingsForAction(n){const s=n._propertyBindings;for(let a=0,c=s.length;a!==c;++a){const u=s[a];0==--u.referenceCount&&this._removeInactiveBinding(u)}}_lendAction(n){const s=this._actions,a=n._cacheIndex,c=this._nActiveActions++,u=s[c];n._cacheIndex=c,s[c]=n,u._cacheIndex=a,s[a]=u}_takeBackAction(n){const s=this._actions,a=n._cacheIndex,c=--this._nActiveActions,u=s[c];n._cacheIndex=c,s[c]=n,u._cacheIndex=a,s[a]=u}_addInactiveBinding(n,s,a){const c=this._bindingsByRootAndName,u=this._bindings;let f=c[s];void 0===f&&(f={},c[s]=f),f[a]=n,n._cacheIndex=u.length,u.push(n)}_removeInactiveBinding(n){const s=this._bindings,a=n.binding,c=a.rootNode.uuid,u=a.path,f=this._bindingsByRootAndName,m=f[c],y=s[s.length-1],v=n._cacheIndex;y._cacheIndex=v,s[v]=y,s.pop(),delete m[u],0===Object.keys(m).length&&delete f[c]}_lendBinding(n){const s=this._bindings,a=n._cacheIndex,c=this._nActiveBindings++,u=s[c];n._cacheIndex=c,s[c]=n,u._cacheIndex=a,s[a]=u}_takeBackBinding(n){const s=this._bindings,a=n._cacheIndex,c=--this._nActiveBindings,u=s[c];n._cacheIndex=c,s[c]=n,u._cacheIndex=a,s[a]=u}_lendControlInterpolant(){const n=this._controlInterpolants,s=this._nActiveControlInterpolants++;let a=n[s];return void 0===a&&(a=new Ny(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),a.__cacheIndex=s,n[s]=a),a}_takeBackControlInterpolant(n){const s=this._controlInterpolants,a=n.__cacheIndex,c=--this._nActiveControlInterpolants,u=s[c];n.__cacheIndex=c,s[c]=n,u.__cacheIndex=a,s[a]=u}clipAction(n,s,a){const c=s||this._root,u=c.uuid;let f="string"==typeof n?ch.findByName(c,n):n;const m=null!==f?f.uuid:n,y=this._actionsByClip[m];let v=null;if(void 0===a&&(a=null!==f?f.blendMode:2500),void 0!==y){const w=y.actionByRoot[u];if(void 0!==w&&w.blendMode===a)return w;v=y.knownActions[0],null===f&&(f=v._clip)}if(null===f)return null;const _=new Fp(this,f,s,a);return this._bindAction(_,v),this._addInactiveAction(_,m,u),_}existingAction(n,s){const a=s||this._root,c=a.uuid,u="string"==typeof n?ch.findByName(a,n):n,m=this._actionsByClip[u?u.uuid:n];return void 0!==m&&m.actionByRoot[c]||null}stopAllAction(){const n=this._actions;for(let a=this._nActiveActions-1;a>=0;--a)n[a].stop();return this}update(n){const s=this._actions,a=this._nActiveActions,c=this.time+=n*=this.timeScale,u=Math.sign(n),f=this._accuIndex^=1;for(let v=0;v!==a;++v)s[v]._update(c,n,u,f);const m=this._bindings,y=this._nActiveBindings;for(let v=0;v!==y;++v)m[v].apply(f);return this}setTime(n){this.time=0;for(let s=0;s<this._actions.length;s++)this._actions[s].time=0;return this.update(n)}getRoot(){return this._root}uncacheClip(n){const s=this._actions,a=n.uuid,c=this._actionsByClip,u=c[a];if(void 0!==u){const f=u.knownActions;for(let m=0,y=f.length;m!==y;++m){const v=f[m];this._deactivateAction(v);const _=v._cacheIndex,w=s[s.length-1];v._cacheIndex=null,v._byClipCacheIndex=null,w._cacheIndex=_,s[_]=w,s.pop(),this._removeInactiveBindingsForAction(v)}delete c[a]}}uncacheRoot(n){const s=n.uuid,a=this._actionsByClip;for(const f in a){const y=a[f].actionByRoot[s];void 0!==y&&(this._deactivateAction(y),this._removeInactiveAction(y))}const u=this._bindingsByRootAndName[s];if(void 0!==u)for(const f in u){const m=u[f];m.restoreOriginalState(),this._removeInactiveBinding(m)}}uncacheAction(n,s){const a=this.existingAction(n,s);null!==a&&(this._deactivateAction(a),this._removeInactiveAction(a))}}).prototype._controlInterpolantsResultBuffer=new Float32Array(1);class Op{constructor(n){"string"==typeof n&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),n=arguments[1]),this.value=n}clone(){return new Op(void 0===this.value.clone?this.value:this.value.clone())}}(class YE extends xl{constructor(n,s,a=1){super(n,s),this.meshPerAttribute=a}copy(n){return super.copy(n),this.meshPerAttribute=n.meshPerAttribute,this}clone(n){const s=super.clone(n);return s.meshPerAttribute=this.meshPerAttribute,s}toJSON(n){const s=super.toJSON(n);return s.isInstancedInterleavedBuffer=!0,s.meshPerAttribute=this.meshPerAttribute,s}}).prototype.isInstancedInterleavedBuffer=!0;class KE{constructor(n=1,s=0,a=0){return this.radius=n,this.phi=s,this.theta=a,this}set(n,s,a){return this.radius=n,this.phi=s,this.theta=a,this}copy(n){return this.radius=n.radius,this.phi=n.phi,this.theta=n.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(n){return this.setFromCartesianCoords(n.x,n.y,n.z)}setFromCartesianCoords(n,s,a){return this.radius=Math.sqrt(n*n+s*s+a*a),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(n,a),this.phi=Math.acos(wn(s/this.radius,-1,1))),this}clone(){return(new this.constructor).copy(this)}}const Sa=new he;class Du{constructor(n=new he(1/0,1/0),s=new he(-1/0,-1/0)){this.min=n,this.max=s}set(n,s){return this.min.copy(n),this.max.copy(s),this}setFromPoints(n){this.makeEmpty();for(let s=0,a=n.length;s<a;s++)this.expandByPoint(n[s]);return this}setFromCenterAndSize(n,s){const a=Sa.copy(s).multiplyScalar(.5);return this.min.copy(n).sub(a),this.max.copy(n).add(a),this}clone(){return(new this.constructor).copy(this)}copy(n){return this.min.copy(n.min),this.max.copy(n.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(n){return this.isEmpty()?n.set(0,0):n.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(n){return this.isEmpty()?n.set(0,0):n.subVectors(this.max,this.min)}expandByPoint(n){return this.min.min(n),this.max.max(n),this}expandByVector(n){return this.min.sub(n),this.max.add(n),this}expandByScalar(n){return this.min.addScalar(-n),this.max.addScalar(n),this}containsPoint(n){return!(n.x<this.min.x||n.x>this.max.x||n.y<this.min.y||n.y>this.max.y)}containsBox(n){return this.min.x<=n.min.x&&n.max.x<=this.max.x&&this.min.y<=n.min.y&&n.max.y<=this.max.y}getParameter(n,s){return s.set((n.x-this.min.x)/(this.max.x-this.min.x),(n.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(n){return!(n.max.x<this.min.x||n.min.x>this.max.x||n.max.y<this.min.y||n.min.y>this.max.y)}clampPoint(n,s){return s.copy(n).clamp(this.min,this.max)}distanceToPoint(n){return Sa.copy(n).clamp(this.min,this.max).sub(n).length()}intersect(n){return this.min.max(n.min),this.max.min(n.max),this}union(n){return this.min.min(n.min),this.max.max(n.max),this}translate(n){return this.min.add(n),this.max.add(n),this}equals(n){return n.min.equals(this.min)&&n.max.equals(this.max)}}Du.prototype.isBox2=!0;const Qs=new k,_h=new $e,Bp=new $e;function ev(h){const n=[];!0===h.isBone&&n.push(h);for(let s=0;s<h.children.length;s++)n.push.apply(n,ev(h.children[s]));return n}const zp=new ArrayBuffer(4),zr=(new Float32Array(zp),new Uint32Array(zp),new Uint32Array(512)),Mr=new Uint32Array(512);for(let h=0;h<256;++h){const n=h-127;n<-27?(zr[h]=0,zr[256|h]=32768,Mr[h]=24,Mr[256|h]=24):n<-14?(zr[h]=1024>>-n-14,zr[256|h]=1024>>-n-14|32768,Mr[h]=-n-1,Mr[256|h]=-n-1):n<=15?(zr[h]=n+15<<10,zr[256|h]=n+15<<10|32768,Mr[h]=13,Mr[256|h]=13):n<128?(zr[h]=31744,zr[256|h]=64512,Mr[h]=24,Mr[256|h]=24):(zr[h]=31744,zr[256|h]=64512,Mr[h]=13,Mr[256|h]=13)}const Mh=new Uint32Array(2048),Uo=new Uint32Array(64),Wp=new Uint32Array(64);for(let h=1;h<1024;++h){let n=h<<13,s=0;for(;0==(8388608&n);)n<<=1,s-=8388608;n&=-8388609,s+=947912704,Mh[h]=n|s}for(let h=1024;h<2048;++h)Mh[h]=939524096+(h-1024<<13);for(let h=1;h<31;++h)Uo[h]=h<<23;Uo[31]=1199570944,Uo[32]=2147483648;for(let h=33;h<63;++h)Uo[h]=2147483648+(h-32<<23);Uo[63]=3347054592;for(let h=1;h<64;++h)32!==h&&(Wp[h]=1024);qi.create=function(h,n){return console.log("THREE.Curve.create() has been deprecated"),h.prototype=Object.create(qi.prototype),h.prototype.constructor=h,h.prototype.getPoint=n,h},Al.prototype.fromPoints=function(h){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(h)},class Hp extends au{constructor(n=10,s=10,a=4473924,c=8947848){a=new Re(a),c=new Re(c);const u=s/2,f=n/s,m=n/2,y=[],v=[];for(let b=0,M=0,C=-m;b<=s;b++,C+=f){y.push(-m,0,C,m,0,C),y.push(C,0,-m,C,0,m);const E=b===u?a:c;E.toArray(v,M),M+=3,E.toArray(v,M),M+=3,E.toArray(v,M),M+=3,E.toArray(v,M),M+=3}const _=new Ye;_.setAttribute("position",new Ve(y,3)),_.setAttribute("color",new Ve(v,3)),super(_,new si({vertexColors:!0,toneMapped:!1})),this.type="GridHelper"}}.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},class aw extends au{constructor(n){const s=ev(n),a=new Ye,c=[],u=[],f=new Re(0,0,1),m=new Re(0,1,0);for(let v=0;v<s.length;v++){const _=s[v];_.parent&&_.parent.isBone&&(c.push(0,0,0),c.push(0,0,0),u.push(f.r,f.g,f.b),u.push(m.r,m.g,m.b))}a.setAttribute("position",new Ve(c,3)),a.setAttribute("color",new Ve(u,3)),super(a,new si({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0})),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=n,this.bones=s,this.matrix=n.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(n){const s=this.bones,a=this.geometry,c=a.getAttribute("position");Bp.copy(this.root.matrixWorld).invert();for(let u=0,f=0;u<s.length;u++){const m=s[u];m.parent&&m.parent.isBone&&(_h.multiplyMatrices(Bp,m.matrixWorld),Qs.setFromMatrixPosition(_h),c.setXYZ(f,Qs.x,Qs.y,Qs.z),_h.multiplyMatrices(Bp,m.parent.matrixWorld),Qs.setFromMatrixPosition(_h),c.setXYZ(f+1,Qs.x,Qs.y,Qs.z),f+=2)}a.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(n)}}.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Xs.prototype.extractUrlBase=function(h){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),class Fo{static decodeText(n){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(n);let s="";for(let a=0,c=n.length;a<c;a++)s+=String.fromCharCode(n[a]);try{return decodeURIComponent(escape(s))}catch(a){return s}}static extractUrlBase(n){const s=n.lastIndexOf("/");return-1===s?"./":n.slice(0,s+1)}static resolveURL(n,s){return"string"!=typeof n||""===n?"":(/^https?:\/\//i.test(s)&&/^\//.test(n)&&(s=s.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(n)||/^data:.*,.*$/i.test(n)||/^blob:.*$/i.test(n)?n:s+n)}}.extractUrlBase(h)},Xs.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Du.prototype.center=function(h){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(h)},Du.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Du.prototype.isIntersectionBox=function(h){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(h)},Du.prototype.size=function(h){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(h)},Ln.prototype.center=function(h){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(h)},Ln.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Ln.prototype.isIntersectionBox=function(h){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(h)},Ln.prototype.isIntersectionSphere=function(h){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(h)},Ln.prototype.size=function(h){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(h)},Us.prototype.toVector3=function(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")},yo.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},yd.prototype.setFromMatrix=function(h){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(h)},Pn.prototype.flattenToArrayOffset=function(h,n){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(h,n)},Pn.prototype.multiplyVector3=function(h){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),h.applyMatrix3(this)},Pn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Pn.prototype.applyToBufferAttribute=function(h){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),h.applyMatrix3(this)},Pn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Pn.prototype.getInverse=function(h){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(h).invert()},$e.prototype.extractPosition=function(h){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(h)},$e.prototype.flattenToArrayOffset=function(h,n){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(h,n)},$e.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new k).setFromMatrixColumn(this,3)},$e.prototype.setRotationFromQuaternion=function(h){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(h)},$e.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},$e.prototype.multiplyVector3=function(h){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),h.applyMatrix4(this)},$e.prototype.multiplyVector4=function(h){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),h.applyMatrix4(this)},$e.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},$e.prototype.rotateAxis=function(h){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),h.transformDirection(this)},$e.prototype.crossVector=function(h){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),h.applyMatrix4(this)},$e.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},$e.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},$e.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},$e.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},$e.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},$e.prototype.applyToBufferAttribute=function(h){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),h.applyMatrix4(this)},$e.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},$e.prototype.makeFrustum=function(h,n,s,a,c,u){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(h,n,a,s,c,u)},$e.prototype.getInverse=function(h){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(h).invert()},rr.prototype.isIntersectionLine=function(h){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(h)},un.prototype.multiplyVector3=function(h){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),h.applyQuaternion(this)},un.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},vo.prototype.isIntersectionBox=function(h){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(h)},vo.prototype.isIntersectionPlane=function(h){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(h)},vo.prototype.isIntersectionSphere=function(h){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(h)},ni.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},ni.prototype.barycoordFromPoint=function(h,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(h,n)},ni.prototype.midpoint=function(h){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(h)},ni.prototypenormal=function(h){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(h)},ni.prototype.plane=function(h){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(h)},ni.barycoordFromPoint=function(h,n,s,a,c){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),ni.getBarycoord(h,n,s,a,c)},ni.normal=function(h,n,s,a){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),ni.getNormal(h,n,s,a)},$s.prototype.extractAllPoints=function(h){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(h)},$s.prototype.extrude=function(h){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Io(this,h)},$s.prototype.makeGeometry=function(h){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new lr(this,h)},he.prototype.fromAttribute=function(h,n,s){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(h,n,s)},he.prototype.distanceToManhattan=function(h){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(h)},he.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},k.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},k.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},k.prototype.getPositionFromMatrix=function(h){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(h)},k.prototype.getScaleFromMatrix=function(h){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(h)},k.prototype.getColumnFromMatrix=function(h,n){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(n,h)},k.prototype.applyProjection=function(h){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(h)},k.prototype.fromAttribute=function(h,n,s){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(h,n,s)},k.prototype.distanceToManhattan=function(h){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(h)},k.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},jt.prototype.fromAttribute=function(h,n,s){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(h,n,s)},jt.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Jt.prototype.getChildByName=function(h){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(h)},Jt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},Jt.prototype.translate=function(h,n){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(n,h)},Jt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},Jt.prototype.applyMatrix=function(h){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(h)},Object.defineProperties(Jt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(h){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=h}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),ii.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(ii.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),Vd.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},zn.prototype.setLens=function(h,n){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==n&&(this.filmGauge=n),this.setFocalLength(h)},Object.defineProperties(Ys.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(h){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=h}},shadowCameraLeft:{set:function(h){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=h}},shadowCameraRight:{set:function(h){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=h}},shadowCameraTop:{set:function(h){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=h}},shadowCameraBottom:{set:function(h){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=h}},shadowCameraNear:{set:function(h){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=h}},shadowCameraFar:{set:function(h){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=h}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(h){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=h}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(h){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=h}},shadowMapHeight:{set:function(h){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=h}}}),Object.defineProperties(mn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===er},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(er)}}}),mn.prototype.setDynamic=function(h){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===h?er:cc),this},mn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},mn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ye.prototype.addIndex=function(h){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(h)},Ye.prototype.addAttribute=function(h,n){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),n&&n.isBufferAttribute||n&&n.isInterleavedBufferAttribute?"index"===h?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(n),this):this.setAttribute(h,n):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(h,new mn(arguments[1],arguments[2])))},Ye.prototype.addDrawCall=function(h,n,s){void 0!==s&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(h,n)},Ye.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Ye.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Ye.prototype.removeAttribute=function(h){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(h)},Ye.prototype.applyMatrix=function(h){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(h)},Object.defineProperties(Ye.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),xl.prototype.setDynamic=function(h){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===h?er:cc),this},xl.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Io.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Io.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Io.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Kc.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},Op.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(Zn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Re}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(h){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===h}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(h){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=h}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(yr.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(h){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=h}}}),en.prototype.clearTarget=function(h,n,s,a){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(h),this.clear(n,s,a)},en.prototype.animate=function(h){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(h)},en.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},en.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},en.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},en.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},en.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},en.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},en.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},en.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},en.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},en.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},en.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},en.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},en.prototype.enableScissorTest=function(h){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(h)},en.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},en.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},en.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},en.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},en.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},en.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},en.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},en.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},en.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},en.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(en.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(h){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=h}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(h){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=h}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(h){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===h?Tn:po}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(Yc.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ti.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(h){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=h}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(h){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=h}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(h){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=h}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(h){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=h}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(h){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=h}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(h){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=h}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(h){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=h}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(h){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=h}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(h){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=h}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(h){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=h}}}),class $y extends Jt{constructor(n){super(),this.type="Audio",this.listener=n,this.context=n.context,this.gain=this.context.createGain(),this.gain.connect(n.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(n){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=n,this.connect(),this}setMediaElementSource(n){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(n),this.connect(),this}setMediaStreamSource(n){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(n),this.connect(),this}setBuffer(n){return this.buffer=n,this.sourceType="buffer",this.autoplay&&this.play(),this}play(n=0){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");this._startedAt=this.context.currentTime+n;const s=this.context.createBufferSource();return s.buffer=this.buffer,s.loop=this.loop,s.loopStart=this.loopStart,s.loopEnd=this.loopEnd,s.onended=this.onEnded.bind(this),s.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=s,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}stop(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let n=1,s=this.filters.length;n<s;n++)this.filters[n-1].connect(this.filters[n]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let n=1,s=this.filters.length;n<s;n++)this.filters[n-1].disconnect(this.filters[n]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(n){return n||(n=[]),!0===this._connected?(this.disconnect(),this.filters=n.slice(),this.connect()):this.filters=n.slice(),this}setDetune(n){if(this.detune=n,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(n){return this.setFilters(n?[n]:[])}setPlaybackRate(n){if(!1!==this.hasPlaybackControl)return this.playbackRate=n,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(n){if(!1!==this.hasPlaybackControl)return this.loop=n,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}setLoopStart(n){return this.loopStart=n,this}setLoopEnd(n){return this.loopEnd=n,this}getVolume(){return this.gain.gain.value}setVolume(n){return this.gain.gain.setTargetAtTime(n,this.context.currentTime,.01),this}}.prototype.load=function(h){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const n=this;return(new gh).load(h,function(a){n.setBuffer(a)}),this},md.prototype.updateCubeMap=function(h,n){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(h,n)},md.prototype.clear=function(h,n,s,a){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(h,n,s,a)},cs.crossOrigin=void 0,cs.loadTexture=function(h,n,s,a){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const c=new ky;c.setCrossOrigin(this.crossOrigin);const u=c.load(h,s,void 0,a);return n&&(u.mapping=n),u},cs.loadTextureCube=function(h,n,s,a){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const c=new jx;c.setCrossOrigin(this.crossOrigin);const u=c.load(h,s,void 0,a);return n&&(u.mapping=n),u},cs.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},cs.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"139"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="139")},239:(Zu,Oa,Mi)=>{function it(lo,Cr,ci,Rs,Is,Hi,Ei){try{var Yi=lo[Hi](Ei),Dr=Yi.value}catch(ts){return void ci(ts)}Yi.done?Cr(Dr):Promise.resolve(Dr).then(Rs,Is)}function As(lo){return function(){var Cr=this,ci=arguments;return new Promise(function(Rs,Is){var Hi=lo.apply(Cr,ci);function Ei(Dr){it(Hi,Rs,Is,Ei,Yi,"next",Dr)}function Yi(Dr){it(Hi,Rs,Is,Ei,Yi,"throw",Dr)}Ei(void 0)})}}Mi.d(Oa,{Z:()=>As})}},Zu=>{Zu(Zu.s=892)}]);